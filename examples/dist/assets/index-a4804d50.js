let Rt,bi,Vc,Xc,Qg,So,Jg,Jt,xh,Ft,UA=(async()=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function Fr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wc(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Ee={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Ti={duration:.5,overwrite:!1,delay:0},bh,te,xt,Le=1e8,nt=1/Le,Th=Math.PI*2,e0=Th/4,r0=0,jc=Math.sqrt,s0=Math.cos,i0=Math.sin,Bt=function(e){return typeof e=="string"},bt=function(e){return typeof e=="function"},Br=function(e){return typeof e=="number"},Eh=function(e){return typeof e>"u"},mr=function(e){return typeof e=="object"},de=function(e){return e!==!1},wh=function(){return typeof window<"u"},Co=function(e){return bt(e)||Bt(e)},Yc=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},ee=Array.isArray,Ah=/(?:-?\.?\d|\.)+/gi,$c=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Ei=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Sh=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,qc=/[+-]=-?[.\d]+/,Kc=/[^,'"\[\]\s]+/gi,n0=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,dt,Fe,Ch,Ih,we={},Io={},Zc,Qc=function(e){return(Io=Ns(e,we))&&_e},Rh=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},Ro=function(e,t){return!t&&console.warn(e)},Jc=function(e,t){return e&&(we[e]=t)&&Io&&(Io[e]=t)||we},_n=function(){return 0},o0={suppressEvents:!0,isStart:!0,kill:!1},Mo={suppressEvents:!0,kill:!1},a0={suppressEvents:!0},Mh={},ss=[],Ph={},td,Ae={},Dh={},ed=30,Po=[],Oh="",kh=function(e){var t=e[0],r,s;if(mr(t)||bt(t)||(e=[e]),!(r=(t._gsap||{}).harness)){for(s=Po.length;s--&&!Po[s].targetTest(t););r=Po[s]}for(s=e.length;s--;)e[s]&&(e[s]._gsap||(e[s]._gsap=new Md(e[s],r)))||e.splice(s,1);return e},ks=function(e){return e._gsap||kh(Ge(e))[0]._gsap},rd=function(e,t,r){return(r=e[t])&&bt(r)?e[t]():Eh(r)&&e.getAttribute&&e.getAttribute(t)||r},pe=function(e,t){return(e=e.split(",")).forEach(t)||e},St=function(e){return Math.round(e*1e5)/1e5||0},Yt=function(e){return Math.round(e*1e7)/1e7||0},wi=function(e,t){var r=t.charAt(0),s=parseFloat(t.substr(2));return e=parseFloat(e),r==="+"?e+s:r==="-"?e-s:r==="*"?e*s:e/s},h0=function(e,t){for(var r=t.length,s=0;e.indexOf(t[s])<0&&++s<r;);return s<r},Do=function(){var e=ss.length,t=ss.slice(0),r,s;for(Ph={},ss.length=0,r=0;r<e;r++)s=t[r],s&&s._lazy&&(s.render(s._lazy[0],s._lazy[1],!0)._lazy=0)},sd=function(e,t,r,s){ss.length&&!te&&Do(),e.render(t,r,s||te&&t<0&&(e._initted||e._startAt)),ss.length&&!te&&Do()},id=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(Kc).length<2?t:Bt(e)?e.trim():e},nd=function(e){return e},Be=function(e,t){for(var r in t)r in e||(e[r]=t[r]);return e},l0=function(e){return function(t,r){for(var s in r)s in t||s==="duration"&&e||s==="ease"||(t[s]=r[s])}},Ns=function(e,t){for(var r in t)e[r]=t[r];return e},od=function e(t,r){for(var s in r)s!=="__proto__"&&s!=="constructor"&&s!=="prototype"&&(t[s]=mr(r[s])?e(t[s]||(t[s]={}),r[s]):r[s]);return t},Oo=function(e,t){var r={},s;for(s in e)s in t||(r[s]=e[s]);return r},mn=function(e){var t=e.parent||dt,r=e.keyframes?l0(ee(e.keyframes)):Be;if(de(e.inherit))for(;t;)r(e,t.vars.defaults),t=t.parent||t._dp;return e},u0=function(e,t){for(var r=e.length,s=r===t.length;s&&r--&&e[r]===t[r];);return r<0},ad=function(e,t,r,s,i){r===void 0&&(r="_first"),s===void 0&&(s="_last");var n=e[s],o;if(i)for(o=t[i];n&&n[i]>o;)n=n._prev;return n?(t._next=n._next,n._next=t):(t._next=e[r],e[r]=t),t._next?t._next._prev=t:e[s]=t,t._prev=n,t.parent=t._dp=e,t},ko=function(e,t,r,s){r===void 0&&(r="_first"),s===void 0&&(s="_last");var i=t._prev,n=t._next;i?i._next=n:e[r]===t&&(e[r]=n),n?n._prev=i:e[s]===t&&(e[s]=i),t._next=t._prev=t.parent=null},is=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Ls=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var r=e;r;)r._dirty=1,r=r.parent;return e},c0=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},Nh=function(e,t,r,s){return e._startAt&&(te?e._startAt.revert(Mo):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,s))},d0=function e(t){return!t||t._ts&&e(t.parent)},hd=function(e){return e._repeat?Ai(e._tTime,e=e.duration()+e._rDelay)*e:0},Ai=function(e,t){var r=Math.floor(e/=t);return e&&r===e?r-1:r},No=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Lo=function(e){return e._end=Yt(e._start+(e._tDur/Math.abs(e._ts||e._rts||nt)||0))},Fo=function(e,t){var r=e._dp;return r&&r.smoothChildTiming&&e._ts&&(e._start=Yt(r._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Lo(e),r._dirty||Ls(r,e)),e},ld=function(e,t){var r;if((t._time||t._initted&&!t._dur)&&(r=No(e.rawTime(),t),(!t._dur||yn(0,t.totalDuration(),r)-t._tTime>nt)&&t.render(r,!0)),Ls(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(r=e;r._dp;)r.rawTime()>=0&&r.totalTime(r._tTime),r=r._dp;e._zTime=-nt}},gr=function(e,t,r,s){return t.parent&&is(t),t._start=Yt((Br(r)?r:r||e!==dt?Ue(e,r,t):e._time)+t._delay),t._end=Yt(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),ad(e,t,"_first","_last",e._sort?"_start":0),Lh(t)||(e._recent=t),s||ld(e,t),e._ts<0&&Fo(e,e._tTime),e},ud=function(e,t){return(we.ScrollTrigger||Rh("scrollTrigger",t))&&we.ScrollTrigger.create(t,e)},cd=function(e,t,r,s,i){if(Wh(e,t,i),!e._initted)return 1;if(!r&&e._pt&&!te&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&td!==Se.frame)return ss.push(e),e._lazy=[i,s],1},p0=function e(t){var r=t.parent;return r&&r._ts&&r._initted&&!r._lock&&(r.rawTime()<0||e(r))},Lh=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},f0=function(e,t,r,s){var i=e.ratio,n=t<0||!t&&(!e._start&&p0(e)&&!(!e._initted&&Lh(e))||(e._ts<0||e._dp._ts<0)&&!Lh(e))?0:1,o=e._rDelay,a=0,h,u,d;if(o&&e._repeat&&(a=yn(0,e._tDur,t),u=Ai(a,o),e._yoyo&&u&1&&(n=1-n),u!==Ai(e._tTime,o)&&(i=1-n,e.vars.repeatRefresh&&e._initted&&e.invalidate())),n!==i||te||s||e._zTime===nt||!t&&e._zTime){if(!e._initted&&cd(e,t,s,r,a))return;for(d=e._zTime,e._zTime=t||(r?nt:0),r||(r=t&&!d),e.ratio=n,e._from&&(n=1-n),e._time=0,e._tTime=a,h=e._pt;h;)h.r(n,h.d),h=h._next;t<0&&Nh(e,t,r,!0),e._onUpdate&&!r&&He(e,"onUpdate"),a&&e._repeat&&!r&&e.parent&&He(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===n&&(n&&is(e,1),!r&&!te&&(He(e,n?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},_0=function(e,t,r){var s;if(r>t)for(s=e._first;s&&s._start<=r;){if(s.data==="isPause"&&s._start>t)return s;s=s._next}else for(s=e._last;s&&s._start>=r;){if(s.data==="isPause"&&s._start<t)return s;s=s._prev}},Si=function(e,t,r,s){var i=e._repeat,n=Yt(t)||0,o=e._tTime/e._tDur;return o&&!s&&(e._time*=n/e._dur),e._dur=n,e._tDur=i?i<0?1e10:Yt(n*(i+1)+e._rDelay*i):n,o>0&&!s&&Fo(e,e._tTime=e._tDur*o),e.parent&&Lo(e),r||Ls(e.parent,e),e},dd=function(e){return e instanceof le?Ls(e):Si(e,e._dur)},m0={_start:0,endTime:_n,totalDuration:_n},Ue=function e(t,r,s){var i=t.labels,n=t._recent||m0,o=t.duration()>=Le?n.endTime(!1):t._dur,a,h,u;return Bt(r)&&(isNaN(r)||r in i)?(h=r.charAt(0),u=r.substr(-1)==="%",a=r.indexOf("="),h==="<"||h===">"?(a>=0&&(r=r.replace(/=/,"")),(h==="<"?n._start:n.endTime(n._repeat>=0))+(parseFloat(r.substr(1))||0)*(u?(a<0?n:s).totalDuration()/100:1)):a<0?(r in i||(i[r]=o),i[r]):(h=parseFloat(r.charAt(a-1)+r.substr(a+1)),u&&s&&(h=h/100*(ee(s)?s[0]:s).totalDuration()),a>1?e(t,r.substr(0,a-1),s)+h:o+h)):r==null?o:+r},gn=function(e,t,r){var s=Br(t[1]),i=(s?2:1)+(e<2?0:1),n=t[i],o,a;if(s&&(n.duration=t[1]),n.parent=r,e){for(o=n,a=r;a&&!("immediateRender"in o);)o=a.vars.defaults||{},a=de(a.vars.inherit)&&a.parent;n.immediateRender=de(o.immediateRender),e<2?n.runBackwards=1:n.startAt=t[i-1]}return new Mt(t[0],n,t[i+1])},ns=function(e,t){return e||e===0?t(e):t},yn=function(e,t,r){return r<e?e:r>t?t:r},re=function(e,t){return!Bt(e)||!(t=n0.exec(e))?"":t[1]},g0=function(e,t,r){return ns(r,function(s){return yn(e,t,s)})},Fh=[].slice,pd=function(e,t){return e&&mr(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&mr(e[0]))&&!e.nodeType&&e!==Fe},y0=function(e,t,r){return r===void 0&&(r=[]),e.forEach(function(s){var i;return Bt(s)&&!t||pd(s,1)?(i=r).push.apply(i,Ge(s)):r.push(s)})||r},Ge=function(e,t,r){return xt&&!t&&xt.selector?xt.selector(e):Bt(e)&&!r&&(Ch||!Ii())?Fh.call((t||Ih).querySelectorAll(e),0):ee(e)?y0(e,r):pd(e)?Fh.call(e,0):e?[e]:[]},Bh=function(e){return e=Ge(e)[0]||Ro("Invalid scope")||{},function(t){var r=e.current||e.nativeElement||e;return Ge(t,r.querySelectorAll?r:r===e?Ro("Invalid scope")||Ih.createElement("div"):e)}},fd=function(e){return e.sort(function(){return .5-Math.random()})},_d=function(e){if(bt(e))return e;var t=mr(e)?e:{each:e},r=Fs(t.ease),s=t.from||0,i=parseFloat(t.base)||0,n={},o=s>0&&s<1,a=isNaN(s)||o,h=t.axis,u=s,d=s;return Bt(s)?u=d={center:.5,edges:.5,end:1}[s]||0:!o&&a&&(u=s[0],d=s[1]),function(l,c,p){var f=(p||t).length,_=n[f],m,g,v,y,x,E,T,w,b;if(!_){if(b=t.grid==="auto"?0:(t.grid||[1,Le])[1],!b){for(T=-Le;T<(T=p[b++].getBoundingClientRect().left)&&b<f;);b--}for(_=n[f]=[],m=a?Math.min(b,f)*u-.5:s%b,g=b===Le?0:a?f*d/b-.5:s/b|0,T=0,w=Le,E=0;E<f;E++)v=E%b-m,y=g-(E/b|0),_[E]=x=h?Math.abs(h==="y"?y:v):jc(v*v+y*y),x>T&&(T=x),x<w&&(w=x);s==="random"&&fd(_),_.max=T-w,_.min=w,_.v=f=(parseFloat(t.amount)||parseFloat(t.each)*(b>f?f-1:h?h==="y"?f/b:b:Math.max(b,f/b))||0)*(s==="edges"?-1:1),_.b=f<0?i-f:i,_.u=re(t.amount||t.each)||0,r=r&&f<0?Cd(r):r}return f=(_[l]-_.min)/_.max||0,Yt(_.b+(r?r(f):f)*_.v)+_.u}},Uh=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(r){var s=Yt(Math.round(parseFloat(r)/e)*e*t);return(s-s%1)/t+(Br(r)?0:re(r))}},md=function(e,t){var r=ee(e),s,i;return!r&&mr(e)&&(s=r=e.radius||Le,e.values?(e=Ge(e.values),(i=!Br(e[0]))&&(s*=s)):e=Uh(e.increment)),ns(t,r?bt(e)?function(n){return i=e(n),Math.abs(i-n)<=s?i:n}:function(n){for(var o=parseFloat(i?n.x:n),a=parseFloat(i?n.y:0),h=Le,u=0,d=e.length,l,c;d--;)i?(l=e[d].x-o,c=e[d].y-a,l=l*l+c*c):l=Math.abs(e[d]-o),l<h&&(h=l,u=d);return u=!s||h<=s?e[u]:n,i||u===n||Br(n)?u:u+re(n)}:Uh(e))},gd=function(e,t,r,s){return ns(ee(e)?!t:r===!0?!!(r=0):!s,function(){return ee(e)?e[~~(Math.random()*e.length)]:(r=r||1e-5)&&(s=r<1?Math.pow(10,(r+"").length-2):1)&&Math.floor(Math.round((e-r/2+Math.random()*(t-e+r*.99))/r)*r*s)/s})},v0=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(s){return t.reduce(function(i,n){return n(i)},s)}},x0=function(e,t){return function(r){return e(parseFloat(r))+(t||re(r))}},b0=function(e,t,r){return vd(e,t,0,1,r)},yd=function(e,t,r){return ns(r,function(s){return e[~~t(s)]})},T0=function e(t,r,s){var i=r-t;return ee(t)?yd(t,e(0,t.length),r):ns(s,function(n){return(i+(n-t)%i)%i+t})},E0=function e(t,r,s){var i=r-t,n=i*2;return ee(t)?yd(t,e(0,t.length-1),r):ns(s,function(o){return o=(n+(o-t)%n)%n||0,t+(o>i?n-o:o)})},vn=function(e){for(var t=0,r="",s,i,n,o;~(s=e.indexOf("random(",t));)n=e.indexOf(")",s),o=e.charAt(s+7)==="[",i=e.substr(s+7,n-s-7).match(o?Kc:Ah),r+=e.substr(t,s-t)+gd(o?i:+i[0],o?0:+i[1],+i[2]||1e-5),t=n+1;return r+e.substr(t,e.length-t)},vd=function(e,t,r,s,i){var n=t-e,o=s-r;return ns(i,function(a){return r+((a-e)/n*o||0)})},w0=function e(t,r,s,i){var n=isNaN(t+r)?0:function(p){return(1-p)*t+p*r};if(!n){var o=Bt(t),a={},h,u,d,l,c;if(s===!0&&(i=1)&&(s=null),o)t={p:t},r={p:r};else if(ee(t)&&!ee(r)){for(d=[],l=t.length,c=l-2,u=1;u<l;u++)d.push(e(t[u-1],t[u]));l--,n=function(p){p*=l;var f=Math.min(c,~~p);return d[f](p-f)},s=r}else i||(t=Ns(ee(t)?[]:{},t));if(!d){for(h in r)Vh.call(a,t,h,"get",r[h]);n=function(p){return $h(p,a)||(o?t.p:t)}}}return ns(s,n)},xd=function(e,t,r){var s=e.labels,i=Le,n,o,a;for(n in s)o=s[n]-t,o<0==!!r&&o&&i>(o=Math.abs(o))&&(a=n,i=o);return a},He=function(e,t,r){var s=e.vars,i=s[t],n=xt,o=e._ctx,a,h,u;if(i)return a=s[t+"Params"],h=s.callbackScope||e,r&&ss.length&&Do(),o&&(xt=o),u=a?i.apply(h,a):i.call(h),xt=n,u},xn=function(e){return is(e),e.scrollTrigger&&e.scrollTrigger.kill(!!te),e.progress()<1&&He(e,"onInterrupt"),e},Ci,bd=[],Td=function(e){if(wh()&&e){e=!e.name&&e.default||e;var t=e.name,r=bt(e),s=t&&!r&&e.init?function(){this._props=[]}:e,i={init:_n,render:$h,add:Vh,kill:G0,modifier:U0,rawVars:0},n={targetTest:0,get:0,getSetter:Yh,aliases:{},register:0};if(Ii(),e!==s){if(Ae[t])return;Be(s,Be(Oo(e,i),n)),Ns(s.prototype,Ns(i,Oo(e,n))),Ae[s.prop=t]=s,e.targetTest&&(Po.push(s),Mh[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}Jc(t,s),e.register&&e.register(_e,s,fe)}else e&&bd.push(e)},ot=255,bn={aqua:[0,ot,ot],lime:[0,ot,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,ot],navy:[0,0,128],white:[ot,ot,ot],olive:[128,128,0],yellow:[ot,ot,0],orange:[ot,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[ot,0,0],pink:[ot,192,203],cyan:[0,ot,ot],transparent:[ot,ot,ot,0]},Gh=function(e,t,r){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(r-t)*e*6:e<.5?r:e*3<2?t+(r-t)*(2/3-e)*6:t)*ot+.5|0},Ed=function(e,t,r){var s=e?Br(e)?[e>>16,e>>8&ot,e&ot]:0:bn.black,i,n,o,a,h,u,d,l,c,p;if(!s){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),bn[e])s=bn[e];else if(e.charAt(0)==="#"){if(e.length<6&&(i=e.charAt(1),n=e.charAt(2),o=e.charAt(3),e="#"+i+i+n+n+o+o+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return s=parseInt(e.substr(1,6),16),[s>>16,s>>8&ot,s&ot,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),s=[e>>16,e>>8&ot,e&ot]}else if(e.substr(0,3)==="hsl"){if(s=p=e.match(Ah),!t)a=+s[0]%360/360,h=+s[1]/100,u=+s[2]/100,n=u<=.5?u*(h+1):u+h-u*h,i=u*2-n,s.length>3&&(s[3]*=1),s[0]=Gh(a+1/3,i,n),s[1]=Gh(a,i,n),s[2]=Gh(a-1/3,i,n);else if(~e.indexOf("="))return s=e.match($c),r&&s.length<4&&(s[3]=1),s}else s=e.match(Ah)||bn.transparent;s=s.map(Number)}return t&&!p&&(i=s[0]/ot,n=s[1]/ot,o=s[2]/ot,d=Math.max(i,n,o),l=Math.min(i,n,o),u=(d+l)/2,d===l?a=h=0:(c=d-l,h=u>.5?c/(2-d-l):c/(d+l),a=d===i?(n-o)/c+(n<o?6:0):d===n?(o-i)/c+2:(i-n)/c+4,a*=60),s[0]=~~(a+.5),s[1]=~~(h*100+.5),s[2]=~~(u*100+.5)),r&&s.length<4&&(s[3]=1),s},wd=function(e){var t=[],r=[],s=-1;return e.split(os).forEach(function(i){var n=i.match(Ei)||[];t.push.apply(t,n),r.push(s+=n.length+1)}),t.c=r,t},Ad=function(e,t,r){var s="",i=(e+s).match(os),n=t?"hsla(":"rgba(",o=0,a,h,u,d;if(!i)return e;if(i=i.map(function(l){return(l=Ed(l,t,1))&&n+(t?l[0]+","+l[1]+"%,"+l[2]+"%,"+l[3]:l.join(","))+")"}),r&&(u=wd(e),a=r.c,a.join(s)!==u.c.join(s)))for(h=e.replace(os,"1").split(Ei),d=h.length-1;o<d;o++)s+=h[o]+(~a.indexOf(o)?i.shift()||n+"0,0,0,0)":(u.length?u:i.length?i:r).shift());if(!h)for(h=e.split(os),d=h.length-1;o<d;o++)s+=h[o]+i[o];return s+h[d]},os=function(){var e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in bn)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),A0=/hsl[a]?\(/,Sd=function(e){var t=e.join(" "),r;if(os.lastIndex=0,os.test(t))return r=A0.test(t),e[1]=Ad(e[1],r),e[0]=Ad(e[0],r,wd(e[1])),!0},Tn,Se=function(){var e=Date.now,t=500,r=33,s=e(),i=s,n=1e3/240,o=n,a=[],h,u,d,l,c,p,f=function _(m){var g=e()-i,v=m===!0,y,x,E,T;if(g>t&&(s+=g-r),i+=g,E=i-s,y=E-o,(y>0||v)&&(T=++l.frame,c=E-l.time*1e3,l.time=E=E/1e3,o+=y+(y>=n?4:n-y),x=1),v||(h=u(_)),x)for(p=0;p<a.length;p++)a[p](E,c,T,m)};return l={time:0,frame:0,tick:function(){f(!0)},deltaRatio:function(_){return c/(1e3/(_||60))},wake:function(){Zc&&(!Ch&&wh()&&(Fe=Ch=window,Ih=Fe.document||{},we.gsap=_e,(Fe.gsapVersions||(Fe.gsapVersions=[])).push(_e.version),Qc(Io||Fe.GreenSockGlobals||!Fe.gsap&&Fe||{}),d=Fe.requestAnimationFrame,bd.forEach(Td)),h&&l.sleep(),u=d||function(_){return setTimeout(_,o-l.time*1e3+1|0)},Tn=1,f(2))},sleep:function(){(d?Fe.cancelAnimationFrame:clearTimeout)(h),Tn=0,u=_n},lagSmoothing:function(_,m){t=_||1/0,r=Math.min(m||33,t)},fps:function(_){n=1e3/(_||240),o=l.time*1e3+n},add:function(_,m,g){var v=m?function(y,x,E,T){_(y,x,E,T),l.remove(v)}:_;return l.remove(_),a[g?"unshift":"push"](v),Ii(),v},remove:function(_,m){~(m=a.indexOf(_))&&a.splice(m,1)&&p>=m&&p--},_listeners:a},l}(),Ii=function(){return!Tn&&Se.wake()},tt={},S0=/^[\d.\-M][\d.\-,\s]/,C0=/["']/g,I0=function(e){for(var t={},r=e.substr(1,e.length-3).split(":"),s=r[0],i=1,n=r.length,o,a,h;i<n;i++)a=r[i],o=i!==n-1?a.lastIndexOf(","):a.length,h=a.substr(0,o),t[s]=isNaN(h)?h.replace(C0,"").trim():+h,s=a.substr(o+1).trim();return t},R0=function(e){var t=e.indexOf("(")+1,r=e.indexOf(")"),s=e.indexOf("(",t);return e.substring(t,~s&&s<r?e.indexOf(")",r+1):r)},M0=function(e){var t=(e+"").split("("),r=tt[t[0]];return r&&t.length>1&&r.config?r.config.apply(null,~e.indexOf("{")?[I0(t[1])]:R0(e).split(",").map(id)):tt._CE&&S0.test(e)?tt._CE("",e):r},Cd=function(e){return function(t){return 1-e(1-t)}},Id=function e(t,r){for(var s=t._first,i;s;)s instanceof le?e(s,r):s.vars.yoyoEase&&(!s._yoyo||!s._repeat)&&s._yoyo!==r&&(s.timeline?e(s.timeline,r):(i=s._ease,s._ease=s._yEase,s._yEase=i,s._yoyo=r)),s=s._next},Fs=function(e,t){return e&&(bt(e)?e:tt[e]||M0(e))||t},Bs=function(e,t,r,s){r===void 0&&(r=function(o){return 1-t(1-o)}),s===void 0&&(s=function(o){return o<.5?t(o*2)/2:1-t((1-o)*2)/2});var i={easeIn:t,easeOut:r,easeInOut:s},n;return pe(e,function(o){tt[o]=we[o]=i,tt[n=o.toLowerCase()]=r;for(var a in i)tt[n+(a==="easeIn"?".in":a==="easeOut"?".out":".inOut")]=tt[o+"."+a]=i[a]}),i},Rd=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},Hh=function e(t,r,s){var i=r>=1?r:1,n=(s||(t?.3:.45))/(r<1?r:1),o=n/Th*(Math.asin(1/i)||0),a=function(u){return u===1?1:i*Math.pow(2,-10*u)*i0((u-o)*n)+1},h=t==="out"?a:t==="in"?function(u){return 1-a(1-u)}:Rd(a);return n=Th/n,h.config=function(u,d){return e(t,u,d)},h},zh=function e(t,r){r===void 0&&(r=1.70158);var s=function(n){return n?--n*n*((r+1)*n+r)+1:0},i=t==="out"?s:t==="in"?function(n){return 1-s(1-n)}:Rd(s);return i.config=function(n){return e(t,n)},i};pe("Linear,Quad,Cubic,Quart,Quint,Strong",function(e,t){var r=t<5?t+1:t;Bs(e+",Power"+(r-1),t?function(s){return Math.pow(s,r)}:function(s){return s},function(s){return 1-Math.pow(1-s,r)},function(s){return s<.5?Math.pow(s*2,r)/2:1-Math.pow((1-s)*2,r)/2})}),tt.Linear.easeNone=tt.none=tt.Linear.easeIn,Bs("Elastic",Hh("in"),Hh("out"),Hh()),function(e,t){var r=1/t,s=2*r,i=2.5*r,n=function(o){return o<r?e*o*o:o<s?e*Math.pow(o-1.5/t,2)+.75:o<i?e*(o-=2.25/t)*o+.9375:e*Math.pow(o-2.625/t,2)+.984375};Bs("Bounce",function(o){return 1-n(1-o)},n)}(7.5625,2.75),Bs("Expo",function(e){return e?Math.pow(2,10*(e-1)):0}),Bs("Circ",function(e){return-(jc(1-e*e)-1)}),Bs("Sine",function(e){return e===1?1:-s0(e*e0)+1}),Bs("Back",zh("in"),zh("out"),zh()),tt.SteppedEase=tt.steps=we.SteppedEase={config:function(e,t){e===void 0&&(e=1);var r=1/e,s=e+(t?0:1),i=t?1:0,n=1-nt;return function(o){return((s*yn(0,n,o)|0)+i)*r}}},Ti.ease=tt["quad.out"],pe("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(e){return Oh+=e+","+e+"Params,"});var Md=function(e,t){this.id=r0++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:rd,this.set=t?t.getSetter:Yh},En=function(){function e(r){this.vars=r,this._delay=+r.delay||0,(this._repeat=r.repeat===1/0?-2:r.repeat||0)&&(this._rDelay=r.repeatDelay||0,this._yoyo=!!r.yoyo||!!r.yoyoEase),this._ts=1,Si(this,+r.duration,1,1),this.data=r.data,xt&&(this._ctx=xt,xt.data.push(this)),Tn||Se.wake()}var t=e.prototype;return t.delay=function(r){return r||r===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+r-this._delay),this._delay=r,this):this._delay},t.duration=function(r){return arguments.length?this.totalDuration(this._repeat>0?r+(r+this._rDelay)*this._repeat:r):this.totalDuration()&&this._dur},t.totalDuration=function(r){return arguments.length?(this._dirty=0,Si(this,this._repeat<0?r:(r-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(r,s){if(Ii(),!arguments.length)return this._tTime;var i=this._dp;if(i&&i.smoothChildTiming&&this._ts){for(Fo(this,r),!i._dp||i.parent||ld(i,this);i&&i.parent;)i.parent._time!==i._start+(i._ts>=0?i._tTime/i._ts:(i.totalDuration()-i._tTime)/-i._ts)&&i.totalTime(i._tTime,!0),i=i.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&r<this._tDur||this._ts<0&&r>0||!this._tDur&&!r)&&gr(this._dp,this,this._start-this._delay)}return(this._tTime!==r||!this._dur&&!s||this._initted&&Math.abs(this._zTime)===nt||!r&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=r),sd(this,r,s)),this},t.time=function(r,s){return arguments.length?this.totalTime(Math.min(this.totalDuration(),r+hd(this))%(this._dur+this._rDelay)||(r?this._dur:0),s):this._time},t.totalProgress=function(r,s){return arguments.length?this.totalTime(this.totalDuration()*r,s):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(r,s){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-r:r)+hd(this),s):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(r,s){var i=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(r-1)*i,s):this._repeat?Ai(this._tTime,i)+1:1},t.timeScale=function(r){if(!arguments.length)return this._rts===-nt?0:this._rts;if(this._rts===r)return this;var s=this.parent&&this._ts?No(this.parent._time,this):this._tTime;return this._rts=+r||0,this._ts=this._ps||r===-nt?0:this._rts,this.totalTime(yn(-Math.abs(this._delay),this._tDur,s),!0),Lo(this),c0(this)},t.paused=function(r){return arguments.length?(this._ps!==r&&(this._ps=r,r?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Ii(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==nt&&(this._tTime-=nt)))),this):this._ps},t.startTime=function(r){if(arguments.length){this._start=r;var s=this.parent||this._dp;return s&&(s._sort||!this.parent)&&gr(s,this,r-this._delay),this}return this._start},t.endTime=function(r){return this._start+(de(r)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(r){var s=this.parent||this._dp;return s?r&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?No(s.rawTime(r),this):this._tTime:this._tTime},t.revert=function(r){r===void 0&&(r=a0);var s=te;return te=r,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(r),this.totalTime(-.01,r.suppressEvents)),this.data!=="nested"&&r.kill!==!1&&this.kill(),te=s,this},t.globalTime=function(r){for(var s=this,i=arguments.length?r:s.rawTime();s;)i=s._start+i/(s._ts||1),s=s._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(r):i},t.repeat=function(r){return arguments.length?(this._repeat=r===1/0?-2:r,dd(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(r){if(arguments.length){var s=this._time;return this._rDelay=r,dd(this),s?this.time(s):this}return this._rDelay},t.yoyo=function(r){return arguments.length?(this._yoyo=r,this):this._yoyo},t.seek=function(r,s){return this.totalTime(Ue(this,r),de(s))},t.restart=function(r,s){return this.play().totalTime(r?-this._delay:0,de(s))},t.play=function(r,s){return r!=null&&this.seek(r,s),this.reversed(!1).paused(!1)},t.reverse=function(r,s){return r!=null&&this.seek(r||this.totalDuration(),s),this.reversed(!0).paused(!1)},t.pause=function(r,s){return r!=null&&this.seek(r,s),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(r){return arguments.length?(!!r!==this.reversed()&&this.timeScale(-this._rts||(r?-nt:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-nt,this},t.isActive=function(){var r=this.parent||this._dp,s=this._start,i;return!!(!r||this._ts&&this._initted&&r.isActive()&&(i=r.rawTime(!0))>=s&&i<this.endTime(!0)-nt)},t.eventCallback=function(r,s,i){var n=this.vars;return arguments.length>1?(s?(n[r]=s,i&&(n[r+"Params"]=i),r==="onUpdate"&&(this._onUpdate=s)):delete n[r],this):n[r]},t.then=function(r){var s=this;return new Promise(function(i){var n=bt(r)?r:nd,o=function(){var a=s.then;s.then=null,bt(n)&&(n=n(s))&&(n.then||n===s)&&(s.then=a),i(n),s.then=a};s._initted&&s.totalProgress()===1&&s._ts>=0||!s._tTime&&s._ts<0?o():s._prom=o})},t.kill=function(){xn(this)},e}();Be(En.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-nt,_prom:0,_ps:!1,_rts:1});var le=function(e){Wc(t,e);function t(s,i){var n;return s===void 0&&(s={}),n=e.call(this,s)||this,n.labels={},n.smoothChildTiming=!!s.smoothChildTiming,n.autoRemoveChildren=!!s.autoRemoveChildren,n._sort=de(s.sortChildren),dt&&gr(s.parent||dt,Fr(n),i),s.reversed&&n.reverse(),s.paused&&n.paused(!0),s.scrollTrigger&&ud(Fr(n),s.scrollTrigger),n}var r=t.prototype;return r.to=function(s,i,n){return gn(0,arguments,this),this},r.from=function(s,i,n){return gn(1,arguments,this),this},r.fromTo=function(s,i,n,o){return gn(2,arguments,this),this},r.set=function(s,i,n){return i.duration=0,i.parent=this,mn(i).repeatDelay||(i.repeat=0),i.immediateRender=!!i.immediateRender,new Mt(s,i,Ue(this,n),1),this},r.call=function(s,i,n){return gr(this,Mt.delayedCall(0,s,i),n)},r.staggerTo=function(s,i,n,o,a,h,u){return n.duration=i,n.stagger=n.stagger||o,n.onComplete=h,n.onCompleteParams=u,n.parent=this,new Mt(s,n,Ue(this,a)),this},r.staggerFrom=function(s,i,n,o,a,h,u){return n.runBackwards=1,mn(n).immediateRender=de(n.immediateRender),this.staggerTo(s,i,n,o,a,h,u)},r.staggerFromTo=function(s,i,n,o,a,h,u,d){return o.startAt=n,mn(o).immediateRender=de(o.immediateRender),this.staggerTo(s,i,o,a,h,u,d)},r.render=function(s,i,n){var o=this._time,a=this._dirty?this.totalDuration():this._tDur,h=this._dur,u=s<=0?0:Yt(s),d=this._zTime<0!=s<0&&(this._initted||!h),l,c,p,f,_,m,g,v,y,x,E,T;if(this!==dt&&u>a&&s>=0&&(u=a),u!==this._tTime||n||d){if(o!==this._time&&h&&(u+=this._time-o,s+=this._time-o),l=u,y=this._start,v=this._ts,m=!v,d&&(h||(o=this._zTime),(s||!i)&&(this._zTime=s)),this._repeat){if(E=this._yoyo,_=h+this._rDelay,this._repeat<-1&&s<0)return this.totalTime(_*100+s,i,n);if(l=Yt(u%_),u===a?(f=this._repeat,l=h):(f=~~(u/_),f&&f===u/_&&(l=h,f--),l>h&&(l=h)),x=Ai(this._tTime,_),!o&&this._tTime&&x!==f&&this._tTime-x*_-this._dur<=0&&(x=f),E&&f&1&&(l=h-l,T=1),f!==x&&!this._lock){var w=E&&x&1,b=w===(E&&f&1);if(f<x&&(w=!w),o=w?0:h,this._lock=1,this.render(o||(T?0:Yt(f*_)),i,!h)._lock=0,this._tTime=u,!i&&this.parent&&He(this,"onRepeat"),this.vars.repeatRefresh&&!T&&(this.invalidate()._lock=1),o&&o!==this._time||m!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(h=this._dur,a=this._tDur,b&&(this._lock=2,o=w?h:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!T&&this.invalidate()),this._lock=0,!this._ts&&!m)return this;Id(this,T)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(g=_0(this,Yt(o),Yt(l)),g&&(u-=l-(l=g._start))),this._tTime=u,this._time=l,this._act=!v,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=s,o=0),!o&&l&&!i&&!f&&(He(this,"onStart"),this._tTime!==u))return this;if(l>=o&&s>=0)for(c=this._first;c;){if(p=c._next,(c._act||l>=c._start)&&c._ts&&g!==c){if(c.parent!==this)return this.render(s,i,n);if(c.render(c._ts>0?(l-c._start)*c._ts:(c._dirty?c.totalDuration():c._tDur)+(l-c._start)*c._ts,i,n),l!==this._time||!this._ts&&!m){g=0,p&&(u+=this._zTime=-nt);break}}c=p}else{c=this._last;for(var A=s<0?s:l;c;){if(p=c._prev,(c._act||A<=c._end)&&c._ts&&g!==c){if(c.parent!==this)return this.render(s,i,n);if(c.render(c._ts>0?(A-c._start)*c._ts:(c._dirty?c.totalDuration():c._tDur)+(A-c._start)*c._ts,i,n||te&&(c._initted||c._startAt)),l!==this._time||!this._ts&&!m){g=0,p&&(u+=this._zTime=A?-nt:nt);break}}c=p}}if(g&&!i&&(this.pause(),g.render(l>=o?0:-nt)._zTime=l>=o?1:-1,this._ts))return this._start=y,Lo(this),this.render(s,i,n);this._onUpdate&&!i&&He(this,"onUpdate",!0),(u===a&&this._tTime>=this.totalDuration()||!u&&o)&&(y===this._start||Math.abs(v)!==Math.abs(this._ts))&&(this._lock||((s||!h)&&(u===a&&this._ts>0||!u&&this._ts<0)&&is(this,1),!i&&!(s<0&&!o)&&(u||o||!a)&&(He(this,u===a&&s>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<a&&this.timeScale()>0)&&this._prom())))}return this},r.add=function(s,i){var n=this;if(Br(i)||(i=Ue(this,i,s)),!(s instanceof En)){if(ee(s))return s.forEach(function(o){return n.add(o,i)}),this;if(Bt(s))return this.addLabel(s,i);if(bt(s))s=Mt.delayedCall(0,s);else return this}return this!==s?gr(this,s,i):this},r.getChildren=function(s,i,n,o){s===void 0&&(s=!0),i===void 0&&(i=!0),n===void 0&&(n=!0),o===void 0&&(o=-Le);for(var a=[],h=this._first;h;)h._start>=o&&(h instanceof Mt?i&&a.push(h):(n&&a.push(h),s&&a.push.apply(a,h.getChildren(!0,i,n)))),h=h._next;return a},r.getById=function(s){for(var i=this.getChildren(1,1,1),n=i.length;n--;)if(i[n].vars.id===s)return i[n]},r.remove=function(s){return Bt(s)?this.removeLabel(s):bt(s)?this.killTweensOf(s):(ko(this,s),s===this._recent&&(this._recent=this._last),Ls(this))},r.totalTime=function(s,i){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Yt(Se.time-(this._ts>0?s/this._ts:(this.totalDuration()-s)/-this._ts))),e.prototype.totalTime.call(this,s,i),this._forcing=0,this):this._tTime},r.addLabel=function(s,i){return this.labels[s]=Ue(this,i),this},r.removeLabel=function(s){return delete this.labels[s],this},r.addPause=function(s,i,n){var o=Mt.delayedCall(0,i||_n,n);return o.data="isPause",this._hasPause=1,gr(this,o,Ue(this,s))},r.removePause=function(s){var i=this._first;for(s=Ue(this,s);i;)i._start===s&&i.data==="isPause"&&is(i),i=i._next},r.killTweensOf=function(s,i,n){for(var o=this.getTweensOf(s,n),a=o.length;a--;)as!==o[a]&&o[a].kill(s,i);return this},r.getTweensOf=function(s,i){for(var n=[],o=Ge(s),a=this._first,h=Br(i),u;a;)a instanceof Mt?h0(a._targets,o)&&(h?(!as||a._initted&&a._ts)&&a.globalTime(0)<=i&&a.globalTime(a.totalDuration())>i:!i||a.isActive())&&n.push(a):(u=a.getTweensOf(o,i)).length&&n.push.apply(n,u),a=a._next;return n},r.tweenTo=function(s,i){i=i||{};var n=this,o=Ue(n,s),a=i,h=a.startAt,u=a.onStart,d=a.onStartParams,l=a.immediateRender,c,p=Mt.to(n,Be({ease:i.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:i.duration||Math.abs((o-(h&&"time"in h?h.time:n._time))/n.timeScale())||nt,onStart:function(){if(n.pause(),!c){var f=i.duration||Math.abs((o-(h&&"time"in h?h.time:n._time))/n.timeScale());p._dur!==f&&Si(p,f,0,1).render(p._time,!0,!0),c=1}u&&u.apply(p,d||[])}},i));return l?p.render(0):p},r.tweenFromTo=function(s,i,n){return this.tweenTo(i,Be({startAt:{time:Ue(this,s)}},n))},r.recent=function(){return this._recent},r.nextLabel=function(s){return s===void 0&&(s=this._time),xd(this,Ue(this,s))},r.previousLabel=function(s){return s===void 0&&(s=this._time),xd(this,Ue(this,s),1)},r.currentLabel=function(s){return arguments.length?this.seek(s,!0):this.previousLabel(this._time+nt)},r.shiftChildren=function(s,i,n){n===void 0&&(n=0);for(var o=this._first,a=this.labels,h;o;)o._start>=n&&(o._start+=s,o._end+=s),o=o._next;if(i)for(h in a)a[h]>=n&&(a[h]+=s);return Ls(this)},r.invalidate=function(s){var i=this._first;for(this._lock=0;i;)i.invalidate(s),i=i._next;return e.prototype.invalidate.call(this,s)},r.clear=function(s){s===void 0&&(s=!0);for(var i=this._first,n;i;)n=i._next,this.remove(i),i=n;return this._dp&&(this._time=this._tTime=this._pTime=0),s&&(this.labels={}),Ls(this)},r.totalDuration=function(s){var i=0,n=this,o=n._last,a=Le,h,u,d;if(arguments.length)return n.timeScale((n._repeat<0?n.duration():n.totalDuration())/(n.reversed()?-s:s));if(n._dirty){for(d=n.parent;o;)h=o._prev,o._dirty&&o.totalDuration(),u=o._start,u>a&&n._sort&&o._ts&&!n._lock?(n._lock=1,gr(n,o,u-o._delay,1)._lock=0):a=u,u<0&&o._ts&&(i-=u,(!d&&!n._dp||d&&d.smoothChildTiming)&&(n._start+=u/n._ts,n._time-=u,n._tTime-=u),n.shiftChildren(-u,!1,-1/0),a=0),o._end>i&&o._ts&&(i=o._end),o=h;Si(n,n===dt&&n._time>i?n._time:i,1,1),n._dirty=0}return n._tDur},t.updateRoot=function(s){if(dt._ts&&(sd(dt,No(s,dt)),td=Se.frame),Se.frame>=ed){ed+=Ee.autoSleep||120;var i=dt._first;if((!i||!i._ts)&&Ee.autoSleep&&Se._listeners.length<2){for(;i&&!i._ts;)i=i._next;i||Se.sleep()}}},t}(En);Be(le.prototype,{_lock:0,_hasPause:0,_forcing:0});var P0=function(e,t,r,s,i,n,o){var a=new fe(this._pt,e,t,0,1,Ld,null,i),h=0,u=0,d,l,c,p,f,_,m,g;for(a.b=r,a.e=s,r+="",s+="",(m=~s.indexOf("random("))&&(s=vn(s)),n&&(g=[r,s],n(g,e,t),r=g[0],s=g[1]),l=r.match(Sh)||[];d=Sh.exec(s);)p=d[0],f=s.substring(h,d.index),c?c=(c+1)%5:f.substr(-5)==="rgba("&&(c=1),p!==l[u++]&&(_=parseFloat(l[u-1])||0,a._pt={_next:a._pt,p:f||u===1?f:",",s:_,c:p.charAt(1)==="="?wi(_,p)-_:parseFloat(p)-_,m:c&&c<4?Math.round:0},h=Sh.lastIndex);return a.c=h<s.length?s.substring(h,s.length):"",a.fp=o,(qc.test(s)||m)&&(a.e=0),this._pt=a,a},Vh=function(e,t,r,s,i,n,o,a,h,u){bt(s)&&(s=s(i||0,e,n));var d=e[t],l=r!=="get"?r:bt(d)?h?e[t.indexOf("set")||!bt(e["get"+t.substr(3)])?t:"get"+t.substr(3)](h):e[t]():d,c=bt(d)?h?L0:kd:jh,p;if(Bt(s)&&(~s.indexOf("random(")&&(s=vn(s)),s.charAt(1)==="="&&(p=wi(l,s)+(re(l)||0),(p||p===0)&&(s=p))),!u||l!==s||Xh)return!isNaN(l*s)&&s!==""?(p=new fe(this._pt,e,t,+l||0,s-(l||0),typeof d=="boolean"?B0:Nd,0,c),h&&(p.fp=h),o&&p.modifier(o,this,e),this._pt=p):(!d&&!(t in e)&&Rh(t,s),P0.call(this,e,t,l,s,c,a||Ee.stringFilter,h))},D0=function(e,t,r,s,i){if(bt(e)&&(e=wn(e,i,t,r,s)),!mr(e)||e.style&&e.nodeType||ee(e)||Yc(e))return Bt(e)?wn(e,i,t,r,s):e;var n={},o;for(o in e)n[o]=wn(e[o],i,t,r,s);return n},Pd=function(e,t,r,s,i,n){var o,a,h,u;if(Ae[e]&&(o=new Ae[e]).init(i,o.rawVars?t[e]:D0(t[e],s,i,n,r),r,s,n)!==!1&&(r._pt=a=new fe(r._pt,i,e,0,1,o.render,o,0,o.priority),r!==Ci))for(h=r._ptLookup[r._targets.indexOf(i)],u=o._props.length;u--;)h[o._props[u]]=a;return o},as,Xh,Wh=function e(t,r,s){var i=t.vars,n=i.ease,o=i.startAt,a=i.immediateRender,h=i.lazy,u=i.onUpdate,d=i.onUpdateParams,l=i.callbackScope,c=i.runBackwards,p=i.yoyoEase,f=i.keyframes,_=i.autoRevert,m=t._dur,g=t._startAt,v=t._targets,y=t.parent,x=y&&y.data==="nested"?y.vars.targets:v,E=t._overwrite==="auto"&&!bh,T=t.timeline,w,b,A,R,S,M,I,C,O,L,D,Y,Z;if(T&&(!f||!n)&&(n="none"),t._ease=Fs(n,Ti.ease),t._yEase=p?Cd(Fs(p===!0?n:p,Ti.ease)):0,p&&t._yoyo&&!t._repeat&&(p=t._yEase,t._yEase=t._ease,t._ease=p),t._from=!T&&!!i.runBackwards,!T||f&&!i.stagger){if(C=v[0]?ks(v[0]).harness:0,Y=C&&i[C.prop],w=Oo(i,Mh),g&&(g._zTime<0&&g.progress(1),r<0&&c&&a&&!_?g.render(-1,!0):g.revert(c&&m?Mo:o0),g._lazy=0),o){if(is(t._startAt=Mt.set(v,Be({data:"isStart",overwrite:!1,parent:y,immediateRender:!0,lazy:!g&&de(h),startAt:null,delay:0,onUpdate:u,onUpdateParams:d,callbackScope:l,stagger:0},o))),t._startAt._dp=0,t._startAt._sat=t,r<0&&(te||!a&&!_)&&t._startAt.revert(Mo),a&&m&&r<=0&&s<=0){r&&(t._zTime=r);return}}else if(c&&m&&!g){if(r&&(a=!1),A=Be({overwrite:!1,data:"isFromStart",lazy:a&&!g&&de(h),immediateRender:a,stagger:0,parent:y},w),Y&&(A[C.prop]=Y),is(t._startAt=Mt.set(v,A)),t._startAt._dp=0,t._startAt._sat=t,r<0&&(te?t._startAt.revert(Mo):t._startAt.render(-1,!0)),t._zTime=r,!a)e(t._startAt,nt,nt);else if(!r)return}for(t._pt=t._ptCache=0,h=m&&de(h)||h&&!m,b=0;b<v.length;b++){if(S=v[b],I=S._gsap||kh(v)[b]._gsap,t._ptLookup[b]=L={},Ph[I.id]&&ss.length&&Do(),D=x===v?b:x.indexOf(S),C&&(O=new C).init(S,Y||w,t,D,x)!==!1&&(t._pt=R=new fe(t._pt,S,O.name,0,1,O.render,O,0,O.priority),O._props.forEach(function(P){L[P]=R}),O.priority&&(M=1)),!C||Y)for(A in w)Ae[A]&&(O=Pd(A,w,t,D,S,x))?O.priority&&(M=1):L[A]=R=Vh.call(t,S,A,"get",w[A],D,x,0,i.stringFilter);t._op&&t._op[b]&&t.kill(S,t._op[b]),E&&t._pt&&(as=t,dt.killTweensOf(S,L,t.globalTime(r)),Z=!t.parent,as=0),t._pt&&h&&(Ph[I.id]=1)}M&&Fd(t),t._onInit&&t._onInit(t)}t._onUpdate=u,t._initted=(!t._op||t._pt)&&!Z,f&&r<=0&&T.render(Le,!0,!0)},O0=function(e,t,r,s,i,n,o){var a=(e._pt&&e._ptCache||(e._ptCache={}))[t],h,u,d,l;if(!a)for(a=e._ptCache[t]=[],d=e._ptLookup,l=e._targets.length;l--;){if(h=d[l][t],h&&h.d&&h.d._pt)for(h=h.d._pt;h&&h.p!==t&&h.fp!==t;)h=h._next;if(!h)return Xh=1,e.vars[t]="+=0",Wh(e,o),Xh=0,1;a.push(h)}for(l=a.length;l--;)u=a[l],h=u._pt||u,h.s=(s||s===0)&&!i?s:h.s+(s||0)+n*h.c,h.c=r-h.s,u.e&&(u.e=St(r)+re(u.e)),u.b&&(u.b=h.s+re(u.b))},k0=function(e,t){var r=e[0]?ks(e[0]).harness:0,s=r&&r.aliases,i,n,o,a;if(!s)return t;i=Ns({},t);for(n in s)if(n in i)for(a=s[n].split(","),o=a.length;o--;)i[a[o]]=i[n];return i},N0=function(e,t,r,s){var i=t.ease||s||"power1.inOut",n,o;if(ee(t))o=r[e]||(r[e]=[]),t.forEach(function(a,h){return o.push({t:h/(t.length-1)*100,v:a,e:i})});else for(n in t)o=r[n]||(r[n]=[]),n==="ease"||o.push({t:parseFloat(e),v:t[n],e:i})},wn=function(e,t,r,s,i){return bt(e)?e.call(t,r,s,i):Bt(e)&&~e.indexOf("random(")?vn(e):e},Dd=Oh+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Od={};pe(Dd+",id,stagger,delay,duration,paused,scrollTrigger",function(e){return Od[e]=1});var Mt=function(e){Wc(t,e);function t(s,i,n,o){var a;typeof i=="number"&&(n.duration=i,i=n,n=null),a=e.call(this,o?i:mn(i))||this;var h=a.vars,u=h.duration,d=h.delay,l=h.immediateRender,c=h.stagger,p=h.overwrite,f=h.keyframes,_=h.defaults,m=h.scrollTrigger,g=h.yoyoEase,v=i.parent||dt,y=(ee(s)||Yc(s)?Br(s[0]):"length"in i)?[s]:Ge(s),x,E,T,w,b,A,R,S;if(a._targets=y.length?kh(y):Ro("GSAP target "+s+" not found. https://greensock.com",!Ee.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=p,f||c||Co(u)||Co(d)){if(i=a.vars,x=a.timeline=new le({data:"nested",defaults:_||{},targets:v&&v.data==="nested"?v.vars.targets:y}),x.kill(),x.parent=x._dp=Fr(a),x._start=0,c||Co(u)||Co(d)){if(w=y.length,R=c&&_d(c),mr(c))for(b in c)~Dd.indexOf(b)&&(S||(S={}),S[b]=c[b]);for(E=0;E<w;E++)T=Oo(i,Od),T.stagger=0,g&&(T.yoyoEase=g),S&&Ns(T,S),A=y[E],T.duration=+wn(u,Fr(a),E,A,y),T.delay=(+wn(d,Fr(a),E,A,y)||0)-a._delay,!c&&w===1&&T.delay&&(a._delay=d=T.delay,a._start+=d,T.delay=0),x.to(A,T,R?R(E,A,y):0),x._ease=tt.none;x.duration()?u=d=0:a.timeline=0}else if(f){mn(Be(x.vars.defaults,{ease:"none"})),x._ease=Fs(f.ease||i.ease||"none");var M=0,I,C,O;if(ee(f))f.forEach(function(L){return x.to(y,L,">")}),x.duration();else{T={};for(b in f)b==="ease"||b==="easeEach"||N0(b,f[b],T,f.easeEach);for(b in T)for(I=T[b].sort(function(L,D){return L.t-D.t}),M=0,E=0;E<I.length;E++)C=I[E],O={ease:C.e,duration:(C.t-(E?I[E-1].t:0))/100*u},O[b]=C.v,x.to(y,O,M),M+=O.duration;x.duration()<u&&x.to({},{duration:u-x.duration()})}}u||a.duration(u=x.duration())}else a.timeline=0;return p===!0&&!bh&&(as=Fr(a),dt.killTweensOf(y),as=0),gr(v,Fr(a),n),i.reversed&&a.reverse(),i.paused&&a.paused(!0),(l||!u&&!f&&a._start===Yt(v._time)&&de(l)&&d0(Fr(a))&&v.data!=="nested")&&(a._tTime=-nt,a.render(Math.max(0,-d)||0)),m&&ud(Fr(a),m),a}var r=t.prototype;return r.render=function(s,i,n){var o=this._time,a=this._tDur,h=this._dur,u=s<0,d=s>a-nt&&!u?a:s<nt?0:s,l,c,p,f,_,m,g,v,y;if(!h)f0(this,s,i,n);else if(d!==this._tTime||!s||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(l=d,v=this.timeline,this._repeat){if(f=h+this._rDelay,this._repeat<-1&&u)return this.totalTime(f*100+s,i,n);if(l=Yt(d%f),d===a?(p=this._repeat,l=h):(p=~~(d/f),p&&p===d/f&&(l=h,p--),l>h&&(l=h)),m=this._yoyo&&p&1,m&&(y=this._yEase,l=h-l),_=Ai(this._tTime,f),l===o&&!n&&this._initted)return this._tTime=d,this;p!==_&&(v&&this._yEase&&Id(v,m),this.vars.repeatRefresh&&!m&&!this._lock&&(this._lock=n=1,this.render(Yt(f*p),!0).invalidate()._lock=0))}if(!this._initted){if(cd(this,u?s:l,n,i,d))return this._tTime=0,this;if(o!==this._time)return this;if(h!==this._dur)return this.render(s,i,n)}if(this._tTime=d,this._time=l,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=g=(y||this._ease)(l/h),this._from&&(this.ratio=g=1-g),l&&!o&&!i&&!p&&(He(this,"onStart"),this._tTime!==d))return this;for(c=this._pt;c;)c.r(g,c.d),c=c._next;v&&v.render(s<0?s:!l&&m?-nt:v._dur*v._ease(l/this._dur),i,n)||this._startAt&&(this._zTime=s),this._onUpdate&&!i&&(u&&Nh(this,s,i,n),He(this,"onUpdate")),this._repeat&&p!==_&&this.vars.onRepeat&&!i&&this.parent&&He(this,"onRepeat"),(d===this._tDur||!d)&&this._tTime===d&&(u&&!this._onUpdate&&Nh(this,s,!0,!0),(s||!h)&&(d===this._tDur&&this._ts>0||!d&&this._ts<0)&&is(this,1),!i&&!(u&&!o)&&(d||o||m)&&(He(this,d===a?"onComplete":"onReverseComplete",!0),this._prom&&!(d<a&&this.timeScale()>0)&&this._prom()))}return this},r.targets=function(){return this._targets},r.invalidate=function(s){return(!s||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(s),e.prototype.invalidate.call(this,s)},r.resetTo=function(s,i,n,o){Tn||Se.wake(),this._ts||this.play();var a=Math.min(this._dur,(this._dp._time-this._start)*this._ts),h;return this._initted||Wh(this,a),h=this._ease(a/this._dur),O0(this,s,i,n,o,h,a)?this.resetTo(s,i,n,o):(Fo(this,0),this.parent||ad(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},r.kill=function(s,i){if(i===void 0&&(i="all"),!s&&(!i||i==="all"))return this._lazy=this._pt=0,this.parent?xn(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(s,i,as&&as.vars.overwrite!==!0)._first||xn(this),this.parent&&n!==this.timeline.totalDuration()&&Si(this,this._dur*this.timeline._tDur/n,0,1),this}var o=this._targets,a=s?Ge(s):o,h=this._ptLookup,u=this._pt,d,l,c,p,f,_,m;if((!i||i==="all")&&u0(o,a))return i==="all"&&(this._pt=0),xn(this);for(d=this._op=this._op||[],i!=="all"&&(Bt(i)&&(f={},pe(i,function(g){return f[g]=1}),i=f),i=k0(o,i)),m=o.length;m--;)if(~a.indexOf(o[m])){l=h[m],i==="all"?(d[m]=i,p=l,c={}):(c=d[m]=d[m]||{},p=i);for(f in p)_=l&&l[f],_&&((!("kill"in _.d)||_.d.kill(f)===!0)&&ko(this,_,"_pt"),delete l[f]),c!=="all"&&(c[f]=1)}return this._initted&&!this._pt&&u&&xn(this),this},t.to=function(s,i){return new t(s,i,arguments[2])},t.from=function(s,i){return gn(1,arguments)},t.delayedCall=function(s,i,n,o){return new t(i,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:s,onComplete:i,onReverseComplete:i,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:o})},t.fromTo=function(s,i,n){return gn(2,arguments)},t.set=function(s,i){return i.duration=0,i.repeatDelay||(i.repeat=0),new t(s,i)},t.killTweensOf=function(s,i,n){return dt.killTweensOf(s,i,n)},t}(En);Be(Mt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),pe("staggerTo,staggerFrom,staggerFromTo",function(e){Mt[e]=function(){var t=new le,r=Fh.call(arguments,0);return r.splice(e==="staggerFromTo"?5:4,0,0),t[e].apply(t,r)}});var jh=function(e,t,r){return e[t]=r},kd=function(e,t,r){return e[t](r)},L0=function(e,t,r,s){return e[t](s.fp,r)},F0=function(e,t,r){return e.setAttribute(t,r)},Yh=function(e,t){return bt(e[t])?kd:Eh(e[t])&&e.setAttribute?F0:jh},Nd=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},B0=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},Ld=function(e,t){var r=t._pt,s="";if(!e&&t.b)s=t.b;else if(e===1&&t.e)s=t.e;else{for(;r;)s=r.p+(r.m?r.m(r.s+r.c*e):Math.round((r.s+r.c*e)*1e4)/1e4)+s,r=r._next;s+=t.c}t.set(t.t,t.p,s,t)},$h=function(e,t){for(var r=t._pt;r;)r.r(e,r.d),r=r._next},U0=function(e,t,r,s){for(var i=this._pt,n;i;)n=i._next,i.p===s&&i.modifier(e,t,r),i=n},G0=function(e){for(var t=this._pt,r,s;t;)s=t._next,t.p===e&&!t.op||t.op===e?ko(this,t,"_pt"):t.dep||(r=1),t=s;return!r},H0=function(e,t,r,s){s.mSet(e,t,s.m.call(s.tween,r,s.mt),s)},Fd=function(e){for(var t=e._pt,r,s,i,n;t;){for(r=t._next,s=i;s&&s.pr>t.pr;)s=s._next;(t._prev=s?s._prev:n)?t._prev._next=t:i=t,(t._next=s)?s._prev=t:n=t,t=r}e._pt=i},fe=function(){function e(r,s,i,n,o,a,h,u,d){this.t=s,this.s=n,this.c=o,this.p=i,this.r=a||Nd,this.d=h||this,this.set=u||jh,this.pr=d||0,this._next=r,r&&(r._prev=this)}var t=e.prototype;return t.modifier=function(r,s,i){this.mSet=this.mSet||this.set,this.set=H0,this.m=r,this.mt=i,this.tween=s},e}();pe(Oh+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(e){return Mh[e]=1}),we.TweenMax=we.TweenLite=Mt,we.TimelineLite=we.TimelineMax=le,dt=new le({sortChildren:!1,defaults:Ti,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Ee.stringFilter=Sd;var Us=[],Bo={},z0=[],Bd=0,V0=0,qh=function(e){return(Bo[e]||z0).map(function(t){return t()})},Kh=function(){var e=Date.now(),t=[];e-Bd>2&&(qh("matchMediaInit"),Us.forEach(function(r){var s=r.queries,i=r.conditions,n,o,a,h;for(o in s)n=Fe.matchMedia(s[o]).matches,n&&(a=1),n!==i[o]&&(i[o]=n,h=1);h&&(r.revert(),a&&t.push(r))}),qh("matchMediaRevert"),t.forEach(function(r){return r.onMatch(r)}),Bd=e,qh("matchMedia"))},Ud=function(){function e(r,s){this.selector=s&&Bh(s),this.data=[],this._r=[],this.isReverted=!1,this.id=V0++,r&&this.add(r)}var t=e.prototype;return t.add=function(r,s,i){bt(r)&&(i=s,s=r,r=bt);var n=this,o=function(){var a=xt,h=n.selector,u;return a&&a!==n&&a.data.push(n),i&&(n.selector=Bh(i)),xt=n,u=s.apply(n,arguments),bt(u)&&n._r.push(u),xt=a,n.selector=h,n.isReverted=!1,u};return n.last=o,r===bt?o(n):r?n[r]=o:o},t.ignore=function(r){var s=xt;xt=null,r(this),xt=s},t.getTweens=function(){var r=[];return this.data.forEach(function(s){return s instanceof e?r.push.apply(r,s.getTweens()):s instanceof Mt&&!(s.parent&&s.parent.data==="nested")&&r.push(s)}),r},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(r,s){var i=this;if(r){var n=this.getTweens();this.data.forEach(function(a){a.data==="isFlip"&&(a.revert(),a.getChildren(!0,!0,!1).forEach(function(h){return n.splice(n.indexOf(h),1)}))}),n.map(function(a){return{g:a.globalTime(0),t:a}}).sort(function(a,h){return h.g-a.g||-1}).forEach(function(a){return a.t.revert(r)}),this.data.forEach(function(a){return a instanceof le?a.data!=="nested"&&a.kill():!(a instanceof Mt)&&a.revert&&a.revert(r)}),this._r.forEach(function(a){return a(r,i)}),this.isReverted=!0}else this.data.forEach(function(a){return a.kill&&a.kill()});if(this.clear(),s)for(var o=Us.length;o--;)Us[o].id===this.id&&Us.splice(o,1)},t.revert=function(r){this.kill(r||{})},e}(),X0=function(){function e(r){this.contexts=[],this.scope=r}var t=e.prototype;return t.add=function(r,s,i){mr(r)||(r={matches:r});var n=new Ud(0,i||this.scope),o=n.conditions={},a,h,u;xt&&!n.selector&&(n.selector=xt.selector),this.contexts.push(n),s=n.add("onMatch",s),n.queries=r;for(h in r)h==="all"?u=1:(a=Fe.matchMedia(r[h]),a&&(Us.indexOf(n)<0&&Us.push(n),(o[h]=a.matches)&&(u=1),a.addListener?a.addListener(Kh):a.addEventListener("change",Kh)));return u&&s(n),this},t.revert=function(r){this.kill(r||{})},t.kill=function(r){this.contexts.forEach(function(s){return s.kill(r,!0)})},e}(),Uo={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(function(s){return Td(s)})},timeline:function(e){return new le(e)},getTweensOf:function(e,t){return dt.getTweensOf(e,t)},getProperty:function(e,t,r,s){Bt(e)&&(e=Ge(e)[0]);var i=ks(e||{}).get,n=r?nd:id;return r==="native"&&(r=""),e&&(t?n((Ae[t]&&Ae[t].get||i)(e,t,r,s)):function(o,a,h){return n((Ae[o]&&Ae[o].get||i)(e,o,a,h))})},quickSetter:function(e,t,r){if(e=Ge(e),e.length>1){var s=e.map(function(u){return _e.quickSetter(u,t,r)}),i=s.length;return function(u){for(var d=i;d--;)s[d](u)}}e=e[0]||{};var n=Ae[t],o=ks(e),a=o.harness&&(o.harness.aliases||{})[t]||t,h=n?function(u){var d=new n;Ci._pt=0,d.init(e,r?u+r:u,Ci,0,[e]),d.render(1,d),Ci._pt&&$h(1,Ci)}:o.set(e,a);return n?h:function(u){return h(e,a,r?u+r:u,o,1)}},quickTo:function(e,t,r){var s,i=_e.to(e,Ns((s={},s[t]="+=0.1",s.paused=!0,s),r||{})),n=function(o,a,h){return i.resetTo(t,o,a,h)};return n.tween=i,n},isTweening:function(e){return dt.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Fs(e.ease,Ti.ease)),od(Ti,e||{})},config:function(e){return od(Ee,e||{})},registerEffect:function(e){var t=e.name,r=e.effect,s=e.plugins,i=e.defaults,n=e.extendTimeline;(s||"").split(",").forEach(function(o){return o&&!Ae[o]&&!we[o]&&Ro(t+" effect requires "+o+" plugin.")}),Dh[t]=function(o,a,h){return r(Ge(o),Be(a||{},i),h)},n&&(le.prototype[t]=function(o,a,h){return this.add(Dh[t](o,mr(a)?a:(h=a)&&{},this),h)})},registerEase:function(e,t){tt[e]=Fs(t)},parseEase:function(e,t){return arguments.length?Fs(e,t):tt},getById:function(e){return dt.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var r=new le(e),s,i;for(r.smoothChildTiming=de(e.smoothChildTiming),dt.remove(r),r._dp=0,r._time=r._tTime=dt._time,s=dt._first;s;)i=s._next,(t||!(!s._dur&&s instanceof Mt&&s.vars.onComplete===s._targets[0]))&&gr(r,s,s._start-s._delay),s=i;return gr(dt,r,0),r},context:function(e,t){return e?new Ud(e,t):xt},matchMedia:function(e){return new X0(e)},matchMediaRefresh:function(){return Us.forEach(function(e){var t=e.conditions,r,s;for(s in t)t[s]&&(t[s]=!1,r=1);r&&e.revert()})||Kh()},addEventListener:function(e,t){var r=Bo[e]||(Bo[e]=[]);~r.indexOf(t)||r.push(t)},removeEventListener:function(e,t){var r=Bo[e],s=r&&r.indexOf(t);s>=0&&r.splice(s,1)},utils:{wrap:T0,wrapYoyo:E0,distribute:_d,random:gd,snap:md,normalize:b0,getUnit:re,clamp:g0,splitColor:Ed,toArray:Ge,selector:Bh,mapRange:vd,pipe:v0,unitize:x0,interpolate:w0,shuffle:fd},install:Qc,effects:Dh,ticker:Se,updateRoot:le.updateRoot,plugins:Ae,globalTimeline:dt,core:{PropTween:fe,globals:Jc,Tween:Mt,Timeline:le,Animation:En,getCache:ks,_removeLinkedListItem:ko,reverting:function(){return te},context:function(e){return e&&xt&&(xt.data.push(e),e._ctx=xt),xt},suppressOverwrites:function(e){return bh=e}}};pe("to,from,fromTo,delayedCall,set,killTweensOf",function(e){return Uo[e]=Mt[e]}),Se.add(le.updateRoot),Ci=Uo.to({},{duration:0});var W0=function(e,t){for(var r=e._pt;r&&r.p!==t&&r.op!==t&&r.fp!==t;)r=r._next;return r},j0=function(e,t){var r=e._targets,s,i,n;for(s in t)for(i=r.length;i--;)n=e._ptLookup[i][s],n&&(n=n.d)&&(n._pt&&(n=W0(n,s)),n&&n.modifier&&n.modifier(t[s],e,r[i],s))},Zh=function(e,t){return{name:e,rawVars:1,init:function(r,s,i){i._onInit=function(n){var o,a;if(Bt(s)&&(o={},pe(s,function(h){return o[h]=1}),s=o),t){o={};for(a in s)o[a]=t(s[a]);s=o}j0(n,s)}}}},_e=Uo.registerPlugin({name:"attr",init:function(e,t,r,s,i){var n,o,a;this.tween=r;for(n in t)a=e.getAttribute(n)||"",o=this.add(e,"setAttribute",(a||0)+"",t[n],s,i,0,0,n),o.op=n,o.b=a,this._props.push(n)},render:function(e,t){for(var r=t._pt;r;)te?r.set(r.t,r.p,r.b,r):r.r(e,r.d),r=r._next}},{name:"endArray",init:function(e,t){for(var r=t.length;r--;)this.add(e,r,e[r]||0,t[r],0,0,0,0,0,1)}},Zh("roundProps",Uh),Zh("modifiers"),Zh("snap",md))||Uo;Mt.version=le.version=_e.version="3.12.1",Zc=1,wh()&&Ii(),tt.Power0,tt.Power1,tt.Power2,tt.Power3,tt.Power4,tt.Linear,tt.Quad,tt.Cubic,tt.Quart,tt.Quint,tt.Strong,tt.Elastic,tt.Back,tt.SteppedEase,tt.Bounce;var Gd=tt.Sine;tt.Expo,tt.Circ;var Hd,hs,Ri,Qh,Gs,zd,Jh,Y0=function(){return typeof window<"u"},Ur={},Hs=180/Math.PI,Mi=Math.PI/180,Pi=Math.atan2,Vd=1e8,tl=/([A-Z])/g,$0=/(left|right|width|margin|padding|x)/i,q0=/[\s,\(]\S/,yr={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},el=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},K0=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},Z0=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},Q0=function(e,t){var r=t.s+t.c*e;t.set(t.t,t.p,~~(r+(r<0?-.5:.5))+t.u,t)},Xd=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},Wd=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},J0=function(e,t,r){return e.style[t]=r},ty=function(e,t,r){return e.style.setProperty(t,r)},ey=function(e,t,r){return e._gsap[t]=r},ry=function(e,t,r){return e._gsap.scaleX=e._gsap.scaleY=r},sy=function(e,t,r,s,i){var n=e._gsap;n.scaleX=n.scaleY=r,n.renderTransform(i,n)},iy=function(e,t,r,s,i){var n=e._gsap;n[t]=r,n.renderTransform(i,n)},pt="transform",Ze=pt+"Origin",ny=function e(t,r){var s=this,i=this.target,n=i.style;if(t in Ur&&n){if(this.tfm=this.tfm||{},t!=="transform")t=yr[t]||t,~t.indexOf(",")?t.split(",").forEach(function(o){return s.tfm[o]=Gr(i,o)}):this.tfm[t]=i._gsap.x?i._gsap[t]:Gr(i,t);else return yr.transform.split(",").forEach(function(o){return e.call(s,o,r)});if(this.props.indexOf(pt)>=0)return;i._gsap.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(Ze,r,"")),t=pt}(n||r)&&this.props.push(t,r,n[t])},jd=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},oy=function(){var e=this.props,t=this.target,r=t.style,s=t._gsap,i,n;for(i=0;i<e.length;i+=3)e[i+1]?t[e[i]]=e[i+2]:e[i+2]?r[e[i]]=e[i+2]:r.removeProperty(e[i].substr(0,2)==="--"?e[i]:e[i].replace(tl,"-$1").toLowerCase());if(this.tfm){for(n in this.tfm)s[n]=this.tfm[n];s.svg&&(s.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),i=Jh(),(!i||!i.isStart)&&!r[pt]&&(jd(r),s.uncache=1)}},Yd=function(e,t){var r={target:e,props:[],revert:oy,save:ny};return e._gsap||_e.core.getCache(e),t&&t.split(",").forEach(function(s){return r.save(s)}),r},$d,rl=function(e,t){var r=hs.createElementNS?hs.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):hs.createElement(e);return r.style?r:hs.createElement(e)},vr=function e(t,r,s){var i=getComputedStyle(t);return i[r]||i.getPropertyValue(r.replace(tl,"-$1").toLowerCase())||i.getPropertyValue(r)||!s&&e(t,Di(r)||r,1)||""},qd="O,Moz,ms,Ms,Webkit".split(","),Di=function(e,t,r){var s=t||Gs,i=s.style,n=5;if(e in i&&!r)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);n--&&!(qd[n]+e in i););return n<0?null:(n===3?"ms":n>=0?qd[n]:"")+e},sl=function(){Y0()&&window.document&&(Hd=window,hs=Hd.document,Ri=hs.documentElement,Gs=rl("div")||{style:{}},rl("div"),pt=Di(pt),Ze=pt+"Origin",Gs.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",$d=!!Di("perspective"),Jh=_e.core.reverting,Qh=1)},il=function e(t){var r=rl("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=this.parentNode,i=this.nextSibling,n=this.style.cssText,o;if(Ri.appendChild(r),r.appendChild(this),this.style.display="block",t)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=e}catch{}else this._gsapBBox&&(o=this._gsapBBox());return s&&(i?s.insertBefore(this,i):s.appendChild(this)),Ri.removeChild(r),this.style.cssText=n,o},Kd=function(e,t){for(var r=t.length;r--;)if(e.hasAttribute(t[r]))return e.getAttribute(t[r])},Zd=function(e){var t;try{t=e.getBBox()}catch{t=il.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===il||(t=il.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+Kd(e,["x","cx","x1"])||0,y:+Kd(e,["y","cy","y1"])||0,width:0,height:0}:t},Qd=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&Zd(e))},An=function(e,t){if(t){var r=e.style;t in Ur&&t!==Ze&&(t=pt),r.removeProperty?((t.substr(0,2)==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),r.removeProperty(t.replace(tl,"-$1").toLowerCase())):r.removeAttribute(t)}},ls=function(e,t,r,s,i,n){var o=new fe(e._pt,t,r,0,1,n?Wd:Xd);return e._pt=o,o.b=s,o.e=i,e._props.push(r),o},Jd={deg:1,rad:1,turn:1},ay={grid:1,flex:1},us=function e(t,r,s,i){var n=parseFloat(s)||0,o=(s+"").trim().substr((n+"").length)||"px",a=Gs.style,h=$0.test(r),u=t.tagName.toLowerCase()==="svg",d=(u?"client":"offset")+(h?"Width":"Height"),l=100,c=i==="px",p=i==="%",f,_,m,g;return i===o||!n||Jd[i]||Jd[o]?n:(o!=="px"&&!c&&(n=e(t,r,s,"px")),g=t.getCTM&&Qd(t),(p||o==="%")&&(Ur[r]||~r.indexOf("adius"))?(f=g?t.getBBox()[h?"width":"height"]:t[d],St(p?n/f*l:n/100*f)):(a[h?"width":"height"]=l+(c?o:i),_=~r.indexOf("adius")||i==="em"&&t.appendChild&&!u?t:t.parentNode,g&&(_=(t.ownerSVGElement||{}).parentNode),(!_||_===hs||!_.appendChild)&&(_=hs.body),m=_._gsap,m&&p&&m.width&&h&&m.time===Se.time&&!m.uncache?St(n/m.width*l):((p||o==="%")&&!ay[vr(_,"display")]&&(a.position=vr(t,"position")),_===t&&(a.position="static"),_.appendChild(Gs),f=Gs[d],_.removeChild(Gs),a.position="absolute",h&&p&&(m=ks(_),m.time=Se.time,m.width=_[d]),St(c?f*n/l:f&&n?l/f*n:0))))},Gr=function(e,t,r,s){var i;return Qh||sl(),t in yr&&t!=="transform"&&(t=yr[t],~t.indexOf(",")&&(t=t.split(",")[0])),Ur[t]&&t!=="transform"?(i=Cn(e,s),i=t!=="transformOrigin"?i[t]:i.svg?i.origin:Ho(vr(e,Ze))+" "+i.zOrigin+"px"):(i=e.style[t],(!i||i==="auto"||s||~(i+"").indexOf("calc("))&&(i=Go[t]&&Go[t](e,t,r)||vr(e,t)||rd(e,t)||(t==="opacity"?1:0))),r&&!~(i+"").trim().indexOf(" ")?us(e,t,i,r)+r:i},hy=function(e,t,r,s){if(!r||r==="none"){var i=Di(t,e,1),n=i&&vr(e,i,1);n&&n!==r?(t=i,r=n):t==="borderColor"&&(r=vr(e,"borderTopColor"))}var o=new fe(this._pt,e.style,t,0,1,Ld),a=0,h=0,u,d,l,c,p,f,_,m,g,v,y,x;if(o.b=r,o.e=s,r+="",s+="",s==="auto"&&(e.style[t]=s,s=vr(e,t)||s,e.style[t]=r),u=[r,s],Sd(u),r=u[0],s=u[1],l=r.match(Ei)||[],x=s.match(Ei)||[],x.length){for(;d=Ei.exec(s);)_=d[0],g=s.substring(a,d.index),p?p=(p+1)%5:(g.substr(-5)==="rgba("||g.substr(-5)==="hsla(")&&(p=1),_!==(f=l[h++]||"")&&(c=parseFloat(f)||0,y=f.substr((c+"").length),_.charAt(1)==="="&&(_=wi(c,_)+y),m=parseFloat(_),v=_.substr((m+"").length),a=Ei.lastIndex-v.length,v||(v=v||Ee.units[t]||y,a===s.length&&(s+=v,o.e+=v)),y!==v&&(c=us(e,t,f,v)||0),o._pt={_next:o._pt,p:g||h===1?g:",",s:c,c:m-c,m:p&&p<4||t==="zIndex"?Math.round:0});o.c=a<s.length?s.substring(a,s.length):""}else o.r=t==="display"&&s==="none"?Wd:Xd;return qc.test(s)&&(o.e=0),this._pt=o,o},tp={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},ly=function(e){var t=e.split(" "),r=t[0],s=t[1]||"50%";return(r==="top"||r==="bottom"||s==="left"||s==="right")&&(e=r,r=s,s=e),t[0]=tp[r]||r,t[1]=tp[s]||s,t.join(" ")},uy=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var r=t.t,s=r.style,i=t.u,n=r._gsap,o,a,h;if(i==="all"||i===!0)s.cssText="",a=1;else for(i=i.split(","),h=i.length;--h>-1;)o=i[h],Ur[o]&&(a=1,o=o==="transformOrigin"?Ze:pt),An(r,o);a&&(An(r,pt),n&&(n.svg&&r.removeAttribute("transform"),Cn(r,1),n.uncache=1,jd(s)))}},Go={clearProps:function(e,t,r,s,i){if(i.data!=="isFromStart"){var n=e._pt=new fe(e._pt,t,r,0,0,uy);return n.u=s,n.pr=-10,n.tween=i,e._props.push(r),1}}},Sn=[1,0,0,1,0,0],ep={},rp=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},sp=function(e){var t=vr(e,pt);return rp(t)?Sn:t.substr(7).match($c).map(St)},nl=function(e,t){var r=e._gsap||ks(e),s=e.style,i=sp(e),n,o,a,h;return r.svg&&e.getAttribute("transform")?(a=e.transform.baseVal.consolidate().matrix,i=[a.a,a.b,a.c,a.d,a.e,a.f],i.join(",")==="1,0,0,1,0,0"?Sn:i):(i===Sn&&!e.offsetParent&&e!==Ri&&!r.svg&&(a=s.display,s.display="block",n=e.parentNode,(!n||!e.offsetParent)&&(h=1,o=e.nextElementSibling,Ri.appendChild(e)),i=sp(e),a?s.display=a:An(e,"display"),h&&(o?n.insertBefore(e,o):n?n.appendChild(e):Ri.removeChild(e))),t&&i.length>6?[i[0],i[1],i[4],i[5],i[12],i[13]]:i)},ol=function(e,t,r,s,i,n){var o=e._gsap,a=i||nl(e,!0),h=o.xOrigin||0,u=o.yOrigin||0,d=o.xOffset||0,l=o.yOffset||0,c=a[0],p=a[1],f=a[2],_=a[3],m=a[4],g=a[5],v=t.split(" "),y=parseFloat(v[0])||0,x=parseFloat(v[1])||0,E,T,w,b;r?a!==Sn&&(T=c*_-p*f)&&(w=y*(_/T)+x*(-f/T)+(f*g-_*m)/T,b=y*(-p/T)+x*(c/T)-(c*g-p*m)/T,y=w,x=b):(E=Zd(e),y=E.x+(~v[0].indexOf("%")?y/100*E.width:y),x=E.y+(~(v[1]||v[0]).indexOf("%")?x/100*E.height:x)),s||s!==!1&&o.smooth?(m=y-h,g=x-u,o.xOffset=d+(m*c+g*f)-m,o.yOffset=l+(m*p+g*_)-g):o.xOffset=o.yOffset=0,o.xOrigin=y,o.yOrigin=x,o.smooth=!!s,o.origin=t,o.originIsAbsolute=!!r,e.style[Ze]="0px 0px",n&&(ls(n,o,"xOrigin",h,y),ls(n,o,"yOrigin",u,x),ls(n,o,"xOffset",d,o.xOffset),ls(n,o,"yOffset",l,o.yOffset)),e.setAttribute("data-svg-origin",y+" "+x)},Cn=function(e,t){var r=e._gsap||new Md(e);if("x"in r&&!t&&!r.uncache)return r;var s=e.style,i=r.scaleX<0,n="px",o="deg",a=getComputedStyle(e),h=vr(e,Ze)||"0",u,d,l,c,p,f,_,m,g,v,y,x,E,T,w,b,A,R,S,M,I,C,O,L,D,Y,Z,P,G,Q,j,q;return u=d=l=f=_=m=g=v=y=0,c=p=1,r.svg=!!(e.getCTM&&Qd(e)),a.translate&&((a.translate!=="none"||a.scale!=="none"||a.rotate!=="none")&&(s[pt]=(a.translate!=="none"?"translate3d("+(a.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(a.rotate!=="none"?"rotate("+a.rotate+") ":"")+(a.scale!=="none"?"scale("+a.scale.split(" ").join(",")+") ":"")+(a[pt]!=="none"?a[pt]:"")),s.scale=s.rotate=s.translate="none"),T=nl(e,r.svg),r.svg&&(r.uncache?(D=e.getBBox(),h=r.xOrigin-D.x+"px "+(r.yOrigin-D.y)+"px",L=""):L=!t&&e.getAttribute("data-svg-origin"),ol(e,L||h,!!L||r.originIsAbsolute,r.smooth!==!1,T)),x=r.xOrigin||0,E=r.yOrigin||0,T!==Sn&&(R=T[0],S=T[1],M=T[2],I=T[3],u=C=T[4],d=O=T[5],T.length===6?(c=Math.sqrt(R*R+S*S),p=Math.sqrt(I*I+M*M),f=R||S?Pi(S,R)*Hs:0,g=M||I?Pi(M,I)*Hs+f:0,g&&(p*=Math.abs(Math.cos(g*Mi))),r.svg&&(u-=x-(x*R+E*M),d-=E-(x*S+E*I))):(q=T[6],Q=T[7],Z=T[8],P=T[9],G=T[10],j=T[11],u=T[12],d=T[13],l=T[14],w=Pi(q,G),_=w*Hs,w&&(b=Math.cos(-w),A=Math.sin(-w),L=C*b+Z*A,D=O*b+P*A,Y=q*b+G*A,Z=C*-A+Z*b,P=O*-A+P*b,G=q*-A+G*b,j=Q*-A+j*b,C=L,O=D,q=Y),w=Pi(-M,G),m=w*Hs,w&&(b=Math.cos(-w),A=Math.sin(-w),L=R*b-Z*A,D=S*b-P*A,Y=M*b-G*A,j=I*A+j*b,R=L,S=D,M=Y),w=Pi(S,R),f=w*Hs,w&&(b=Math.cos(w),A=Math.sin(w),L=R*b+S*A,D=C*b+O*A,S=S*b-R*A,O=O*b-C*A,R=L,C=D),_&&Math.abs(_)+Math.abs(f)>359.9&&(_=f=0,m=180-m),c=St(Math.sqrt(R*R+S*S+M*M)),p=St(Math.sqrt(O*O+q*q)),w=Pi(C,O),g=Math.abs(w)>2e-4?w*Hs:0,y=j?1/(j<0?-j:j):0),r.svg&&(L=e.getAttribute("transform"),r.forceCSS=e.setAttribute("transform","")||!rp(vr(e,pt)),L&&e.setAttribute("transform",L))),Math.abs(g)>90&&Math.abs(g)<270&&(i?(c*=-1,g+=f<=0?180:-180,f+=f<=0?180:-180):(p*=-1,g+=g<=0?180:-180)),t=t||r.uncache,r.x=u-((r.xPercent=u&&(!t&&r.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-u)?-50:0)))?e.offsetWidth*r.xPercent/100:0)+n,r.y=d-((r.yPercent=d&&(!t&&r.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-d)?-50:0)))?e.offsetHeight*r.yPercent/100:0)+n,r.z=l+n,r.scaleX=St(c),r.scaleY=St(p),r.rotation=St(f)+o,r.rotationX=St(_)+o,r.rotationY=St(m)+o,r.skewX=g+o,r.skewY=v+o,r.transformPerspective=y+n,(r.zOrigin=parseFloat(h.split(" ")[2])||0)&&(s[Ze]=Ho(h)),r.xOffset=r.yOffset=0,r.force3D=Ee.force3D,r.renderTransform=r.svg?dy:$d?ip:cy,r.uncache=0,r},Ho=function(e){return(e=e.split(" "))[0]+" "+e[1]},al=function(e,t,r){var s=re(t);return St(parseFloat(t)+parseFloat(us(e,"x",r+"px",s)))+s},cy=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,ip(e,t)},zs="0deg",In="0px",Vs=") ",ip=function(e,t){var r=t||this,s=r.xPercent,i=r.yPercent,n=r.x,o=r.y,a=r.z,h=r.rotation,u=r.rotationY,d=r.rotationX,l=r.skewX,c=r.skewY,p=r.scaleX,f=r.scaleY,_=r.transformPerspective,m=r.force3D,g=r.target,v=r.zOrigin,y="",x=m==="auto"&&e&&e!==1||m===!0;if(v&&(d!==zs||u!==zs)){var E=parseFloat(u)*Mi,T=Math.sin(E),w=Math.cos(E),b;E=parseFloat(d)*Mi,b=Math.cos(E),n=al(g,n,T*b*-v),o=al(g,o,-Math.sin(E)*-v),a=al(g,a,w*b*-v+v)}_!==In&&(y+="perspective("+_+Vs),(s||i)&&(y+="translate("+s+"%, "+i+"%) "),(x||n!==In||o!==In||a!==In)&&(y+=a!==In||x?"translate3d("+n+", "+o+", "+a+") ":"translate("+n+", "+o+Vs),h!==zs&&(y+="rotate("+h+Vs),u!==zs&&(y+="rotateY("+u+Vs),d!==zs&&(y+="rotateX("+d+Vs),(l!==zs||c!==zs)&&(y+="skew("+l+", "+c+Vs),(p!==1||f!==1)&&(y+="scale("+p+", "+f+Vs),g.style[pt]=y||"translate(0, 0)"},dy=function(e,t){var r=t||this,s=r.xPercent,i=r.yPercent,n=r.x,o=r.y,a=r.rotation,h=r.skewX,u=r.skewY,d=r.scaleX,l=r.scaleY,c=r.target,p=r.xOrigin,f=r.yOrigin,_=r.xOffset,m=r.yOffset,g=r.forceCSS,v=parseFloat(n),y=parseFloat(o),x,E,T,w,b;a=parseFloat(a),h=parseFloat(h),u=parseFloat(u),u&&(u=parseFloat(u),h+=u,a+=u),a||h?(a*=Mi,h*=Mi,x=Math.cos(a)*d,E=Math.sin(a)*d,T=Math.sin(a-h)*-l,w=Math.cos(a-h)*l,h&&(u*=Mi,b=Math.tan(h-u),b=Math.sqrt(1+b*b),T*=b,w*=b,u&&(b=Math.tan(u),b=Math.sqrt(1+b*b),x*=b,E*=b)),x=St(x),E=St(E),T=St(T),w=St(w)):(x=d,w=l,E=T=0),(v&&!~(n+"").indexOf("px")||y&&!~(o+"").indexOf("px"))&&(v=us(c,"x",n,"px"),y=us(c,"y",o,"px")),(p||f||_||m)&&(v=St(v+p-(p*x+f*T)+_),y=St(y+f-(p*E+f*w)+m)),(s||i)&&(b=c.getBBox(),v=St(v+s/100*b.width),y=St(y+i/100*b.height)),b="matrix("+x+","+E+","+T+","+w+","+v+","+y+")",c.setAttribute("transform",b),g&&(c.style[pt]=b)},py=function(e,t,r,s,i){var n=360,o=Bt(i),a=parseFloat(i)*(o&&~i.indexOf("rad")?Hs:1),h=a-s,u=s+h+"deg",d,l;return o&&(d=i.split("_")[1],d==="short"&&(h%=n,h!==h%(n/2)&&(h+=h<0?n:-n)),d==="cw"&&h<0?h=(h+n*Vd)%n-~~(h/n)*n:d==="ccw"&&h>0&&(h=(h-n*Vd)%n-~~(h/n)*n)),e._pt=l=new fe(e._pt,t,r,s,h,K0),l.e=u,l.u="deg",e._props.push(r),l},np=function(e,t){for(var r in t)e[r]=t[r];return e},fy=function(e,t,r){var s=np({},r._gsap),i="perspective,force3D,transformOrigin,svgOrigin",n=r.style,o,a,h,u,d,l,c,p;s.svg?(h=r.getAttribute("transform"),r.setAttribute("transform",""),n[pt]=t,o=Cn(r,1),An(r,pt),r.setAttribute("transform",h)):(h=getComputedStyle(r)[pt],n[pt]=t,o=Cn(r,1),n[pt]=h);for(a in Ur)h=s[a],u=o[a],h!==u&&i.indexOf(a)<0&&(c=re(h),p=re(u),d=c!==p?us(r,a,h,p):parseFloat(h),l=parseFloat(u),e._pt=new fe(e._pt,o,a,d,l-d,el),e._pt.u=p||0,e._props.push(a));np(o,s)};pe("padding,margin,Width,Radius",function(e,t){var r="Top",s="Right",i="Bottom",n="Left",o=(t<3?[r,s,i,n]:[r+n,r+s,i+s,i+n]).map(function(a){return t<2?e+a:"border"+a+e});Go[t>1?"border"+e:e]=function(a,h,u,d,l){var c,p;if(arguments.length<4)return c=o.map(function(f){return Gr(a,f,u)}),p=c.join(" "),p.split(c[0]).length===5?c[0]:p;c=(d+"").split(" "),p={},o.forEach(function(f,_){return p[f]=c[_]=c[_]||c[(_-1)/2|0]}),a.init(h,p,l)}});var op={name:"css",register:sl,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,r,s,i){var n=this._props,o=e.style,a=r.vars.startAt,h,u,d,l,c,p,f,_,m,g,v,y,x,E,T,w;Qh||sl(),this.styles=this.styles||Yd(e),w=this.styles.props,this.tween=r;for(f in t)if(f!=="autoRound"&&(u=t[f],!(Ae[f]&&Pd(f,t,r,s,e,i)))){if(c=typeof u,p=Go[f],c==="function"&&(u=u.call(r,s,e,i),c=typeof u),c==="string"&&~u.indexOf("random(")&&(u=vn(u)),p)p(this,e,f,u,r)&&(T=1);else if(f.substr(0,2)==="--")h=(getComputedStyle(e).getPropertyValue(f)+"").trim(),u+="",os.lastIndex=0,os.test(h)||(_=re(h),m=re(u)),m?_!==m&&(h=us(e,f,h,m)+m):_&&(u+=_),this.add(o,"setProperty",h,u,s,i,0,0,f),n.push(f),w.push(f,0,o[f]);else if(c!=="undefined"){if(a&&f in a?(h=typeof a[f]=="function"?a[f].call(r,s,e,i):a[f],Bt(h)&&~h.indexOf("random(")&&(h=vn(h)),re(h+"")||(h+=Ee.units[f]||re(Gr(e,f))||""),(h+"").charAt(1)==="="&&(h=Gr(e,f))):h=Gr(e,f),l=parseFloat(h),g=c==="string"&&u.charAt(1)==="="&&u.substr(0,2),g&&(u=u.substr(2)),d=parseFloat(u),f in yr&&(f==="autoAlpha"&&(l===1&&Gr(e,"visibility")==="hidden"&&d&&(l=0),w.push("visibility",0,o.visibility),ls(this,o,"visibility",l?"inherit":"hidden",d?"inherit":"hidden",!d)),f!=="scale"&&f!=="transform"&&(f=yr[f],~f.indexOf(",")&&(f=f.split(",")[0]))),v=f in Ur,v){if(this.styles.save(f),y||(x=e._gsap,x.renderTransform&&!t.parseTransform||Cn(e,t.parseTransform),E=t.smoothOrigin!==!1&&x.smooth,y=this._pt=new fe(this._pt,o,pt,0,1,x.renderTransform,x,0,-1),y.dep=1),f==="scale")this._pt=new fe(this._pt,x,"scaleY",x.scaleY,(g?wi(x.scaleY,g+d):d)-x.scaleY||0,el),this._pt.u=0,n.push("scaleY",f),f+="X";else if(f==="transformOrigin"){w.push(Ze,0,o[Ze]),u=ly(u),x.svg?ol(e,u,0,E,0,this):(m=parseFloat(u.split(" ")[2])||0,m!==x.zOrigin&&ls(this,x,"zOrigin",x.zOrigin,m),ls(this,o,f,Ho(h),Ho(u)));continue}else if(f==="svgOrigin"){ol(e,u,1,E,0,this);continue}else if(f in ep){py(this,x,f,l,g?wi(l,g+u):u);continue}else if(f==="smoothOrigin"){ls(this,x,"smooth",x.smooth,u);continue}else if(f==="force3D"){x[f]=u;continue}else if(f==="transform"){fy(this,u,e);continue}}else f in o||(f=Di(f)||f);if(v||(d||d===0)&&(l||l===0)&&!q0.test(u)&&f in o)_=(h+"").substr((l+"").length),d||(d=0),m=re(u)||(f in Ee.units?Ee.units[f]:_),_!==m&&(l=us(e,f,h,m)),this._pt=new fe(this._pt,v?x:o,f,l,(g?wi(l,g+d):d)-l,!v&&(m==="px"||f==="zIndex")&&t.autoRound!==!1?Q0:el),this._pt.u=m||0,_!==m&&m!=="%"&&(this._pt.b=h,this._pt.r=Z0);else if(f in o)hy.call(this,e,f,h,g?g+u:u);else if(f in e)this.add(e,f,h||e[f],g?g+u:u,s,i);else if(f!=="parseTransform"){Rh(f,u);continue}v||(f in o?w.push(f,0,o[f]):w.push(f,1,h||e[f])),n.push(f)}}T&&Fd(this)},render:function(e,t){if(t.tween._time||!Jh())for(var r=t._pt;r;)r.r(e,r.d),r=r._next;else t.styles.revert()},get:Gr,aliases:yr,getSetter:function(e,t,r){var s=yr[t];return s&&s.indexOf(",")<0&&(t=s),t in Ur&&t!==Ze&&(e._gsap.x||Gr(e,"x"))?r&&zd===r?t==="scale"?ry:ey:(zd=r||{})&&(t==="scale"?sy:iy):e.style&&!Eh(e.style[t])?J0:~t.indexOf("-")?ty:Yh(e,t)},core:{_removeProperty:An,_getMatrix:nl}};_e.utils.checkPrefix=Di,_e.core.getStyleSaver=Yd,function(e,t,r,s){var i=pe(e+","+t+","+r,function(n){Ur[n]=1});pe(t,function(n){Ee.units[n]="deg",ep[n]=1}),yr[i[13]]=e+","+t,pe(s,function(n){var o=n.split(":");yr[o[1]]=i[o[0]]})}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY"),pe("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(e){Ee.units[e]="px"}),_e.registerPlugin(op);var Xs=_e.registerPlugin(op)||_e;Xs.core.Tween;var Ws=(e=>(e[e.Region=0]="Region",e[e.BoundingBox=1]="BoundingBox",e[e.Mesh=2]="Mesh",e[e.LinkedMesh=3]="LinkedMesh",e[e.Path=4]="Path",e[e.Point=5]="Point",e[e.Clipping=6]="Clipping",e))(Ws||{}),js=(e=>(e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e))(js||{}),ap=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS",e))(ap||{}),hl=(e=>(e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e))(hl||{}),V=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e))(V||{}),Qe=(e=>(e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e))(Qe||{}),k=(e=>(e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e))(k||{}),Oi=(e=>(e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(Oi||{}),X=(e=>(e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e))(X||{}),ll=(e=>(e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e))(ll||{}),Hr=(e=>(e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e))(Hr||{}),zr=(e=>(e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e))(zr||{}),xr=(e=>(e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e))(xr||{}),Je=(e=>(e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e))(Je||{}),br=(e=>(e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e))(br||{}),ul=(e=>(e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e))(ul||{}),ze=(e=>(e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e))(ze||{}),Nt=(e=>(e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e))(Nt||{}),Pt=(e=>(e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e))(Pt||{}),Tr=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e))(Tr||{});const _y={createCanvas:(e,t)=>{const r=document.createElement("canvas");return r.width=e,r.height=t,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>new DOMParser().parseFromString(e,"text/xml")},F={ADAPTER:_y,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var cl=/iPhone/i,hp=/iPod/i,lp=/iPad/i,up=/\biOS-universal(?:.+)Mac\b/i,dl=/\bAndroid(?:.+)Mobile\b/i,cp=/Android/i,ki=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,zo=/Silk/i,Vr=/Windows Phone/i,dp=/\bWindows(?:.+)ARM\b/i,pp=/BlackBerry/i,fp=/BB10/i,_p=/Opera Mini/i,mp=/\b(CriOS|Chrome)(?:.+)Mobile/i,gp=/Mobile(?:.+)Firefox\b/i,yp=function(e){return typeof e<"u"&&e.platform==="MacIntel"&&typeof e.maxTouchPoints=="number"&&e.maxTouchPoints>1&&typeof MSStream>"u"};function my(e){return function(t){return t.test(e)}}function vp(e){var t={userAgent:"",platform:"",maxTouchPoints:0};!e&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof e=="string"?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0});var r=t.userAgent,s=r.split("[FBAN");typeof s[1]<"u"&&(r=s[0]),s=r.split("Twitter"),typeof s[1]<"u"&&(r=s[0]);var i=my(r),n={apple:{phone:i(cl)&&!i(Vr),ipod:i(hp),tablet:!i(cl)&&(i(lp)||yp(t))&&!i(Vr),universal:i(up),device:(i(cl)||i(hp)||i(lp)||i(up)||yp(t))&&!i(Vr)},amazon:{phone:i(ki),tablet:!i(ki)&&i(zo),device:i(ki)||i(zo)},android:{phone:!i(Vr)&&i(ki)||!i(Vr)&&i(dl),tablet:!i(Vr)&&!i(ki)&&!i(dl)&&(i(zo)||i(cp)),device:!i(Vr)&&(i(ki)||i(zo)||i(dl)||i(cp))||i(/\bokhttp\b/i)},windows:{phone:i(Vr),tablet:i(dp),device:i(Vr)||i(dp)},other:{blackberry:i(pp),blackberry10:i(fp),opera:i(_p),firefox:i(gp),chrome:i(mp),device:i(pp)||i(fp)||i(_p)||i(gp)||i(mp)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const gy=vp.default??vp,Er=gy(globalThis.navigator);F.RETINA_PREFIX=/@([0-9\.]+)x/,F.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1,Jt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},xh=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e},Jg=function(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function s(){if(this instanceof s){var i=[null];i.push.apply(i,arguments);var n=Function.bind.apply(t,i);return new n}return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var i=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(r,s,i.get?i:{enumerable:!0,get:function(){return e[s]}})}),r};var xp={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function i(h,u,d){this.fn=h,this.context=u,this.once=d||!1}function n(h,u,d,l,c){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new i(d,l||h,c),f=r?r+u:u;return h._events[f]?h._events[f].fn?h._events[f]=[h._events[f],p]:h._events[f].push(p):(h._events[f]=p,h._eventsCount++),h}function o(h,u){--h._eventsCount===0?h._events=new s:delete h._events[u]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],u,d;if(this._eventsCount===0)return h;for(d in u=this._events)t.call(u,d)&&h.push(r?d.slice(1):d);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(u)):h},a.prototype.listeners=function(h){var u=r?r+h:h,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var l=0,c=d.length,p=new Array(c);l<c;l++)p[l]=d[l].fn;return p},a.prototype.listenerCount=function(h){var u=r?r+h:h,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(h,u,d,l,c,p){var f=r?r+h:h;if(!this._events[f])return!1;var _=this._events[f],m=arguments.length,g,v;if(_.fn){switch(_.once&&this.removeListener(h,_.fn,void 0,!0),m){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,u),!0;case 3:return _.fn.call(_.context,u,d),!0;case 4:return _.fn.call(_.context,u,d,l),!0;case 5:return _.fn.call(_.context,u,d,l,c),!0;case 6:return _.fn.call(_.context,u,d,l,c,p),!0}for(v=1,g=new Array(m-1);v<m;v++)g[v-1]=arguments[v];_.fn.apply(_.context,g)}else{var y=_.length,x;for(v=0;v<y;v++)switch(_[v].once&&this.removeListener(h,_[v].fn,void 0,!0),m){case 1:_[v].fn.call(_[v].context);break;case 2:_[v].fn.call(_[v].context,u);break;case 3:_[v].fn.call(_[v].context,u,d);break;case 4:_[v].fn.call(_[v].context,u,d,l);break;default:if(!g)for(x=1,g=new Array(m-1);x<m;x++)g[x-1]=arguments[x];_[v].fn.apply(_[v].context,g)}}return!0},a.prototype.on=function(h,u,d){return n(this,h,u,d,!1)},a.prototype.once=function(h,u,d){return n(this,h,u,d,!0)},a.prototype.removeListener=function(h,u,d,l){var c=r?r+h:h;if(!this._events[c])return this;if(!u)return o(this,c),this;var p=this._events[c];if(p.fn)p.fn===u&&(!l||p.once)&&(!d||p.context===d)&&o(this,c);else{for(var f=0,_=[],m=p.length;f<m;f++)(p[f].fn!==u||l&&!p[f].once||d&&p[f].context!==d)&&_.push(p[f]);_.length?this._events[c]=_.length===1?_[0]:_:o(this,c)}return this},a.prototype.removeAllListeners=function(h){var u;return h?(u=r?r+h:h,this._events[u]&&o(this,u)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a})(xp);var yy=xp.exports;const Rn=xh(yy);var pl={exports:{}};pl.exports=Vo,pl.exports.default=Vo;function Vo(e,t,r){r=r||2;var s=t&&t.length,i=s?t[0]*r:e.length,n=bp(e,0,i,r,!0),o=[];if(!n||n.next===n.prev)return o;var a,h,u,d,l,c,p;if(s&&(n=Ey(e,t,n,r)),e.length>80*r){a=u=e[0],h=d=e[1];for(var f=r;f<i;f+=r)l=e[f],c=e[f+1],l<a&&(a=l),c<h&&(h=c),l>u&&(u=l),c>d&&(d=c);p=Math.max(u-a,d-h),p=p!==0?32767/p:0}return Mn(n,o,r,a,h,p,0),o}function bp(e,t,r,s,i){var n,o;if(i===ml(e,t,r,s)>0)for(n=t;n<r;n+=s)o=wp(n,e[n],e[n+1],o);else for(n=r-s;n>=t;n-=s)o=wp(n,e[n],e[n+1],o);return o&&Xo(o,o.next)&&(Dn(o),o=o.next),o}function Ys(e,t){if(!e)return e;t||(t=e);var r=e,s;do if(s=!1,!r.steiner&&(Xo(r,r.next)||ft(r.prev,r,r.next)===0)){if(Dn(r),r=t=r.prev,r===r.next)break;s=!0}else r=r.next;while(s||r!==t);return t}function Mn(e,t,r,s,i,n,o){if(e){!o&&n&&Iy(e,s,i,n);for(var a=e,h,u;e.prev!==e.next;){if(h=e.prev,u=e.next,n?xy(e,s,i,n):vy(e)){t.push(h.i/r|0),t.push(e.i/r|0),t.push(u.i/r|0),Dn(e),e=u.next,a=u.next;continue}if(e=u,e===a){o?o===1?(e=by(Ys(e),t,r),Mn(e,t,r,s,i,n,2)):o===2&&Ty(e,t,r,s,i,n):Mn(Ys(e),t,r,s,i,n,1);break}}}}function vy(e){var t=e.prev,r=e,s=e.next;if(ft(t,r,s)>=0)return!1;for(var i=t.x,n=r.x,o=s.x,a=t.y,h=r.y,u=s.y,d=i<n?i<o?i:o:n<o?n:o,l=a<h?a<u?a:u:h<u?h:u,c=i>n?i>o?i:o:n>o?n:o,p=a>h?a>u?a:u:h>u?h:u,f=s.next;f!==t;){if(f.x>=d&&f.x<=c&&f.y>=l&&f.y<=p&&Ni(i,a,n,h,o,u,f.x,f.y)&&ft(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function xy(e,t,r,s){var i=e.prev,n=e,o=e.next;if(ft(i,n,o)>=0)return!1;for(var a=i.x,h=n.x,u=o.x,d=i.y,l=n.y,c=o.y,p=a<h?a<u?a:u:h<u?h:u,f=d<l?d<c?d:c:l<c?l:c,_=a>h?a>u?a:u:h>u?h:u,m=d>l?d>c?d:c:l>c?l:c,g=fl(p,f,t,r,s),v=fl(_,m,t,r,s),y=e.prevZ,x=e.nextZ;y&&y.z>=g&&x&&x.z<=v;){if(y.x>=p&&y.x<=_&&y.y>=f&&y.y<=m&&y!==i&&y!==o&&Ni(a,d,h,l,u,c,y.x,y.y)&&ft(y.prev,y,y.next)>=0||(y=y.prevZ,x.x>=p&&x.x<=_&&x.y>=f&&x.y<=m&&x!==i&&x!==o&&Ni(a,d,h,l,u,c,x.x,x.y)&&ft(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;y&&y.z>=g;){if(y.x>=p&&y.x<=_&&y.y>=f&&y.y<=m&&y!==i&&y!==o&&Ni(a,d,h,l,u,c,y.x,y.y)&&ft(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;x&&x.z<=v;){if(x.x>=p&&x.x<=_&&x.y>=f&&x.y<=m&&x!==i&&x!==o&&Ni(a,d,h,l,u,c,x.x,x.y)&&ft(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function by(e,t,r){var s=e;do{var i=s.prev,n=s.next.next;!Xo(i,n)&&Tp(i,s,s.next,n)&&Pn(i,n)&&Pn(n,i)&&(t.push(i.i/r|0),t.push(s.i/r|0),t.push(n.i/r|0),Dn(s),Dn(s.next),s=e=n),s=s.next}while(s!==e);return Ys(s)}function Ty(e,t,r,s,i,n){var o=e;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&Py(o,a)){var h=Ep(o,a);o=Ys(o,o.next),h=Ys(h,h.next),Mn(o,t,r,s,i,n,0),Mn(h,t,r,s,i,n,0);return}a=a.next}o=o.next}while(o!==e)}function Ey(e,t,r,s){var i=[],n,o,a,h,u;for(n=0,o=t.length;n<o;n++)a=t[n]*s,h=n<o-1?t[n+1]*s:e.length,u=bp(e,a,h,s,!1),u===u.next&&(u.steiner=!0),i.push(My(u));for(i.sort(wy),n=0;n<i.length;n++)r=Ay(i[n],r);return r}function wy(e,t){return e.x-t.x}function Ay(e,t){var r=Sy(e,t);if(!r)return t;var s=Ep(r,e);return Ys(s,s.next),Ys(r,r.next)}function Sy(e,t){var r=t,s=e.x,i=e.y,n=-1/0,o;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=s&&a>n&&(n=a,o=r.x<r.next.x?r:r.next,a===s))return o}r=r.next}while(r!==t);if(!o)return null;var h=o,u=o.x,d=o.y,l=1/0,c;r=o;do s>=r.x&&r.x>=u&&s!==r.x&&Ni(i<d?s:n,i,u,d,i<d?n:s,i,r.x,r.y)&&(c=Math.abs(i-r.y)/(s-r.x),Pn(r,e)&&(c<l||c===l&&(r.x>o.x||r.x===o.x&&Cy(o,r)))&&(o=r,l=c)),r=r.next;while(r!==h);return o}function Cy(e,t){return ft(e.prev,e,t.prev)<0&&ft(t.next,e,e.next)<0}function Iy(e,t,r,s){var i=e;do i.z===0&&(i.z=fl(i.x,i.y,t,r,s)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,Ry(i)}function Ry(e){var t,r,s,i,n,o,a,h,u=1;do{for(r=e,e=null,n=null,o=0;r;){for(o++,s=r,a=0,t=0;t<u&&(a++,s=s.nextZ,!!s);t++);for(h=u;a>0||h>0&&s;)a!==0&&(h===0||!s||r.z<=s.z)?(i=r,r=r.nextZ,a--):(i=s,s=s.nextZ,h--),n?n.nextZ=i:e=i,i.prevZ=n,n=i;r=s}n.nextZ=null,u*=2}while(o>1);return e}function fl(e,t,r,s,i){return e=(e-r)*i|0,t=(t-s)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function My(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function Ni(e,t,r,s,i,n,o,a){return(i-o)*(t-a)>=(e-o)*(n-a)&&(e-o)*(s-a)>=(r-o)*(t-a)&&(r-o)*(n-a)>=(i-o)*(s-a)}function Py(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Dy(e,t)&&(Pn(e,t)&&Pn(t,e)&&Oy(e,t)&&(ft(e.prev,e,t.prev)||ft(e,t.prev,t))||Xo(e,t)&&ft(e.prev,e,e.next)>0&&ft(t.prev,t,t.next)>0)}function ft(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Xo(e,t){return e.x===t.x&&e.y===t.y}function Tp(e,t,r,s){var i=jo(ft(e,t,r)),n=jo(ft(e,t,s)),o=jo(ft(r,s,e)),a=jo(ft(r,s,t));return!!(i!==n&&o!==a||i===0&&Wo(e,r,t)||n===0&&Wo(e,s,t)||o===0&&Wo(r,e,s)||a===0&&Wo(r,t,s))}function Wo(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function jo(e){return e>0?1:e<0?-1:0}function Dy(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Tp(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Pn(e,t){return ft(e.prev,e,e.next)<0?ft(e,t,e.next)>=0&&ft(e,e.prev,t)>=0:ft(e,t,e.prev)<0||ft(e,e.next,t)<0}function Oy(e,t){var r=e,s=!1,i=(e.x+t.x)/2,n=(e.y+t.y)/2;do r.y>n!=r.next.y>n&&r.next.y!==r.y&&i<(r.next.x-r.x)*(n-r.y)/(r.next.y-r.y)+r.x&&(s=!s),r=r.next;while(r!==e);return s}function Ep(e,t){var r=new _l(e.i,e.x,e.y),s=new _l(t.i,t.x,t.y),i=e.next,n=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,s.next=r,r.prev=s,n.next=s,s.prev=n,s}function wp(e,t,r,s){var i=new _l(e,t,r);return s?(i.next=s.next,i.prev=s,s.next.prev=i,s.next=i):(i.prev=i,i.next=i),i}function Dn(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function _l(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Vo.deviation=function(e,t,r,s){var i=t&&t.length,n=i?t[0]*r:e.length,o=Math.abs(ml(e,0,n,r));if(i)for(var a=0,h=t.length;a<h;a++){var u=t[a]*r,d=a<h-1?t[a+1]*r:e.length;o-=Math.abs(ml(e,u,d,r))}var l=0;for(a=0;a<s.length;a+=3){var c=s[a]*r,p=s[a+1]*r,f=s[a+2]*r;l+=Math.abs((e[c]-e[f])*(e[p+1]-e[c+1])-(e[c]-e[p])*(e[f+1]-e[c+1]))}return o===0&&l===0?0:Math.abs((l-o)/o)};function ml(e,t,r,s){for(var i=0,n=t,o=r-s;n<r;n+=s)i+=(e[o]-e[n])*(e[n+1]+e[o+1]),o=n;return i}Vo.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},s=0,i=0;i<e.length;i++){for(var n=0;n<e[i].length;n++)for(var o=0;o<t;o++)r.vertices.push(e[i][n][o]);i>0&&(s+=e[i-1].length,r.holes.push(s))}return r};var ky=pl.exports;const Ny=xh(ky);var Yo={exports:{}};Yo.exports,function(e,t){(function(r){var s=t&&!t.nodeType&&t,i=e&&!e.nodeType&&e,n=typeof Jt=="object"&&Jt;(n.global===n||n.window===n||n.self===n)&&(r=n);var o,a=2147483647,h=36,u=1,d=26,l=38,c=700,p=72,f=128,_="-",m=/^xn--/,g=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=h-u,E=Math.floor,T=String.fromCharCode,w;function b(P){throw RangeError(y[P])}function A(P,G){for(var Q=P.length,j=[];Q--;)j[Q]=G(P[Q]);return j}function R(P,G){var Q=P.split("@"),j="";Q.length>1&&(j=Q[0]+"@",P=Q[1]),P=P.replace(v,".");var q=P.split("."),Wt=A(q,G).join(".");return j+Wt}function S(P){for(var G=[],Q=0,j=P.length,q,Wt;Q<j;)q=P.charCodeAt(Q++),q>=55296&&q<=56319&&Q<j?(Wt=P.charCodeAt(Q++),(Wt&64512)==56320?G.push(((q&1023)<<10)+(Wt&1023)+65536):(G.push(q),Q--)):G.push(q);return G}function M(P){return A(P,function(G){var Q="";return G>65535&&(G-=65536,Q+=T(G>>>10&1023|55296),G=56320|G&1023),Q+=T(G),Q}).join("")}function I(P){return P-48<10?P-22:P-65<26?P-65:P-97<26?P-97:h}function C(P,G){return P+22+75*(P<26)-((G!=0)<<5)}function O(P,G,Q){var j=0;for(P=Q?E(P/c):P>>1,P+=E(P/G);P>x*d>>1;j+=h)P=E(P/x);return E(j+(x+1)*P/(P+l))}function L(P){var G=[],Q=P.length,j,q=0,Wt=f,Ot=p,jt,he,Ne,Qt,ct,kt,Lt,Nr,Lr;for(jt=P.lastIndexOf(_),jt<0&&(jt=0),he=0;he<jt;++he)P.charCodeAt(he)>=128&&b("not-basic"),G.push(P.charCodeAt(he));for(Ne=jt>0?jt+1:0;Ne<Q;){for(Qt=q,ct=1,kt=h;Ne>=Q&&b("invalid-input"),Lt=I(P.charCodeAt(Ne++)),(Lt>=h||Lt>E((a-q)/ct))&&b("overflow"),q+=Lt*ct,Nr=kt<=Ot?u:kt>=Ot+d?d:kt-Ot,!(Lt<Nr);kt+=h)Lr=h-Nr,ct>E(a/Lr)&&b("overflow"),ct*=Lr;j=G.length+1,Ot=O(q-Qt,j,Qt==0),E(q/j)>a-Wt&&b("overflow"),Wt+=E(q/j),q%=j,G.splice(q++,0,Wt)}return M(G)}function D(P){var G,Q,j,q,Wt,Ot,jt,he,Ne,Qt,ct,kt=[],Lt,Nr,Lr,Ao;for(P=S(P),Lt=P.length,G=f,Q=0,Wt=p,Ot=0;Ot<Lt;++Ot)ct=P[Ot],ct<128&&kt.push(T(ct));for(j=q=kt.length,q&&kt.push(_);j<Lt;){for(jt=a,Ot=0;Ot<Lt;++Ot)ct=P[Ot],ct>=G&&ct<jt&&(jt=ct);for(Nr=j+1,jt-G>E((a-Q)/Nr)&&b("overflow"),Q+=(jt-G)*Nr,G=jt,Ot=0;Ot<Lt;++Ot)if(ct=P[Ot],ct<G&&++Q>a&&b("overflow"),ct==G){for(he=Q,Ne=h;Qt=Ne<=Wt?u:Ne>=Wt+d?d:Ne-Wt,!(he<Qt);Ne+=h)Ao=he-Qt,Lr=h-Qt,kt.push(T(C(Qt+Ao%Lr,0))),he=E(Ao/Lr);kt.push(T(C(he,0))),Wt=O(Q,Nr,j==q),Q=0,++j}++Q,++G}return kt.join("")}function Y(P){return R(P,function(G){return m.test(G)?L(G.slice(4).toLowerCase()):G})}function Z(P){return R(P,function(G){return g.test(G)?"xn--"+D(G):G})}if(o={version:"1.3.2",ucs2:{decode:S,encode:M},decode:L,encode:D,toASCII:Z,toUnicode:Y},s&&i)if(e.exports==s)i.exports=o;else for(w in o)o.hasOwnProperty(w)&&(s[w]=o[w]);else r.punycode=o})(Jt)}(Yo,Yo.exports);var Ly=Yo.exports,Fy={isString:function(e){return typeof e=="string"},isObject:function(e){return typeof e=="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}},On={};function By(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Uy=function(e,t,r,s){t=t||"&",r=r||"=";var i={};if(typeof e!="string"||e.length===0)return i;var n=/\+/g;e=e.split(t);var o=1e3;s&&typeof s.maxKeys=="number"&&(o=s.maxKeys);var a=e.length;o>0&&a>o&&(a=o);for(var h=0;h<a;++h){var u=e[h].replace(n,"%20"),d=u.indexOf(r),l,c,p,f;d>=0?(l=u.substr(0,d),c=u.substr(d+1)):(l=u,c=""),p=decodeURIComponent(l),f=decodeURIComponent(c),By(i,p)?Array.isArray(i[p])?i[p].push(f):i[p]=[i[p],f]:i[p]=f}return i},kn=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},Gy=function(e,t,r,s){return t=t||"&",r=r||"=",e===null&&(e=void 0),typeof e=="object"?Object.keys(e).map(function(i){var n=encodeURIComponent(kn(i))+r;return Array.isArray(e[i])?e[i].map(function(o){return n+encodeURIComponent(kn(o))}).join(t):n+encodeURIComponent(kn(e[i]))}).join(t):s?encodeURIComponent(kn(s))+r+encodeURIComponent(kn(e)):""};On.decode=On.parse=Uy,On.encode=On.stringify=Gy;var Hy=Ly,wr=Fy,zy=$o,Vy=tv,Xy=Jy;function tr(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Wy=/^([a-z0-9.+-]+:)/i,jy=/:[0-9]*$/,Yy=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,$y=["<",">",'"',"`"," ","\r",`
`,"	"],qy=["{","}","|","\\","^","`"].concat($y),gl=["'"].concat(qy),Ap=["%","/","?",";","#"].concat(gl),Sp=["/","?","#"],Ky=255,Cp=/^[+a-z0-9A-Z_-]{0,63}$/,Zy=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Qy={javascript:!0,"javascript:":!0},yl={javascript:!0,"javascript:":!0},Li={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},vl=On;function $o(e,t,r){if(e&&wr.isObject(e)&&e instanceof tr)return e;var s=new tr;return s.parse(e,t,r),s}tr.prototype.parse=function(e,t,r){if(!wr.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var s=e.indexOf("?"),i=s!==-1&&s<e.indexOf("#")?"?":"#",n=e.split(i),o=/\\/g;n[0]=n[0].replace(o,"/"),e=n.join(i);var a=e;if(a=a.trim(),!r&&e.split("#").length===1){var h=Yy.exec(a);if(h)return this.path=a,this.href=a,this.pathname=h[1],h[2]?(this.search=h[2],t?this.query=vl.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var u=Wy.exec(a);if(u){u=u[0];var d=u.toLowerCase();this.protocol=d,a=a.substr(u.length)}if(r||u||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var l=a.substr(0,2)==="//";l&&!(u&&yl[u])&&(a=a.substr(2),this.slashes=!0)}if(!yl[u]&&(l||u&&!Li[u])){for(var c=-1,p=0;p<Sp.length;p++){var f=a.indexOf(Sp[p]);f!==-1&&(c===-1||f<c)&&(c=f)}var _,m;c===-1?m=a.lastIndexOf("@"):m=a.lastIndexOf("@",c),m!==-1&&(_=a.slice(0,m),a=a.slice(m+1),this.auth=decodeURIComponent(_)),c=-1;for(var p=0;p<Ap.length;p++){var f=a.indexOf(Ap[p]);f!==-1&&(c===-1||f<c)&&(c=f)}c===-1&&(c=a.length),this.host=a.slice(0,c),a=a.slice(c),this.parseHost(),this.hostname=this.hostname||"";var g=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!g)for(var v=this.hostname.split(/\./),p=0,y=v.length;p<y;p++){var x=v[p];if(x&&!x.match(Cp)){for(var E="",T=0,w=x.length;T<w;T++)x.charCodeAt(T)>127?E+="x":E+=x[T];if(!E.match(Cp)){var b=v.slice(0,p),A=v.slice(p+1),R=x.match(Zy);R&&(b.push(R[1]),A.unshift(R[2])),A.length&&(a="/"+A.join(".")+a),this.hostname=b.join(".");break}}}this.hostname.length>Ky?this.hostname="":this.hostname=this.hostname.toLowerCase(),g||(this.hostname=Hy.toASCII(this.hostname));var S=this.port?":"+this.port:"",M=this.hostname||"";this.host=M+S,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Qy[d])for(var p=0,y=gl.length;p<y;p++){var I=gl[p];if(a.indexOf(I)!==-1){var C=encodeURIComponent(I);C===I&&(C=escape(I)),a=a.split(I).join(C)}}var O=a.indexOf("#");O!==-1&&(this.hash=a.substr(O),a=a.slice(0,O));var L=a.indexOf("?");if(L!==-1?(this.search=a.substr(L),this.query=a.substr(L+1),t&&(this.query=vl.parse(this.query)),a=a.slice(0,L)):t&&(this.search="",this.query={}),a&&(this.pathname=a),Li[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var S=this.pathname||"",D=this.search||"";this.path=S+D}return this.href=this.format(),this};function Jy(e){return wr.isString(e)&&(e=$o(e)),e instanceof tr?e.format():tr.prototype.format.call(e)}tr.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",s=this.hash||"",i=!1,n="";this.host?i=e+this.host:this.hostname&&(i=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&wr.isObject(this.query)&&Object.keys(this.query).length&&(n=vl.stringify(this.query));var o=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||Li[t])&&i!==!1?(i="//"+(i||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):i||(i=""),s&&s.charAt(0)!=="#"&&(s="#"+s),o&&o.charAt(0)!=="?"&&(o="?"+o),r=r.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),t+i+r+o+s};function tv(e,t){return $o(e,!1,!0).resolve(t)}tr.prototype.resolve=function(e){return this.resolveObject($o(e,!1,!0)).format()},tr.prototype.resolveObject=function(e){if(wr.isString(e)){var t=new tr;t.parse(e,!1,!0),e=t}for(var r=new tr,s=Object.keys(this),i=0;i<s.length;i++){var n=s[i];r[n]=this[n]}if(r.hash=e.hash,e.href==="")return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var o=Object.keys(e),a=0;a<o.length;a++){var h=o[a];h!=="protocol"&&(r[h]=e[h])}return Li[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!Li[e.protocol]){for(var u=Object.keys(e),d=0;d<u.length;d++){var l=u[d];r[l]=e[l]}return r.href=r.format(),r}if(r.protocol=e.protocol,!e.host&&!yl[e.protocol]){for(var y=(e.pathname||"").split("/");y.length&&!(e.host=y.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),y[0]!==""&&y.unshift(""),y.length<2&&y.unshift(""),r.pathname=y.join("/")}else r.pathname=e.pathname;if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var c=r.pathname||"",p=r.search||"";r.path=c+p}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var f=r.pathname&&r.pathname.charAt(0)==="/",_=e.host||e.pathname&&e.pathname.charAt(0)==="/",m=_||f||r.host&&e.pathname,g=m,v=r.pathname&&r.pathname.split("/")||[],y=e.pathname&&e.pathname.split("/")||[],x=r.protocol&&!Li[r.protocol];if(x&&(r.hostname="",r.port=null,r.host&&(v[0]===""?v[0]=r.host:v.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(y[0]===""?y[0]=e.host:y.unshift(e.host)),e.host=null),m=m&&(y[0]===""||v[0]==="")),_)r.host=e.host||e.host===""?e.host:r.host,r.hostname=e.hostname||e.hostname===""?e.hostname:r.hostname,r.search=e.search,r.query=e.query,v=y;else if(y.length)v||(v=[]),v.pop(),v=v.concat(y),r.search=e.search,r.query=e.query;else if(!wr.isNullOrUndefined(e.search)){if(x){r.hostname=r.host=v.shift();var E=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;E&&(r.auth=E.shift(),r.host=r.hostname=E.shift())}return r.search=e.search,r.query=e.query,(!wr.isNull(r.pathname)||!wr.isNull(r.search))&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!v.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var T=v.slice(-1)[0],w=(r.host||e.host||v.length>1)&&(T==="."||T==="..")||T==="",b=0,A=v.length;A>=0;A--)T=v[A],T==="."?v.splice(A,1):T===".."?(v.splice(A,1),b++):b&&(v.splice(A,1),b--);if(!m&&!g)for(;b--;b)v.unshift("..");m&&v[0]!==""&&(!v[0]||v[0].charAt(0)!=="/")&&v.unshift(""),w&&v.join("/").substr(-1)!=="/"&&v.push("");var R=v[0]===""||v[0]&&v[0].charAt(0)==="/";if(x){r.hostname=r.host=R?"":v.length?v.shift():"";var E=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;E&&(r.auth=E.shift(),r.host=r.hostname=E.shift())}return m=m||r.host&&v.length,m&&!R&&v.unshift(""),v.length?r.pathname=v.join("/"):(r.pathname=null,r.path=null),(!wr.isNull(r.pathname)||!wr.isNull(r.search))&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},tr.prototype.parseHost=function(){var e=this.host,t=jy.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const ev={parse:zy,format:Xy,resolve:Vy};function er(e){if(typeof e!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function Nn(e){return e.split("?")[0].split("#")[0]}function rv(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function sv(e,t,r){return e.replace(new RegExp(rv(t),"g"),r)}function iv(e,t){let r="",s=0,i=-1,n=0,o=-1;for(let a=0;a<=e.length;++a){if(a<e.length)o=e.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||n===1))if(i!==a-1&&n===2){if(r.length<2||s!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){const h=r.lastIndexOf("/");if(h!==r.length-1){h===-1?(r="",s=0):(r=r.slice(0,h),s=r.length-1-r.lastIndexOf("/")),i=a,n=0;continue}}else if(r.length===2||r.length===1){r="",s=0,i=a,n=0;continue}}t&&(r.length>0?r+="/..":r="..",s=2)}else r.length>0?r+=`/${e.slice(i+1,a)}`:r=e.slice(i+1,a),s=a-i-1;i=a,n=0}else o===46&&n!==-1?++n:n=-1}return r}const se={toPosix(e){return sv(e,"\\","/")},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl(e){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e)},hasProtocol(e){return/^[^/:]+:\//.test(this.toPosix(e))},getProtocol(e){er(e),e=this.toPosix(e);let t="";const r=/^file:\/\/\//.exec(e),s=/^[^/:]+:\/\//.exec(e),i=/^[^/:]+:\//.exec(e);if(r||s||i){const n=(r==null?void 0:r[0])||(s==null?void 0:s[0])||(i==null?void 0:i[0]);t=n,e=e.slice(n.length)}return t},toAbsolute(e,t,r){if(this.isDataUrl(e))return e;const s=Nn(this.toPosix(t??F.ADAPTER.getBaseUrl())),i=Nn(this.toPosix(r??this.rootname(s)));return er(e),e=this.toPosix(e),e.startsWith("/")?se.join(i,e.slice(1)):this.isAbsolute(e)?e:this.join(s,e)},normalize(e){if(e=this.toPosix(e),er(e),e.length===0)return".";let t="";const r=e.startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));const s=e.endsWith("/");return e=iv(e,!1),e.length>0&&s&&(e+="/"),r?`/${e}`:t+e},isAbsolute(e){return er(e),e=this.toPosix(e),this.hasProtocol(e)?!0:e.startsWith("/")},join(...e){if(e.length===0)return".";let t;for(let r=0;r<e.length;++r){const s=e[r];if(er(s),s.length>0)if(t===void 0)t=s;else{const i=e[r-1]??"";this.extname(i)?t+=`/../${s}`:t+=`/${s}`}}return t===void 0?".":this.normalize(t)},dirname(e){if(er(e),e.length===0)return".";e=this.toPosix(e);let t=e.charCodeAt(0);const r=t===47;let s=-1,i=!0;const n=this.getProtocol(e),o=e;e=e.slice(n.length);for(let a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!i){s=a;break}}else i=!1;return s===-1?r?"/":this.isUrl(o)?n+e:n:r&&s===1?"//":n+e.slice(0,s)},rootname(e){er(e),e=this.toPosix(e);let t="";if(e.startsWith("/")?t="/":t=this.getProtocol(e),this.isUrl(e)){const r=e.indexOf("/",t.length);r!==-1?t=e.slice(0,r):t=e,t.endsWith("/")||(t+="/")}return t},basename(e,t){er(e),t&&er(t),e=Nn(this.toPosix(e));let r=0,s=-1,i=!0,n;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let o=t.length-1,a=-1;for(n=e.length-1;n>=0;--n){const h=e.charCodeAt(n);if(h===47){if(!i){r=n+1;break}}else a===-1&&(i=!1,a=n+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(s=n):(o=-1,s=a))}return r===s?s=a:s===-1&&(s=e.length),e.slice(r,s)}for(n=e.length-1;n>=0;--n)if(e.charCodeAt(n)===47){if(!i){r=n+1;break}}else s===-1&&(i=!1,s=n+1);return s===-1?"":e.slice(r,s)},extname(e){er(e),e=Nn(this.toPosix(e));let t=-1,r=0,s=-1,i=!0,n=0;for(let o=e.length-1;o>=0;--o){const a=e.charCodeAt(o);if(a===47){if(!i){r=o+1;break}continue}s===-1&&(i=!1,s=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||s===-1||n===0||n===1&&t===s-1&&t===r+1?"":e.slice(t,s)},parse(e){er(e);const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;e=Nn(this.toPosix(e));let r=e.charCodeAt(0);const s=this.isAbsolute(e);let i;t.root=this.rootname(e),s||this.hasProtocol(e)?i=1:i=0;let n=-1,o=0,a=-1,h=!0,u=e.length-1,d=0;for(;u>=i;--u){if(r=e.charCodeAt(u),r===47){if(!h){o=u+1;break}continue}a===-1&&(h=!1,a=u+1),r===46?n===-1?n=u:d!==1&&(d=1):n!==-1&&(d=-1)}return n===-1||a===-1||d===0||d===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&s?t.base=t.name=e.slice(1,a):t.base=t.name=e.slice(o,a)):(o===0&&s?(t.name=e.slice(1,n),t.base=e.slice(1,a)):(t.name=e.slice(o,n),t.base=e.slice(o,a)),t.ext=e.slice(n,a)),t.dir=this.dirname(e),t},sep:"/",delimiter:":"},Ip={};function J(e,t,r=3){if(Ip[t])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`):(s=s.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${e}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`),console.warn(s))),Ip[t]=!0}let xl;function nv(){return typeof xl>"u"&&(xl=function(){var t;const e={stencil:!0,failIfMajorPerformanceCaveat:F.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!F.ADAPTER.getWebGLRenderingContext())return!1;const r=F.ADAPTER.createCanvas();let s=r.getContext("webgl",e)||r.getContext("experimental-webgl",e);const i=!!((t=s==null?void 0:s.getContextAttributes())!=null&&t.stencil);if(s){const n=s.getExtension("WEBGL_lose_context");n&&n.loseContext()}return s=null,i}catch{return!1}}()),xl}var ov={grad:.9,turn:360,rad:360/(2*Math.PI)},Xr=function(e){return typeof e=="string"?e.length>0:typeof e=="number"},Ut=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},Ve=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=1),e>r?r:e>t?e:t},Rp=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},Mp=function(e){return{r:Ve(e.r,0,255),g:Ve(e.g,0,255),b:Ve(e.b,0,255),a:Ve(e.a)}},bl=function(e){return{r:Ut(e.r),g:Ut(e.g),b:Ut(e.b),a:Ut(e.a,3)}},av=/^#([0-9a-f]{3,8})$/i,qo=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},Pp=function(e){var t=e.r,r=e.g,s=e.b,i=e.a,n=Math.max(t,r,s),o=n-Math.min(t,r,s),a=o?n===t?(r-s)/o:n===r?2+(s-t)/o:4+(t-r)/o:0;return{h:60*(a<0?a+6:a),s:n?o/n*100:0,v:n/255*100,a:i}},Dp=function(e){var t=e.h,r=e.s,s=e.v,i=e.a;t=t/360*6,r/=100,s/=100;var n=Math.floor(t),o=s*(1-r),a=s*(1-(t-n)*r),h=s*(1-(1-t+n)*r),u=n%6;return{r:255*[s,a,o,o,h,s][u],g:255*[h,s,s,a,o,o][u],b:255*[o,o,h,s,s,a][u],a:i}},Op=function(e){return{h:Rp(e.h),s:Ve(e.s,0,100),l:Ve(e.l,0,100),a:Ve(e.a)}},kp=function(e){return{h:Ut(e.h),s:Ut(e.s),l:Ut(e.l),a:Ut(e.a,3)}},Np=function(e){return Dp((r=(t=e).s,{h:t.h,s:(r*=((s=t.l)<50?s:100-s)/100)>0?2*r/(s+r)*100:0,v:s+r,a:t.a}));var t,r,s},Ln=function(e){return{h:(t=Pp(e)).h,s:(i=(200-(r=t.s))*(s=t.v)/100)>0&&i<200?r*s/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,r,s,i},hv=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,lv=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,uv=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,cv=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Tl={string:[[function(e){var t=av.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?Ut(parseInt(e[3]+e[3],16)/255,2):1}:e.length===6||e.length===8?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:e.length===8?Ut(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=uv.exec(e)||cv.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:Mp({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=hv.exec(e)||lv.exec(e);if(!t)return null;var r,s,i=Op({h:(r=t[1],s=t[2],s===void 0&&(s="deg"),Number(r)*(ov[s]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Np(i)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,s=e.b,i=e.a,n=i===void 0?1:i;return Xr(t)&&Xr(r)&&Xr(s)?Mp({r:Number(t),g:Number(r),b:Number(s),a:Number(n)}):null},"rgb"],[function(e){var t=e.h,r=e.s,s=e.l,i=e.a,n=i===void 0?1:i;if(!Xr(t)||!Xr(r)||!Xr(s))return null;var o=Op({h:Number(t),s:Number(r),l:Number(s),a:Number(n)});return Np(o)},"hsl"],[function(e){var t=e.h,r=e.s,s=e.v,i=e.a,n=i===void 0?1:i;if(!Xr(t)||!Xr(r)||!Xr(s))return null;var o=function(a){return{h:Rp(a.h),s:Ve(a.s,0,100),v:Ve(a.v,0,100),a:Ve(a.a)}}({h:Number(t),s:Number(r),v:Number(s),a:Number(n)});return Dp(o)},"hsv"]]},Lp=function(e,t){for(var r=0;r<t.length;r++){var s=t[r][0](e);if(s)return[s,t[r][1]]}return[null,void 0]},dv=function(e){return typeof e=="string"?Lp(e.trim(),Tl.string):typeof e=="object"&&e!==null?Lp(e,Tl.object):[null,void 0]},El=function(e,t){var r=Ln(e);return{h:r.h,s:Ve(r.s+100*t,0,100),l:r.l,a:r.a}},wl=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},Fp=function(e,t){var r=Ln(e);return{h:r.h,s:r.s,l:Ve(r.l+100*t,0,100),a:r.a}},Al=function(){function e(t){this.parsed=dv(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return this.parsed!==null},e.prototype.brightness=function(){return Ut(wl(this.rgba),2)},e.prototype.isDark=function(){return wl(this.rgba)<.5},e.prototype.isLight=function(){return wl(this.rgba)>=.5},e.prototype.toHex=function(){return t=bl(this.rgba),r=t.r,s=t.g,i=t.b,o=(n=t.a)<1?qo(Ut(255*n)):"","#"+qo(r)+qo(s)+qo(i)+o;var t,r,s,i,n,o},e.prototype.toRgb=function(){return bl(this.rgba)},e.prototype.toRgbString=function(){return t=bl(this.rgba),r=t.r,s=t.g,i=t.b,(n=t.a)<1?"rgba("+r+", "+s+", "+i+", "+n+")":"rgb("+r+", "+s+", "+i+")";var t,r,s,i,n},e.prototype.toHsl=function(){return kp(Ln(this.rgba))},e.prototype.toHslString=function(){return t=kp(Ln(this.rgba)),r=t.h,s=t.s,i=t.l,(n=t.a)<1?"hsla("+r+", "+s+"%, "+i+"%, "+n+")":"hsl("+r+", "+s+"%, "+i+"%)";var t,r,s,i,n},e.prototype.toHsv=function(){return t=Pp(this.rgba),{h:Ut(t.h),s:Ut(t.s),v:Ut(t.v),a:Ut(t.a,3)};var t},e.prototype.invert=function(){return Ar({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},e.prototype.saturate=function(t){return t===void 0&&(t=.1),Ar(El(this.rgba,t))},e.prototype.desaturate=function(t){return t===void 0&&(t=.1),Ar(El(this.rgba,-t))},e.prototype.grayscale=function(){return Ar(El(this.rgba,-1))},e.prototype.lighten=function(t){return t===void 0&&(t=.1),Ar(Fp(this.rgba,t))},e.prototype.darken=function(t){return t===void 0&&(t=.1),Ar(Fp(this.rgba,-t))},e.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},e.prototype.alpha=function(t){return typeof t=="number"?Ar({r:(r=this.rgba).r,g:r.g,b:r.b,a:t}):Ut(this.rgba.a,3);var r},e.prototype.hue=function(t){var r=Ln(this.rgba);return typeof t=="number"?Ar({h:t,s:r.s,l:r.l,a:r.a}):Ut(r.h)},e.prototype.isEqual=function(t){return this.toHex()===Ar(t).toHex()},e}(),Ar=function(e){return e instanceof Al?e:new Al(e)},Bp=[],pv=function(e){e.forEach(function(t){Bp.indexOf(t)<0&&(t(Al,Tl),Bp.push(t))})};function fv(e,t){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var i in r)s[r[i]]=i;var n={};e.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,h,u=s[this.toHex()];if(u)return u;if(o!=null&&o.closest){var d=this.toRgb(),l=1/0,c="black";if(!n.length)for(var p in r)n[p]=new e(r[p]).toRgb();for(var f in r){var _=(a=d,h=n[f],Math.pow(a.r-h.r,2)+Math.pow(a.g-h.g,2)+Math.pow(a.b-h.b,2));_<l&&(l=_,c=f)}return c}},t.string.push([function(o){var a=o.toLowerCase(),h=a==="transparent"?"#0000":r[a];return h?new e(h).toRgb():null},"name"])}pv([fv]);const Fi=class{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Fi)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,t){const r=typeof e;if(r!==typeof t)return!1;if(r==="number"||r==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((s,i)=>s===t[i]);if(e!==null&&t!==null){const s=Object.keys(e),i=Object.keys(t);return s.length!==i.length?!1:s.every(n=>e[n]===t[n])}return e===t}toRgba(){const[e,t,r,s]=this._components;return{r:e,g:t,b:r,a:s}}toRgb(){const[e,t,r]=this._components;return{r:e,g:t,b:r}}toRgbaString(){const[e,t,r]=this.toUint8RgbArray();return`rgba(${e},${t},${r},${this.alpha})`}toUint8RgbArray(e){const[t,r,s]=this._components;return e=e??[],e[0]=Math.round(t*255),e[1]=Math.round(r*255),e[2]=Math.round(s*255),e}toRgbArray(e){e=e??[];const[t,r,s]=this._components;return e[0]=t,e[1]=r,e[2]=s,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[t,r,s,i]=Fi.temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=r,this._components[2]*=s,this._components[3]*=i,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let r=this._int>>16&255,s=this._int>>8&255,i=this._int&255;return t&&(r=r*e+.5|0,s=s*e+.5|0,i=i*e+.5|0),(e*255<<24)+(r<<16)+(s<<8)+i}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[t,r,s]=this._components;return this._components[0]=Math.round(t*e)/e,this._components[1]=Math.round(r*e)/e,this._components[2]=Math.round(s*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[t,r,s,i]=this._components;return e[0]=t,e[1]=r,e[2]=s,e[3]=i,e}normalize(e){let t,r,s,i;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const n=e;t=(n>>16&255)/255,r=(n>>8&255)/255,s=(n&255)/255,i=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,r,s,i=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,r,s,i=255]=e,t/=255,r/=255,s/=255,i/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const o=Fi.HEX_PATTERN.exec(e);o&&(e=`#${o[2]}`)}const n=Ar(e);n.isValid()&&({r:t,g:r,b:s,a:i}=n.rgba,t/=255,r/=255,s/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=r,this._components[2]=s,this._components[3]=i,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,t,r]=this._components;this._int=(e*255<<16)+(t*255<<8)+(r*255|0)}_clamp(e,t=0,r=1){return typeof e=="number"?Math.min(Math.max(e,t),r):(e.forEach((s,i)=>{e[i]=Math.min(Math.max(s,t),r)}),e)}};let st=Fi;st.shared=new Fi,st.temp=new Fi,st.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;function Up(e,t=[]){return J("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),st.shared.setValue(e).toRgbArray(t)}function _v(e){return J("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),st.shared.setValue(e).toHex()}function Gp(e){return J("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),st.shared.setValue(e).toNumber()}function Bi(e){return J("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),st.shared.setValue(e).toNumber()}function mv(){const e=[],t=[];for(let s=0;s<32;s++)e[s]=s,t[s]=s;e[V.NORMAL_NPM]=V.NORMAL,e[V.ADD_NPM]=V.ADD,e[V.SCREEN_NPM]=V.SCREEN,t[V.NORMAL]=V.NORMAL_NPM,t[V.ADD]=V.ADD_NPM,t[V.SCREEN]=V.SCREEN_NPM;const r=[];return r.push(t),r.push(e),r}const Hp=mv();function zp(e,t){return Hp[t?1:0][e]}function gv(e,t=null){const r=e*6;if(t=t||new Uint16Array(r),t.length!==r)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${r}`);for(let s=0,i=0;s<r;s+=6,i+=4)t[s+0]=i+0,t[s+1]=i+1,t[s+2]=i+2,t[s+3]=i+0,t[s+4]=i+2,t[s+5]=i+3;return t}function Vp(e){if(e.BYTES_PER_ELEMENT===4)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(e.BYTES_PER_ELEMENT===2){if(e instanceof Uint16Array)return"Uint16Array"}else if(e.BYTES_PER_ELEMENT===1&&e instanceof Uint8Array)return"Uint8Array";return null}function Ko(e){return e+=e===0?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1}function Xp(e){return!(e&e-1)&&!!e}function Wp(e){let t=(e>65535?1:0)<<4;e>>>=t;let r=(e>255?1:0)<<3;return e>>>=r,t|=r,r=(e>15?1:0)<<2,e>>>=r,t|=r,r=(e>3?1:0)<<1,e>>>=r,t|=r,t|e>>1}function Ui(e,t,r){const s=e.length;let i;if(t>=s||r===0)return;r=t+r>s?s-t:r;const n=s-r;for(i=t;i<n;++i)e[i]=e[i+r];e.length=n}function cs(e){return e===0?0:e<0?-1:1}let yv=0;function $s(){return++yv}const jp=class{constructor(e,t,r,s){this.left=e,this.top=t,this.right=r,this.bottom=s}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let Sl=jp;Sl.EMPTY=new jp(0,0,0,0);const Yp={},Sr=Object.create(null),ds=Object.create(null);class vv{constructor(t,r,s){this._canvas=F.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=s||F.RESOLUTION,this.resize(t,r)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,r){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(r*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function $p(e,t,r){for(let s=0,i=4*r*t;s<t;++s,i+=4)if(e[i+3]!==0)return!1;return!0}function qp(e,t,r,s,i){const n=4*t;for(let o=s,a=s*n+4*r;o<=i;++o,a+=n)if(e[a+3]!==0)return!1;return!0}function xv(e){const{width:t,height:r}=e,s=e.getContext("2d",{willReadFrequently:!0});if(s===null)throw new TypeError("Failed to get canvas 2D context");const i=s.getImageData(0,0,t,r).data;let n=0,o=0,a=t-1,h=r-1;for(;o<r&&$p(i,t,o);)++o;if(o===r)return Sl.EMPTY;for(;$p(i,t,h);)--h;for(;qp(i,t,n,o,h);)++n;for(;qp(i,t,a,o,h);)--a;return++a,++h,new Sl(n,o,a,h)}function bv(e){const t=xv(e),{width:r,height:s}=t;let i=null;if(!t.isEmpty()){const n=e.getContext("2d");if(n===null)throw new TypeError("Failed to get canvas 2D context");i=n.getImageData(t.left,t.top,r,s)}return{width:r,height:s,data:i}}let Zo;function Tv(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location,Zo||(Zo=document.createElement("a")),Zo.href=e;const r=ev.parse(Zo.href),s=!r.port&&t.port===""||r.port===t.port;return r.hostname!==t.hostname||!s||r.protocol!==t.protocol?"anonymous":""}function ps(e,t=1){var s;const r=(s=F.RETINA_PREFIX)==null?void 0:s.exec(e);return r?parseFloat(r[1]):t}var B=(e=>(e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e))(B||{});const Cl=e=>{if(typeof e=="function"||typeof e=="object"&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={...typeof e.extension!="object"?{type:e.extension}:e.extension,ref:e}}if(typeof e=="object")e={...e};else throw new Error("Invalid extension type");return typeof e.type=="string"&&(e.type=[e.type]),e},Kp=(e,t)=>Cl(e).priority??t,z={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(Cl).forEach(t=>{t.type.forEach(r=>{var s,i;return(i=(s=this._removeHandlers)[r])==null?void 0:i.call(s,t)})}),this},add(...e){return e.map(Cl).forEach(t=>{t.type.forEach(r=>{const s=this._addHandlers,i=this._queue;s[r]?s[r](t):(i[r]=i[r]||[],i[r].push(t))})}),this},handle(e,t,r){const s=this._addHandlers,i=this._removeHandlers;if(s[e]||i[e])throw new Error(`Extension type ${e} already has a handler`);s[e]=t,i[e]=r;const n=this._queue;return n[e]&&(n[e].forEach(o=>t(o)),delete n[e]),this},handleByMap(e,t){return this.handle(e,r=>{t[r.name]=r.ref},r=>{delete t[r.name]})},handleByList(e,t,r=-1){return this.handle(e,s=>{t.includes(s.ref)||(t.push(s.ref),t.sort((i,n)=>Kp(n,r)-Kp(i,r)))},s=>{const i=t.indexOf(s.ref);i!==-1&&t.splice(i,1)})}};class Il{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const Ev=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function wv(e){let t="";for(let r=0;r<e;++r)r>0&&(t+=`
else `),r<e-1&&(t+=`if(test == ${r}.0){}`);return t}function Av(e,t){if(e===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=t.createShader(t.FRAGMENT_SHADER);for(;;){const s=Ev.replace(/%forloop%/gi,wv(e));if(t.shaderSource(r,s),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))e=e/2|0;else break}return e}const Rl=0,Ml=1,Pl=2,Dl=3,Ol=4,kl=5;let qs=class t0{constructor(){this.data=0,this.blendMode=V.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Rl)}set blend(t){!!(this.data&1<<Rl)!==t&&(this.data^=1<<Rl)}get offsets(){return!!(this.data&1<<Ml)}set offsets(t){!!(this.data&1<<Ml)!==t&&(this.data^=1<<Ml)}get culling(){return!!(this.data&1<<Pl)}set culling(t){!!(this.data&1<<Pl)!==t&&(this.data^=1<<Pl)}get depthTest(){return!!(this.data&1<<Dl)}set depthTest(t){!!(this.data&1<<Dl)!==t&&(this.data^=1<<Dl)}get depthMask(){return!!(this.data&1<<kl)}set depthMask(t){!!(this.data&1<<kl)!==t&&(this.data^=1<<kl)}get clockwiseFrontFace(){return!!(this.data&1<<Ol)}set clockwiseFrontFace(t){!!(this.data&1<<Ol)!==t&&(this.data^=1<<Ol)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==V.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new t0;return t.depthTest=!1,t.blend=!0,t}};const Nl=[];function Zp(e,t){if(!e)return null;let r="";if(typeof e=="string"){const s=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);s&&(r=s[1].toLowerCase())}for(let s=Nl.length-1;s>=0;--s){const i=Nl[s];if(i.test&&i.test(e,r))return new i(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class rr{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,r,s,i,n,o,a,h){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:d}=this;this._aliasCount++;for(let l=0,c=d.length;l<c;l++)d[l][u](t,r,s,i,n,o,a,h);return d===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const r=this.items.indexOf(t);return r!==-1&&(this.ensureNonAliasedItems(),this.items.splice(r,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(rr.prototype,{dispatch:{value:rr.prototype.emit},run:{value:rr.prototype.emit}});class Fn{constructor(t=0,r=0){this._width=t,this._height=r,this.destroyed=!1,this.internal=!1,this.onResize=new rr("setRealSize"),this.onUpdate=new rr("update"),this.onError=new rr("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,r){(t!==this._width||r!==this._height)&&(this._width=t,this._height=r,this.onResize.emit(t,r))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,r,s){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,r){return!1}}class Bn extends Fn{constructor(t,r){const{width:s,height:i}=r||{};if(!s||!i)throw new Error("BufferResource width or height invalid");super(s,i),this.data=t}upload(t,r,s){const i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Je.UNPACK);const n=r.realWidth,o=r.realHeight;return s.width===n&&s.height===o?i.texSubImage2D(r.target,0,0,0,n,o,r.format,s.type,this.data):(s.width=n,s.height=o,i.texImage2D(r.target,0,s.internalFormat,n,o,0,r.format,s.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const Sv={scaleMode:Hr.NEAREST,format:k.RGBA,alphaMode:Je.NPM},Gi=class extends Rn{constructor(e=null,t=null){super(),t=Object.assign({},Gi.defaultOptions,t);const{alphaMode:r,mipmap:s,anisotropicLevel:i,scaleMode:n,width:o,height:a,wrapMode:h,format:u,type:d,target:l,resolution:c,resourceOptions:p}=t;e&&!(e instanceof Fn)&&(e=Zp(e,p),e.internal=!0),this.resolution=c||F.RESOLUTION,this.width=Math.round((o||0)*this.resolution)/this.resolution,this.height=Math.round((a||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=i,this._wrapMode=h,this._scaleMode=n,this.format=u,this.type=d,this.target=l,this.alphaMode=r,this.uid=$s(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=o>0&&a>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let r;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this}setSize(e,t,r){return r=r||this.resolution,this.setRealSize(e*r,t*r,r)}setRealSize(e,t,r){return this.resolution=r||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Xp(this.realWidth)&&Xp(this.realHeight)}setResolution(e){const t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ds[this.cacheId],delete Sr[this.cacheId],this.cacheId=null),this.dispose(),Gi.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,r=F.STRICT_TEXTURE_CACHE){const s=typeof e=="string";let i=null;if(s)i=e;else{if(!e._pixiId){const o=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId=`${o}_${$s()}`}i=e._pixiId}let n=ds[i];if(s&&r&&!n)throw new Error(`The cacheId "${i}" does not exist in BaseTextureCache.`);return n||(n=new Gi(e,t),n.cacheId=i,Gi.addToCache(n,i)),n}static fromBuffer(e,t,r,s){e=e||new Float32Array(t*r*4);const i=new Bn(e,{width:t,height:r}),n=e instanceof Float32Array?X.FLOAT:X.UNSIGNED_BYTE;return new Gi(i,Object.assign({},Sv,{type:n},s))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),ds[t]&&ds[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),ds[t]=e)}static removeFromCache(e){if(typeof e=="string"){const t=ds[e];if(t){const r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete ds[e],t}}else if(e!=null&&e.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete ds[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}};let $=Gi;$.defaultOptions={mipmap:xr.POW2,anisotropicLevel:0,scaleMode:Hr.LINEAR,wrapMode:zr.CLAMP,alphaMode:Je.UNPACK,target:Oi.TEXTURE_2D,format:k.RGBA,type:X.UNSIGNED_BYTE},$._globalBatch=0;class Ll{constructor(){this.texArray=null,this.blend=0,this.type=Qe.TRIANGLES,this.start=0,this.size=0,this.data=null}}let Cv=0;class Ct{constructor(t,r=!0,s=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=s,this.static=r,this.id=Cv++,this.disposeRunner=new rr("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Tr.ELEMENT_ARRAY_BUFFER:Tr.ARRAY_BUFFER}get index(){return this.type===Tr.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Ct(t)}}class Qo{constructor(t,r=0,s=!1,i=X.FLOAT,n,o,a,h=1){this.buffer=t,this.size=r,this.normalized=s,this.type=i,this.stride=n,this.start=o,this.instance=a,this.divisor=h}destroy(){this.buffer=null}static from(t,r,s,i,n){return new Qo(t,r,s,i,n)}}const Iv={Float32Array,Uint32Array,Int32Array,Uint8Array};function Rv(e,t){let r=0,s=0;const i={};for(let h=0;h<e.length;h++)s+=t[h],r+=e[h].length;const n=new ArrayBuffer(r*4);let o=null,a=0;for(let h=0;h<e.length;h++){const u=t[h],d=e[h],l=Vp(d);i[l]||(i[l]=new Iv[l](n)),o=i[l];for(let c=0;c<d.length;c++){const p=(c/u|0)*s+a,f=c%u;o[p+f]=d[c]}a+=u}return new Float32Array(n)}const Qp={5126:4,5123:2,5121:1};let Mv=0;const Pv={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class fs{constructor(t=[],r={}){this.buffers=t,this.indexBuffer=null,this.attributes=r,this.glVertexArrayObjects={},this.id=Mv++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new rr("disposeGeometry"),this.refCount=0}addAttribute(t,r,s=0,i=!1,n,o,a,h=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof Ct||(r instanceof Array&&(r=new Float32Array(r)),r=new Ct(r));const u=t.split("|");if(u.length>1){for(let l=0;l<u.length;l++)this.addAttribute(u[l],r,s,i,n);return this}let d=this.buffers.indexOf(r);return d===-1&&(this.buffers.push(r),d=this.buffers.length-1),this.attributes[t]=new Qo(d,s,i,n,o,a,h),this.instanced=this.instanced||h,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Ct||(t instanceof Array&&(t=new Uint16Array(t)),t=new Ct(t)),t.type=Tr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],r=[],s=new Ct;let i;for(i in this.attributes){const n=this.attributes[i],o=this.buffers[n.buffer];t.push(o.data),r.push(n.size*Qp[n.type]/4),n.buffer=0}for(s.data=Rv(t,r),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[s],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const r=this.attributes[t];return this.buffers[r.buffer].data.length/(r.stride/4||r.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new fs;for(let r=0;r<this.buffers.length;r++)t.buffers[r]=new Ct(this.buffers[r].data.slice(0));for(const r in this.attributes){const s=this.attributes[r];t.attributes[r]=new Qo(s.buffer,s.size,s.normalized,s.type,s.stride,s.start,s.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Tr.ELEMENT_ARRAY_BUFFER),t}static merge(t){const r=new fs,s=[],i=[],n=[];let o;for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)i[h]=i[h]||0,i[h]+=o.buffers[h].data.length,n[h]=0}for(let a=0;a<o.buffers.length;a++)s[a]=new Pv[Vp(o.buffers[a].data)](i[a]),r.buffers[a]=new Ct(s[a]);for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)s[h].set(o.buffers[h].data,n[h]),n[h]+=o.buffers[h].data.length}if(r.attributes=o.attributes,o.indexBuffer){r.indexBuffer=r.buffers[o.buffers.indexOf(o.indexBuffer)],r.indexBuffer.type=Tr.ELEMENT_ARRAY_BUFFER;let a=0,h=0,u=0,d=0;for(let l=0;l<o.buffers.length;l++)if(o.buffers[l]!==o.indexBuffer){d=l;break}for(const l in o.attributes){const c=o.attributes[l];(c.buffer|0)===d&&(h+=c.size*Qp[c.type]/4)}for(let l=0;l<t.length;l++){const c=t[l].indexBuffer.data;for(let p=0;p<c.length;p++)r.indexBuffer.data[p+u]+=a;a+=t[l].buffers[d].data.length/h,u+=c.length}}return r}}class Jp extends fs{constructor(t=!1){super(),this._buffer=new Ct(null,t,!1),this._indexBuffer=new Ct(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,X.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,X.FLOAT).addAttribute("aColor",this._buffer,4,!0,X.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,X.FLOAT).addIndex(this._indexBuffer)}}const Jo=Math.PI*2,Dv=180/Math.PI,Ov=Math.PI/180;var $t=(e=>(e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e))($t||{});class W{constructor(t=0,r=0){this.x=0,this.y=0,this.x=t,this.y=r}clone(){return new W(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,r=t){return this.x=t,this.y=r,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const ta=[new W,new W,new W,new W];class K{constructor(t=0,r=0,s=0,i=0){this.x=Number(t),this.y=Number(r),this.width=Number(s),this.height=Number(i),this.type=$t.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new K(0,0,0,0)}clone(){return new K(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,r){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&r>=this.y&&r<this.y+this.height}intersects(t,r){if(!r){const b=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=b)return!1;const A=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>A}const s=this.left,i=this.right,n=this.top,o=this.bottom;if(i<=s||o<=n)return!1;const a=ta[0].set(t.left,t.top),h=ta[1].set(t.left,t.bottom),u=ta[2].set(t.right,t.top),d=ta[3].set(t.right,t.bottom);if(u.x<=a.x||h.y<=a.y)return!1;const l=Math.sign(r.a*r.d-r.b*r.c);if(l===0||(r.apply(a,a),r.apply(h,h),r.apply(u,u),r.apply(d,d),Math.max(a.x,h.x,u.x,d.x)<=s||Math.min(a.x,h.x,u.x,d.x)>=i||Math.max(a.y,h.y,u.y,d.y)<=n||Math.min(a.y,h.y,u.y,d.y)>=o))return!1;const c=l*(h.y-a.y),p=l*(a.x-h.x),f=c*s+p*n,_=c*i+p*n,m=c*s+p*o,g=c*i+p*o;if(Math.max(f,_,m,g)<=c*a.x+p*a.y||Math.min(f,_,m,g)>=c*d.x+p*d.y)return!1;const v=l*(a.y-u.y),y=l*(u.x-a.x),x=v*s+y*n,E=v*i+y*n,T=v*s+y*o,w=v*i+y*o;return!(Math.max(x,E,T,w)<=v*a.x+y*a.y||Math.min(x,E,T,w)>=v*d.x+y*d.y)}pad(t=0,r=t){return this.x-=t,this.y-=r,this.width+=t*2,this.height+=r*2,this}fit(t){const r=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=r,this.width=Math.max(s-r,0),this.y=i,this.height=Math.max(n-i,0),this}ceil(t=1,r=.001){const s=Math.ceil((this.x+this.width-r)*t)/t,i=Math.ceil((this.y+this.height-r)*t)/t;return this.x=Math.floor((this.x+r)*t)/t,this.y=Math.floor((this.y+r)*t)/t,this.width=s-this.x,this.height=i-this.y,this}enlarge(t){const r=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=r,this.width=s-r,this.y=i,this.height=n-i,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class ea{constructor(t=0,r=0,s=0){this.x=t,this.y=r,this.radius=s,this.type=$t.CIRC}clone(){return new ea(this.x,this.y,this.radius)}contains(t,r){if(this.radius<=0)return!1;const s=this.radius*this.radius;let i=this.x-t,n=this.y-r;return i*=i,n*=n,i+n<=s}getBounds(){return new K(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class ra{constructor(t=0,r=0,s=0,i=0){this.x=t,this.y=r,this.width=s,this.height=i,this.type=$t.ELIP}clone(){return new ra(this.x,this.y,this.width,this.height)}contains(t,r){if(this.width<=0||this.height<=0)return!1;let s=(t-this.x)/this.width,i=(r-this.y)/this.height;return s*=s,i*=i,s+i<=1}getBounds(){return new K(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Wr{constructor(...t){let r=Array.isArray(t[0])?t[0]:t;if(typeof r[0]!="number"){const s=[];for(let i=0,n=r.length;i<n;i++)s.push(r[i].x,r[i].y);r=s}this.points=r,this.type=$t.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),r=new Wr(t);return r.closeStroke=this.closeStroke,r}contains(t,r){let s=!1;const i=this.points.length/2;for(let n=0,o=i-1;n<i;o=n++){const a=this.points[n*2],h=this.points[n*2+1],u=this.points[o*2],d=this.points[o*2+1];h>r!=d>r&&t<(u-a)*((r-h)/(d-h))+a&&(s=!s)}return s}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,r)=>`${t}, ${r}`,"")}]`}}class sa{constructor(t=0,r=0,s=0,i=0,n=20){this.x=t,this.y=r,this.width=s,this.height=i,this.radius=n,this.type=$t.RREC}clone(){return new sa(this.x,this.y,this.width,this.height,this.radius)}contains(t,r){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&r>=this.y&&r<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(r>=this.y+s&&r<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let i=t-(this.x+s),n=r-(this.y+s);const o=s*s;if(i*i+n*n<=o||(i=t-(this.x+this.width-s),i*i+n*n<=o)||(n=r-(this.y+this.height-s),i*i+n*n<=o)||(i=t-(this.x+s),i*i+n*n<=o))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class ut{constructor(t=1,r=0,s=0,i=1,n=0,o=0){this.array=null,this.a=t,this.b=r,this.c=s,this.d=i,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,r,s,i,n,o){return this.a=t,this.b=r,this.c=s,this.d=i,this.tx=n,this.ty=o,this}toArray(t,r){this.array||(this.array=new Float32Array(9));const s=r||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(t,r){r=r||new W;const s=t.x,i=t.y;return r.x=this.a*s+this.c*i+this.tx,r.y=this.b*s+this.d*i+this.ty,r}applyInverse(t,r){r=r||new W;const s=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return r.x=this.d*s*i+-this.c*s*n+(this.ty*this.c-this.tx*this.d)*s,r.y=this.a*s*n+-this.b*s*i+(-this.ty*this.a+this.tx*this.b)*s,r}translate(t,r){return this.tx+=t,this.ty+=r,this}scale(t,r){return this.a*=t,this.d*=r,this.c*=t,this.b*=r,this.tx*=t,this.ty*=r,this}rotate(t){const r=Math.cos(t),s=Math.sin(t),i=this.a,n=this.c,o=this.tx;return this.a=i*r-this.b*s,this.b=i*s+this.b*r,this.c=n*r-this.d*s,this.d=n*s+this.d*r,this.tx=o*r-this.ty*s,this.ty=o*s+this.ty*r,this}append(t){const r=this.a,s=this.b,i=this.c,n=this.d;return this.a=t.a*r+t.b*i,this.b=t.a*s+t.b*n,this.c=t.c*r+t.d*i,this.d=t.c*s+t.d*n,this.tx=t.tx*r+t.ty*i+this.tx,this.ty=t.tx*s+t.ty*n+this.ty,this}setTransform(t,r,s,i,n,o,a,h,u){return this.a=Math.cos(a+u)*n,this.b=Math.sin(a+u)*n,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(s*this.a+i*this.c),this.ty=r-(s*this.b+i*this.d),this}prepend(t){const r=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const s=this.a,i=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=r*t.a+this.ty*t.c+t.tx,this.ty=r*t.b+this.ty*t.d+t.ty,this}decompose(t){const r=this.a,s=this.b,i=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-i,n),h=Math.atan2(s,r),u=Math.abs(a+h);return u<1e-5||Math.abs(Jo-u)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(r*r+s*s),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx+(o.x*r+o.y*i),t.position.y=this.ty+(o.x*s+o.y*n),t}invert(){const t=this.a,r=this.b,s=this.c,i=this.d,n=this.tx,o=t*i-r*s;return this.a=i/o,this.b=-r/o,this.c=-s/o,this.d=t/o,this.tx=(s*this.ty-i*n)/o,this.ty=-(t*this.ty-r*n)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new ut;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new ut}static get TEMP_MATRIX(){return new ut}}const Ks=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Zs=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Qs=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Js=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Fl=[],tf=[],ia=Math.sign;function kv(){for(let e=0;e<16;e++){const t=[];Fl.push(t);for(let r=0;r<16;r++){const s=ia(Ks[e]*Ks[r]+Qs[e]*Zs[r]),i=ia(Zs[e]*Ks[r]+Js[e]*Zs[r]),n=ia(Ks[e]*Qs[r]+Qs[e]*Js[r]),o=ia(Zs[e]*Qs[r]+Js[e]*Js[r]);for(let a=0;a<16;a++)if(Ks[a]===s&&Zs[a]===i&&Qs[a]===n&&Js[a]===o){t.push(a);break}}}for(let e=0;e<16;e++){const t=new ut;t.set(Ks[e],Zs[e],Qs[e],Js[e],0,0),tf.push(t)}}kv();const _t={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>Ks[e],uY:e=>Zs[e],vX:e=>Qs[e],vY:e=>Js[e],inv:e=>e&8?e&15:-e&7,add:(e,t)=>Fl[e][t],sub:(e,t)=>Fl[e][_t.inv(t)],rotate180:e=>e^4,isVertical:e=>(e&3)===2,byDirection:(e,t)=>Math.abs(e)*2<=Math.abs(t)?t>=0?_t.S:_t.N:Math.abs(t)*2<=Math.abs(e)?e>0?_t.E:_t.W:t>0?e>0?_t.SE:_t.SW:e>0?_t.NE:_t.NW,matrixAppendRotationInv:(e,t,r=0,s=0)=>{const i=tf[_t.inv(t)];i.tx=r,i.ty=s,e.append(i)}};class _s{constructor(t,r,s=0,i=0){this._x=s,this._y=i,this.cb=t,this.scope=r}clone(t=this.cb,r=this.scope){return new _s(t,r,this._x,this._y)}set(t=0,r=t){return(this._x!==t||this._y!==r)&&(this._x=t,this._y=r,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const ef=class{constructor(){this.worldTransform=new ut,this.localTransform=new ut,this.position=new _s(this.onChange,this,0,0),this.scale=new _s(this.onChange,this,1,1),this.pivot=new _s(this.onChange,this,0,0),this.skew=new _s(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){const r=e.worldTransform,s=this.worldTransform;s.a=t.a*r.a+t.b*r.c,s.b=t.a*r.b+t.b*r.d,s.c=t.c*r.a+t.d*r.c,s.d=t.c*r.b+t.d*r.d,s.tx=t.tx*r.a+t.ty*r.c+r.tx,s.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}};let Hi=ef;Hi.IDENTITY=new ef;var Nv=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,Lv=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function rf(e,t,r){const s=e.createShader(t);return e.shaderSource(s,r),e.compileShader(s),s}function Bl(e){const t=new Array(e);for(let r=0;r<t.length;r++)t[r]=!1;return t}function sf(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Bl(2*t);case"bvec3":return Bl(3*t);case"bvec4":return Bl(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const zi=[{test:e=>e.type==="float"&&e.size===1&&!e.isArray,code:e=>`
            if(uv["${e}"] !== ud["${e}"].value)
            {
                ud["${e}"].value = uv["${e}"]
                gl.uniform1f(ud["${e}"].location, uv["${e}"])
            }
            `},{test:(e,t)=>(e.type==="sampler2D"||e.type==="samplerCube"||e.type==="sampler2DArray")&&e.size===1&&!e.isArray&&(t==null||t.castToBaseTexture!==void 0),code:e=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${e}"], t);

            if(ud["${e}"].value !== t)
            {
                ud["${e}"].value = t;
                gl.uniform1i(ud["${e}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(e,t)=>e.type==="mat3"&&e.size===1&&!e.isArray&&t.a!==void 0,code:e=>`
            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));
            `,codeUbo:e=>`
                var ${e}_matrix = uv.${e}.toArray(true);

                data[offset] = ${e}_matrix[0];
                data[offset+1] = ${e}_matrix[1];
                data[offset+2] = ${e}_matrix[2];
        
                data[offset + 4] = ${e}_matrix[3];
                data[offset + 5] = ${e}_matrix[4];
                data[offset + 6] = ${e}_matrix[5];
        
                data[offset + 8] = ${e}_matrix[6];
                data[offset + 9] = ${e}_matrix[7];
                data[offset + 10] = ${e}_matrix[8];
            `},{test:(e,t)=>e.type==="vec2"&&e.size===1&&!e.isArray&&t.x!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${e}"].location, v.x, v.y);
                }`,codeUbo:e=>`
                v = uv.${e};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:e=>e.type==="vec2"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);
                }
            `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.width!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${e}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(e,t)=>e.type==="vec3"&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${e}"].location, v.red, v.green, v.blue)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:e=>e.type==="vec4"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])
                }`}],Fv={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},Bv={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Uv(e,t){var s;const r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in e.uniforms){const n=t[i];if(!n){(s=e.uniforms[i])!=null&&s.group&&(e.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const o=e.uniforms[i];let a=!1;for(let h=0;h<zi.length;h++)if(zi[h].test(n,o)){r.push(zi[h].code(i,o)),a=!0;break}if(!a){const h=(n.size===1&&!n.isArray?Fv:Bv)[n.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${h};`)}}return new Function("ud","uv","renderer","syncData",r.join(`
`))}const nf={};let Vi=nf;function Gv(){if(Vi===nf||Vi!=null&&Vi.isContextLost()){const e=F.ADAPTER.createCanvas();let t;F.PREFER_ENV>=js.WEBGL2&&(t=e.getContext("webgl2",{})),t||(t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Vi=t}return Vi}let na;function Hv(){if(!na){na=ze.MEDIUM;const e=Gv();e&&e.getShaderPrecisionFormat&&(na=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision?ze.HIGH:ze.MEDIUM)}return na}function of(e,t){const r=e.getShaderSource(t).split(`
`).map((u,d)=>`${d}: ${u}`),s=e.getShaderInfoLog(t),i=s.split(`
`),n={},o=i.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!n[u]?(n[u]=!0,!0):!1),a=[""];o.forEach(u=>{r[u-1]=`%c${r[u-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const h=r.join(`
`);a[0]=h,console.error(s),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function zv(e,t,r,s){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(r,e.COMPILE_STATUS)||of(e,r),e.getShaderParameter(s,e.COMPILE_STATUS)||of(e,s),console.error("PixiJS Error: Could not initialize shader."),e.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}const Vv={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function af(e){return Vv[e]}let oa=null;const hf={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function lf(e,t){if(!oa){const r=Object.keys(hf);oa={};for(let s=0;s<r.length;++s){const i=r[s];oa[e[i]]=hf[i]}}return oa[t]}function uf(e,t,r){if(e.substring(0,9)!=="precision"){let s=t;return t===ze.HIGH&&r!==ze.HIGH&&(s=ze.MEDIUM),`precision ${s} float;
${e}`}else if(r!==ze.HIGH&&e.substring(0,15)==="precision highp")return e.replace("precision highp","precision mediump");return e}let Un;function Xv(){if(typeof Un=="boolean")return Un;try{Un=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Un=!1}return Un}let Wv=0;const aa={},Xi=class{constructor(e,t,r="pixi-shader",s={}){this.extra={},this.id=Wv++,this.vertexSrc=e||Xi.defaultVertexSrc,this.fragmentSrc=t||Xi.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(r=r.replace(/\s+/g,"-"),aa[r]?(aa[r]++,r+=`-${aa[r]}`):aa[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}
${this.fragmentSrc}`,this.vertexSrc=uf(this.vertexSrc,Xi.defaultVertexPrecision,ze.HIGH),this.fragmentSrc=uf(this.fragmentSrc,Xi.defaultFragmentPrecision,Hv())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return Lv}static get defaultFragmentSrc(){return Nv}static from(e,t,r){const s=e+t;let i=Yp[s];return i||(Yp[s]=i=new Xi(e,t,r)),i}};let sr=Xi;sr.defaultVertexPrecision=ze.HIGH,sr.defaultFragmentPrecision=Er.apple.device?ze.HIGH:ze.MEDIUM;let jv=0;class ir{constructor(t,r,s){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=jv++,this.static=!!r,this.ubo=!!s,t instanceof Ct?(this.buffer=t,this.buffer.type=Tr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Ct(new Float32Array(1)),this.buffer.type=Tr.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,r,s){if(!this.ubo)this.uniforms[t]=new ir(r,s);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,r,s){return new ir(t,r,s)}static uboFrom(t,r){return new ir(t,r??!0,!0)}}class Cr{constructor(t,r){this.uniformBindCount=0,this.program=t,r?r instanceof ir?this.uniformGroup=r:this.uniformGroup=new ir(r):this.uniformGroup=new ir({}),this.disposeRunner=new rr("disposeShader")}checkUniformExists(t,r){if(r.uniforms[t])return!0;for(const s in r.uniforms){const i=r.uniforms[s];if(i.group&&this.checkUniformExists(t,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,r,s){const i=sr.from(t,r);return new Cr(i,s)}}class Yv{constructor(t,r){if(this.vertexSrc=t,this.fragTemplate=r,this.programCache={},this.defaultGroupCache={},!r.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!r.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const s=new Int32Array(t);for(let n=0;n<t;n++)s[n]=n;this.defaultGroupCache[t]=ir.from({uSamplers:s},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${t}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new sr(this.vertexSrc,i)}const r={tint:new Float32Array([1,1,1,1]),translationMatrix:new ut,default:this.defaultGroupCache[t]};return new Cr(this.programCache[t],r)}generateSampleSrc(t){let r="";r+=`
`,r+=`
`;for(let s=0;s<t;s++)s>0&&(r+=`
else `),s<t-1&&(r+=`if(vTextureId < ${s}.5)`),r+=`
{`,r+=`
	color = texture2D(uSamplers[${s}], vTextureCoord);`,r+=`
}`;return r+=`
`,r+=`
`,r}}class Ul{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function $v(){return!Er.apple.device}function qv(e){let t=!0;const r=F.ADAPTER.getNavigator();if(Er.tablet||Er.phone){if(Er.apple.device){const s=r.userAgent.match(/OS (\d+)_(\d+)?/);s&&parseInt(s[1],10)<11&&(t=!1)}if(Er.android.device){const s=r.userAgent.match(/Android\s([0-9.]*)/);s&&parseInt(s[1],10)<7&&(t=!1)}}return t?e:4}class ha{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var Kv=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Zv=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const nr=class extends ha{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=Jp,this.vertexSize=6,this.state=qs.for2d(),this.size=nr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??qv(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??$v(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return J("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return Zv}static get defaultFragmentTemplate(){return Kv}setShaderGenerator({vertex:e=nr.defaultVertexSrc,fragment:t=nr.defaultFragmentTemplate}={}){this.shaderGenerator=new Yv(e,t)}contextChange(){const e=this.renderer.gl;F.PREFER_ENV===js.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),nr.defaultMaxTextures),this.maxTextures=Av(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:t}=nr,r=this.size/4,s=Math.floor(r/this.maxTextures)+1;for(;e.length<r;)e.push(new Ll);for(;t.length<s;)t.push(new Ul);for(let i=0;i<this.maxTextures;i++)this._tempBoundTextures[i]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:t}=this,r=nr._textureArrayPool,s=this.renderer.batch,i=this._tempBoundTextures,n=this.renderer.textureGC.count;let o=++$._globalBatch,a=0,h=r[0],u=0;s.copyBoundTextures(i,t);for(let d=0;d<this._bufferSize;++d){const l=e[d];e[d]=null,l._batchEnabled!==o&&(h.count>=t&&(s.boundArray(h,i,o,t),this.buildDrawCalls(h,u,d),u=d,h=r[++a],++o),l._batchEnabled=o,l.touched=n,h.elements[h.count++]=l)}h.count>0&&(s.boundArray(h,i,o,t),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(let d=0;d<i.length;d++)i[d]=null;$._globalBatch=o}buildDrawCalls(e,t,r){const{_bufferedElements:s,_attributeBuffer:i,_indexBuffer:n,vertexSize:o}=this,a=nr._drawCallPool;let h=this._dcIndex,u=this._aIndex,d=this._iIndex,l=a[h];l.start=this._iIndex,l.texArray=e;for(let c=t;c<r;++c){const p=s[c],f=p._texture.baseTexture,_=Hp[f.alphaMode?1:0][p.blendMode];s[c]=null,t<c&&l.blend!==_&&(l.size=d-l.start,t=c,l=a[++h],l.texArray=e,l.start=d),this.packInterleavedGeometry(p,i,n,u,d),u+=p.vertexData.length/2*o,d+=p.indices.length,l.blend=_}t<r&&(l.size=d-l.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=d}bindAndClearTexArray(e){const t=this.renderer.texture;for(let r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:r}=this;nr.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:t,state:r}=this.renderer,s=nr._drawCallPool;let i=null;for(let n=0;n<e;n++){const{texArray:o,type:a,size:h,start:u,blend:d}=s[n];i!==o&&(i=o,this.bindAndClearTexArray(o)),this.state.blendMode=d,r.set(this.state),t.drawElements(a,h,t.UNSIGNED_SHORT,u*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),nr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const t=Ko(Math.ceil(e/8)),r=Wp(t),s=t*8;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let i=this._aBuffers[s];return i||(this._aBuffers[s]=i=new Il(s*this.vertexSize*4)),i}getIndexBuffer(e){const t=Ko(Math.ceil(e/12)),r=Wp(t),s=t*12;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let i=this._iBuffers[r];return i||(this._iBuffers[r]=i=new Uint16Array(s)),i}packInterleavedGeometry(e,t,r,s,i){const{uint32View:n,float32View:o}=t,a=s/this.vertexSize,h=e.uvs,u=e.indices,d=e.vertexData,l=e._texture.baseTexture._batchLocation,c=Math.min(e.worldAlpha,1),p=st.shared.setValue(e._tintRGB).toPremultiplied(c,e._texture.baseTexture.alphaMode>0);for(let f=0;f<d.length;f+=2)o[s++]=d[f],o[s++]=d[f+1],o[s++]=h[f],o[s++]=h[f+1],n[s++]=p,o[s++]=l;for(let f=0;f<u.length;f++)r[i++]=a+u[f]}};let or=nr;or.defaultBatchSize=4096,or.extension={name:"batch",type:B.RendererPlugin},or._drawCallPool=[],or._textureArrayPool=[],z.add(or);var Qv=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,Jv=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Gn=class extends Cr{constructor(e,t,r){const s=sr.from(e||Gn.defaultVertexSrc,t||Gn.defaultFragmentSrc);super(s,r),this.padding=0,this.resolution=Gn.defaultResolution,this.multisample=Gn.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new qs}apply(e,t,r,s,i){e.applyFilter(this,t,r,s)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return Jv}static get defaultFragmentSrc(){return Qv}};let Gt=Gn;Gt.defaultResolution=1,Gt.defaultMultisample=Pt.NONE;class la{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new st(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:r,background:s,backgroundAlpha:i}=t,n=s??r;n!==void 0&&(this.color=n),this.alpha=i}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}la.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},la.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"background"},z.add(la);class cf{constructor(t){this.renderer=t,this.emptyRenderer=new ha(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,r){const{boundTextures:s}=this.renderer.texture;for(let i=r-1;i>=0;--i)t[i]=s[i]||null,t[i]&&(t[i]._batchLocation=i)}boundArray(t,r,s,i){const{elements:n,ids:o,count:a}=t;let h=0;for(let u=0;u<a;u++){const d=n[u],l=d._batchLocation;if(l>=0&&l<i&&r[l]===d){o[u]=l;continue}for(;h<i;){const c=r[h];if(c&&c._batchEnabled===s&&c._batchLocation===h){h++;continue}o[u]=h,d._batchLocation=h,r[h]=d;break}}}destroy(){this.renderer=null}}cf.extension={type:B.RendererSystem,name:"batch"},z.add(cf);let df=0;class ua{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=df++}init(t){if(t.context)this.initFromContext(t.context);else{const r=this.renderer.background.alpha<1,s=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:r,premultipliedAlpha:s,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=df++,this.renderer.runners.contextChange.emit(t);const r=this.renderer.view;r.addEventListener!==void 0&&(r.addEventListener("webglcontextlost",this.handleContextLost,!1),r.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const r=this.createContext(this.renderer.view,t);this.initFromContext(r)}createContext(t,r){let s;if(F.PREFER_ENV>=js.WEBGL2&&(s=t.getContext("webgl2",r)),s)this.webGLVersion=2;else if(this.webGLVersion=1,s=t.getContext("webgl",r)||t.getContext("experimental-webgl",r),!s)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=s,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,r={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,r,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,r,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const r=t.getContextAttributes(),s="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;s&&(this.webGLVersion=2),r&&!r.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=s||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}ua.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},ua.extension={type:B.RendererSystem,name:"context"},z.add(ua);class tx extends Bn{upload(t,r,s){const i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Je.UNPACK);const n=r.realWidth,o=r.realHeight;return s.width===n&&s.height===o?i.texSubImage2D(r.target,0,0,0,n,o,r.format,s.type,this.data):(s.width=n,s.height=o,i.texImage2D(r.target,0,s.internalFormat,n,o,0,r.format,s.type,this.data)),!0}}class Gl{constructor(t,r){this.width=Math.round(t||100),this.height=Math.round(r||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new rr("disposeFramebuffer"),this.multisample=Pt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,r){return this.colorTextures[t]=r||new $(null,{scaleMode:Hr.NEAREST,resolution:1,mipmap:xr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new $(new tx(null,{width:this.width,height:this.height}),{scaleMode:Hr.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:xr.OFF,format:k.DEPTH_COMPONENT,type:X.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,r){if(t=Math.round(t),r=Math.round(r),!(t===this.width&&r===this.height)){this.width=t,this.height=r,this.dirtyId++,this.dirtySize++;for(let s=0;s<this.colorTextures.length;s++){const i=this.colorTextures[s],n=i.resolution;i.setSize(t/n,r/n)}if(this.depthTexture){const s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,r/s)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class pf extends ${constructor(t={}){if(typeof t=="number"){const r=arguments[0],s=arguments[1],i=arguments[2],n=arguments[3];t={width:r,height:s,scaleMode:i,resolution:n}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=Pt.NONE),super(null,t),this.mipmap=xr.OFF,this.valid=!0,this._clear=new st([0,0,0,0]),this.framebuffer=new Gl(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(t,r){this.framebuffer.resize(t*this.resolution,r*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class ms extends Fn{constructor(t){const r=t,s=r.naturalWidth||r.videoWidth||r.width,i=r.naturalHeight||r.videoHeight||r.height;super(s,i),this.source=t,this.noSubImage=!1}static crossOrigin(t,r,s){s===void 0&&!r.startsWith("data:")?t.crossOrigin=Tv(r):s!==!1&&(t.crossOrigin=typeof s=="string"?s:"anonymous")}upload(t,r,s,i){const n=t.gl,o=r.realWidth,a=r.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||i.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1&&i.buffered.length===0)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===Je.UNPACK),!this.noSubImage&&r.target===n.TEXTURE_2D&&s.width===o&&s.height===a?n.texSubImage2D(n.TEXTURE_2D,0,0,0,r.format,s.type,i):(s.width=o,s.height=a,n.texImage2D(r.target,0,s.internalFormat,r.format,s.type,i)),!0}update(){if(this.destroyed)return;const t=this.source,r=t.naturalWidth||t.videoWidth||t.width,s=t.naturalHeight||t.videoHeight||t.height;this.resize(r,s),super.update()}dispose(){this.source=null}}class ff extends ms{constructor(t,r){if(r=r||{},typeof t=="string"){const s=new Image;ms.crossOrigin(s,t,r.crossorigin),s.src=t,t=s}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(r.createBitmap??F.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this.bitmap=null,this._load=null,r.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((r,s)=>{const i=this.source;this.url=i.src;const n=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.resize(i.width,i.height),this._load=null,this.createBitmap?r(this.process()):r(this))};i.complete&&i.src?n():(i.onload=n,i.onerror=o=>{s(o),this.onError.emit(o)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const r=globalThis.createImageBitmap,s=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:s?"cors":"no-cors"}).then(i=>i.blob()).then(i=>r(i,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Je.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,r,s){if(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,r,s);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,r,s,this.bitmap),!this.preserveBitmap){let i=!0;const n=r._glTextures;for(const o in n){const a=n[o];if(a!==s&&a.dirtyId!==r.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class _f{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,r,s){const i=r.width,n=r.height;if(s){const o=t.width/2/i,a=t.height/2/n,h=t.x/i+o,u=t.y/n+a;s=_t.add(s,_t.NW),this.x0=h+o*_t.uX(s),this.y0=u+a*_t.uY(s),s=_t.add(s,2),this.x1=h+o*_t.uX(s),this.y1=u+a*_t.uY(s),s=_t.add(s,2),this.x2=h+o*_t.uX(s),this.y2=u+a*_t.uY(s),s=_t.add(s,2),this.x3=h+o*_t.uX(s),this.y3=u+a*_t.uY(s)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const mf=new _f;function ca(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}class U extends Rn{constructor(t,r,s,i,n,o,a){if(super(),this.noFrame=!1,r||(this.noFrame=!0,r=new K(0,0,1,1)),t instanceof U&&(t=t.baseTexture),this.baseTexture=t,this._frame=r,this.trim=i,this.valid=!1,this._uvs=mf,this.uvMatrix=null,this.orig=s||r,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new W(o.x,o.y):new W(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=r:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:r}=this.baseTexture;r!=null&&r.url&&Sr[r.url]&&U.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,U.removeFromCache(this),this.textureCacheIds=null}clone(){var i;const t=this._frame.clone(),r=this._frame===this.orig?t:this.orig.clone(),s=new U(this.baseTexture,!this.noFrame&&t,r,(i=this.trim)==null?void 0:i.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(s._frame=t),s}updateUvs(){this._uvs===mf&&(this._uvs=new _f),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,r={},s=F.STRICT_TEXTURE_CACHE){const i=typeof t=="string";let n=null;if(i)n=t;else if(t instanceof $){if(!t.cacheId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";t.cacheId=`${a}-${$s()}`,$.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){const a=(r==null?void 0:r.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${$s()}`}n=t._pixiId}let o=Sr[n];if(i&&s&&!o)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!o&&!(t instanceof $)?(r.resolution||(r.resolution=ps(t)),o=new U(new $(t,r)),o.baseTexture.cacheId=n,$.addToCache(o.baseTexture,n),U.addToCache(o,n)):!o&&t instanceof $&&(o=new U(t),U.addToCache(o,n)),o}static fromURL(t,r){const s=Object.assign({autoLoad:!1},r==null?void 0:r.resourceOptions),i=U.from(t,Object.assign({resourceOptions:s},r),!1),n=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):n.load().then(()=>Promise.resolve(i))}static fromBuffer(t,r,s,i){return new U($.fromBuffer(t,r,s,i))}static fromLoader(t,r,s,i){const n=new $(t,Object.assign({scaleMode:$.defaultOptions.scaleMode,resolution:ps(r)},i)),{resource:o}=n;o instanceof ff&&(o.url=r);const a=new U(n);return s||(s=r),$.addToCache(a.baseTexture,s),U.addToCache(a,s),s!==r&&($.addToCache(a.baseTexture,r),U.addToCache(a,r)),a.baseTexture.valid?Promise.resolve(a):new Promise(h=>{a.baseTexture.once("loaded",()=>h(a))})}static addToCache(t,r){r&&(t.textureCacheIds.includes(r)||t.textureCacheIds.push(r),Sr[r]&&Sr[r]!==t&&console.warn(`Texture added to the cache with an id [${r}] that already had an entry`),Sr[r]=t)}static removeFromCache(t){if(typeof t=="string"){const r=Sr[t];if(r){const s=r.textureCacheIds.indexOf(t);return s>-1&&r.textureCacheIds.splice(s,1),delete Sr[t],r}}else if(t!=null&&t.textureCacheIds){for(let r=0;r<t.textureCacheIds.length;++r)Sr[t.textureCacheIds[r]]===t&&delete Sr[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:r,y:s,width:i,height:n}=t,o=r+i>this.baseTexture.width,a=s+n>this.baseTexture.height;if(o||a){const h=o&&a?"and":"or",u=`X: ${r} + ${i} = ${r+i} > ${this.baseTexture.width}`,d=`Y: ${s} + ${n} = ${s+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${u} ${h} ${d}`)}this.valid=i&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return U._EMPTY||(U._EMPTY=new U(new $),ca(U._EMPTY),ca(U._EMPTY.baseTexture)),U._EMPTY}static get WHITE(){if(!U._WHITE){const t=F.ADAPTER.createCanvas(16,16),r=t.getContext("2d");t.width=16,t.height=16,r.fillStyle="white",r.fillRect(0,0,16,16),U._WHITE=new U($.from(t)),ca(U._WHITE),ca(U._WHITE.baseTexture)}return U._WHITE}}class ti extends U{constructor(t,r){super(t,r),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,r,s=!0){const i=this.baseTexture.resolution,n=Math.round(t*i)/i,o=Math.round(r*i)/i;this.valid=n>0&&o>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=o,s&&this.baseTexture.resize(n,o),this.updateUvs()}setResolution(t){const{baseTexture:r}=this;r.resolution!==t&&(r.setResolution(t),this.resize(r.width,r.height,!1))}static create(t){return new ti(new pf(t))}}class gf{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,r,s=Pt.NONE){const i=new pf(Object.assign({width:t,height:r,resolution:1,multisample:s},this.textureOptions));return new ti(i)}getOptimalTexture(t,r,s=1,i=Pt.NONE){let n;t=Math.ceil(t*s-1e-6),r=Math.ceil(r*s-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||r!==this._pixelsHeight?(t=Ko(t),r=Ko(r),n=((t&65535)<<16|r&65535)>>>0,i>1&&(n+=i*4294967296)):n=i>1?-i:-1,this.texturePool[n]||(this.texturePool[n]=[]);let o=this.texturePool[n].pop();return o||(o=this.createTexture(t,r,i)),o.filterPoolKey=n,o.setResolution(s),o}getFilterTexture(t,r,s){const i=this.getOptimalTexture(t.width,t.height,r||t.resolution,s||Pt.NONE);return i.filterFrame=t.filterFrame,i}returnTexture(t){const r=t.filterPoolKey;t.filterFrame=null,this.texturePool[r].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const r in this.texturePool){const s=this.texturePool[r];if(s)for(let i=0;i<s.length;i++)s[i].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const r in this.texturePool){if(!(Number(r)<0))continue;const s=this.texturePool[r];if(s)for(let i=0;i<s.length;i++)s[i].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}gf.SCREEN_KEY=-1;class ex extends fs{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class yf extends fs{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Ct(this.vertices),this.uvBuffer=new Ct(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,r){let s=0,i=0;return this.uvs[0]=s,this.uvs[1]=i,this.uvs[2]=s+r.width/t.width,this.uvs[3]=i,this.uvs[4]=s+r.width/t.width,this.uvs[5]=i+r.height/t.height,this.uvs[6]=s,this.uvs[7]=i+r.height/t.height,s=r.x,i=r.y,this.vertices[0]=s,this.vertices[1]=i,this.vertices[2]=s+r.width,this.vertices[3]=i,this.vertices[4]=s+r.width,this.vertices[5]=i+r.height,this.vertices[6]=s,this.vertices[7]=i+r.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class rx{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Pt.NONE,this.sourceFrame=new K,this.destinationFrame=new K,this.bindingSourceFrame=new K,this.bindingDestinationFrame=new K,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const da=[new W,new W,new W,new W],Hl=new ut;class vf{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new gf,this.statePool=[],this.quad=new ex,this.quadUv=new yf,this.tempRect=new K,this.activeState={},this.globalUniforms=new ir({outputFrame:new K,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,r){const s=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new rx,o=this.renderer.renderTexture;let a=r[0].resolution,h=r[0].multisample,u=r[0].padding,d=r[0].autoFit,l=r[0].legacy??!0;for(let f=1;f<r.length;f++){const _=r[f];a=Math.min(a,_.resolution),h=Math.min(h,_.multisample),u=this.useMaxPadding?Math.max(u,_.padding):u+_.padding,d=d&&_.autoFit,l=l||(_.legacy??!0)}i.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),i.push(n),n.resolution=a,n.multisample=h,n.legacy=l,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(u);const c=this.tempRect.copyFrom(o.sourceFrame);s.projection.transform&&this.transformAABB(Hl.copyFrom(s.projection.transform).invert(),c),d?(n.sourceFrame.fit(c),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(c)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,o.current?o.current.resolution:s.resolution,o.sourceFrame,o.destinationFrame,s.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,a,h),n.filters=r,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const p=this.tempRect;p.x=0,p.y=0,p.width=n.sourceFrame.width,p.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(o.sourceFrame),n.bindingDestinationFrame.copyFrom(o.destinationFrame),n.transform=s.projection.transform,s.projection.transform=null,o.bind(n.renderTexture,n.sourceFrame,p),s.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,r=t.pop(),s=r.filters;this.activeState=r;const i=this.globalUniforms.uniforms;i.outputFrame=r.sourceFrame,i.resolution=r.resolution;const n=i.inputSize,o=i.inputPixel,a=i.inputClamp;if(n[0]=r.destinationFrame.width,n[1]=r.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=Math.round(n[0]*r.resolution),o[1]=Math.round(n[1]*r.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=r.sourceFrame.width*n[2]-.5*o[2],a[3]=r.sourceFrame.height*n[3]-.5*o[3],r.legacy){const u=i.filterArea;u[0]=r.destinationFrame.width,u[1]=r.destinationFrame.height,u[2]=r.sourceFrame.x,u[3]=r.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const h=t[t.length-1];if(this.renderer.framebuffer.blit(),s.length===1)s[0].apply(this,r.renderTexture,h.renderTexture,br.BLEND,r),this.returnFilterTexture(r.renderTexture);else{let u=r.renderTexture,d=this.getOptimalFilterTexture(u.width,u.height,r.resolution);d.filterFrame=u.filterFrame;let l=0;for(l=0;l<s.length-1;++l){l===1&&r.multisample>1&&(d=this.getOptimalFilterTexture(u.width,u.height,r.resolution),d.filterFrame=u.filterFrame),s[l].apply(this,u,d,br.CLEAR,r);const c=u;u=d,d=c}s[l].apply(this,u,h.renderTexture,br.BLEND,r),l>1&&r.multisample>1&&this.returnFilterTexture(r.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(d)}r.clear(),this.statePool.push(r)}bindAndClear(t,r=br.CLEAR){const{renderTexture:s,state:i}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t==null?void 0:t.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,s.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?s.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=i.stateId&1||this.forceClear;(r===br.CLEAR||r===br.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,r,s,i){const n=this.renderer;n.state.set(t.state),this.bindAndClear(s,i),t.uniforms.uSampler=r,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(r._frame,r.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Qe.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(Qe.TRIANGLE_STRIP))}calculateSpriteMatrix(t,r){const{sourceFrame:s,destinationFrame:i}=this.activeState,{orig:n}=r._texture,o=t.set(i.width,0,0,i.height,s.x,s.y),a=r.worldTransform.copyTo(ut.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/n.width,1/n.height),o.translate(r.anchor.x,r.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,r,s=1,i=Pt.NONE){return this.texturePool.getOptimalTexture(t,r,s,i)}getFilterTexture(t,r,s){if(typeof t=="number"){const n=t;t=r,r=n}t=t||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(t.width,t.height,r||t.resolution,s||Pt.NONE);return i.filterFrame=t.filterFrame,i}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,r){const s=da[0],i=da[1],n=da[2],o=da[3];s.set(r.left,r.top),i.set(r.left,r.bottom),n.set(r.right,r.top),o.set(r.right,r.bottom),t.apply(s,s),t.apply(i,i),t.apply(n,n),t.apply(o,o);const a=Math.min(s.x,i.x,n.x,o.x),h=Math.min(s.y,i.y,n.y,o.y),u=Math.max(s.x,i.x,n.x,o.x),d=Math.max(s.y,i.y,n.y,o.y);r.x=a,r.y=h,r.width=u-a,r.height=d-h}roundFrame(t,r,s,i,n){if(!(t.width<=0||t.height<=0||s.width<=0||s.height<=0)){if(n){const{a:o,b:a,c:h,d:u}=n;if((Math.abs(a)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(u)>1e-4))return}n=n?Hl.copyFrom(n):Hl.identity(),n.translate(-s.x,-s.y).scale(i.width/s.width,i.height/s.height).translate(i.x,i.y),this.transformAABB(n,t),t.ceil(r),this.transformAABB(n.invert(),t)}}}vf.extension={type:B.RendererSystem,name:"filter"},z.add(vf);class sx{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Pt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const ix=new K;class xf{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Gl(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new K,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let r=this.renderer.context.extensions.drawBuffers,s=this.renderer.context.extensions.depthTexture;F.PREFER_ENV===js.WEBGL_LEGACY&&(r=null,s=null),r?t.drawBuffers=i=>r.drawBuffersWEBGL(i):(this.hasMRT=!1,t.drawBuffers=()=>{}),s||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,r,s=0){const{gl:i}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==s&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=s),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,s)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let o=0;o<t.colorTextures.length;o++){const a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),r){const o=r.width>>s,a=r.height>>s,h=o/r.width;this.setViewport(r.x*h,r.y*h,o,a)}else{const o=t.width>>s,a=t.height>>s;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),r?this.setViewport(r.x,r.y,r.width,r.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,r,s,i){const n=this.viewport;t=Math.round(t),r=Math.round(r),s=Math.round(s),i=Math.round(i),(n.width!==s||n.height!==i||n.x!==t||n.y!==r)&&(n.x=t,n.y=r,n.width=s,n.height=i,this.gl.viewport(t,r,s,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,r,s,i,n=hl.COLOR|hl.DEPTH){const{gl:o}=this;o.clearColor(t,r,s,i),o.clear(n)}initFramebuffer(t){const{gl:r}=this,s=new sx(r.createFramebuffer());return s.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=s,this.managedFramebuffers.push(t),t.disposeRunner.add(this),s}resizeFramebuffer(t){const{gl:r}=this,s=t.glFramebuffers[this.CONTEXT_UID];s.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,s.stencil),s.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,s.multisample,r.DEPTH24_STENCIL8,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t.width,t.height));const i=t.colorTextures;let n=i.length;r.drawBuffers||(n=Math.min(n,1));for(let o=0;o<n;o++){const a=i[o],h=a.parentTextureArray||a;this.renderer.texture.bind(h,0),o===0&&s.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,s.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,s.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,r){const{gl:s}=this,i=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let o=n.length;s.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&this.canMultisampleFramebuffer(t)?i.msaaBuffer=i.msaaBuffer||s.createRenderbuffer():i.msaaBuffer&&(s.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const a=[];for(let h=0;h<o;h++){const u=n[h],d=u.parentTextureArray||u;this.renderer.texture.bind(d,0),h===0&&i.msaaBuffer?(s.bindRenderbuffer(s.RENDERBUFFER,i.msaaBuffer),s.renderbufferStorageMultisample(s.RENDERBUFFER,i.multisample,d._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,i.msaaBuffer)):(s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+h,u.target,d._glTextures[this.CONTEXT_UID].texture,r),a.push(s.COLOR_ATTACHMENT0+h))}if(a.length>1&&s.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){const h=t.depthTexture;this.renderer.texture.bind(h,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,r)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(i.stencil=i.stencil||s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,i.stencil),i.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,i.multisample,s.DEPTH24_STENCIL8,t.width,t.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,i.stencil)):i.stencil&&(s.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:r}=this;let s=Pt.NONE;if(t<=1||r===null)return s;for(let i=0;i<r.length;i++)if(r[i]<=t){s=r[i];break}return s===1&&(s=Pt.NONE),s}blit(t,r,s){const{current:i,renderer:n,gl:o,CONTEXT_UID:a}=this;if(n.context.webGLVersion!==2||!i)return;const h=i.glFramebuffers[a];if(!h)return;if(!t){if(!h.msaaBuffer)return;const d=i.colorTextures[0];if(!d)return;h.blitFramebuffer||(h.blitFramebuffer=new Gl(i.width,i.height),h.blitFramebuffer.addColorTexture(0,d)),t=h.blitFramebuffer,t.colorTextures[0]!==d&&(t.colorTextures[0]=d,t.dirtyId++,t.dirtyFormat++),(t.width!==i.width||t.height!==i.height)&&(t.width=i.width,t.height=i.height,t.dirtyId++,t.dirtySize++)}r||(r=ix,r.width=i.width,r.height=i.height),s||(s=r);const u=r.width===s.width&&r.height===s.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,h.framebuffer),o.blitFramebuffer(r.left,r.top,r.right,r.bottom,s.left,s.top,s.right,s.bottom,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,r){const s=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!s)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),r||(i.deleteFramebuffer(s.framebuffer),s.msaaBuffer&&i.deleteRenderbuffer(s.msaaBuffer),s.stencil&&i.deleteRenderbuffer(s.stencil)),s.blitFramebuffer&&this.disposeFramebuffer(s.blitFramebuffer,r)}disposeAll(t){const r=this.managedFramebuffers;this.managedFramebuffers=[];for(let s=0;s<r.length;s++)this.disposeFramebuffer(r[s],t)}forceStencil(){const t=this.current;if(!t)return;const r=t.glFramebuffers[this.CONTEXT_UID];if(!r||r.stencil)return;t.stencil=!0;const s=t.width,i=t.height,n=this.gl,o=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o),r.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,n.DEPTH24_STENCIL8,s,i):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,s,i),r.stencil=o,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new K}destroy(){this.renderer=null}}xf.extension={type:B.RendererSystem,name:"framebuffer"},z.add(xf);const zl={5126:4,5123:2,5121:1};class bf{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,r.webGLVersion!==2){let s=this.renderer.context.extensions.vertexArrayObject;F.PREFER_ENV===js.WEBGL_LEGACY&&(s=null),s?(t.createVertexArray=()=>s.createVertexArrayOES(),t.bindVertexArray=i=>s.bindVertexArrayOES(i),t.deleteVertexArray=i=>s.deleteVertexArrayOES(i)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(r.webGLVersion!==2){const s=t.getExtension("ANGLE_instanced_arrays");s?(t.vertexAttribDivisor=(i,n)=>s.vertexAttribDivisorANGLE(i,n),t.drawElementsInstanced=(i,n,o,a,h)=>s.drawElementsInstancedANGLE(i,n,o,a,h),t.drawArraysInstanced=(i,n,o,a)=>s.drawArraysInstancedANGLE(i,n,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=r.webGLVersion===2||!!r.extensions.uint32ElementIndex}bind(t,r){r=r||this.renderer.shader.shader;const{gl:s}=this;let i=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={},n=!0);const o=i[r.program.id]||this.initGeometryVao(t,r,n);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?s.bindVertexArray(o):this.activateVao(t,r.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,r=this.renderer.buffer;for(let s=0;s<t.buffers.length;s++){const i=t.buffers[s];r.update(i)}}checkCompatibility(t,r){const s=t.attributes,i=r.attributeData;for(const n in i)if(!s[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,r){const s=t.attributes,i=r.attributeData,n=["g",t.id];for(const o in s)i[o]&&n.push(o,i[o].location);return n.join("-")}initGeometryVao(t,r,s=!0){const i=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,a=r.program;a.glPrograms[n]||this.renderer.shader.generateProgram(r),this.checkCompatibility(t,a);const h=this.getSignature(t,a),u=t.glVertexArrayObjects[this.CONTEXT_UID];let d=u[h];if(d)return u[a.id]=d,d;const l=t.buffers,c=t.attributes,p={},f={};for(const _ in l)p[_]=0,f[_]=0;for(const _ in c)!c[_].size&&a.attributeData[_]?c[_].size=a.attributeData[_].size:c[_].size||console.warn(`PIXI Geometry attribute '${_}' size cannot be determined (likely the bound shader does not have the attribute)`),p[c[_].buffer]+=c[_].size*zl[c[_].type];for(const _ in c){const m=c[_],g=m.size;m.stride===void 0&&(p[m.buffer]===g*zl[m.type]?m.stride=0:m.stride=p[m.buffer]),m.start===void 0&&(m.start=f[m.buffer],f[m.buffer]+=g*zl[m.type])}d=i.createVertexArray(),i.bindVertexArray(d);for(let _=0;_<l.length;_++){const m=l[_];o.bind(m),s&&m._glBuffers[n].refCount++}return this.activateVao(t,a),u[a.id]=d,u[h]=d,i.bindVertexArray(null),o.unbind(Tr.ARRAY_BUFFER),d}disposeGeometry(t,r){var a;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const s=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(t.disposeRunner.remove(this),!!s){if(o)for(let h=0;h<n.length;h++){const u=n[h]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!r&&o.dispose(n[h],r))}if(!r){for(const h in s)if(h[0]==="g"){const u=s[h];this._activeVao===u&&this.unbind(),i.deleteVertexArray(u)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const r=Object.keys(this.managedGeometries);for(let s=0;s<r.length;s++)this.disposeGeometry(this.managedGeometries[r[s]],t)}activateVao(t,r){const s=this.gl,i=this.CONTEXT_UID,n=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let h=null;for(const u in a){const d=a[u],l=o[d.buffer],c=l._glBuffers[i];if(r.attributeData[u]){h!==c&&(n.bind(l),h=c);const p=r.attributeData[u].location;if(s.enableVertexAttribArray(p),s.vertexAttribPointer(p,d.size,d.type||s.FLOAT,d.normalized,d.stride,d.start),d.instance)if(this.hasInstance)s.vertexAttribDivisor(p,d.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,r,s,i){const{gl:n}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,h=a===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(t,r||o.indexBuffer.data.length,h,(s||0)*a,i||1):n.drawElements(t,r||o.indexBuffer.data.length,h,(s||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(t,s,r||o.getSize(),i||1):n.drawArrays(t,s,r||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}bf.extension={type:B.RendererSystem,name:"geometry"},z.add(bf);const Tf=new ut;class Vl{constructor(t,r){this._texture=t,this.mapCoord=new ut,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof r>"u"?.5:r,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,r){r===void 0&&(r=t);const s=this.mapCoord;for(let i=0;i<t.length;i+=2){const n=t[i],o=t[i+1];r[i]=n*s.a+o*s.c+s.tx,r[i+1]=n*s.b+o*s.d+s.ty}return r}update(t){const r=this._texture;if(!r||!r.valid||!t&&this._textureID===r._updateID)return!1;this._textureID=r._updateID,this._updateID++;const s=r._uvs;this.mapCoord.set(s.x1-s.x0,s.y1-s.y0,s.x3-s.x0,s.y3-s.y0,s.x0,s.y0);const i=r.orig,n=r.trim;n&&(Tf.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Tf));const o=r.baseTexture,a=this.uClampFrame,h=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(r._frame.x+h+u)/o.width,a[1]=(r._frame.y+h+u)/o.height,a[2]=(r._frame.x+r._frame.width-h+u)/o.width,a[3]=(r._frame.y+r._frame.height-h+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=r._frame.width===o.width&&r._frame.height===o.height&&r.rotate===0,!0}}var nx=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,ox=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class ax extends Gt{constructor(t,r,s){let i=null;typeof t!="string"&&r===void 0&&s===void 0&&(i=t,t=void 0,r=void 0,s=void 0),super(t||ox,r||nx,s),this.maskSprite=i,this.maskMatrix=new ut}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,r,s,i){const n=this._maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Vl(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,r,s,i))}}class hx{constructor(t=null){this.type=Nt.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Gt.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Nt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Ef{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,r){let s=r;if(!s.isMaskData){const n=this.maskDataPool.pop()||new hx;n.pooled=!0,n.maskObject=r,s=n}const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(s.copyCountersOrReset(i),s._colorMask=i?i._colorMask:15,s.autoDetect&&this.detect(s),s._target=t,s.type!==Nt.SPRITE&&this.maskStack.push(s),s.enabled)switch(s.type){case Nt.SCISSOR:this.renderer.scissor.push(s);break;case Nt.STENCIL:this.renderer.stencil.push(s);break;case Nt.SPRITE:s.copyCountersOrReset(null),this.pushSpriteMask(s);break;case Nt.COLOR:this.pushColorMask(s);break}s.type===Nt.SPRITE&&this.maskStack.push(s)}pop(t){const r=this.maskStack.pop();if(!(!r||r._target!==t)){if(r.enabled)switch(r.type){case Nt.SCISSOR:this.renderer.scissor.pop(r);break;case Nt.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case Nt.SPRITE:this.popSpriteMask(r);break;case Nt.COLOR:this.popColorMask(r);break}if(r.reset(),r.pooled&&this.maskDataPool.push(r),this.maskStack.length!==0){const s=this.maskStack[this.maskStack.length-1];s.type===Nt.SPRITE&&s._filters&&(s._filters[0].maskSprite=s.maskObject)}}}detect(t){const r=t.maskObject;r?r.isSprite?t.type=Nt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=Nt.SCISSOR:t.type=Nt.STENCIL:t.type=Nt.COLOR}pushSpriteMask(t){const{maskObject:r}=t,s=t._target;let i=t._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new ax]));const n=this.renderer,o=n.renderTexture;let a,h;if(o.current){const d=o.current;a=t.resolution||d.resolution,h=t.multisample??d.multisample}else a=t.resolution||n.resolution,h=t.multisample??n.multisample;i[0].resolution=a,i[0].multisample=h,i[0].maskSprite=r;const u=s.filterArea;s.filterArea=r.getBounds(!0),n.filter.push(s,i),s.filterArea=u,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const r=t._colorMask,s=t._colorMask=r&t.colorMask;s!==r&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}popColorMask(t){const r=t._colorMask,s=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;s!==r&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}destroy(){this.renderer=null}}Ef.extension={type:B.RendererSystem,name:"mask"},z.add(Ef);class wf{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:r}=this.renderer,s=this.getStackLength();this.maskStack=t;const i=this.getStackLength();i!==s&&(i===0?r.disable(this.glConst):(r.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Af=new ut,Sf=[],pa=class extends wf{constructor(e){super(e),this.glConst=F.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const t=e._scissorRect,{maskObject:r}=e,{renderer:s}=this,i=s.renderTexture,n=r.getBounds(!0,Sf.pop()??new K);this.roundFrameToPixels(n,i.current?i.current.resolution:s.resolution,i.sourceFrame,i.destinationFrame,s.projection.transform),t&&n.fit(t),e._scissorRectLocal=n}static isMatrixRotated(e){if(!e)return!1;const{a:t,b:r,c:s,d:i}=e;return(Math.abs(r)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(i)>1e-4)}testScissor(e){const{maskObject:t}=e;if(!t.isFastRect||!t.isFastRect()||pa.isMatrixRotated(t.worldTransform)||pa.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const r=e._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(e,t,r,s,i){pa.isMatrixRotated(i)||(i=i?Af.copyFrom(i):Af.identity(),i.translate(-r.x,-r.y).scale(s.width/r.width,s.height/r.height).translate(s.x,s.y),this.renderer.filter.transformAABB(i,e),e.fit(s),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:t}=this.renderer;e&&Sf.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=e.y:t=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}};let Cf=pa;Cf.extension={type:B.RendererSystem,name:"scissor"},z.add(Cf);class If extends wf{constructor(t){super(t),this.glConst=F.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const r=t.maskObject,{gl:s}=this.renderer,i=t._stencilCounter;i===0&&(this.renderer.framebuffer.forceStencil(),s.clearStencil(0),s.clear(s.STENCIL_BUFFER_BIT),s.enable(s.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;n!==0&&(t._colorMask=0,s.colorMask(!1,!1,!1,!1)),s.stencilFunc(s.EQUAL,i,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.INCR),r.renderable=!0,r.render(this.renderer),this.renderer.batch.flush(),r.renderable=!1,n!==0&&(t._colorMask=n,s.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){const r=this.renderer.gl;if(this.getStackLength()===0)r.disable(r.STENCIL_TEST);else{const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,i=s?s._colorMask:15;i!==0&&(s._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilOp(r.KEEP,r.KEEP,r.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,i!==0&&(s._colorMask=i,r.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}If.extension={type:B.RendererSystem,name:"stencil"},z.add(If);class Rf{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return J("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return J("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return J("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const r in t)this.plugins[r]=new t[r](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}Rf.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"_plugin"},z.add(Rf);class Mf{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new ut,this.transform=null}update(t,r,s,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=r||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,s,i),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,r,s,i){const n=this.projectionMatrix,o=i?-1:1;n.identity(),n.a=1/r.width*2,n.d=o*(1/r.height*2),n.tx=-1-r.x*n.a,n.ty=-o-r.y*n.d}setTransform(t){}destroy(){this.renderer=null}}Mf.extension={type:B.RendererSystem,name:"projection"},z.add(Mf);const lx=new Hi;class Pf{constructor(t){this.renderer=t,this._tempMatrix=new ut}generateTexture(t,r){const{region:s,...i}=r||{},n=s||t.getLocalBounds(null,!0);n.width===0&&(n.width=1),n.height===0&&(n.height=1);const o=ti.create({width:n.width,height:n.height,...i});this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const a=t.transform;return t.transform=lx,this.renderer.render(t,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=a,o}destroy(){}}Pf.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"textureGenerator"},z.add(Pf);const ei=new K,Hn=new K;class Df{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new K,this.destinationFrame=new K,this.viewportFrame=new K}contextChange(){var r;const t=(r=this.renderer)==null?void 0:r.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,r,s){const i=this.renderer;this.current=t;let n,o,a;t?(n=t.baseTexture,a=n.resolution,r||(ei.width=t.frame.width,ei.height=t.frame.height,r=ei),s||(Hn.x=t.frame.x,Hn.y=t.frame.y,Hn.width=r.width,Hn.height=r.height,s=Hn),o=n.framebuffer):(a=i.resolution,r||(ei.width=i._view.screen.width,ei.height=i._view.screen.height,r=ei),s||(s=ei,s.width=r.width,s.height=r.height));const h=this.viewportFrame;h.x=s.x*a,h.y=s.y*a,h.width=s.width*a,h.height=s.height*a,t||(h.y=i.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(o,h),this.renderer.projection.update(s,r,a,!o),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(r),this.destinationFrame.copyFrom(s)}clear(t,r){const s=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,i=st.shared.setValue(t||s);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&i.premultiply(i.alpha);const n=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=n.width!==o.width||n.height!==o.height;if(a){let{x:h,y:u,width:d,height:l}=this.viewportFrame;h=Math.round(h),u=Math.round(u),d=Math.round(d),l=Math.round(l),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,u,d,l)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,r),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Df.extension={type:B.RendererSystem,name:"renderTexture"},z.add(Df);class ux{constructor(t,r){this.program=t,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function cx(e,t){const r={},s=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<s;i++){const n=t.getActiveAttrib(e,i);if(n.name.startsWith("gl_"))continue;const o=lf(t,n.type),a={type:o,name:n.name,size:af(o),location:t.getAttribLocation(e,n.name)};r[n.name]=a}return r}function dx(e,t){const r={},s=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let i=0;i<s;i++){const n=t.getActiveUniform(e,i),o=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),h=lf(t,n.type);r[o]={name:o,index:i,type:h,size:n.size,isArray:a,value:sf(h,n.size)}}return r}function px(e,t){var a;const r=rf(e,e.VERTEX_SHADER,t.vertexSrc),s=rf(e,e.FRAGMENT_SHADER,t.fragmentSrc),i=e.createProgram();e.attachShader(i,r),e.attachShader(i,s);const n=(a=t.extra)==null?void 0:a.transformFeedbackVaryings;if(n&&(typeof e.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(i,n.names,n.bufferMode==="separate"?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)||zv(e,i,r,s),t.attributeData=cx(i,e),t.uniformData=dx(i,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const h=Object.keys(t.attributeData);h.sort((u,d)=>u>d?1:-1);for(let u=0;u<h.length;u++)t.attributeData[h[u]].location=u,e.bindAttribLocation(i,u,h[u]);e.linkProgram(i)}e.deleteShader(r),e.deleteShader(s);const o={};for(const h in t.uniformData){const u=t.uniformData[h];o[h]={location:e.getUniformLocation(i,h),value:sf(u.type,u.size)}}return new ux(i,o)}function fx(e,t,r,s,i){r.buffer.update(i)}const _x={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Of={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function mx(e){const t=e.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let r=0,s=0,i=0;for(let n=0;n<t.length;n++){const o=t[n];if(r=Of[o.data.type],o.data.size>1&&(r=Math.max(r,16)*o.data.size),o.dataLen=r,s%r!==0&&s<16){const a=s%r%16;s+=a,i+=a}s+r>16?(i=Math.ceil(i/16)*16,o.offset=i,i+=r,s=r):(o.offset=i,s+=r,i+=r)}return i=Math.ceil(i/16)*16,{uboElements:t,size:i}}function gx(e,t){const r=[];for(const s in e)t[s]&&r.push(t[s]);return r.sort((s,i)=>s.index-i.index),r}function yx(e,t){if(!e.autoManage)return{size:0,syncFunc:fx};const r=gx(e.uniforms,t),{uboElements:s,size:i}=mx(r),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<s.length;o++){const a=s[o],h=e.uniforms[a.data.name],u=a.data.name;let d=!1;for(let l=0;l<zi.length;l++){const c=zi[l];if(c.codeUbo&&c.test(a.data,h)){n.push(`offset = ${a.offset/4};`,zi[l].codeUbo(a.data.name,h)),d=!0;break}}if(!d)if(a.data.size>1){const l=af(a.data.type),c=Math.max(Of[a.data.type]/16,1),p=l/c,f=(4-p%4)%4;n.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*c}; i++)
                {
                    for(var j = 0; j < ${p}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${f};
                }

                `)}else{const l=_x[a.data.type];n.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};
                ${l};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let vx=0;const fa={textureCount:0,uboCount:0};class kf{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=vx++}systemCheck(){if(!Xv())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,r){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const s=t.program,i=s.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==s&&(this.program=s,this.gl.useProgram(i.program)),r||(fa.textureCount=0,fa.uboCount=0,this.syncUniformGroup(t.uniformGroup,fa)),i}setUniforms(t){const r=this.shader.program,s=r.glPrograms[this.renderer.CONTEXT_UID];r.syncUniforms(s.uniformData,t,this.renderer)}syncUniformGroup(t,r){const s=this.getGlProgram();(!t.static||t.dirtyId!==s.uniformDirtyGroups[t.id])&&(s.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,s,r))}syncUniforms(t,r,s){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(r.uniformData,t.uniforms,this.renderer,s)}createSyncGroups(t){const r=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[r]||(this.cache[r]=Uv(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[r],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,r){const s=this.getGlProgram();if(!t.static||t.dirtyId!==0||!s.uniformGroups[t.id]){t.dirtyId=0;const i=s.uniformGroups[t.id]||this.createSyncBufferGroup(t,s,r);t.buffer.update(),i(s.uniformData,t.uniforms,this.renderer,fa,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,s.uniformBufferBindings[r])}createSyncBufferGroup(t,r,s){const{gl:i}=this.renderer;this.renderer.buffer.bind(t.buffer);const n=this.gl.getUniformBlockIndex(r.program,s);r.uniformBufferBindings[s]=this.shader.uniformBindCount,i.uniformBlockBinding(r.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(t,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=yx(t,this.shader.program.uniformData)),t.autoManage){const h=new Float32Array(a.size/4);t.buffer.update(h)}return r.uniformGroups[t.id]=a.syncFunc,r.uniformGroups[t.id]}getSignature(t,r,s){const i=t.uniforms,n=[`${s}-`];for(const o in i)n.push(o),r[o]&&n.push(r[o].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const r=this.gl,s=t.program,i=px(r,s);return s.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}kf.extension={type:B.RendererSystem,name:"shader"},z.add(kf);class _a{constructor(t){this.renderer=t}run(t){const{renderer:r}=this;r.runners.init.emit(r.options),t.hello&&console.log(`PixiJS 7.2.4 - ${r.rendererLogId} - https://pixijs.com`),r.resize(r.screen.width,r.screen.height)}destroy(){}}_a.defaultOptions={hello:!1},_a.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"startup"},z.add(_a);function xx(e,t=[]){return t[V.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.ADD]=[e.ONE,e.ONE],t[V.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.NONE]=[0,0],t[V.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[V.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[V.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[V.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[V.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[V.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[V.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[V.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[V.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[V.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[V.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}const bx=0,Tx=1,Ex=2,wx=3,Ax=4,Sx=5,Xl=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=V.NONE,this._blendEq=!1,this.map=[],this.map[bx]=this.setBlend,this.map[Tx]=this.setOffset,this.map[Ex]=this.setCullFace,this.map[wx]=this.setDepthTest,this.map[Ax]=this.setFrontFace,this.map[Sx]=this.setDepthMask,this.checks=[],this.defaultState=new qs,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=xx(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,r=0;for(;t;)t&1&&this.map[r].call(this,!!(e.data&1<<r)),t=t>>1,r++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(Xl.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(Xl.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const t=this.blendModes[e],r=this.gl;t.length===2?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){const r=this.checks.indexOf(e);t&&r===-1?this.checks.push(e):!t&&r!==-1&&this.checks.splice(r,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let Nf=Xl;Nf.extension={type:B.RendererSystem,name:"state"},z.add(Nf);class Cx extends Rn{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const r=(t.priority??[]).filter(i=>t.systems[i]),s=[...r,...Object.keys(t.systems).filter(i=>!r.includes(i))];for(const i of s)this.addSystem(t.systems[i],i)}addRunners(...t){t.forEach(r=>{this.runners[r]=new rr(r)})}addSystem(t,r){const s=new t(this);if(this[r])throw new Error(`Whoops! The name "${r}" is already in use`);this[r]=s,this._systemsHash[r]=s;for(const i in this.runners)this.runners[i].add(s);return this}emitWithCustomOptions(t,r){const s=Object.keys(this._systemsHash);t.items.forEach(i=>{const n=s.find(o=>this._systemsHash[o]===i);i[t.name](r[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const ma=class{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=ma.defaultMaxIdle,this.checkCountMax=ma.defaultCheckCountMax,this.mode=ma.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==ul.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,t=e.managedTextures;let r=!1;for(let s=0;s<t.length;s++){const i=t[s];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(e.destroyTexture(i,!0),t[s]=null,r=!0)}if(r){let s=0;for(let i=0;i<t.length;i++)t[i]!==null&&(t[s++]=t[i]);t.length=s}}unload(e){const t=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(let s=e.children.length-1;s>=0;s--)this.unload(e.children[s])}destroy(){this.renderer=null}};let ar=ma;ar.defaultMode=ul.AUTO,ar.defaultMaxIdle=3600,ar.defaultCheckCountMax=600,ar.extension={type:B.RendererSystem,name:"textureGC"},z.add(ar);class Wl{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=X.UNSIGNED_BYTE,this.internalFormat=k.RGBA,this.samplerType=0}}function Ix(e){let t;return"WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?t={[X.UNSIGNED_BYTE]:{[k.RGBA]:e.RGBA8,[k.RGB]:e.RGB8,[k.RG]:e.RG8,[k.RED]:e.R8,[k.RGBA_INTEGER]:e.RGBA8UI,[k.RGB_INTEGER]:e.RGB8UI,[k.RG_INTEGER]:e.RG8UI,[k.RED_INTEGER]:e.R8UI,[k.ALPHA]:e.ALPHA,[k.LUMINANCE]:e.LUMINANCE,[k.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[X.BYTE]:{[k.RGBA]:e.RGBA8_SNORM,[k.RGB]:e.RGB8_SNORM,[k.RG]:e.RG8_SNORM,[k.RED]:e.R8_SNORM,[k.RGBA_INTEGER]:e.RGBA8I,[k.RGB_INTEGER]:e.RGB8I,[k.RG_INTEGER]:e.RG8I,[k.RED_INTEGER]:e.R8I},[X.UNSIGNED_SHORT]:{[k.RGBA_INTEGER]:e.RGBA16UI,[k.RGB_INTEGER]:e.RGB16UI,[k.RG_INTEGER]:e.RG16UI,[k.RED_INTEGER]:e.R16UI,[k.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[X.SHORT]:{[k.RGBA_INTEGER]:e.RGBA16I,[k.RGB_INTEGER]:e.RGB16I,[k.RG_INTEGER]:e.RG16I,[k.RED_INTEGER]:e.R16I},[X.UNSIGNED_INT]:{[k.RGBA_INTEGER]:e.RGBA32UI,[k.RGB_INTEGER]:e.RGB32UI,[k.RG_INTEGER]:e.RG32UI,[k.RED_INTEGER]:e.R32UI,[k.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[X.INT]:{[k.RGBA_INTEGER]:e.RGBA32I,[k.RGB_INTEGER]:e.RGB32I,[k.RG_INTEGER]:e.RG32I,[k.RED_INTEGER]:e.R32I},[X.FLOAT]:{[k.RGBA]:e.RGBA32F,[k.RGB]:e.RGB32F,[k.RG]:e.RG32F,[k.RED]:e.R32F,[k.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[X.HALF_FLOAT]:{[k.RGBA]:e.RGBA16F,[k.RGB]:e.RGB16F,[k.RG]:e.RG16F,[k.RED]:e.R16F},[X.UNSIGNED_SHORT_5_6_5]:{[k.RGB]:e.RGB565},[X.UNSIGNED_SHORT_4_4_4_4]:{[k.RGBA]:e.RGBA4},[X.UNSIGNED_SHORT_5_5_5_1]:{[k.RGBA]:e.RGB5_A1},[X.UNSIGNED_INT_2_10_10_10_REV]:{[k.RGBA]:e.RGB10_A2,[k.RGBA_INTEGER]:e.RGB10_A2UI},[X.UNSIGNED_INT_10F_11F_11F_REV]:{[k.RGB]:e.R11F_G11F_B10F},[X.UNSIGNED_INT_5_9_9_9_REV]:{[k.RGB]:e.RGB9_E5},[X.UNSIGNED_INT_24_8]:{[k.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[X.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[k.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:t={[X.UNSIGNED_BYTE]:{[k.RGBA]:e.RGBA,[k.RGB]:e.RGB,[k.ALPHA]:e.ALPHA,[k.LUMINANCE]:e.LUMINANCE,[k.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[X.UNSIGNED_SHORT_5_6_5]:{[k.RGB]:e.RGB},[X.UNSIGNED_SHORT_4_4_4_4]:{[k.RGBA]:e.RGBA},[X.UNSIGNED_SHORT_5_5_5_1]:{[k.RGBA]:e.RGBA}},t}class Lf{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new $,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=Ix(t);const r=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=r;for(let i=0;i<r;i++)this.boundTextures[i]=null;this.emptyTextures={};const s=new Wl(t.createTexture());t.bindTexture(t.TEXTURE_2D,s.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=s,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Wl(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(t,r=0){const{gl:s}=this;if(t=t==null?void 0:t.castToBaseTexture(),(t==null?void 0:t.valid)&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[r]!==t&&(this.currentLocation!==r&&(this.currentLocation=r,s.activeTexture(s.TEXTURE0+r)),s.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,s.activeTexture(s.TEXTURE0+r)),this.updateTexture(t)):i.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[r]=t}else this.currentLocation!==r&&(this.currentLocation=r,s.activeTexture(s.TEXTURE0+r)),s.bindTexture(s.TEXTURE_2D,this.emptyTextures[s.TEXTURE_2D].texture),this.boundTextures[r]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:r,boundTextures:s}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<s.length;i++)s[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<s.length;i++)s[i]===t&&(this.currentLocation!==i&&(r.activeTexture(r.TEXTURE0+i),this.currentLocation=i),r.bindTexture(t.target,this.emptyTextures[t.target].texture),s[i]=null)}ensureSamplerType(t){const{boundTextures:r,hasIntegerTextures:s,CONTEXT_UID:i}=this;if(s)for(let n=t-1;n>=0;--n){const o=r[n];o&&o._glTextures[i].samplerType!==ll.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(t){const r=new Wl(this.gl.createTexture());return r.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=r,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),r}initTextureType(t,r){var s;r.internalFormat=((s=this.internalFormats[t.type])==null?void 0:s[t.format])??t.format,this.webGLVersion===2&&t.type===X.HALF_FLOAT?r.type=this.gl.HALF_FLOAT:r.type=t.type}updateTexture(t){var i;const r=t._glTextures[this.CONTEXT_UID];if(!r)return;const s=this.renderer;if(this.initTextureType(t,r),(i=t.resource)==null?void 0:i.upload(s,t,r))r.samplerType!==ll.FLOAT&&(this.hasIntegerTextures=!0);else{const n=t.realWidth,o=t.realHeight,a=s.gl;(r.width!==n||r.height!==o||r.dirtyId<0)&&(r.width=n,r.height=o,a.texImage2D(t.target,0,r.internalFormat,n,o,0,t.format,r.type,null))}t.dirtyStyleId!==r.dirtyStyleId&&this.updateTextureStyle(t),r.dirtyId=t.dirtyId}destroyTexture(t,r){const{gl:s}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),s.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!r)){const i=this.managedTextures.indexOf(t);i!==-1&&Ui(this.managedTextures,i,1)}}updateTextureStyle(t){var s;const r=t._glTextures[this.CONTEXT_UID];r&&((t.mipmap===xr.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?r.mipmap=!1:r.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?r.wrapMode=zr.CLAMP:r.wrapMode=t.wrapMode,(s=t.resource)!=null&&s.style(this.renderer,t,r)||this.setStyle(t,r),r.dirtyStyleId=t.dirtyStyleId)}setStyle(t,r){const s=this.gl;if(r.mipmap&&t.mipmap!==xr.ON_MANUAL&&s.generateMipmap(t.target),s.texParameteri(t.target,s.TEXTURE_WRAP_S,r.wrapMode),s.texParameteri(t.target,s.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===Hr.LINEAR?s.LINEAR_MIPMAP_LINEAR:s.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===Hr.LINEAR){const n=Math.min(t.anisotropicLevel,s.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));s.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===Hr.LINEAR?s.LINEAR:s.NEAREST);s.texParameteri(t.target,s.TEXTURE_MAG_FILTER,t.scaleMode===Hr.LINEAR?s.LINEAR:s.NEAREST)}destroy(){this.renderer=null}}Lf.extension={type:B.RendererSystem,name:"texture"},z.add(Lf);class Ff{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:r,CONTEXT_UID:s}=this,i=t._glTransformFeedbacks[s]||this.createGLTransformFeedback(t);r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,r){const{gl:s,renderer:i}=this;r&&i.shader.bind(r),s.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:r,renderer:s,CONTEXT_UID:i}=this,n=r.createTransformFeedback();t._glTransformFeedbacks[i]=n,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n);for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];a&&(s.buffer.update(a),a._glBuffers[i].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[i].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,r){const s=t._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];if(!a)continue;const h=a._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!r&&n.dispose(a,r))}s&&(r||i.deleteTransformFeedback(s),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Ff.extension={type:B.RendererSystem,name:"transformFeedback"},z.add(Ff);class ga{constructor(t){this.renderer=t}init(t){this.screen=new K(0,0,t.width,t.height),this.element=t.view||F.ADAPTER.createCanvas(),this.resolution=t.resolution||F.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,r){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(r*this.resolution);const s=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=s,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${s}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",s,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var r;t&&((r=this.element.parentNode)==null||r.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}ga.defaultOptions={width:800,height:600,resolution:F.RESOLUTION,autoDensity:!1},ga.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"_view"},z.add(ga),F.PREFER_ENV=js.WEBGL2,F.STRICT_TEXTURE_CACHE=!1,F.RENDER_OPTIONS={...ua.defaultOptions,...la.defaultOptions,...ga.defaultOptions,..._a.defaultOptions},Object.defineProperties(F,{WRAP_MODE:{get(){return $.defaultOptions.wrapMode},set(e){J("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),$.defaultOptions.wrapMode=e}},SCALE_MODE:{get(){return $.defaultOptions.scaleMode},set(e){J("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),$.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get(){return $.defaultOptions.mipmap},set(e){J("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),$.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get(){return $.defaultOptions.anisotropicLevel},set(e){J("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),$.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get(){return J("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Gt.defaultResolution},set(e){Gt.defaultResolution=e}},FILTER_MULTISAMPLE:{get(){return J("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Gt.defaultMultisample},set(e){Gt.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get(){return or.defaultMaxTextures},set(e){J("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),or.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get(){return or.defaultBatchSize},set(e){J("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),or.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get(){return or.canUploadSameBuffer},set(e){J("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),or.canUploadSameBuffer=e}},GC_MODE:{get(){return ar.defaultMode},set(e){J("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ar.defaultMode=e}},GC_MAX_IDLE:{get(){return ar.defaultMaxIdle},set(e){J("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ar.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get(){return ar.defaultCheckCountMax},set(e){J("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ar.defaultCheckCountMax=e}},PRECISION_VERTEX:{get(){return sr.defaultVertexPrecision},set(e){J("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),sr.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get(){return sr.defaultFragmentPrecision},set(e){J("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),sr.defaultFragmentPrecision=e}}});var ri=(e=>(e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(ri||{});class jl{constructor(t,r=null,s=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=r,this.priority=s,this.once=i}match(t,r=null){return this.fn===t&&this.context===r}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const r=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),r}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const r=this.next;return this.next=t?null:r,this.previous=null,r}}const Ce=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new jl(null,null,1/0),this.deltaMS=1/Ce.targetFPMS,this.elapsedMS=1/Ce.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,r=ri.NORMAL){return this._addListener(new jl(e,t,r))}addOnce(e,t,r=ri.NORMAL){return this._addListener(new jl(e,t,r,!0))}_addListener(e){let t=this._head.next,r=this._head;if(!t)e.connect(r);else{for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}return this._startIfPossible(),this}remove(e,t){let r=this._head.next;for(;r;)r.match(e,t)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const i=e-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=e-i%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Ce.targetFPMS;const r=this._head;let s=r.next;for(;s;)s=s.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,t)/1e3,Ce.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!Ce._shared){const e=Ce._shared=new Ce;e.autoStart=!0,e._protected=!0}return Ce._shared}static get system(){if(!Ce._system){const e=Ce._system=new Ce;e.autoStart=!0,e._protected=!0}return Ce._system}};let Ht=Ce;Ht.targetFPMS=.06,Object.defineProperties(F,{TARGET_FPMS:{get(){return Ht.targetFPMS},set(e){J("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Ht.targetFPMS=e}}});class Bf{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(r){this._ticker&&this._ticker.remove(this.render,this),this._ticker=r,r&&r.add(this.render,this,ri.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Ht.shared:new Ht,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Bf.extension=B.Application,z.add(Bf);const Uf=[];z.handleByList(B.Renderer,Uf);function Rx(e){for(const t of Uf)if(t.test(e))return new t(e);throw new Error("Unable to auto-detect a suitable renderer.")}var Mx=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Px=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Dx=Mx,Gf=Px;class Hf{constructor(t){this.renderer=t}contextChange(t){let r;if(this.renderer.context.webGLVersion===1){const s=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),r=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,s)}else{const s=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),r=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,s)}r>=Pt.HIGH?this.multisample=Pt.HIGH:r>=Pt.MEDIUM?this.multisample=Pt.MEDIUM:r>=Pt.LOW?this.multisample=Pt.LOW:this.multisample=Pt.NONE}destroy(){}}Hf.extension={type:B.RendererSystem,name:"_multisample"},z.add(Hf);class Ox{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class zf{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:r,CONTEXT_UID:s}=this,i=t._glBuffers[s]||this.createGLBuffer(t);r.bindBuffer(t.type,i.buffer)}unbind(t){const{gl:r}=this;r.bindBuffer(t,null)}bindBufferBase(t,r){const{gl:s,CONTEXT_UID:i}=this;if(this.boundBufferBases[r]!==t){const n=t._glBuffers[i]||this.createGLBuffer(t);this.boundBufferBases[r]=t,s.bindBufferBase(s.UNIFORM_BUFFER,r,n.buffer)}}bindBufferRange(t,r,s){const{gl:i,CONTEXT_UID:n}=this;s=s||0;const o=t._glBuffers[n]||this.createGLBuffer(t);i.bindBufferRange(i.UNIFORM_BUFFER,r||0,o.buffer,s*256,256)}update(t){const{gl:r,CONTEXT_UID:s}=this,i=t._glBuffers[s]||this.createGLBuffer(t);if(t._updateID!==i.updateID)if(i.updateID=t._updateID,r.bindBuffer(t.type,i.buffer),i.byteLength>=t.data.byteLength)r.bufferSubData(t.type,0,t.data);else{const n=t.static?r.STATIC_DRAW:r.DYNAMIC_DRAW;i.byteLength=t.data.byteLength,r.bufferData(t.type,t.data,n)}}dispose(t,r){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const s=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),s&&(r||i.deleteBuffer(s.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const r=Object.keys(this.managedBuffers);for(let s=0;s<r.length;s++)this.dispose(this.managedBuffers[r[s]],t)}createGLBuffer(t){const{CONTEXT_UID:r,gl:s}=this;return t._glBuffers[r]=new Ox(s.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[r]}}zf.extension={type:B.RendererSystem,name:"buffer"},z.add(zf);class Vf{constructor(t){this.renderer=t}render(t,r){const s=this.renderer;let i,n,o,a;if(r&&(i=r.renderTexture,n=r.clear,o=r.transform,a=r.skipUpdateTransform),this.renderingToScreen=!i,s.runners.prerender.emit(),s.emit("prerender"),s.projection.transform=o,!s.context.isLost){if(i||(this.lastObjectRendered=t),!a){const h=t.enableTempParent();t.updateTransform(),t.disableTempParent(h)}s.renderTexture.bind(i),s.batch.currentRenderer.start(),(n??s.background.clearBeforeRender)&&s.renderTexture.clear(),t.render(s),s.batch.currentRenderer.flush(),i&&(r.blit&&s.framebuffer.blit(),i.baseTexture.update()),s.runners.postrender.emit(),s.projection.transform=null,s.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}Vf.extension={type:B.RendererSystem,name:"objectRenderer"},z.add(Vf);const Yl=class extends Cx{constructor(e){super(),this.type=ap.WEBGL,e=Object.assign({},F.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ir({projectionMatrix:new ut},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Yl.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in e&&(J("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=Yl.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:nv()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return J("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return J("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return J("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return J("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){J("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return J("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){J("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return J("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}};let Wi=Yl;Wi.extension={type:B.Renderer,priority:1},Wi.__plugins={},Wi.__systems={},z.handleByMap(B.RendererPlugin,Wi.__plugins),z.handleByMap(B.RendererSystem,Wi.__systems),z.add(Wi);class Xf extends Fn{constructor(t,r){const{width:s,height:i}=r||{};super(s,i),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){const o=new $;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,r){for(let s=0;s<this.length;s++)t[s]&&(t[s].castToBaseTexture?this.addBaseTextureAt(t[s].castToBaseTexture(),s):t[s]instanceof Fn?this.addResourceAt(t[s],s):this.addResourceAt(Zp(t[s],r),s))}dispose(){for(let t=0,r=this.length;t<r;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,r){if(!this.items[r])throw new Error(`Index ${r} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[r].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=t,this.items[r].on("update",t.update,t)}unbind(t){super.unbind(t);for(let r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map(r=>r.resource).filter(r=>r).map(r=>r.load());return this._load=Promise.all(t).then(()=>{const{realWidth:r,realHeight:s}=this.items[0];return this.resize(r,s),Promise.resolve(this)}),this._load}}class kx extends Xf{constructor(t,r){const{width:s,height:i}=r||{};let n,o;Array.isArray(t)?(n=t,o=t.length):o=t,super(o,{width:s,height:i}),n&&this.initFromArray(n,r)}addBaseTextureAt(t,r){if(t.resource)this.addResourceAt(t.resource,r);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=Oi.TEXTURE_2D_ARRAY}upload(t,r,s){const{length:i,itemDirtyIds:n,items:o}=this,{gl:a}=t;s.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,s.internalFormat,this._width,this._height,i,0,r.format,s.type,null);for(let h=0;h<i;h++){const u=o[h];n[h]<u.dirtyId&&(n[h]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,h,u.resource.width,u.resource.height,1,r.format,s.type,u.resource.source))}return!0}}class Nx extends ms{constructor(t){super(t)}static test(t){const{OffscreenCanvas:r}=globalThis;return r&&t instanceof r?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const zn=class extends Xf{constructor(e,t){const{width:r,height:s,autoLoad:i,linkBaseTexture:n}=t||{};if(e&&e.length!==zn.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:r,height:s});for(let o=0;o<zn.SIDES;o++)this.items[o].target=Oi.TEXTURE_CUBE_MAP_POSITIVE_X+o;this.linkBaseTexture=n!==!1,e&&this.initFromArray(e,t),i!==!1&&this.load()}bind(e){super.bind(e),e.target=Oi.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,r){if(r===void 0&&(r=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=Oi.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(e,t,r){const s=this.itemDirtyIds;for(let i=0;i<zn.SIDES;i++){const n=this.items[i];(s[i]<n.dirtyId||r.dirtyId<t.dirtyId)&&(n.valid&&n.resource?(n.resource.upload(e,n,r),s[i]=n.dirtyId):s[i]<-1&&(e.gl.texImage2D(n.target,0,r.internalFormat,t.realWidth,t.realHeight,0,t.format,r.type,null),s[i]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===zn.SIDES}};let Wf=zn;Wf.SIDES=6;class ji extends ms{constructor(t,r){r=r||{};let s,i;typeof t=="string"?(s=ji.EMPTY,i=t):(s=t,i=null),super(s),this.url=i,this.crossOrigin=r.crossOrigin??!0,this.alphaMode=typeof r.alphaMode=="number"?r.alphaMode:null,this._load=null,r.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,r)=>{if(this.url===null){t(this);return}try{const s=await F.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await s.blob();if(this.destroyed)return;const n=await createImageBitmap(i,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Je.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=n,this.update(),t(this)}catch(s){if(this.destroyed)return;r(s),this.onError.emit(s)}}),this._load)}upload(t,r,s){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(r.alphaMode=this.alphaMode),super.upload(t,r,s)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return ji._EMPTY=ji._EMPTY??F.ADAPTER.createCanvas(0,0),ji._EMPTY}}const ya=class extends ms{constructor(e,t){t=t||{},super(F.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),e(this)},ya.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;ms.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;const t=e.width,r=e.height;if(!t||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=t*this.scale,i=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/r*t,i=this._overrideHeight||this._overrideWidth/t*r),s=Math.round(s),i=Math.round(i);const n=this.source;n.width=s,n.height=i,n._pixiId=`canvas_${$s()}`,n.getContext("2d").drawImage(e,0,0,t,r,0,0,s,i),this._resolve(),this._resolve=null}}static getSize(e){const t=ya.SVG_SIZE.exec(e),r={};return t&&(r[t[1]]=Math.round(parseFloat(t[3])),r[t[5]]=Math.round(parseFloat(t[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return t==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&ya.SVG_XML.test(e)}};let Vn=ya;Vn.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Vn.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const $l=class extends ms{constructor(e,t){if(t=t||{},!(e instanceof HTMLVideoElement)){const r=document.createElement("video");r.setAttribute("preload","auto"),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),typeof e=="string"&&(e=[e]);const s=e[0].src||e[0];ms.crossOrigin(r,s,t.crossorigin);for(let i=0;i<e.length;++i){const n=document.createElement("source");let{src:o,mime:a}=e[i];o=o||e[i];const h=o.split("?").shift().toLowerCase(),u=h.slice(h.lastIndexOf(".")+1);a=a||$l.MIME_TYPES[u]||`video/${u}`,n.src=o,n.type=a,r.appendChild(n)}e=r}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){const t=Ht.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Ht.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Ht.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._isConnectedToTicker&&(Ht.shared.remove(this.update,this),this._isConnectedToTicker=!1);const e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Ht.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Ht.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e)}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||$l.TYPES.includes(t)}};let ql=$l;ql.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],ql.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},Nl.push(ji,ff,Nx,ql,Vn,Bn,Wf,kx);class jf{constructor(){this.size=null,this.names=null,this.values=null,this.renderObject=null}get width(){const t=this.texture;return t.trim?t.trim.width:t.orig.width}get height(){const t=this.texture;return t.trim?t.trim.height:t.orig.height}get u(){return this.texture._uvs.x0}get v(){return this.texture._uvs.y0}get u2(){return this.texture._uvs.x2}get v2(){return this.texture._uvs.y2}get offsetX(){const t=this.texture;return t.trim?t.trim.x:0}get offsetY(){return this.spineOffsetY}get pixiOffsetY(){const t=this.texture;return t.trim?t.trim.y:0}get spineOffsetY(){const t=this.texture;return this.originalHeight-this.height-(t.trim?t.trim.y:0)}get originalWidth(){return this.texture.orig.width}get originalHeight(){return this.texture.orig.height}get x(){return this.texture.frame.x}get y(){return this.texture.frame.y}get rotate(){return this.texture.rotate!==0}get degrees(){return(360-this.texture.rotate*45)%360}}class Lx{constructor(){this.entries={},this.size=0}add(t){const r=this.entries[t];return this.entries[t]=!0,r?!1:(this.size++,!0)}addAll(t){const r=this.size;for(let s=0,i=t.length;s<i;s++)this.add(t[s]);return r!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}}const jr=class{static clamp(e,t,r){return e<t?t:e>r?r:e}static cosDeg(e){return Math.cos(e*jr.degRad)}static sinDeg(e){return Math.sin(e*jr.degRad)}static signum(e){return Math.sign(e)}static toInt(e){return e>0?Math.floor(e):Math.ceil(e)}static cbrt(e){const t=Math.pow(Math.abs(e),.3333333333333333);return e<0?-t:t}static randomTriangular(e,t){return jr.randomTriangularWith(e,t,(e+t)*.5)}static randomTriangularWith(e,t,r){const s=Math.random(),i=t-e;return s<=(r-e)/i?e+Math.sqrt(s*i*(r-e)):t-Math.sqrt((1-s)*i*(t-r))}static isPowerOfTwo(e){return e&&(e&e-1)===0}};let si=jr;si.PI=3.1415927,si.PI2=jr.PI*2,si.radiansToDegrees=180/jr.PI,si.radDeg=jr.radiansToDegrees,si.degreesToRadians=jr.PI/180,si.degRad=jr.degreesToRadians;const Fx={yDown:!0,FAIL_ON_NON_EXISTING_SKIN:!1,GLOBAL_AUTO_UPDATE:!0,GLOBAL_DELAY_LIMIT:0};class va{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?K.EMPTY:(t=t||new K(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,r){const{a:s,b:i,c:n,d:o,tx:a,ty:h}=t,u=s*r.x+n*r.y+a,d=i*r.x+o*r.y+h;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,d),this.maxY=Math.max(this.maxY,d)}addQuad(t){let r=this.minX,s=this.minY,i=this.maxX,n=this.maxY,o=t[0],a=t[1];r=o<r?o:r,s=a<s?a:s,i=o>i?o:i,n=a>n?a:n,o=t[2],a=t[3],r=o<r?o:r,s=a<s?a:s,i=o>i?o:i,n=a>n?a:n,o=t[4],a=t[5],r=o<r?o:r,s=a<s?a:s,i=o>i?o:i,n=a>n?a:n,o=t[6],a=t[7],r=o<r?o:r,s=a<s?a:s,i=o>i?o:i,n=a>n?a:n,this.minX=r,this.minY=s,this.maxX=i,this.maxY=n}addFrame(t,r,s,i,n){this.addFrameMatrix(t.worldTransform,r,s,i,n)}addFrameMatrix(t,r,s,i,n){const o=t.a,a=t.b,h=t.c,u=t.d,d=t.tx,l=t.ty;let c=this.minX,p=this.minY,f=this.maxX,_=this.maxY,m=o*r+h*s+d,g=a*r+u*s+l;c=m<c?m:c,p=g<p?g:p,f=m>f?m:f,_=g>_?g:_,m=o*i+h*s+d,g=a*i+u*s+l,c=m<c?m:c,p=g<p?g:p,f=m>f?m:f,_=g>_?g:_,m=o*r+h*n+d,g=a*r+u*n+l,c=m<c?m:c,p=g<p?g:p,f=m>f?m:f,_=g>_?g:_,m=o*i+h*n+d,g=a*i+u*n+l,c=m<c?m:c,p=g<p?g:p,f=m>f?m:f,_=g>_?g:_,this.minX=c,this.minY=p,this.maxX=f,this.maxY=_}addVertexData(t,r,s){let i=this.minX,n=this.minY,o=this.maxX,a=this.maxY;for(let h=r;h<s;h+=2){const u=t[h],d=t[h+1];i=u<i?u:i,n=d<n?d:n,o=u>o?u:o,a=d>a?d:a}this.minX=i,this.minY=n,this.maxX=o,this.maxY=a}addVertices(t,r,s,i){this.addVerticesMatrix(t.worldTransform,r,s,i)}addVerticesMatrix(t,r,s,i,n=0,o=n){const a=t.a,h=t.b,u=t.c,d=t.d,l=t.tx,c=t.ty;let p=this.minX,f=this.minY,_=this.maxX,m=this.maxY;for(let g=s;g<i;g+=2){const v=r[g],y=r[g+1],x=a*v+u*y+l,E=d*y+h*v+c;p=Math.min(p,x-n),_=Math.max(_,x+n),f=Math.min(f,E-o),m=Math.max(m,E+o)}this.minX=p,this.minY=f,this.maxX=_,this.maxY=m}addBounds(t){const r=this.minX,s=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<r?t.minX:r,this.minY=t.minY<s?t.minY:s,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,r){const s=t.minX>r.minX?t.minX:r.minX,i=t.minY>r.minY?t.minY:r.minY,n=t.maxX<r.maxX?t.maxX:r.maxX,o=t.maxY<r.maxY?t.maxY:r.maxY;if(s<=n&&i<=o){const a=this.minX,h=this.minY,u=this.maxX,d=this.maxY;this.minX=s<a?s:a,this.minY=i<h?i:h,this.maxX=n>u?n:u,this.maxY=o>d?o:d}}addBoundsMatrix(t,r){this.addFrameMatrix(r,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,r){const s=t.minX>r.x?t.minX:r.x,i=t.minY>r.y?t.minY:r.y,n=t.maxX<r.x+r.width?t.maxX:r.x+r.width,o=t.maxY<r.y+r.height?t.maxY:r.y+r.height;if(s<=n&&i<=o){const a=this.minX,h=this.minY,u=this.maxX,d=this.maxY;this.minX=s<a?s:a,this.minY=i<h?i:h,this.maxX=n>u?n:u,this.maxY=o>d?o:d}}pad(t=0,r=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=r,this.maxY+=r)}addFramePad(t,r,s,i,n,o){t-=n,r-=o,s+=n,i+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>s?this.maxX:s,this.minY=this.minY<r?this.minY:r,this.maxY=this.maxY>i?this.maxY:i}}class mt extends Rn{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Hi,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new va,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const r=Object.keys(t);for(let s=0;s<r.length;++s){const i=r[s];Object.defineProperty(mt.prototype,i,Object.getOwnPropertyDescriptor(t,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,r){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),r||(this._boundsRect||(this._boundsRect=new K),r=this._boundsRect),this._bounds.getRectangle(r)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new K),t=this._localBoundsRect),this._localBounds||(this._localBounds=new va);const r=this.transform,s=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,n=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,t);return this.parent=s,this.transform=r,this._bounds=i,this._bounds.updateID+=this._boundsID-n,o}toGlobal(t,r,s=!1){return s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,r)}toLocal(t,r,s,i){return r&&(t=r.toGlobal(t,s,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,s)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,r=0,s=1,i=1,n=0,o=0,a=0,h=0,u=0){return this.position.x=t,this.position.y=r,this.scale.x=s||1,this.scale.y=i||1,this.rotation=n,this.skew.x=o,this.skew.y=a,this.pivot.x=h,this.pivot.y=u,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Bx),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*Dv}set angle(t){this.transform.rotation=t*Ov}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount--,r._maskRefCount===0&&(r.renderable=!0,r.isMask=!1))}if(this._mask=t,this._mask){const r=this._mask.isMaskData?this._mask.maskObject:this._mask;r&&(r._maskRefCount===0&&(r.renderable=!1,r.isMask=!0),r._maskRefCount++)}}}}class Bx extends mt{constructor(){super(...arguments),this.sortDirty=null}}mt.prototype.displayObjectUpdateTransform=mt.prototype.updateTransform;const Ux=new ut;function Gx(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}const Kl=class extends mt{constructor(){super(),this.children=[],this.sortableChildren=Kl.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{const t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;const r=this.getChildIndex(e),s=this.getChildIndex(t);this.children[r]=t,this.children[s]=e,this.onChildrenChange(r<s?r:s)}getChildIndex(e){const t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const r=this.getChildIndex(e);Ui(this.children,r,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{const t=e[0],r=this.children.indexOf(t);if(r===-1)return null;t.parent=null,t.transform._parentID=-1,Ui(this.children,r,1),this._boundsID++,this.onChildrenChange(r),t.emit("removed",this),this.emit("childRemoved",t,this,r)}return e[0]}removeChildAt(e){const t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,Ui(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){const r=e,s=t,i=s-r;let n;if(i>0&&i<=s){n=this.children.splice(r,i);for(let o=0;o<n.length;++o)n[o].parent=null,n[o].transform&&(n[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let o=0;o<n.length;++o)n[o].emit("removed",this),this.emit("childRemoved",n[o],this,o);return n}else if(i===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,r=this.children.length;t<r;++t){const s=this.children[t];s._lastSortedIndex=t,!e&&s.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(Gx),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){const r=this.children[e];r.visible&&r.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const t=this.children[e];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const r=t._mask.isMaskData?t._mask.maskObject:t._mask;r?(r.calculateBounds(),this._bounds.addBoundsMask(t._bounds,r._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){const r=super.getLocalBounds(e);if(!t)for(let s=0,i=this.children.length;s<i;++s){const n=this.children[s];n.visible&&n.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(e){const t=e.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let r,s;this.cullArea?(r=this.cullArea,s=this.worldTransform):this._render!==Kl.prototype._render&&(r=this.getBounds(!0));const i=e.projection.transform;if(i&&(s?(s=Ux.copyFrom(s),s.prepend(i)):s=i),r&&t.intersects(r,s))this._render(e);else if(this.cullArea)return;for(let n=0,o=this.children.length;n<o;++n){const a=this.children[n],h=a.cullable;a.cullable=h||!this.cullArea,a.render(e),a.cullable=h}}render(e){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let r=0,s=this.children.length;r<s;++r)this.children[r].render(e)}}renderAdvanced(e){var i,n,o;const t=this.filters,r=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let a=0;a<t.length;a++)t[a].enabled&&this._enabledFilters.push(t[a])}const s=t&&((i=this._enabledFilters)==null?void 0:i.length)||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==Nt.NONE));if(s&&e.batch.flush(),t&&((n=this._enabledFilters)!=null&&n.length)&&e.filter.push(this,this._enabledFilters),r&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let a=0,h=this.children.length;a<h;++a)this.children[a].render(e)}s&&e.batch.flush(),r&&e.mask.pop(this),t&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const t=typeof e=="boolean"?e:e==null?void 0:e.children,r=this.removeChildren(0,this.children.length);if(t)for(let s=0;s<r.length;++s)r[s].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const t=this.getLocalBounds().width;t!==0?this.scale.x=e/t:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const t=this.getLocalBounds().height;t!==0?this.scale.y=e/t:this.scale.y=1,this._height=e}};let et=Kl;et.defaultSortableChildren=!1,et.prototype.containerUpdateTransform=et.prototype.updateTransform,Object.defineProperties(F,{SORTABLE_CHILDREN:{get(){return et.defaultSortableChildren},set(e){J("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),et.defaultSortableChildren=e}}});const Xn=new W,Hx=new Uint16Array([0,1,2,0,2,3]);class me extends et{constructor(t){super(),this._anchor=new _s(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new st(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=V.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||U.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=Hx,this.pluginName="batch",this.isSprite=!0,this._roundPixels=F.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=cs(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=cs(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const r=this.transform.worldTransform,s=r.a,i=r.b,n=r.c,o=r.d,a=r.tx,h=r.ty,u=this.vertexData,d=t.trim,l=t.orig,c=this._anchor;let p=0,f=0,_=0,m=0;if(d?(f=d.x-c._x*l.width,p=f+d.width,m=d.y-c._y*l.height,_=m+d.height):(f=-c._x*l.width,p=f+l.width,m=-c._y*l.height,_=m+l.height),u[0]=s*f+n*m+a,u[1]=o*m+i*f+h,u[2]=s*p+n*m+a,u[3]=o*m+i*p+h,u[4]=s*p+n*_+a,u[5]=o*_+i*p+h,u[6]=s*f+n*_+a,u[7]=o*_+i*f+h,this._roundPixels){const g=F.RESOLUTION;for(let v=0;v<u.length;++v)u[v]=Math.round(u[v]*g)/g}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,r=this.vertexTrimmedData,s=t.orig,i=this._anchor,n=this.transform.worldTransform,o=n.a,a=n.b,h=n.c,u=n.d,d=n.tx,l=n.ty,c=-i._x*s.width,p=c+s.width,f=-i._y*s.height,_=f+s.height;r[0]=o*c+h*f+d,r[1]=u*f+a*c+l,r[2]=o*p+h*f+d,r[3]=u*f+a*p+l,r[4]=o*p+h*_+d,r[5]=u*_+a*p+l,r[6]=o*c+h*_+d,r[7]=u*_+a*c+l}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,r=this._texture.orig;!t||t.width===r.width&&t.height===r.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new va),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new K),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Xn);const r=this._texture.orig.width,s=this._texture.orig.height,i=-r*this.anchor.x;let n=0;return Xn.x>=i&&Xn.x<i+r&&(n=-s*this.anchor.y,Xn.y>=n&&Xn.y<n+s)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const r=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!r)}this._texture=null}static from(t,r){const s=t instanceof U?t:U.from(t,r);return new me(s)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const r=cs(this.scale.x)||1;this.scale.x=r*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const r=cs(this.scale.y)||1;this.scale.y=r*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||U.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}class zx{constructor(t,r){this.uvBuffer=t,this.uvMatrix=r,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const r=this.uvBuffer.data;(!this.data||this.data.length!==r.length)&&(this.data=new Float32Array(r.length)),this.uvMatrix.multiplyUvs(r,this.data),this._updateID++}}const Zl=new W,Yf=new Wr,$f=class extends et{constructor(e,t,r,s=Qe.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=r||qs.for2d(),this.drawMode=s,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=F.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Qe.TRIANGLES&&t.length<$f.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const t=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;const s=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[s]),e.plugins[s].render(this)}calculateVertices(){const e=this.geometry.buffers[0],t=e.data,r=e._updateID;if(r===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));const s=this.transform.worldTransform,i=s.a,n=s.b,o=s.c,a=s.d,h=s.tx,u=s.ty,d=this.vertexData;for(let l=0;l<d.length/2;l++){const c=t[l*2],p=t[l*2+1];d[l*2]=i*c+o*p+h,d[l*2+1]=n*c+a*p+u}if(this._roundPixels){const l=F.RESOLUTION;for(let c=0;c<d.length;++c)d[c]=Math.round(d[c]*l)/l}this.vertexDirty=r}calculateUvs(){const e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new zx(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,Zl);const t=this.geometry.getBuffer("aVertexPosition").data,r=Yf.points,s=this.geometry.getIndex().data,i=s.length,n=this.drawMode===4?3:1;for(let o=0;o+2<i;o+=n){const a=s[o]*2,h=s[o+1]*2,u=s[o+2]*2;if(r[0]=t[a],r[1]=t[a+1],r[2]=t[h],r[3]=t[h+1],r[4]=t[u],r[5]=t[u+1],Yf.contains(Zl.x,Zl.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let ii=$f;ii.BATCHABLE_SIZE=100;class xa extends fs{constructor(t,r,s){super();const i=new Ct(t),n=new Ct(r,!0),o=new Ct(s,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,X.FLOAT).addAttribute("aTextureCoord",n,2,!1,X.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var Vx=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,Xx=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class Wn extends Cr{constructor(t,r){const s={uSampler:t,alpha:1,uTextureMatrix:ut.IDENTITY,uColor:new Float32Array([1,1,1,1])};r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r),r.uniforms&&Object.assign(s,r.uniforms),super(r.program||sr.from(Xx,Vx),s),this._colorDirty=!1,this.uvMatrix=new Vl(t),this.batchable=r.program===void 0,this.pluginName=r.pluginName,this._tintColor=new st(r.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=r.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture.alphaMode;st.shared.setValue(this._tintColor).premultiply(this._alpha,t).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class Wx extends xa{constructor(t=100,r=100,s=10,i=10){super(),this.segWidth=s,this.segHeight=i,this.width=t,this.height=r,this.build()}build(){const t=this.segWidth*this.segHeight,r=[],s=[],i=[],n=this.segWidth-1,o=this.segHeight-1,a=this.width/n,h=this.height/o;for(let d=0;d<t;d++){const l=d%this.segWidth,c=d/this.segWidth|0;r.push(l*a,c*h),s.push(l/n,c/o)}const u=n*o;for(let d=0;d<u;d++){const l=d%n,c=d/n|0,p=c*this.segWidth+l,f=c*this.segWidth+l+1,_=(c+1)*this.segWidth+l,m=(c+1)*this.segWidth+l+1;i.push(p,f,_,f,m,_)}this.buffers[0].data=new Float32Array(r),this.buffers[1].data=new Float32Array(s),this.indexBuffer.data=new Uint16Array(i),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class jx extends xa{constructor(t=200,r,s=0){super(new Float32Array(r.length*4),new Float32Array(r.length*4),new Uint16Array((r.length-1)*6)),this.points=r,this._width=t,this.textureScale=s,this.build()}get width(){return this._width}build(){const t=this.points;if(!t)return;const r=this.getBuffer("aVertexPosition"),s=this.getBuffer("aTextureCoord"),i=this.getIndex();if(t.length<1)return;r.data.length/4!==t.length&&(r.data=new Float32Array(t.length*4),s.data=new Float32Array(t.length*4),i.data=new Uint16Array((t.length-1)*6));const n=s.data,o=i.data;n[0]=0,n[1]=0,n[2]=0,n[3]=1;let a=0,h=t[0];const u=this._width*this.textureScale,d=t.length;for(let c=0;c<d;c++){const p=c*4;if(this.textureScale>0){const f=h.x-t[c].x,_=h.y-t[c].y,m=Math.sqrt(f*f+_*_);h=t[c],a+=m/u}else a=c/(d-1);n[p]=a,n[p+1]=0,n[p+2]=a,n[p+3]=1}let l=0;for(let c=0;c<d-1;c++){const p=c*2;o[l++]=p,o[l++]=p+1,o[l++]=p+2,o[l++]=p+2,o[l++]=p+1,o[l++]=p+3}s.update(),i.update(),this.updateVertices()}updateVertices(){const t=this.points;if(t.length<1)return;let r=t[0],s,i=0,n=0;const o=this.buffers[0].data,a=t.length,h=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let u=0;u<a;u++){const d=t[u],l=u*4;u<t.length-1?s=t[u+1]:s=d,n=-(s.x-r.x),i=s.y-r.y;const c=Math.sqrt(i*i+n*n);c<1e-6?(i=0,n=0):(i/=c,n/=c,i*=h,n*=h),o[l]=d.x+i,o[l+1]=d.y+n,o[l+2]=d.x-i,o[l+3]=d.y-n,r=d}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}class Yx extends ii{constructor(t,r,s){const i=new Wx(t.width,t.height,r,s),n=new Wn(U.WHITE);super(i,n),this.texture=t,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const t=this.geometry,{width:r,height:s}=this.shader.texture;this.autoResize&&(t.width!==r||t.height!==s)&&(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())}set texture(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(t)}destroy(t){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(t)}}class qf extends ii{constructor(t=U.EMPTY,r,s,i,n){const o=new xa(r,s,i);o.getBuffer("aVertexPosition").static=!1;const a=new Wn(t);super(o,a,null,n),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}}class $x extends ii{constructor(t,r,s=0){const i=new jx(t.height,r,s),n=new Wn(t);s>0&&(t.baseTexture.wrapMode=zr.REPEAT),super(i,n),this.autoUpdate=!0}_render(t){const r=this.geometry;(this.autoUpdate||r._width!==this.shader.texture.height)&&(r._width=this.shader.texture.height,r.update()),super._render(t)}}const ba={build(e){const t=e.points;let r,s,i,n,o,a;if(e.type===$t.CIRC){const f=e.shape;r=f.x,s=f.y,o=a=f.radius,i=n=0}else if(e.type===$t.ELIP){const f=e.shape;r=f.x,s=f.y,o=f.width,a=f.height,i=n=0}else{const f=e.shape,_=f.width/2,m=f.height/2;r=f.x+_,s=f.y+m,o=a=Math.max(0,Math.min(f.radius,Math.min(_,m))),i=_-o,n=m-a}if(!(o>=0&&a>=0&&i>=0&&n>=0)){t.length=0;return}const h=Math.ceil(2.3*Math.sqrt(o+a)),u=h*8+(i?4:0)+(n?4:0);if(t.length=u,u===0)return;if(h===0){t.length=8,t[0]=t[6]=r+i,t[1]=t[3]=s+n,t[2]=t[4]=r-i,t[5]=t[7]=s-n;return}let d=0,l=h*4+(i?2:0)+2,c=l,p=u;{const f=i+o,_=n,m=r+f,g=r-f,v=s+_;if(t[d++]=m,t[d++]=v,t[--l]=v,t[--l]=g,n){const y=s-_;t[c++]=g,t[c++]=y,t[--p]=y,t[--p]=m}}for(let f=1;f<h;f++){const _=Math.PI/2*(f/h),m=i+Math.cos(_)*o,g=n+Math.sin(_)*a,v=r+m,y=r-m,x=s+g,E=s-g;t[d++]=v,t[d++]=x,t[--l]=x,t[--l]=y,t[c++]=y,t[c++]=E,t[--p]=E,t[--p]=v}{const f=i,_=n+a,m=r+f,g=r-f,v=s+_,y=s-_;t[d++]=m,t[d++]=v,t[--p]=y,t[--p]=m,i&&(t[d++]=g,t[d++]=v,t[--p]=y,t[--p]=g)}},triangulate(e,t){const r=e.points,s=t.points,i=t.indices;if(r.length===0)return;let n=s.length/2;const o=n;let a,h;if(e.type!==$t.RREC){const d=e.shape;a=d.x,h=d.y}else{const d=e.shape;a=d.x+d.width/2,h=d.y+d.height/2}const u=e.matrix;s.push(e.matrix?u.a*a+u.c*h+u.tx:a,e.matrix?u.b*a+u.d*h+u.ty:h),n++,s.push(r[0],r[1]);for(let d=2;d<r.length;d+=2)s.push(r[d],r[d+1]),i.push(n++,o,n);i.push(o+1,o,n)}};function Kf(e,t=!1){const r=e.length;if(r<6)return;let s=0;for(let i=0,n=e[r-2],o=e[r-1];i<r;i+=2){const a=e[i],h=e[i+1];s+=(a-n)*(h+o),n=a,o=h}if(!t&&s>0||t&&s<=0){const i=r/2;for(let n=i+i%2;n<r;n+=2){const o=r-n-2,a=r-n-1,h=n,u=n+1;[e[o],e[h]]=[e[h],e[o]],[e[a],e[u]]=[e[u],e[a]]}}}const Zf={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let r=e.points;const s=e.holes,i=t.points,n=t.indices;if(r.length>=6){Kf(r,!1);const o=[];for(let u=0;u<s.length;u++){const d=s[u];Kf(d.points,!0),o.push(r.length/2),r=r.concat(d.points)}const a=Ny(r,o,2);if(!a)return;const h=i.length/2;for(let u=0;u<a.length;u+=3)n.push(a[u]+h),n.push(a[u+1]+h),n.push(a[u+2]+h);for(let u=0;u<r.length;u++)i.push(r[u])}}},qx={build(e){const t=e.shape,r=t.x,s=t.y,i=t.width,n=t.height,o=e.points;o.length=0,i>=0&&n>=0&&o.push(r,s,r+i,s,r+i,s+n,r,s+n)},triangulate(e,t){const r=e.points,s=t.points;if(r.length===0)return;const i=s.length/2;s.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),t.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},Kx={build(e){ba.build(e)},triangulate(e,t){ba.triangulate(e,t)}};var hr=(e=>(e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e))(hr||{}),ni=(e=>(e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e))(ni||{});const Yi={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let r=Math.ceil(e/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};class Qf{static curveTo(t,r,s,i,n,o){const a=o[o.length-2],h=o[o.length-1]-r,u=a-t,d=i-r,l=s-t,c=Math.abs(h*l-u*d);if(c<1e-8||n===0)return(o[o.length-2]!==t||o[o.length-1]!==r)&&o.push(t,r),null;const p=h*h+u*u,f=d*d+l*l,_=h*d+u*l,m=n*Math.sqrt(p)/c,g=n*Math.sqrt(f)/c,v=m*_/p,y=g*_/f,x=m*l+g*u,E=m*d+g*h,T=u*(g+v),w=h*(g+v),b=l*(m+y),A=d*(m+y),R=Math.atan2(w-E,T-x),S=Math.atan2(A-E,b-x);return{cx:x+t,cy:E+r,radius:n,startAngle:R,endAngle:S,anticlockwise:u*d>l*h}}static arc(t,r,s,i,n,o,a,h,u){const d=a-o,l=Yi._segmentsCount(Math.abs(d)*n,Math.ceil(Math.abs(d)/Jo)*40),c=d/(l*2),p=c*2,f=Math.cos(c),_=Math.sin(c),m=l-1,g=m%1/m;for(let v=0;v<=m;++v){const y=v+g*v,x=c+o+p*y,E=Math.cos(x),T=-Math.sin(x);u.push((f*E+_*T)*n+s,(f*-T+_*E)*n+i)}}}class Zx{constructor(){this.reset()}begin(t,r,s){this.reset(),this.style=t,this.start=r,this.attribStart=s}end(t,r){this.attribSize=r-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Ql{static curveLength(t,r,s,i,n,o,a,h){let u=0,d=0,l=0,c=0,p=0,f=0,_=0,m=0,g=0,v=0,y=0,x=t,E=r;for(let T=1;T<=10;++T)d=T/10,l=d*d,c=l*d,p=1-d,f=p*p,_=f*p,m=_*t+3*f*d*s+3*p*l*n+c*a,g=_*r+3*f*d*i+3*p*l*o+c*h,v=x-m,y=E-g,x=m,E=g,u+=Math.sqrt(v*v+y*y);return u}static curveTo(t,r,s,i,n,o,a){const h=a[a.length-2],u=a[a.length-1];a.length-=2;const d=Yi._segmentsCount(Ql.curveLength(h,u,t,r,s,i,n,o));let l=0,c=0,p=0,f=0,_=0;a.push(h,u);for(let m=1,g=0;m<=d;++m)g=m/d,l=1-g,c=l*l,p=c*l,f=g*g,_=f*g,a.push(p*h+3*c*g*t+3*l*f*s+_*n,p*u+3*c*g*r+3*l*f*i+_*o)}}function Jf(e,t,r,s,i,n,o,a){const h=e-r*i,u=t-s*i,d=e+r*n,l=t+s*n;let c,p;o?(c=s,p=-r):(c=-s,p=r);const f=h+c,_=u+p,m=d+c,g=l+p;return a.push(f,_,m,g),2}function oi(e,t,r,s,i,n,o,a){const h=r-e,u=s-t;let d=Math.atan2(h,u),l=Math.atan2(i-e,n-t);a&&d<l?d+=Math.PI*2:!a&&d>l&&(l+=Math.PI*2);let c=d;const p=l-d,f=Math.abs(p),_=Math.sqrt(h*h+u*u),m=(15*f*Math.sqrt(_)/Math.PI>>0)+1,g=p/m;if(c+=g,a){o.push(e,t,r,s);for(let v=1,y=c;v<m;v++,y+=g)o.push(e,t,e+Math.sin(y)*_,t+Math.cos(y)*_);o.push(e,t,i,n)}else{o.push(r,s,e,t);for(let v=1,y=c;v<m;v++,y+=g)o.push(e+Math.sin(y)*_,t+Math.cos(y)*_,e,t);o.push(i,n,e,t)}return m*2}function Qx(e,t){const r=e.shape;let s=e.points||r.points.slice();const i=t.closePointEps;if(s.length===0)return;const n=e.lineStyle,o=new W(s[0],s[1]),a=new W(s[s.length-2],s[s.length-1]),h=r.type!==$t.POLY||r.closeStroke,u=Math.abs(o.x-a.x)<i&&Math.abs(o.y-a.y)<i;if(h){s=s.slice(),u&&(s.pop(),s.pop(),a.set(s[s.length-2],s[s.length-1]));const D=(o.x+a.x)*.5,Y=(a.y+o.y)*.5;s.unshift(D,Y),s.push(D,Y)}const d=t.points,l=s.length/2;let c=s.length;const p=d.length/2,f=n.width/2,_=f*f,m=n.miterLimit*n.miterLimit;let g=s[0],v=s[1],y=s[2],x=s[3],E=0,T=0,w=-(v-x),b=g-y,A=0,R=0,S=Math.sqrt(w*w+b*b);w/=S,b/=S,w*=f,b*=f;const M=n.alignment,I=(1-M)*2,C=M*2;h||(n.cap===ni.ROUND?c+=oi(g-w*(I-C)*.5,v-b*(I-C)*.5,g-w*I,v-b*I,g+w*C,v+b*C,d,!0)+2:n.cap===ni.SQUARE&&(c+=Jf(g,v,w,b,I,C,!0,d))),d.push(g-w*I,v-b*I,g+w*C,v+b*C);for(let D=1;D<l-1;++D){g=s[(D-1)*2],v=s[(D-1)*2+1],y=s[D*2],x=s[D*2+1],E=s[(D+1)*2],T=s[(D+1)*2+1],w=-(v-x),b=g-y,S=Math.sqrt(w*w+b*b),w/=S,b/=S,w*=f,b*=f,A=-(x-T),R=y-E,S=Math.sqrt(A*A+R*R),A/=S,R/=S,A*=f,R*=f;const Y=y-g,Z=v-x,P=y-E,G=T-x,Q=Y*P+Z*G,j=Z*P-G*Y,q=j<0;if(Math.abs(j)<.001*Math.abs(Q)){d.push(y-w*I,x-b*I,y+w*C,x+b*C),Q>=0&&(n.join===hr.ROUND?c+=oi(y,x,y-w*I,x-b*I,y-A*I,x-R*I,d,!1)+4:c+=2,d.push(y-A*C,x-R*C,y+A*I,x+R*I));continue}const Wt=(-w+g)*(-b+x)-(-w+y)*(-b+v),Ot=(-A+E)*(-R+x)-(-A+y)*(-R+T),jt=(Y*Ot-P*Wt)/j,he=(G*Wt-Z*Ot)/j,Ne=(jt-y)*(jt-y)+(he-x)*(he-x),Qt=y+(jt-y)*I,ct=x+(he-x)*I,kt=y-(jt-y)*C,Lt=x-(he-x)*C,Nr=Math.min(Y*Y+Z*Z,P*P+G*G),Lr=q?I:C,Ao=Nr+Lr*Lr*_,BA=Ne<=Ao;let vh=n.join;if(vh===hr.MITER&&Ne/_>m&&(vh=hr.BEVEL),BA)switch(vh){case hr.MITER:{d.push(Qt,ct,kt,Lt);break}case hr.BEVEL:{q?d.push(Qt,ct,y+w*C,x+b*C,Qt,ct,y+A*C,x+R*C):d.push(y-w*I,x-b*I,kt,Lt,y-A*I,x-R*I,kt,Lt),c+=2;break}case hr.ROUND:{q?(d.push(Qt,ct,y+w*C,x+b*C),c+=oi(y,x,y+w*C,x+b*C,y+A*C,x+R*C,d,!0)+4,d.push(Qt,ct,y+A*C,x+R*C)):(d.push(y-w*I,x-b*I,kt,Lt),c+=oi(y,x,y-w*I,x-b*I,y-A*I,x-R*I,d,!1)+4,d.push(y-A*I,x-R*I,kt,Lt));break}}else{switch(d.push(y-w*I,x-b*I,y+w*C,x+b*C),vh){case hr.MITER:{q?d.push(kt,Lt,kt,Lt):d.push(Qt,ct,Qt,ct),c+=2;break}case hr.ROUND:{q?c+=oi(y,x,y+w*C,x+b*C,y+A*C,x+R*C,d,!0)+2:c+=oi(y,x,y-w*I,x-b*I,y-A*I,x-R*I,d,!1)+2;break}}d.push(y-A*I,x-R*I,y+A*C,x+R*C),c+=2}}g=s[(l-2)*2],v=s[(l-2)*2+1],y=s[(l-1)*2],x=s[(l-1)*2+1],w=-(v-x),b=g-y,S=Math.sqrt(w*w+b*b),w/=S,b/=S,w*=f,b*=f,d.push(y-w*I,x-b*I,y+w*C,x+b*C),h||(n.cap===ni.ROUND?c+=oi(y-w*(I-C)*.5,x-b*(I-C)*.5,y-w*I,x-b*I,y+w*C,x+b*C,d,!1)+2:n.cap===ni.SQUARE&&(c+=Jf(y,x,w,b,I,C,!1,d)));const O=t.indices,L=Yi.epsilon*Yi.epsilon;for(let D=p;D<c+p-2;++D)g=d[D*2],v=d[D*2+1],y=d[(D+1)*2],x=d[(D+1)*2+1],E=d[(D+2)*2],T=d[(D+2)*2+1],!(Math.abs(g*(x-T)+y*(T-v)+E*(v-x))<L)&&O.push(D,D+1,D+2)}function Jx(e,t){let r=0;const s=e.shape,i=e.points||s.points,n=s.type!==$t.POLY||s.closeStroke;if(i.length===0)return;const o=t.points,a=t.indices,h=i.length/2,u=o.length/2;let d=u;for(o.push(i[0],i[1]),r=1;r<h;r++)o.push(i[r*2],i[r*2+1]),a.push(d,d+1),d++;n&&a.push(d,u)}function t_(e,t){e.lineStyle.native?Jx(e,t):Qx(e,t)}class Jl{static curveLength(t,r,s,i,n,o){const a=t-2*s+n,h=r-2*i+o,u=2*s-2*t,d=2*i-2*r,l=4*(a*a+h*h),c=4*(a*u+h*d),p=u*u+d*d,f=2*Math.sqrt(l+c+p),_=Math.sqrt(l),m=2*l*_,g=2*Math.sqrt(p),v=c/_;return(m*f+_*c*(f-g)+(4*p*l-c*c)*Math.log((2*_+v+f)/(v+g)))/(4*m)}static curveTo(t,r,s,i,n){const o=n[n.length-2],a=n[n.length-1],h=Yi._segmentsCount(Jl.curveLength(o,a,t,r,s,i));let u=0,d=0;for(let l=1;l<=h;++l){const c=l/h;u=o+(t-o)*c,d=a+(r-a)*c,n.push(u+(t+(s-t)*c-u)*c,d+(r+(i-r)*c-d)*c)}}}const tu={[$t.POLY]:Zf,[$t.CIRC]:ba,[$t.ELIP]:ba,[$t.RECT]:qx,[$t.RREC]:Kx},e_=[],Ta=[];class Ea{constructor(t,r=null,s=null,i=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=s,this.fillStyle=r,this.matrix=i,this.type=t.type}clone(){return new Ea(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const $i=new W,r_=class extends Jp{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new va,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Ta.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t.reset(),e_.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,r=null,s=null){const i=new Ea(e,t,r,s);return this.graphicsData.push(i),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;const r=new Ea(e,null,null,t),s=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=s.lineStyle,s.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const t=this.graphicsData;for(let r=0;r<t.length;++r){const s=t[r];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(e,$i):$i.copyFrom(e),s.shape.contains($i.x,$i.y))){let i=!1;if(s.holes){for(let n=0;n<s.holes.length;n++)if(s.holes[n].shape.contains($i.x,$i.y)){i=!0;break}}if(!i)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,t=this.graphicsData;let r=null,s=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],s=r.style);for(let a=this.shapeIndex;a<t.length;a++){this.shapeIndex++;const h=t[a],u=h.fillStyle,d=h.lineStyle;tu[h.type].build(h),h.matrix&&this.transformPoints(h.points,h.matrix),(u.visible||d.visible)&&this.processHoles(h.holes);for(let l=0;l<2;l++){const c=l===0?u:d;if(!c.visible)continue;const p=c.texture.baseTexture,f=this.indices.length,_=this.points.length/2;p.wrapMode=zr.REPEAT,l===0?this.processFill(h):this.processLine(h);const m=this.points.length/2-_;m!==0&&(r&&!this._compareStyles(s,c)&&(r.end(f,_),r=null),r||(r=e_.pop()||new Zx,r.begin(c,f,_),this.batches.push(r),s=c),this.addUvs(this.points,e,c.texture,_,m,c.matrix))}}const i=this.indices.length,n=this.points.length/2;if(r&&r.end(i,n),this.batches.length===0){this.batchable=!0;return}const o=n>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&o===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=o?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){const r=this.graphicsData[e],s=r.fillStyle,i=r.lineStyle;if(s&&!s.texture.baseTexture.valid||i&&!i.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let t=0,r=e.length;t<r;t++){const s=e[t];for(let i=0;i<s.size;i++){const n=s.start+i;this.indicesUint16[n]=this.indicesUint16[n]-s.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<r_.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++$._globalBatch;for(let d=0;d<this.drawCalls.length;d++)this.drawCalls[d].texArray.clear(),Ta.push(this.drawCalls[d]);this.drawCalls.length=0;const t=this.colors,r=this.textureIds;let s=Ta.pop();s||(s=new Ll,s.texArray=new Ul),s.texArray.count=0,s.start=0,s.size=0,s.type=Qe.TRIANGLES;let i=0,n=null,o=0,a=!1,h=Qe.TRIANGLES,u=0;this.drawCalls.push(s);for(let d=0;d<this.batches.length;d++){const l=this.batches[d],c=8,p=l.style,f=p.texture.baseTexture;a!==!!p.native&&(a=!!p.native,h=a?Qe.LINES:Qe.TRIANGLES,n=null,i=c,e++),n!==f&&(n=f,f._batchEnabled!==e&&(i===c&&(e++,i=0,s.size>0&&(s=Ta.pop(),s||(s=new Ll,s.texArray=new Ul),this.drawCalls.push(s)),s.start=u,s.size=0,s.texArray.count=0,s.type=h),f.touched=1,f._batchEnabled=e,f._batchLocation=i,f.wrapMode=zr.REPEAT,s.texArray.elements[s.texArray.count++]=f,i++)),s.size+=l.size,u+=l.size,o=f._batchLocation,this.addColors(t,p.color,p.alpha,l.attribSize,l.attribStart),this.addTextureIds(r,o,l.attribSize,l.attribStart)}$._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,t=this.uvs,r=this.colors,s=this.textureIds,i=new ArrayBuffer(e.length*3*4),n=new Float32Array(i),o=new Uint32Array(i);let a=0;for(let h=0;h<e.length/2;h++)n[a++]=e[h*2],n[a++]=e[h*2+1],n[a++]=t[h*2],n[a++]=t[h*2+1],o[a++]=r[h],n[a++]=s[h];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?Zf.triangulate(e,this):tu[e.type].triangulate(e,this)}processLine(e){t_(e,this);for(let t=0;t<e.holes.length;t++)t_(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){const r=e[t];tu[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let r=0;r<e.length/2;r++){const s=e[r*2],i=e[r*2+1];e[r*2]=t.a*s+t.c*i+t.tx,e[r*2+1]=t.b*s+t.d*i+t.ty}}addColors(e,t,r,s,i=0){const n=st.shared.setValue(t).toLittleEndianNumber(),o=st.shared.setValue(n).toPremultiplied(r);e.length=Math.max(e.length,i+s);for(let a=0;a<s;a++)e[i+a]=o}addTextureIds(e,t,r,s=0){e.length=Math.max(e.length,s+r);for(let i=0;i<r;i++)e[s+i]=t}addUvs(e,t,r,s,i,n=null){let o=0;const a=t.length,h=r.frame;for(;o<i;){let d=e[(s+o)*2],l=e[(s+o)*2+1];if(n){const c=n.a*d+n.c*l+n.tx;l=n.b*d+n.d*l+n.ty,d=c}o++,t.push(d/h.width,l/h.height)}const u=r.baseTexture;(h.width<u.width||h.height<u.height)&&this.adjustUvs(t,r,a,i)}adjustUvs(e,t,r,s){const i=t.baseTexture,n=1e-6,o=r+s*2,a=t.frame,h=a.width/i.width,u=a.height/i.height;let d=a.x/a.width,l=a.y/a.height,c=Math.floor(e[r]+n),p=Math.floor(e[r+1]+n);for(let f=r+2;f<o;f+=2)c=Math.min(c,Math.floor(e[f]+n)),p=Math.min(p,Math.floor(e[f+1]+n));d-=c,l-=p;for(let f=r;f<o;f+=2)e[f]=(e[f]+d)*h,e[f+1]=(e[f+1]+l)*u}};let s_=r_;s_.BATCHABLE_SIZE=100;class wa{constructor(){this.color=16777215,this.alpha=1,this.texture=U.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new wa;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=U.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class eu extends wa{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=ni.BUTT,this.join=hr.MITER,this.miterLimit=10}clone(){const t=new eu;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const ru={},Aa=class extends et{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new wa,this._lineStyle=new eu,this._matrix=null,this._holeMode=!1,this.state=qs.for2d(),this._geometry=e||new s_,this._geometry.refCount++,this._transformID=-1,this._tintColor=new st(16777215),this.blendMode=V.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Aa(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,r,s=.5,i=!1){return typeof e=="number"&&(e={width:e,color:t,alpha:r,alignment:s,native:i}),this.lineTextureStyle(e)}lineTextureStyle(e){const t={width:0,texture:U.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:ni.BUTT,join:hr.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const r=e.width>0&&e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:r},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Wr,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new Wr,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);const r=this.currentPath.points,s=r[r.length-2],i=r[r.length-1];return(s!==e||i!==t)&&r.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,r,s){this._initCurve();const i=this.currentPath.points;return i.length===0&&this.moveTo(0,0),Jl.curveTo(e,t,r,s,i),this}bezierCurveTo(e,t,r,s,i,n){return this._initCurve(),Ql.curveTo(e,t,r,s,i,n,this.currentPath.points),this}arcTo(e,t,r,s,i){this._initCurve(e,t);const n=this.currentPath.points,o=Qf.curveTo(e,t,r,s,i,n);if(o){const{cx:a,cy:h,radius:u,startAngle:d,endAngle:l,anticlockwise:c}=o;this.arc(a,h,u,d,l,c)}return this}arc(e,t,r,s,i,n=!1){if(s===i)return this;if(!n&&i<=s?i+=Jo:n&&s<=i&&(s+=Jo),i-s===0)return this;const o=e+Math.cos(s)*r,a=t+Math.sin(s)*r,h=this._geometry.closePointEps;let u=this.currentPath?this.currentPath.points:null;if(u){const d=Math.abs(u[u.length-2]-o),l=Math.abs(u[u.length-1]-a);d<h&&l<h||u.push(o,a)}else this.moveTo(o,a),u=this.currentPath.points;return Qf.arc(o,a,e,t,r,s,i,n,u),this}beginFill(e=0,t){return this.beginTextureFill({texture:U.WHITE,color:e,alpha:t})}normalizeColor(e){const t=st.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){const t={texture:U.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const r=e.alpha>0;return r?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:r},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,r,s){return this.drawShape(new K(e,t,r,s))}drawRoundedRect(e,t,r,s,i){return this.drawShape(new sa(e,t,r,s,i))}drawCircle(e,t,r){return this.drawShape(new ea(e,t,r))}drawEllipse(e,t,r,s){return this.drawShape(new ra(e,t,r,s))}drawPolygon(...e){let t,r=!0;const s=e[0];s.points?(r=s.closeStroke,t=s.points):Array.isArray(e[0])?t=e[0]:t=e;const i=new Wr(t);return i.closeStroke=r,this.drawShape(i),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===$t.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,t=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(let s=0;s<r;s++){const i=e.batches[s],n=i.style.color,o=new Float32Array(this.vertexData.buffer,i.attribStart*4*2,i.attribSize*2),a=new Float32Array(e.uvsFloat32.buffer,i.attribStart*4*2,i.attribSize*2),h=new Uint16Array(e.indicesUint16.buffer,i.start*2,i.size),u={vertexData:o,blendMode:t,indices:h,uvs:a,_batchRGB:st.shared.setValue(n).toRgbArray(),_tintRGB:n,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[s]=u}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,r=this.batches.length;t<r;t++){const s=this.batches[t];s.worldAlpha=this.worldAlpha*s.alpha,e.plugins[this.pluginName].render(s)}}}_renderDirect(e){const t=this._resolveDirectShader(e),r=this._geometry,s=this.worldAlpha,i=t.uniforms,n=r.drawCalls;i.translationMatrix=this.transform.worldTransform,st.shared.setValue(this._tintColor).premultiply(s).toArray(i.tint),e.shader.bind(t),e.geometry.bind(r,t),e.state.set(this.state);for(let o=0,a=n.length;o<a;o++)this._renderDrawCallDirect(e,r.drawCalls[o])}_renderDrawCallDirect(e,t){const{texArray:r,type:s,size:i,start:n}=t,o=r.count;for(let a=0;a<o;a++)e.texture.bind(r.elements[a],a);e.geometry.draw(s,i,n)}_resolveDirectShader(e){let t=this.shader;const r=this.pluginName;if(!t){if(!ru[r]){const{maxTextures:s}=e.plugins[r],i=new Int32Array(s);for(let a=0;a<s;a++)i[a]=a;const n={tint:new Float32Array([1,1,1,1]),translationMatrix:new ut,default:ir.from({uSamplers:i},!0)},o=e.plugins[r]._shader.program;ru[r]=new Cr(o,n)}t=ru[r]}return t}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:t,minY:r,maxX:s,maxY:i}=e.bounds;this._bounds.addFrame(this.transform,t,r,s,i)}containsPoint(e){return this.worldTransform.applyInverse(e,Aa._TEMP_POINT),this._geometry.containsPoint(Aa._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t._tintRGB=st.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const t=this.transform.worldTransform,r=t.a,s=t.b,i=t.c,n=t.d,o=t.tx,a=t.ty,h=this._geometry.points,u=this.vertexData;let d=0;for(let l=0;l<h.length;l+=2){const c=h[l],p=h[l+1];u[d++]=r*c+i*p+o,u[d++]=n*p+s*c+a}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};let Ie=Aa;Ie.curves=Yi,Ie._TEMP_POINT=new W;const gs=[0,0,0];class tb extends me{constructor(){super(...arguments),this.region=null,this.attachment=null}}class eb extends qf{constructor(t,r,s,i,n){super(t,r,s,i,n),this.region=null,this.attachment=null}}const i_=class extends et{constructor(e){if(super(),!e)throw new Error("The spineData param is required.");if(typeof e=="string")throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');this.spineData=e,this.createSkeleton(e),this.slotContainers=[],this.tempClipContainers=[];for(let t=0,r=this.skeleton.slots.length;t<r;t++){const s=this.skeleton.slots[t],i=s.getAttachment(),n=this.newContainer();if(this.slotContainers.push(n),this.addChild(n),this.tempClipContainers.push(null),!!i)if(i.type===Ws.Region){const o=i.name,a=this.createSprite(s,i,o);s.currentSprite=a,s.currentSpriteName=o,n.addChild(a)}else if(i.type===Ws.Mesh){const o=this.createMesh(s,i);s.currentMesh=o,s.currentMeshId=i.id,s.currentMeshName=i.name,n.addChild(o)}else i.type===Ws.Clipping&&(this.createGraphics(s,i),n.addChild(s.clippingContainer),n.addChild(s.currentGraphics))}this.tintRgb=new Float32Array([1,1,1]),this.autoUpdate=!0,this.visible=!0}get debug(){return this._debug}set debug(e){var t;e!=this._debug&&((t=this._debug)==null||t.unregisterSpine(this),e==null||e.registerSpine(this),this._debug=e)}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this.updateTransform=e?i_.prototype.autoUpdateTransform:et.prototype.updateTransform)}get tint(){return Bi(this.tintRgb)}set tint(e){this.tintRgb=Up(e,this.tintRgb)}get delayLimit(){return(typeof this.localDelayLimit<"u"?this.localDelayLimit:Fx.GLOBAL_DELAY_LIMIT)||Number.MAX_VALUE}update(e){var u;const t=this.delayLimit;if(e>t&&(e=t),this.state.update(e),this.state.apply(this.skeleton),!this.skeleton)return;this.skeleton.updateWorldTransform();const r=this.skeleton.slots,s=this.color;let i=null,n=null;s?(i=s.light,n=s.dark):i=this.tintRgb;for(let d=0,l=r.length;d<l;d++){const c=r[d],p=c.getAttachment(),f=this.slotContainers[d];if(!p){f.visible=!1;continue}let _=null;p.sequence&&p.sequence.apply(c,p);let m=p.region;const g=p.color;switch(p!=null&&p.type){case Ws.Region:if(f.transform.setFromMatrix(c.bone.matrix),m=p.region,c.currentMesh&&(c.currentMesh.visible=!1,c.currentMesh=null,c.currentMeshId=void 0,c.currentMeshName=void 0),!m){c.currentSprite&&(c.currentSprite.renderable=!1);break}if(!c.currentSpriteName||c.currentSpriteName!==p.name){const y=p.name;if(c.currentSprite&&(c.currentSprite.visible=!1),c.sprites=c.sprites||{},c.sprites[y]!==void 0)c.sprites[y].visible=!0;else{const x=this.createSprite(c,p,y);f.addChild(x)}c.currentSprite=c.sprites[y],c.currentSpriteName=y}c.currentSprite.renderable=!0,c.hackRegion||this.setSpriteRegion(p,c.currentSprite,m),c.currentSprite.color?_=c.currentSprite.color:(gs[0]=i[0]*c.color.r*g.r,gs[1]=i[1]*c.color.g*g.g,gs[2]=i[2]*c.color.b*g.b,c.currentSprite.tint=Bi(gs)),c.currentSprite.blendMode=c.blendMode;break;case Ws.Mesh:if(c.currentSprite){c.currentSprite.visible=!1,c.currentSprite=null,c.currentSpriteName=void 0;const y=new Hi;y._parentID=-1,y._worldID=f.transform._worldID,f.transform=y}if(!m){c.currentMesh&&(c.currentMesh.renderable=!1);break}const v=p.id;if(c.currentMeshId===void 0||c.currentMeshId!==v){const y=v;if(c.currentMesh&&(c.currentMesh.visible=!1),c.meshes=c.meshes||{},c.meshes[y]!==void 0)c.meshes[y].visible=!0;else{const x=this.createMesh(c,p);f.addChild(x)}c.currentMesh=c.meshes[y],c.currentMeshName=p.name,c.currentMeshId=y}c.currentMesh.renderable=!0,p.computeWorldVerticesOld(c,c.currentMesh.vertices),c.currentMesh.color?_=c.currentMesh.color:(gs[0]=i[0]*c.color.r*g.r,gs[1]=i[1]*c.color.g*g.g,gs[2]=i[2]*c.color.b*g.b,c.currentMesh.tint=Bi(gs)),c.currentMesh.blendMode=c.blendMode,c.hackRegion||this.setMeshRegion(p,c.currentMesh,m);break;case Ws.Clipping:c.currentGraphics||(this.createGraphics(c,p),f.addChild(c.clippingContainer),f.addChild(c.currentGraphics)),this.updateGraphics(c,p),f.alpha=1,f.visible=!0;continue;default:f.visible=!1;continue}if(f.visible=!0,_){let v=c.color.r*g.r,y=c.color.g*g.g,x=c.color.b*g.b;_.setLight(i[0]*v+n[0]*(1-v),i[1]*y+n[1]*(1-y),i[2]*x+n[2]*(1-x)),c.darkColor?(v=c.darkColor.r,y=c.darkColor.g,x=c.darkColor.b):(v=0,y=0,x=0),_.setDark(i[0]*v+n[0]*(1-v),i[1]*y+n[1]*(1-y),i[2]*x+n[2]*(1-x))}f.alpha=c.color.a}const o=this.skeleton.drawOrder;let a=null,h=null;for(let d=0,l=o.length;d<l;d++){const c=r[o[d].data.index],p=this.slotContainers[o[d].data.index];if(h||p.parent!==null&&p.parent!==this&&(p.parent.removeChild(p),p.parent=this),c.currentGraphics&&c.getAttachment())h=c.clippingContainer,a=c.getAttachment(),h.children.length=0,this.children[d]=p,a.endSlot===c.data&&(a.endSlot=null);else if(h){let f=this.tempClipContainers[d];f||(f=this.tempClipContainers[d]=this.newContainer(),f.visible=!1),this.children[d]=f,p.parent=null,h.addChild(p),a.endSlot==c.data&&(h.renderable=!0,h=null,a=null)}else this.children[d]=p}(u=this._debug)==null||u.renderDebug(this)}setSpriteRegion(e,t,r){t.attachment===e&&t.region===r||(t.region=r,t.attachment=e,t.texture=r.texture,t.rotation=e.rotation*si.degRad,t.position.x=e.x,t.position.y=e.y,t.alpha=e.color.a,r.size?(t.scale.x=r.size.width/r.originalWidth,t.scale.y=-r.size.height/r.originalHeight):(t.scale.x=e.scaleX*e.width/r.originalWidth,t.scale.y=-e.scaleY*e.height/r.originalHeight))}setMeshRegion(e,t,r){t.attachment===e&&t.region===r||(t.region=r,t.attachment=e,t.texture=r.texture,r.texture.updateUvs(),t.uvBuffer.update(e.regionUVs))}autoUpdateTransform(){{this.lastTime=this.lastTime||Date.now();const e=(Date.now()-this.lastTime)*.001;this.lastTime=Date.now(),this.update(e)}et.prototype.updateTransform.call(this)}createSprite(e,t,r){let s=t.region;e.hackAttachment===t&&(s=e.hackRegion);const i=s?s.texture:null,n=this.newSprite(i);return n.anchor.set(.5),s&&this.setSpriteRegion(t,n,t.region),e.sprites=e.sprites||{},e.sprites[r]=n,n}createMesh(e,t){let r=t.region;e.hackAttachment===t&&(r=e.hackRegion,e.hackAttachment=null,e.hackRegion=null);const s=this.newMesh(r?r.texture:null,new Float32Array(t.regionUVs.length),t.regionUVs,new Uint16Array(t.triangles),Qe.TRIANGLES);return typeof s._canvasPadding<"u"&&(s._canvasPadding=1.5),s.alpha=t.color.a,s.region=t.region,r&&this.setMeshRegion(t,s,r),e.meshes=e.meshes||{},e.meshes[t.id]=s,s}createGraphics(e,t){const r=this.newGraphics(),s=new Wr([]);return r.clear(),r.beginFill(16777215,1),r.drawPolygon(s),r.renderable=!1,e.currentGraphics=r,e.clippingContainer=this.newContainer(),e.clippingContainer.mask=e.currentGraphics,r}updateGraphics(e,t){const r=e.currentGraphics.geometry,s=r.graphicsData[0].shape.points,i=t.worldVerticesLength;s.length=i,t.computeWorldVertices(e,0,i,s,0,2),r.invalidate()}hackTextureBySlotIndex(e,t=null,r=null){const s=this.skeleton.slots[e];if(!s)return!1;const i=s.getAttachment();let n=i.region;return t?(n=new jf,n.texture=t,n.size=r,s.hackRegion=n,s.hackAttachment=i):(s.hackRegion=null,s.hackAttachment=null),s.currentSprite?this.setSpriteRegion(i,s.currentSprite,n):s.currentMesh&&this.setMeshRegion(i,s.currentMesh,n),!0}hackTextureBySlotName(e,t=null,r=null){const s=this.skeleton.findSlotIndex(e);return s==-1?!1:this.hackTextureBySlotIndex(s,t,r)}hackTextureAttachment(e,t,r,s=null){const i=this.skeleton.findSlotIndex(e),n=this.skeleton.getAttachmentByName(e,t);n.region.texture=r;const o=this.skeleton.slots[i];if(!o)return!1;const a=o.getAttachment();if(t===a.name){let h=n.region;return r?(h=new jf,h.texture=r,h.size=s,o.hackRegion=h,o.hackAttachment=a):(o.hackRegion=null,o.hackAttachment=null),o.currentSprite&&o.currentSprite.region!=h?(this.setSpriteRegion(a,o.currentSprite,h),o.currentSprite.region=h):o.currentMesh&&o.currentMesh.region!=h&&this.setMeshRegion(a,o.currentMesh,h),!0}return!1}newContainer(){return new et}newSprite(e){return new tb(e)}newGraphics(){return new Ie}newMesh(e,t,r,s,i){return new eb(e,t,r,s,i)}transformHack(){return 1}hackAttachmentGroups(e,t,r){if(!e)return;const s=[],i=[];for(let n=0,o=this.skeleton.slots.length;n<o;n++){const a=this.skeleton.slots[n],h=a.currentSpriteName||a.currentMeshName||"",u=a.currentSprite||a.currentMesh;h.endsWith(e)?(u.parentGroup=t,i.push(u)):r&&u&&(u.parentGroup=r,s.push(u))}return[s,i]}destroy(e){this.debug=null;for(let t=0,r=this.skeleton.slots.length;t<r;t++){const s=this.skeleton.slots[t];for(const i in s.meshes)s.meshes[i].destroy(e);s.meshes=null;for(const i in s.sprites)s.sprites[i].destroy(e);s.sprites=null}for(let t=0,r=this.slotContainers.length;t<r;t++)this.slotContainers[t].destroy(e);this.spineData=null,this.skeleton=null,this.slotContainers=null,this.stateData=null,this.state=null,this.tempClipContainers=null,super.destroy(e)}};let n_=i_;n_.clippingPolygon=[],Object.defineProperty(n_.prototype,"visible",{get(){return this._visible},set(e){e!==this._visible&&(this._visible=e,e&&(this.lastTime=0))}});const lt="color: red; font-weight: bold",rb="color: #74b64c",sb="color: #74b64c; font-weight: bold",Sa="color: blue; font-weight: bold",ib="color: #cf0198",Tt="color: black",nb="color: white",su="#3580bd",iu="#74b64c";function Yr(e,t,...r){console.error("%c[%s]%c -- "+e,"color: "+t.color,t.className,Tt,...r)}function ys(e,t,...r){console.warn("%c[%s]%c -- "+e,"color: "+t.color,t.className,Tt,...r)}function lr(e,t,...r){console.log("%c[%s]%c -- "+e,"color: "+t.color,t.className,Tt,...r)}function ai(e,t,r){return Math.max(t,Math.min(r,e))}let ob=class{constructor(e,t,r){if(this.timelines=[],this.timelineIds=new Lx,!e)throw new Error("name cannot be null.");this.name=e,this.setTimelines(t),this.duration=r}setTimelines(e){if(!e)throw new Error("timelines cannot be null.");this.timelines=e,this.timelineIds.clear();for(let t=0;t<e.length;t++)this.timelineIds.addAll(e[t].getPropertyIds())}hasTimeline(e){for(let t=0;t<e.length;t++)if(this.timelineIds.contains(e[t]))return!0;return!1}apply(e,t,r,s,i,n,o,a){if(!e)throw new Error("skeleton cannot be null.");s&&this.duration!=0&&(r%=this.duration,t>0&&(t%=this.duration));const h=this.timelines;for(let u=0,d=h.length;u<d;u++)h[u].apply(e,t,r,i,n,o,a)}};new ob("<empty>",[],0),V.NORMAL,V.ADD,V.MULTIPLY,V.SCREEN;const o_=new ut;mt.prototype._cacheAsBitmap=!1,mt.prototype._cacheData=null,mt.prototype._cacheAsBitmapResolution=null,mt.prototype._cacheAsBitmapMultisample=null;class ab{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(mt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(e){if(this._cacheAsBitmap===e)return;this._cacheAsBitmap=e;let t;e?(this._cacheData||(this._cacheData=new ab),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}}),mt.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))},mt.prototype._initCachedDisplayObject=function(e){var l,c;if((l=this._cacheData)!=null&&l.sprite)return;const t=this.alpha;this.alpha=1,e.batch.flush();const r=this.getLocalBounds(null,!0).clone();if((c=this.filters)!=null&&c.length){const p=this.filters[0].padding;r.pad(p)}r.ceil(F.RESOLUTION);const s=e.renderTexture.current,i=e.renderTexture.sourceFrame.clone(),n=e.renderTexture.destinationFrame.clone(),o=e.projection.transform,a=ti.create({width:r.width,height:r.height,resolution:this.cacheAsBitmapResolution||e.resolution,multisample:this.cacheAsBitmapMultisample??e.multisample}),h=`cacheAsBitmap_${$s()}`;this._cacheData.textureCacheId=h,$.addToCache(a.baseTexture,h),U.addToCache(a,h);const u=this.transform.localTransform.copyTo(o_).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:a,clear:!0,transform:u,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=o,e.renderTexture.bind(s,i,n),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const d=new me(a);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(r.x/r.width),d.anchor.y=-(r.y/r.height),d.alpha=t,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)},mt.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))},mt.prototype._initCachedDisplayObjectCanvas=function(e){var u;if((u=this._cacheData)!=null&&u.sprite)return;const t=this.getLocalBounds(null,!0),r=this.alpha;this.alpha=1;const s=e.canvasContext.activeContext,i=e._projTransform;t.ceil(F.RESOLUTION);const n=ti.create({width:t.width,height:t.height}),o=`cacheAsBitmap_${$s()}`;this._cacheData.textureCacheId=o,$.addToCache(n.baseTexture,o),U.addToCache(n,o);const a=o_;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=t.x,a.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:n,clear:!0,transform:a,skipUpdateTransform:!1}),e.canvasContext.activeContext=s,e._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const h=new me(n);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(t.x/t.width),h.anchor.y=-(t.y/t.height),h.alpha=r,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)},mt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},mt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},mt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,$.removeFromCache(this._cacheData.textureCacheId),U.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},mt.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)},mt.prototype.name=null,et.prototype.getChildByName=function(e,t){for(let r=0,s=this.children.length;r<s;r++)if(this.children[r].name===e)return this.children[r];if(t)for(let r=0,s=this.children.length;r<s;r++){const i=this.children[r];if(!i.getChildByName)continue;const n=i.getChildByName(e,!0);if(n)return n}return null},mt.prototype.getGlobalPosition=function(e=new W,t=!1){return this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e};var hb=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class lb extends Gt{constructor(t=1){super(Dx,hb,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const ub={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},cb=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function db(e){const t=ub[e],r=t.length;let s=cb,i="";const n="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<e;a++){let h=n.replace("%index%",a.toString());o=a,a>=r&&(o=e-a-1),h=h.replace("%value%",t[o].toString()),i+=h,i+=`
`}return s=s.replace("%blur%",i),s=s.replace("%size%",e.toString()),s}const pb=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function fb(e,t){const r=Math.ceil(e/2);let s=pb,i="",n;t?n="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":n="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<e;o++){let a=n.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(r-1)}.0`),i+=a,i+=`
`}return s=s.replace("%blur%",i),s=s.replace("%size%",e.toString()),s}class nu extends Gt{constructor(t,r=8,s=4,i=Gt.defaultResolution,n=5){const o=fb(n,t),a=db(n);super(o,a),this.horizontal=t,this.resolution=i,this._quality=0,this.quality=s,this.blur=r}apply(t,r,s,i){if(s?this.horizontal?this.uniforms.strength=1/s.width*(s.width/r.width):this.uniforms.strength=1/s.height*(s.height/r.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/r.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/r.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,r,s,i);else{const n=t.getFilterTexture(),o=t.renderer;let a=r,h=n;this.state.blend=!1,t.applyFilter(this,a,h,br.CLEAR);for(let u=1;u<this.passes-1;u++){t.bindAndClear(a,br.BLIT),this.uniforms.uSampler=h;const d=h;h=a,a=d,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,h,s,i),t.returnFilterTexture(n)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class _b extends Gt{constructor(t=8,r=4,s=Gt.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new nu(!0,t,r,s,i),this.blurYFilter=new nu(!1,t,r,s,i),this.resolution=s,this.quality=r,this.blur=t,this.repeatEdgePixels=!1}apply(t,r,s,i){const n=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(n&&o){const a=t.getFilterTexture();this.blurXFilter.apply(t,r,a,br.CLEAR),this.blurYFilter.apply(t,a,s,i),t.returnFilterTexture(a)}else o?this.blurYFilter.apply(t,r,s,i):this.blurXFilter.apply(t,r,s,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var mb=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class ou extends Gt{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(Gf,mb,t),this.alpha=1}_loadMatrix(t,r=!1){let s=t;r&&(this._multiply(s,this.uniforms.m,t),s=this._colorMatrix(s)),this.uniforms.m=s}_multiply(t,r,s){return t[0]=r[0]*s[0]+r[1]*s[5]+r[2]*s[10]+r[3]*s[15],t[1]=r[0]*s[1]+r[1]*s[6]+r[2]*s[11]+r[3]*s[16],t[2]=r[0]*s[2]+r[1]*s[7]+r[2]*s[12]+r[3]*s[17],t[3]=r[0]*s[3]+r[1]*s[8]+r[2]*s[13]+r[3]*s[18],t[4]=r[0]*s[4]+r[1]*s[9]+r[2]*s[14]+r[3]*s[19]+r[4],t[5]=r[5]*s[0]+r[6]*s[5]+r[7]*s[10]+r[8]*s[15],t[6]=r[5]*s[1]+r[6]*s[6]+r[7]*s[11]+r[8]*s[16],t[7]=r[5]*s[2]+r[6]*s[7]+r[7]*s[12]+r[8]*s[17],t[8]=r[5]*s[3]+r[6]*s[8]+r[7]*s[13]+r[8]*s[18],t[9]=r[5]*s[4]+r[6]*s[9]+r[7]*s[14]+r[8]*s[19]+r[9],t[10]=r[10]*s[0]+r[11]*s[5]+r[12]*s[10]+r[13]*s[15],t[11]=r[10]*s[1]+r[11]*s[6]+r[12]*s[11]+r[13]*s[16],t[12]=r[10]*s[2]+r[11]*s[7]+r[12]*s[12]+r[13]*s[17],t[13]=r[10]*s[3]+r[11]*s[8]+r[12]*s[13]+r[13]*s[18],t[14]=r[10]*s[4]+r[11]*s[9]+r[12]*s[14]+r[13]*s[19]+r[14],t[15]=r[15]*s[0]+r[16]*s[5]+r[17]*s[10]+r[18]*s[15],t[16]=r[15]*s[1]+r[16]*s[6]+r[17]*s[11]+r[18]*s[16],t[17]=r[15]*s[2]+r[16]*s[7]+r[17]*s[12]+r[18]*s[17],t[18]=r[15]*s[3]+r[16]*s[8]+r[17]*s[13]+r[18]*s[18],t[19]=r[15]*s[4]+r[16]*s[9]+r[17]*s[14]+r[18]*s[19]+r[19],t}_colorMatrix(t){const r=new Float32Array(t);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r}brightness(t,r){const s=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(s,r)}tint(t,r){const[s,i,n]=st.shared.setValue(t).toArray(),o=[s,0,0,0,0,0,i,0,0,0,0,0,n,0,0,0,0,0,1,0];this._loadMatrix(o,r)}greyscale(t,r){const s=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(s,r)}blackAndWhite(t){const r=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(r,t)}hue(t,r){t=(t||0)/180*Math.PI;const s=Math.cos(t),i=Math.sin(t),n=Math.sqrt,o=1/3,a=n(o),h=s+(1-s)*o,u=o*(1-s)-a*i,d=o*(1-s)+a*i,l=o*(1-s)+a*i,c=s+o*(1-s),p=o*(1-s)-a*i,f=o*(1-s)-a*i,_=o*(1-s)+a*i,m=s+o*(1-s),g=[h,u,d,0,0,l,c,p,0,0,f,_,m,0,0,0,0,0,1,0];this._loadMatrix(g,r)}contrast(t,r){const s=(t||0)+1,i=-.5*(s-1),n=[s,0,0,0,i,0,s,0,0,i,0,0,s,0,i,0,0,0,1,0];this._loadMatrix(n,r)}saturate(t=0,r){const s=t*2/3+1,i=(s-1)*-.5,n=[s,i,i,0,0,i,s,i,0,0,i,i,s,0,0,0,0,0,1,0];this._loadMatrix(n,r)}desaturate(){this.saturate(-1)}negative(t){const r=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(r,t)}sepia(t){const r=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(r,t)}technicolor(t){const r=[1.9125277891456085,-.8545344976951645,-.09155508482755584,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491134,0,0,0,1,0];this._loadMatrix(r,t)}polaroid(t){const r=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(r,t)}toBGR(t){const r=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(r,t)}kodachrome(t){const r=[1.1285582396593523,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964945,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(r,t)}browni(t){const r=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.03770324983778316,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(r,t)}vintage(t){const r=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(r,t)}colorTone(t,r,s,i,n){t=t||.2,r=r||.15,s=s||16770432,i=i||3375104;const o=st.shared,[a,h,u]=o.setValue(s).toArray(),[d,l,c]=o.setValue(i).toArray(),p=[.3,.59,.11,0,0,a,h,u,t,0,d,l,c,r,0,a-d,h-l,u-c,0,0];this._loadMatrix(p,n)}night(t,r){t=t||.1;const s=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(s,r)}predator(t,r){const s=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(s,r)}lsd(t){const r=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(r,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}ou.prototype.grayscale=ou.prototype.greyscale;var gb=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,yb=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class vb extends Gt{constructor(t,r){const s=new ut;t.renderable=!1,super(yb,gb,{mapSampler:t._texture,filterMatrix:s,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=s,r==null&&(r=20),this.scale=new W(r,r)}apply(t,r,s,i){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const n=this.maskSprite.worldTransform,o=Math.sqrt(n.a*n.a+n.b*n.b),a=Math.sqrt(n.c*n.c+n.d*n.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=n.a/o,this.uniforms.rotation[1]=n.b/o,this.uniforms.rotation[2]=n.c/a,this.uniforms.rotation[3]=n.d/a),t.applyFilter(this,r,s,i)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var xb=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,bb=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class Tb extends Gt{constructor(){super(bb,xb)}}var Eb=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class wb extends Gt{constructor(t=.5,r=Math.random()){super(Gf,Eb,{uNoise:0,uSeed:0}),this.noise=t,this.seed=r}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const a_={AlphaFilter:lb,BlurFilter:_b,BlurFilterPass:nu,ColorMatrixFilter:ou,DisplacementFilter:vb,FXAAFilter:Tb,NoiseFilter:wb};Object.entries(a_).forEach(([e,t])=>{Object.defineProperty(a_,e,{get(){return J("7.1.0",`filters.${e} has moved to ${e}`),t}})});class Ab{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(Ht.system.add(this.tickerUpdate,this,ri.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Ht.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const vs=new Ab;class jn{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=jn.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new W,this.page=new W,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,r,s){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,r,s,i,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Ca extends jn{constructor(){super(...arguments),this.client=new W,this.movement=new W,this.offset=new W,this.global=new W,this.screen=new W}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,r,s){return t.worldTransform.applyInverse(s||this.global,r)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,r,s,i,n,o,a,h,u,d,l,c,p,f,_){throw new Error("Method not implemented.")}}class ur extends Ca{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class qi extends Ca{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}qi.DOM_DELTA_PIXEL=0,qi.DOM_DELTA_LINE=1,qi.DOM_DELTA_PAGE=2;const Sb=2048,Cb=new W,au=new W;class Ib{constructor(t){this.dispatch=new Rn,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,r){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:r,priority:0}),this.mappingTable[t].sort((s,i)=>s.priority-i.priority)}dispatchEvent(t,r){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,r),this.dispatch.emit(r||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const r=this.mappingTable[t.type];if(r)for(let s=0,i=r.length;s<i;s++)r[s].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,r){vs.pauseUpdate=!0;const s=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",i=this[s](this.rootTarget,this.rootTarget.eventMode,Cb.set(t,r),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(t,r){if(!t.target)return;const s=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let i=0,n=s.length-1;i<n;i++)if(t.currentTarget=s[i],this.notifyTarget(t,r),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,r),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let i=s.length-2;i>=0;i--)if(t.currentTarget=s[i],this.notifyTarget(t,r),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,r,s=this._allInteractiveElements){if(s.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const i=Array.isArray(r)?r:[r];for(let n=s.length-1;n>=0;n--)i.forEach(o=>{t.currentTarget=s[n],this.notifyTarget(t,o)})}propagationPath(t){const r=[t];for(let s=0;s<Sb&&t!==this.rootTarget;s++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(t.parent),t=t.parent}return r.reverse(),r}hitTestMoveRecursive(t,r,s,i,n,o=!1){let a=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||r==="dynamic")&&(vs.pauseUpdate=!1),t.interactiveChildren&&t.children){const d=t.children;for(let l=d.length-1;l>=0;l--){const c=d[l],p=this.hitTestMoveRecursive(c,this._isInteractive(r)?r:c.eventMode,s,i,n,o||n(t,s));if(p){if(p.length>0&&!p[p.length-1].parent)continue;const f=t.isInteractive();(p.length>0||f)&&(f&&this._allInteractiveElements.push(t),p.push(t)),this._hitElements.length===0&&(this._hitElements=p),a=!0}}}const h=this._isInteractive(r),u=t.isInteractive();return u&&u&&this._allInteractiveElements.push(t),o||this._hitElements.length>0?null:a?this._hitElements:h&&!n(t,s)&&i(t,s)?u?[t]:[]:null}hitTestRecursive(t,r,s,i,n){if(this._interactivePrune(t)||n(t,s))return null;if((t.eventMode==="dynamic"||r==="dynamic")&&(vs.pauseUpdate=!1),t.interactiveChildren&&t.children){const h=t.children;for(let u=h.length-1;u>=0;u--){const d=h[u],l=this.hitTestRecursive(d,this._isInteractive(r)?r:d.eventMode,s,i,n);if(l){if(l.length>0&&!l[l.length-1].parent)continue;const c=t.isInteractive();return(l.length>0||c)&&l.push(t),l}}}const o=this._isInteractive(r),a=t.isInteractive();return o&&i(t,s)?a?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,r){var s;if(t.hitArea&&(t.worldTransform.applyInverse(r,au),!t.hitArea.contains(au.x,au.y)))return!0;if(t._mask){const i=t._mask.isMaskData?t._mask.maskObject:t._mask;if(i&&!((s=i.containsPoint)!=null&&s.call(i,r)))return!0}return!1}hitTestFn(t,r){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(r):!1}notifyTarget(t,r){var n,o;r=r??t.type;const s=`on${r}`;(o=(n=t.currentTarget)[s])==null||o.call(n,t);const i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${r}capture`:r;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,r)}mapPointerDown(t){if(!(t instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.createPointerEvent(t);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const i=r.button===2;this.dispatchEvent(r,i?"rightdown":"mousedown")}const s=this.trackingData(t.pointerId);s.pressTargetsByButton[t.button]=r.composedPath(),this.freeEvent(r)}mapPointerMove(t){var h,u;if(!(t instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const r=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const s=r.pointerType==="mouse"||r.pointerType==="pen",i=this.trackingData(t.pointerId),n=this.findMountedTarget(i.overTargets);if(((h=i.overTargets)==null?void 0:h.length)>0&&n!==r.target){const d=t.type==="mousemove"?"mouseout":"pointerout",l=this.createPointerEvent(t,d,n);if(this.dispatchEvent(l,"pointerout"),s&&this.dispatchEvent(l,"mouseout"),!r.composedPath().includes(n)){const c=this.createPointerEvent(t,"pointerleave",n);for(c.eventPhase=c.AT_TARGET;c.target&&!r.composedPath().includes(c.target);)c.currentTarget=c.target,this.notifyTarget(c),s&&this.notifyTarget(c,"mouseleave"),c.target=c.target.parent;this.freeEvent(c)}this.freeEvent(l)}if(n!==r.target){const d=t.type==="mousemove"?"mouseover":"pointerover",l=this.clonePointerEvent(r,d);this.dispatchEvent(l,"pointerover"),s&&this.dispatchEvent(l,"mouseover");let c=n==null?void 0:n.parent;for(;c&&c!==this.rootTarget.parent&&c!==r.target;)c=c.parent;if(!c||c===this.rootTarget.parent){const p=this.clonePointerEvent(r,"pointerenter");for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==n&&p.target!==this.rootTarget.parent;)p.currentTarget=p.target,this.notifyTarget(p),s&&this.notifyTarget(p,"mouseenter"),p.target=p.target.parent;this.freeEvent(p)}this.freeEvent(l)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(r,"pointermove"),a&&o.push("globalpointermove"),r.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),a&&o.push("globaltouchmove")),s&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(u=r.target)==null?void 0:u.cursor),o.length>0&&this.all(r,o),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=r.composedPath(),this.freeEvent(r)}mapPointerOver(t){var o;if(!(t instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(t.pointerId),s=this.createPointerEvent(t),i=s.pointerType==="mouse"||s.pointerType==="pen";this.dispatchEvent(s,"pointerover"),i&&this.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(this.cursor=(o=s.target)==null?void 0:o.cursor);const n=this.clonePointerEvent(s,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),i&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;r.overTargets=s.composedPath(),this.freeEvent(s),this.freeEvent(n)}mapPointerOut(t){if(!(t instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(t.pointerId);if(r.overTargets){const s=t.pointerType==="mouse"||t.pointerType==="pen",i=this.findMountedTarget(r.overTargets),n=this.createPointerEvent(t,"pointerout",i);this.dispatchEvent(n),s&&this.dispatchEvent(n,"mouseout");const o=this.createPointerEvent(t,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),s&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;r.overTargets=null,this.freeEvent(n),this.freeEvent(o)}this.cursor=null}mapPointerUp(t){if(!(t instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=performance.now(),s=this.createPointerEvent(t);if(this.dispatchEvent(s,"pointerup"),s.pointerType==="touch")this.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const a=s.button===2;this.dispatchEvent(s,a?"rightup":"mouseup")}const i=this.trackingData(t.pointerId),n=this.findMountedTarget(i.pressTargetsByButton[t.button]);let o=n;if(n&&!s.composedPath().includes(n)){let a=n;for(;a&&!s.composedPath().includes(a);){if(s.currentTarget=a,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")this.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const h=s.button===2;this.notifyTarget(s,h?"rightupoutside":"mouseupoutside")}a=a.parent}delete i.pressTargetsByButton[t.button],o=a}if(o){const a=this.clonePointerEvent(s,"click");a.target=o,a.path=null,i.clicksByButton[t.button]||(i.clicksByButton[t.button]={clickCount:0,target:a.target,timeStamp:r});const h=i.clicksByButton[t.button];if(h.target===a.target&&r-h.timeStamp<200?++h.clickCount:h.clickCount=1,h.target=a.target,h.timeStamp=r,a.detail=h.clickCount,a.pointerType==="mouse"){const u=a.button===2;this.dispatchEvent(a,u?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(s)}mapPointerUpOutside(t){if(!(t instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const r=this.trackingData(t.pointerId),s=this.findMountedTarget(r.pressTargetsByButton[t.button]),i=this.createPointerEvent(t);if(s){let n=s;for(;n;)i.currentTarget=n,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),n=n.parent;delete r.pressTargetsByButton[t.button]}this.freeEvent(i)}mapWheel(t){if(!(t instanceof qi)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const r=this.createWheelEvent(t);this.dispatchEvent(r),this.freeEvent(r)}findMountedTarget(t){if(!t)return null;let r=t[0];for(let s=1;s<t.length&&t[s].parent===r;s++)r=t[s];return r}createPointerEvent(t,r,s){const i=this.allocateEvent(ur);return this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t,i.target=s??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],typeof r=="string"&&(i.type=r),i}createWheelEvent(t){const r=this.allocateEvent(qi);return this.copyWheelData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=this.hitTest(r.global.x,r.global.y),r}clonePointerEvent(t,r){const s=this.allocateEvent(ur);return s.nativeEvent=t.nativeEvent,s.originalEvent=t.originalEvent,this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.target=t.target,s.path=t.composedPath().slice(),s.type=r??s.type,s}copyWheelData(t,r){r.deltaMode=t.deltaMode,r.deltaX=t.deltaX,r.deltaY=t.deltaY,r.deltaZ=t.deltaZ}copyPointerData(t,r){t instanceof ur&&r instanceof ur&&(r.pointerId=t.pointerId,r.width=t.width,r.height=t.height,r.isPrimary=t.isPrimary,r.pointerType=t.pointerType,r.pressure=t.pressure,r.tangentialPressure=t.tangentialPressure,r.tiltX=t.tiltX,r.tiltY=t.tiltY,r.twist=t.twist)}copyMouseData(t,r){t instanceof Ca&&r instanceof Ca&&(r.altKey=t.altKey,r.button=t.button,r.buttons=t.buttons,r.client.copyFrom(t.client),r.ctrlKey=t.ctrlKey,r.metaKey=t.metaKey,r.movement.copyFrom(t.movement),r.screen.copyFrom(t.screen),r.shiftKey=t.shiftKey,r.global.copyFrom(t.global))}copyData(t,r){r.isTrusted=t.isTrusted,r.srcElement=t.srcElement,r.timeStamp=performance.now(),r.type=t.type,r.detail=t.detail,r.view=t.view,r.which=t.which,r.layer.copyFrom(t.layer),r.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const r=this.eventPool.get(t).pop()||new t(this);return r.eventPhase=r.NONE,r.currentTarget=null,r.path=null,r.target=null,r}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const r=t.constructor;this.eventPool.has(r)||this.eventPool.set(r,[]),this.eventPool.get(r).push(t)}notifyListeners(t,r){const s=t.currentTarget._events[r];if(s&&t.currentTarget.isInteractive())if("fn"in s)s.once&&t.currentTarget.removeListener(r,s.fn,void 0,!0),s.fn.call(s.context,t);else for(let i=0,n=s.length;i<n&&!t.propagationImmediatelyStopped;i++)s[i].once&&t.currentTarget.removeListener(r,s[i].fn,void 0,!0),s[i].fn.call(s[i].context,t)}}const Rb=1,Mb={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},hu=class{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new Ib(null),vs.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new ur(null),this.rootWheelEvent=new qi(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...hu.defaultEventFeatures},{set:(t,r,s)=>(r==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=s),t[r]=s,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:t,resolution:r}=this.renderer;this.setTargetElement(t),this.resolution=r,hu._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;const r=this.cursorStyles[e];if(r)switch(typeof r){case"string":t&&(this.domElement.style.cursor=r);break;case"function":r(e);break;case"object":t&&Object.assign(this.domElement.style,r);break}else t&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;const t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let r=0,s=t.length;r<s;r++){const i=t[r],n=this.bootstrapEvent(this.rootPointerEvent,i);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;vs.pointerMoved();const t=this.normalizeToPointerData(e);for(let r=0,s=t.length;r<s;r++){const i=this.bootstrapEvent(this.rootPointerEvent,t[r]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);const r=t!==this.domElement?"outside":"",s=this.normalizeToPointerData(e);for(let i=0,n=s.length;i<n;i++){const o=this.bootstrapEvent(this.rootPointerEvent,s[i]);o.type+=r,this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;const t=this.normalizeToPointerData(e);for(let r=0,s=t.length;r<s;r++){const i=this.bootstrapEvent(this.rootPointerEvent,t[r]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,vs.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;vs.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;vs.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,r){let s;this.domElement.parentElement?s=this.domElement.getBoundingClientRect():s={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const i=1/this.resolution;e.x=(t-s.left)*(this.domElement.width/s.width)*i,e.y=(r-s.top)*(this.domElement.height/s.height)*i}normalizeToPointerData(e){const t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let r=0,s=e.changedTouches.length;r<s;r++){const i=e.changedTouches[r];typeof i.button>"u"&&(i.button=0),typeof i.buttons>"u"&&(i.buttons=1),typeof i.isPrimary>"u"&&(i.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof i.width>"u"&&(i.width=i.radiusX||1),typeof i.height>"u"&&(i.height=i.radiusY||1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="touch"),typeof i.pointerId>"u"&&(i.pointerId=i.identifier||0),typeof i.pressure>"u"&&(i.pressure=i.force||.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),typeof i.layerX>"u"&&(i.layerX=i.offsetX=i.clientX),typeof i.layerY>"u"&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,i.type=e.type,t.push(i)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const r=e;typeof r.isPrimary>"u"&&(r.isPrimary=!0),typeof r.width>"u"&&(r.width=1),typeof r.height>"u"&&(r.height=1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="mouse"),typeof r.pointerId>"u"&&(r.pointerId=Rb),typeof r.pressure>"u"&&(r.pressure=.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),r.isNormalized=!0,t.push(r)}else t.push(e);return t}normalizeWheelEvent(e){const t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=Mb[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}};let Yn=hu;Yn.extension={name:"events",type:[B.RendererSystem,B.CanvasRendererSystem]},Yn.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0},z.add(Yn);function h_(e){return e==="dynamic"||e==="static"}const Pb={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??h_(Yn.defaultEventMode)},set interactive(e){J("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=e,this.eventMode=e?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Yn.defaultEventMode},set eventMode(e){this._internalInteractive=h_(e),this._internalEventMode=e},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(e,t,r){const s=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof t=="function"?void 0:t;e=s?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.on(e,t,i)},removeEventListener(e,t,r){const s=typeof r=="boolean"&&r||typeof r=="object"&&r.capture,i=typeof t=="function"?void 0:t;e=s?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.off(e,t,i)},dispatchEvent(e){if(!(e instanceof jn))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};mt.mixin(Pb);const Db={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};mt.mixin(Db);const Ob=9,Ia=100,kb=0,Nb=0,l_=2,u_=1,Lb=-1e3,Fb=-1e3,Bb=2;class c_{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Er.tablet||Er.phone)&&this.createTouchHook();const r=document.createElement("div");r.style.width=`${Ia}px`,r.style.height=`${Ia}px`,r.style.position="absolute",r.style.top=`${kb}px`,r.style.left=`${Nb}px`,r.style.zIndex=l_.toString(),this.div=r,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${u_}px`,t.style.height=`${u_}px`,t.style.position="absolute",t.style.top=`${Lb}px`,t.style.left=`${Fb}px`,t.style.zIndex=Bb.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const r=t.children;if(r)for(let s=0;s<r.length;s++)this.updateAccessibleObjects(r[s])}update(){const t=performance.now();if(Er.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:r,y:s,width:i,height:n}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:h}=this.renderer,u=i/o*h,d=n/a*h;let l=this.div;l.style.left=`${r}px`,l.style.top=`${s}px`,l.style.width=`${o}px`,l.style.height=`${a}px`;for(let c=0;c<this.children.length;c++){const p=this.children[c];if(p.renderId!==this.renderId)p._accessibleActive=!1,Ui(this.children,c,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,c--;else{l=p._accessibleDiv;let f=p.hitArea;const _=p.worldTransform;p.hitArea?(l.style.left=`${(_.tx+f.x*_.a)*u}px`,l.style.top=`${(_.ty+f.y*_.d)*d}px`,l.style.width=`${f.width*_.a*u}px`,l.style.height=`${f.height*_.d*d}px`):(f=p.getBounds(),this.capHitArea(f),l.style.left=`${f.x*u}px`,l.style.top=`${f.y*d}px`,l.style.width=`${f.width*u}px`,l.style.height=`${f.height*d}px`,l.title!==p.accessibleTitle&&p.accessibleTitle!==null&&(l.title=p.accessibleTitle),l.getAttribute("aria-label")!==p.accessibleHint&&p.accessibleHint!==null&&l.setAttribute("aria-label",p.accessibleHint)),(p.accessibleTitle!==l.title||p.tabIndex!==l.tabIndex)&&(l.title=p.accessibleTitle,l.tabIndex=p.tabIndex,this.debug&&this.updateDebugHTML(l))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:r,height:s}=this.renderer;t.x+t.width>r&&(t.width=r-t.x),t.y+t.height>s&&(t.height=s-t.y)}addChild(t){let r=this.pool.pop();r||(r=document.createElement("button"),r.style.width=`${Ia}px`,r.style.height=`${Ia}px`,r.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",r.style.position="absolute",r.style.zIndex=l_.toString(),r.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?r.setAttribute("aria-live","off"):r.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?r.setAttribute("aria-relevant","additions"):r.setAttribute("aria-relevant","text"),r.addEventListener("click",this._onClick.bind(this)),r.addEventListener("focus",this._onFocus.bind(this)),r.addEventListener("focusout",this._onFocusOut.bind(this))),r.style.pointerEvents=t.accessiblePointerEvents,r.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?r.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(r.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&r.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(r),t._accessibleActive=!0,t._accessibleDiv=r,r.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,r){const{displayObject:s}=t.target,i=this.renderer.events.rootBoundary,n=Object.assign(new jn(i),{target:s});i.rootTarget=this.renderer.lastObjectRendered,r.forEach(o=>i.dispatchEvent(n,o))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===Ob&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}c_.extension={name:"accessibility",type:[B.RendererPlugin,B.CanvasRendererPlugin]},z.add(c_);const lu=class{constructor(e){this.stage=new et,e=Object.assign({forceCanvas:!1},e),this.renderer=Rx(e),lu._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(e,t){const r=lu._plugins.slice(0);r.reverse(),r.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};let uu=lu;uu._plugins=[],z.handleByList(B.Application,uu._plugins);class d_{static init(t){Object.defineProperty(this,"resizeTo",{set(r){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=r,r&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let r,s;if(this._resizeTo===globalThis.window)r=globalThis.innerWidth,s=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:n}=this._resizeTo;r=i,s=n}this.renderer.resize(r,s),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}d_.extension=B.Application,z.add(d_);const p_={loader:B.LoadParser,resolver:B.ResolveParser,cache:B.CacheParser,detection:B.DetectionParser};z.handle(B.Asset,e=>{const t=e.ref;Object.entries(p_).filter(([r])=>!!t[r]).forEach(([r,s])=>z.add(Object.assign(t[r],{extension:t[r].extension??s})))},e=>{const t=e.ref;Object.keys(p_).filter(r=>!!t[r]).forEach(r=>z.remove(t[r]))});class Ub{constructor(t,r=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r}add(t){t.forEach(r=>{this._assetList.push(r)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<r;s++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function $n(e,t){if(Array.isArray(t)){for(const r of t)if(e.startsWith(`data:${r}`))return!0;return!1}return e.startsWith(`data:${t}`)}function hi(e,t){const r=e.split("?")[0],s=se.extname(r).toLowerCase();return Array.isArray(t)?t.includes(s):s===t}const $r=(e,t)=>(Array.isArray(e)||(e=[e]),t?e.map(r=>typeof r=="string"?t(r):r):e),cu=(e,t)=>{const r=t.split("?")[1];return r&&(e+=`?${r}`),e};function f_(e,t,r,s,i){const n=t[r];for(let o=0;o<n.length;o++){const a=n[o];r<t.length-1?f_(e.replace(s[r],a),t,r+1,s,i):i.push(e.replace(s[r],a))}}function Gb(e){const t=/\{(.*?)\}/g,r=e.match(t),s=[];if(r){const i=[];r.forEach(n=>{const o=n.substring(1,n.length-1).split(",");i.push(o)}),f_(e,i,0,r,s)}else s.push(e);return s}const Ra=e=>!Array.isArray(e);class Hb{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const r=this._cache.get(t);return r||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),r}set(t,r){const s=$r(t);let i;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];if(h.test(r)){i=h.getCacheableAssets(s,r);break}}i||(i={},s.forEach(a=>{i[a]=r}));const n=Object.keys(i),o={cacheKeys:n,keys:s};if(s.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==r&&console.warn("[Cache] already has key:",a),this._cache.set(a,i[a])}),r instanceof U){const a=r;s.forEach(h=>{a.baseTexture!==U.EMPTY.baseTexture&&$.addToCache(a.baseTexture,h),U.addToCache(a,h)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const r=this._cacheMap.get(t);r.cacheKeys.forEach(s=>{this._cache.delete(s)}),r.keys.forEach(s=>{this._cacheMap.delete(s)})}get parsers(){return this._parsers}}const qn=new Hb;class zb{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,r,s)=>(this._parsersValidated=!1,t[r]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,r){const s={promise:null,parser:null};return s.promise=(async()=>{var o,a;let i=null,n=null;if(r.loadParser&&(n=this._parserHash[r.loadParser],n||console.warn(`[Assets] specified load parser "${r.loadParser}" not found while loading ${t}`)),!n){for(let h=0;h<this.parsers.length;h++){const u=this.parsers[h];if(u.load&&((o=u.test)!=null&&o.call(u,t,r,this))){n=u;break}}if(!n)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await n.load(t,r,this),s.parser=n;for(let h=0;h<this.parsers.length;h++){const u=this.parsers[h];u.parse&&u.parse&&await((a=u.testParse)==null?void 0:a.call(u,i,r,this))&&(i=await u.parse(i,r,this)||i,s.parser=u)}return i})(),s}async load(t,r){this._parsersValidated||this._validateParsers();let s=0;const i={},n=Ra(t),o=$r(t,u=>({src:u})),a=o.length,h=o.map(async u=>{const d=se.toAbsolute(u.src);if(!i[u.src])try{this.promiseCache[d]||(this.promiseCache[d]=this._getLoadPromiseAndParser(d,u)),i[u.src]=await this.promiseCache[d].promise,r&&r(++s/a)}catch(l){throw delete this.promiseCache[d],delete i[u.src],new Error(`[Loader.load] Failed to load ${d}.
${l}`)}});return await Promise.all(h),n?i[o[0].src]:i}async unload(t){const r=$r(t,s=>({src:s})).map(async s=>{var o,a;const i=se.toAbsolute(s.src),n=this.promiseCache[i];if(n){const h=await n.promise;(a=(o=n.parser)==null?void 0:o.unload)==null||a.call(o,h,s,this),delete this.promiseCache[i]}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,r)=>(t[r.name]&&console.warn(`[Assets] loadParser name conflict "${r.name}"`),{...t,[r.name]:r}),{})}}var Ir=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(Ir||{});const Vb=".json",Xb="application/json",Wb={extension:{type:B.LoadParser,priority:Ir.Low},name:"loadJson",test(e){return $n(e,Xb)||hi(e,Vb)},async load(e){return await(await F.ADAPTER.fetch(e)).json()}};z.add(Wb);const jb=".txt",Yb="text/plain",$b={name:"loadTxt",extension:{type:B.LoadParser,priority:Ir.Low},test(e){return $n(e,Yb)||hi(e,jb)},async load(e){return await(await F.ADAPTER.fetch(e)).text()}};z.add($b);const qb=["normal","bold","100","200","300","400","500","600","700","800","900"],Kb=[".ttf",".otf",".woff",".woff2"],Zb=["font/ttf","font/otf","font/woff","font/woff2"],Qb=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function Jb(e){const t=se.extname(e),r=se.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1));let s=r.length>0;for(const n of r)if(!n.match(Qb)){s=!1;break}let i=r.join(" ");return s||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}const t1={extension:{type:B.LoadParser,priority:Ir.Low},name:"loadWebFont",test(e){return $n(e,Zb)||hi(e,Kb)},async load(e,t){var s,i,n;const r=F.ADAPTER.getFontFaceSet();if(r){const o=[],a=((s=t.data)==null?void 0:s.family)??Jb(e),h=((n=(i=t.data)==null?void 0:i.weights)==null?void 0:n.filter(d=>qb.includes(d)))??["normal"],u=t.data??{};for(let d=0;d<h.length;d++){const l=h[d],c=new FontFace(a,`url(${encodeURI(e)})`,{...u,weight:l});await c.load(),r.add(c),o.push(c)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){(Array.isArray(e)?e:[e]).forEach(t=>F.ADAPTER.getFontFaceSet().delete(t))}};z.add(t1);let __=0,du;const e1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",r1={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${e1}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},s1={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let pu;class i1{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const r=URL.createObjectURL(new Blob([r1.code],{type:"application/javascript"})),s=new Worker(r);s.addEventListener("message",i=>{s.terminate(),URL.revokeObjectURL(r),t(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){du===void 0&&(du=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<du&&(pu||(pu=URL.createObjectURL(new Blob([s1.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(pu),t.addEventListener("message",r=>{this.complete(r.data),this.returnWorker(r.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,r){await this._initWorkers();const s=new Promise((i,n)=>{this.queue.push({id:t,arguments:r,resolve:i,reject:n})});return this.next(),s}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const r=this.queue.pop(),s=r.id;this.resolveHash[__]={resolve:r.resolve,reject:r.reject},t.postMessage({data:r.arguments,uuid:__++,id:s})}}const m_=new i1;function Ma(e,t,r){const s=new U(e);return s.baseTexture.on("dispose",()=>{delete t.promiseCache[r]}),s}const n1=[".jpeg",".jpg",".png",".webp",".avif"],o1=["image/jpeg","image/png","image/webp","image/avif"];async function a1(e){const t=await F.ADAPTER.fetch(e);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${t.status} ${t.statusText}`);const r=await t.blob();return await createImageBitmap(r)}const Pa={name:"loadTextures",extension:{type:B.LoadParser,priority:Ir.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(e){return $n(e,o1)||hi(e,n1)},async load(e,t,r){let s=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await m_.isImageBitmapSupported()?s=await m_.loadImageBitmap(e):s=await a1(e):s=await new Promise(n=>{s=new Image,s.crossOrigin=this.config.crossOrigin,s.src=e,s.complete?n(s):s.onload=()=>{n(s)}});const i=new $(s,{resolution:ps(e),...t.data});return i.resource.src=e,Ma(i,r,e)},unload(e){e.destroy(!0)}};z.add(Pa);const h1=".svg",l1="image/svg+xml",u1={extension:{type:B.LoadParser,priority:Ir.High},name:"loadSVG",test(e){return $n(e,l1)||hi(e,h1)},async testParse(e){return Vn.test(e)},async parse(e,t,r){var n;const s=new Vn(e,(n=t==null?void 0:t.data)==null?void 0:n.resourceOptions);await s.load();const i=new $(s,{resolution:ps(e),...t==null?void 0:t.data});return i.resource.src=e,Ma(i,r,e)},async load(e,t){return(await F.ADAPTER.fetch(e)).text()},unload:Pa.unload};z.add(u1);class c1{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,r)=>`${t}${this._bundleIdConnector}${r}`,extractAssetIdFromBundle:(t,r)=>r.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(r=>{this._preferredOrder.push(r),r.priority||(r.priority=Object.keys(r.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const r=t;this._defaultSearchParams=Object.keys(r).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(r[s])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(r=>{this.addBundle(r.name,r.assets)})}addBundle(t,r){const s=[];Array.isArray(r)?r.forEach(i=>{if(typeof i.name=="string"){const n=this._createBundleAssetId(t,i.name);s.push(n),this.add([i.name,n],i.srcs,i.data)}else{const n=i.name.map(o=>this._createBundleAssetId(t,o));n.forEach(o=>{s.push(o)}),this.add([...i.name,...n],i.srcs)}}):Object.keys(r).forEach(i=>{s.push(this._createBundleAssetId(t,i)),this.add([i,this._createBundleAssetId(t,i)],r[i])}),this._bundles[t]=s}add(t,r,s){const i=$r(t);i.forEach(o=>{this.hasKey(o)&&console.warn(`[Resolver] already has key: ${o} overwriting`)}),Array.isArray(r)||(typeof r=="string"?r=Gb(r):r=[r]);const n=r.map(o=>{let a=o;if(typeof o=="string"){let h=!1;for(let u=0;u<this._parsers.length;u++){const d=this._parsers[u];if(d.test(o)){a=d.parse(o),h=!0;break}}h||(a={src:o})}return a.format||(a.format=a.src.split(".").pop()),a.alias||(a.alias=i),(this._basePath||this._rootPath)&&(a.src=se.toAbsolute(a.src,this._basePath,this._rootPath)),a.src=this._appendDefaultSearchParams(a.src),a.data=a.data??s,a});i.forEach(o=>{this._assetMap[o]=n})}resolveBundle(t){const r=Ra(t);t=$r(t);const s={};return t.forEach(i=>{const n=this._bundles[i];if(n){const o=this.resolve(n),a={};for(const h in o){const u=o[h];a[this._extractAssetIdFromBundle(i,h)]=u}s[i]=a}}),r?s[t[0]]:s}resolveUrl(t){const r=this.resolve(t);if(typeof t!="string"){const s={};for(const i in r)s[i]=r[i].src;return s}return r.src}resolve(t){const r=Ra(t);t=$r(t);const s={};return t.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let n=this._assetMap[i];const o=this._getPreferredOrder(n),a=n[0];o==null||o.priority.forEach(h=>{o.params[h].forEach(u=>{const d=n.filter(l=>l[h]?l[h]===u:!1);d.length&&(n=d)})}),this._resolverHash[i]=n[0]??a}else{let n=i;(this._basePath||this._rootPath)&&(n=se.toAbsolute(n,this._basePath,this._rootPath)),n=this._appendDefaultSearchParams(n),this._resolverHash[i]={src:n}}s[i]=this._resolverHash[i]}),r?s[t[0]]:s}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let r=0;r<t.length;r++){const s=t[0],i=this._preferredOrder.find(n=>n.params.format.includes(s.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const r=/\?/.test(t)?"&":"?";return`${t}${r}${this._defaultSearchParams}`}}class d1{constructor(){this._detections=[],this._initialized=!1,this.resolver=new c1,this.loader=new zb,this.cache=qn,this._backgroundLoader=new Ub(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,o,a;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let h=t.manifest;typeof h=="string"&&(h=await this.load(h)),this.resolver.addManifest(h)}const r=((n=t.texturePreference)==null?void 0:n.resolution)??1,s=typeof r=="number"?[r]:r;let i=[];if((o=t.texturePreference)!=null&&o.format){const h=(a=t.texturePreference)==null?void 0:a.format;i=typeof h=="string"?[h]:h;for(const u of this._detections)await u.test()||(i=await u.remove(i))}else for(const h of this._detections)await h.test()&&(i=await h.add(i));this.resolver.prefer({params:{format:i,resolution:s}}),t.preferences&&this.setPreferences(t.preferences)}add(t,r,s){this.resolver.add(t,r,s)}async load(t,r){this._initialized||await this.init();const s=Ra(t),i=$r(t).map(a=>typeof a!="string"?(this.resolver.add(a.src,a),a.src):(this.resolver.hasKey(a)||this.resolver.add(a,a),a)),n=this.resolver.resolve(i),o=await this._mapLoadToResolve(n,r);return s?o[i[0]]:o}addBundle(t,r){this.resolver.addBundle(t,r)}async loadBundle(t,r){this._initialized||await this.init();let s=!1;typeof t=="string"&&(s=!0,t=[t]);const i=this.resolver.resolveBundle(t),n={},o=Object.keys(i);let a=0,h=0;const u=()=>{r==null||r(++a/h)},d=o.map(l=>{const c=i[l];return h+=Object.keys(c).length,this._mapLoadToResolve(c,u).then(p=>{n[l]=p})});return await Promise.all(d),s?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const r=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(r))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const r=this.resolver.resolveBundle(t);Object.values(r).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return qn.get(t);const r={};for(let s=0;s<t.length;s++)r[s]=qn.get(t[s]);return r}async _mapLoadToResolve(t,r){const s=Object.values(t),i=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(s,r);this._backgroundLoader.active=!0;const o={};return s.forEach((a,h)=>{const u=n[a.src],d=[a.src];a.alias&&d.push(...a.alias),o[i[h]]=u,qn.set(d,u)}),o}async unload(t){this._initialized||await this.init();const r=$r(t).map(i=>typeof i!="string"?i.src:i),s=this.resolver.resolve(r);await this._unloadFromResolved(s)}async unloadBundle(t){this._initialized||await this.init(),t=$r(t);const r=this.resolver.resolveBundle(t),s=Object.keys(r).map(i=>this._unloadFromResolved(r[i]));await Promise.all(s)}async _unloadFromResolved(t){const r=Object.values(t);r.forEach(s=>{qn.remove(s.src)}),await this.loader.unload(r)}get detections(){return this._detections}get preferWorkers(){return Pa.config.preferWorkers}set preferWorkers(t){J("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(r=>{r.config&&Object.keys(r.config).filter(s=>s in t).forEach(s=>{r.config[s]=t[s]})})}}const it=new d1;z.handleByList(B.LoadParser,it.loader.parsers).handleByList(B.ResolveParser,it.resolver.parsers).handleByList(B.CacheParser,it.cache.parsers).handleByList(B.DetectionParser,it.detections);const p1={extension:B.CacheParser,test:e=>Array.isArray(e)&&e.every(t=>t instanceof U),getCacheableAssets:(e,t)=>{const r={};return e.forEach(s=>{t.forEach((i,n)=>{r[s+(n===0?"":n+1)]=i})}),r}};z.add(p1);const f1={extension:{type:B.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const e="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await F.ADAPTER.fetch(e).then(r=>r.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"avif"],remove:async e=>e.filter(t=>t!=="avif")};z.add(f1);const _1={extension:{type:B.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const e="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await F.ADAPTER.fetch(e).then(r=>r.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"webp"],remove:async e=>e.filter(t=>t!=="webp")};z.add(_1);const g_=["png","jpg","jpeg"],m1={extension:{type:B.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...g_],remove:async e=>e.filter(t=>!g_.includes(t))};z.add(m1);const g1={extension:B.ResolveParser,test:Pa.test,parse:e=>{var t;return{resolution:parseFloat(((t=F.RETINA_PREFIX.exec(e))==null?void 0:t[1])??"1"),format:e.split(".").pop(),src:e}}};z.add(g1);var Re=(e=>(e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e))(Re||{});const Da={[33776]:.5,[33777]:.5,[33778]:1,[33779]:1,[35916]:.5,[35917]:.5,[35918]:1,[35919]:1,[37488]:.5,[37489]:.5,[37490]:1,[37491]:1,[37492]:.5,[37496]:1,[37493]:.5,[37497]:1,[37494]:.5,[37495]:.5,[35840]:.5,[35842]:.5,[35841]:.25,[35843]:.25,[36196]:.5,[35986]:.5,[35986]:1,[34798]:1,[37808]:1};let qr,Ki;function y_(){Ki={s3tc:qr.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:qr.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:qr.getExtension("WEBGL_compressed_texture_etc"),etc1:qr.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:qr.getExtension("WEBGL_compressed_texture_pvrtc")||qr.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:qr.getExtension("WEBGL_compressed_texture_atc"),astc:qr.getExtension("WEBGL_compressed_texture_astc")}}const y1={extension:{type:B.DetectionParser,priority:2},test:async()=>{const e=F.ADAPTER.createCanvas().getContext("webgl");return e?(qr=e,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async e=>{Ki||y_();const t=[];for(const r in Ki)Ki[r]&&t.push(r);return[...t,...e]},remove:async e=>(Ki||y_(),e.filter(t=>!(t in Ki)))};z.add(y1);class v1 extends Bn{constructor(t,r={width:1,height:1,autoLoad:!0}){let s,i;typeof t=="string"?(s=t,i=new Uint8Array):(s=null,i=t),super(i,r),this.origin=s,this.buffer=i?new Il(i):null,this._load=null,this.loaded=!1,this.origin!==null&&r.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new Il(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}}class li extends v1{constructor(t,r){super(t,r),this.format=r.format,this.levels=r.levels||1,this._width=r.width,this._height=r.height,this._extension=li._formatToExtension(this.format),(r.levelBuffers||this.buffer)&&(this._levelBuffers=r.levelBuffers||li._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,r,s){const i=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let n=0,o=this.levels;n<o;n++){const{levelID:a,levelWidth:h,levelHeight:u,levelBuffer:d}=this._levelBuffers[n];i.compressedTexImage2D(i.TEXTURE_2D,a,this.format,h,u,0,d)}return!0}onBlobLoaded(){this._levelBuffers=li._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,r,s,i,n,o,a){const h=new Array(s);let u=t.byteOffset,d=o,l=a,c=d+i-1&~(i-1),p=l+n-1&~(n-1),f=c*p*Da[r];for(let _=0;_<s;_++)h[_]={levelID:_,levelWidth:s>1?d:c,levelHeight:s>1?l:p,levelBuffer:new Uint8Array(t.buffer,u,f)},u+=f,d=d>>1||1,l=l>>1||1,c=d+i-1&~(i-1),p=l+n-1&~(n-1),f=c*p*Da[r];return h}}const fu=4,Oa=124,x1=32,v_=20,b1=542327876,ka={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},T1={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Na={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},E1=1,w1=2,A1=4,S1=64,C1=512,I1=131072,R1=827611204,M1=861165636,P1=894720068,D1=808540228,O1=4,k1={[R1]:Re.COMPRESSED_RGBA_S3TC_DXT1_EXT,[M1]:Re.COMPRESSED_RGBA_S3TC_DXT3_EXT,[P1]:Re.COMPRESSED_RGBA_S3TC_DXT5_EXT},N1={[70]:Re.COMPRESSED_RGBA_S3TC_DXT1_EXT,[71]:Re.COMPRESSED_RGBA_S3TC_DXT1_EXT,[73]:Re.COMPRESSED_RGBA_S3TC_DXT3_EXT,[74]:Re.COMPRESSED_RGBA_S3TC_DXT3_EXT,[76]:Re.COMPRESSED_RGBA_S3TC_DXT5_EXT,[77]:Re.COMPRESSED_RGBA_S3TC_DXT5_EXT,[72]:Re.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,[75]:Re.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,[78]:Re.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function L1(e){const t=new Uint32Array(e);if(t[0]!==b1)throw new Error("Invalid DDS file magic word");const r=new Uint32Array(e,0,Oa/Uint32Array.BYTES_PER_ELEMENT),s=r[ka.HEIGHT],i=r[ka.WIDTH],n=r[ka.MIPMAP_COUNT],o=new Uint32Array(e,ka.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,x1/Uint32Array.BYTES_PER_ELEMENT),a=o[E1];if(a&A1){const h=o[T1.FOURCC];if(h!==D1){const v=k1[h],y=fu+Oa,x=new Uint8Array(e,y);return[new li(x,{format:v,width:i,height:s,levels:n})]}const u=fu+Oa,d=new Uint32Array(t.buffer,u,v_/Uint32Array.BYTES_PER_ELEMENT),l=d[Na.DXGI_FORMAT],c=d[Na.RESOURCE_DIMENSION],p=d[Na.MISC_FLAG],f=d[Na.ARRAY_SIZE],_=N1[l];if(_===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${l}`);if(p===O1)throw new Error("DDSParser does not support cubemap textures");if(c===6)throw new Error("DDSParser does not supported 3D texture data");const m=new Array,g=fu+Oa+v_;if(f===1)m.push(new Uint8Array(e,g));else{const v=Da[_];let y=0,x=i,E=s;for(let w=0;w<n;w++){const b=Math.max(1,x+3&-4),A=Math.max(1,E+3&-4),R=b*A*v;y+=R,x=x>>>1,E=E>>>1}let T=g;for(let w=0;w<f;w++)m.push(new Uint8Array(e,T,y)),T+=y}return m.map(v=>new li(v,{format:_,width:i,height:s,levels:n}))}throw a&S1?new Error("DDSParser does not support uncompressed texture data."):a&C1?new Error("DDSParser does not supported YUV uncompressed texture data."):a&I1?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&w1?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const x_=[171,75,84,88,32,49,49,187,13,10,26,10],F1=67305985,cr={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},_u=64,b_={[X.UNSIGNED_BYTE]:1,[X.UNSIGNED_SHORT]:2,[X.INT]:4,[X.UNSIGNED_INT]:4,[X.FLOAT]:4,[X.HALF_FLOAT]:8},B1={[k.RGBA]:4,[k.RGB]:3,[k.RG]:2,[k.RED]:1,[k.LUMINANCE]:1,[k.LUMINANCE_ALPHA]:2,[k.ALPHA]:1},U1={[X.UNSIGNED_SHORT_4_4_4_4]:2,[X.UNSIGNED_SHORT_5_5_5_1]:2,[X.UNSIGNED_SHORT_5_6_5]:2};function G1(e,t,r=!1){const s=new DataView(t);if(!H1(e,s))return null;const i=s.getUint32(cr.ENDIANNESS,!0)===F1,n=s.getUint32(cr.GL_TYPE,i),o=s.getUint32(cr.GL_FORMAT,i),a=s.getUint32(cr.GL_INTERNAL_FORMAT,i),h=s.getUint32(cr.PIXEL_WIDTH,i),u=s.getUint32(cr.PIXEL_HEIGHT,i)||1,d=s.getUint32(cr.PIXEL_DEPTH,i)||1,l=s.getUint32(cr.NUMBER_OF_ARRAY_ELEMENTS,i)||1,c=s.getUint32(cr.NUMBER_OF_FACES,i),p=s.getUint32(cr.NUMBER_OF_MIPMAP_LEVELS,i),f=s.getUint32(cr.BYTES_OF_KEY_VALUE_DATA,i);if(u===0||d!==1)throw new Error("Only 2D textures are supported");if(c!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(l!==1)throw new Error("WebGL does not support array textures");const _=4,m=4,g=h+3&-4,v=u+3&-4,y=new Array(l);let x=h*u;n===0&&(x=g*v);let E;if(n!==0?b_[n]?E=b_[n]*B1[o]:E=U1[n]:E=Da[a],E===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const T=r?V1(s,f,i):null;let w=x*E,b=h,A=u,R=g,S=v,M=_u+f;for(let I=0;I<p;I++){const C=s.getUint32(M,i);let O=M+4;for(let L=0;L<l;L++){let D=y[L];D||(D=y[L]=new Array(p)),D[I]={levelID:I,levelWidth:p>1||n!==0?b:R,levelHeight:p>1||n!==0?A:S,levelBuffer:new Uint8Array(t,O,w)},O+=w}M+=C+4,M=M%4!==0?M+4-M%4:M,b=b>>1||1,A=A>>1||1,R=b+_-1&~(_-1),S=A+m-1&~(m-1),w=R*S*E}return n!==0?{uncompressed:y.map(I=>{let C=I[0].levelBuffer,O=!1;return n===X.FLOAT?C=new Float32Array(I[0].levelBuffer.buffer,I[0].levelBuffer.byteOffset,I[0].levelBuffer.byteLength/4):n===X.UNSIGNED_INT?(O=!0,C=new Uint32Array(I[0].levelBuffer.buffer,I[0].levelBuffer.byteOffset,I[0].levelBuffer.byteLength/4)):n===X.INT&&(O=!0,C=new Int32Array(I[0].levelBuffer.buffer,I[0].levelBuffer.byteOffset,I[0].levelBuffer.byteLength/4)),{resource:new Bn(C,{width:I[0].levelWidth,height:I[0].levelHeight}),type:n,format:O?z1(o):o}}),kvData:T}:{compressed:y.map(I=>new li(null,{format:a,width:h,height:u,levels:p,levelBuffers:I})),kvData:T}}function H1(e,t){for(let r=0;r<x_.length;r++)if(t.getUint8(r)!==x_[r])return console.error(`${e} is not a valid *.ktx file!`),!1;return!0}function z1(e){switch(e){case k.RGBA:return k.RGBA_INTEGER;case k.RGB:return k.RGB_INTEGER;case k.RG:return k.RG_INTEGER;case k.RED:return k.RED_INTEGER;default:return e}}function V1(e,t,r){const s=new Map;let i=0;for(;i<t;){const n=e.getUint32(_u+i,r),o=_u+i+4,a=3-(n+3)%4;if(n===0||n>t-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let h=0;for(;h<n&&e.getUint8(o+h)!==0;h++);if(h===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=new TextDecoder().decode(new Uint8Array(e.buffer,o,h)),d=new DataView(e.buffer,o+h+1,n-h-1);s.set(u,d),i+=4+n+a}return s}const X1={extension:{type:B.LoadParser,priority:Ir.High},name:"loadDDS",test(e){return hi(e,".dds")},async load(e,t,r){const s=await(await F.ADAPTER.fetch(e)).arrayBuffer(),i=L1(s).map(n=>{const o=new $(n,{mipmap:xr.OFF,alphaMode:Je.NO_PREMULTIPLIED_ALPHA,resolution:ps(e),...t.data});return Ma(o,r,e)});return i.length===1?i[0]:i},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};z.add(X1);const W1={extension:{type:B.LoadParser,priority:Ir.High},name:"loadKTX",test(e){return hi(e,".ktx")},async load(e,t,r){const s=await(await F.ADAPTER.fetch(e)).arrayBuffer(),{compressed:i,uncompressed:n,kvData:o}=G1(e,s),a=i??n,h={mipmap:xr.OFF,alphaMode:Je.NO_PREMULTIPLIED_ALPHA,resolution:ps(e),...t.data},u=a.map(d=>{a===n&&Object.assign(h,{type:d.type,format:d.format});const l=new $(d,h);return l.ktxKeyValueData=o,Ma(l,r,e)});return u.length===1?u[0]:u},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};z.add(W1);const j1={extension:B.ResolveParser,test:e=>{const t=e.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(t)},parse:e=>{var t,r;if(e.split("?")[0].split(".").pop()==="ktx"){const s=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(s.some(i=>e.endsWith(i)))return{resolution:parseFloat(((t=F.RETINA_PREFIX.exec(e))==null?void 0:t[1])??"1"),format:s.find(i=>e.endsWith(i)),src:e}}return{resolution:parseFloat(((r=F.RETINA_PREFIX.exec(e))==null?void 0:r[1])??"1"),format:e.split(".").pop(),src:e}}};z.add(j1);const Y1=new K,$1=4,Kn=class{constructor(e){this.renderer=e}async image(e,t,r){const s=new Image;return s.src=await this.base64(e,t,r),s}async base64(e,t,r){const s=this.canvas(e);if(s.toBlob!==void 0)return new Promise((i,n)=>{s.toBlob(o=>{if(!o){n(new Error("ICanvas.toBlob failed!"));return}const a=new FileReader;a.onload=()=>i(a.result),a.onerror=n,a.readAsDataURL(o)},t,r)});if(s.toDataURL!==void 0)return s.toDataURL(t,r);if(s.convertToBlob!==void 0){const i=await s.convertToBlob({type:t,quality:r});return new Promise((n,o)=>{const a=new FileReader;a.onload=()=>n(a.result),a.onerror=o,a.readAsDataURL(i)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,t){const{pixels:r,width:s,height:i,flipY:n}=this._rawPixels(e,t);n&&Kn._flipY(r,s,i),Kn._unpremultiplyAlpha(r);const o=new vv(s,i,1),a=new ImageData(new Uint8ClampedArray(r.buffer),s,i);return o.context.putImageData(a,0,0),o.canvas}pixels(e,t){const{pixels:r,width:s,height:i,flipY:n}=this._rawPixels(e,t);return n&&Kn._flipY(r,s,i),Kn._unpremultiplyAlpha(r),r}_rawPixels(e,t){const r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");let s,i=!1,n,o=!1;if(e&&(e instanceof ti?n=e:(n=r.generateTexture(e,{resolution:r.resolution,multisample:r.multisample}),o=!0)),n){if(s=n.baseTexture.resolution,t=t??n.frame,i=!1,!o){r.renderTexture.bind(n);const l=n.framebuffer.glFramebuffers[r.CONTEXT_UID];l.blitFramebuffer&&r.framebuffer.bind(l.blitFramebuffer)}}else s=r.resolution,t||(t=Y1,t.width=r.width/s,t.height=r.height/s),i=!0,r.renderTexture.bind();const a=Math.round(t.width*s),h=Math.round(t.height*s),u=new Uint8Array($1*a*h),d=r.gl;return d.readPixels(Math.round(t.x*s),Math.round(t.y*s),a,h,d.RGBA,d.UNSIGNED_BYTE,u),o&&(n==null||n.destroy(!0)),{pixels:u,width:a,height:h,flipY:i}}destroy(){this.renderer=null}static _flipY(e,t,r){const s=t<<2,i=r>>1,n=new Uint8Array(s);for(let o=0;o<i;o++){const a=o*s,h=(r-o-1)*s;n.set(e.subarray(a,a+s)),e.copyWithin(a,h,h+s),e.set(n,h)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const t=e.length;for(let r=0;r<t;r+=4){const s=e[r+3];if(s!==0){const i=255.001/s;e[r]=e[r]*i+.5,e[r+1]=e[r+1]*i+.5,e[r+2]=e[r+2]*i+.5}}}};let T_=Kn;T_.extension={name:"extract",type:B.RendererSystem},z.add(T_);class E_{constructor(t,r,s){this.geometry=new fs,this.indexBuffer=null,this.size=s,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<t.length;++i){let n=t[i];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||X.FLOAT,offset:n.offset},r[i]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let r=0;this.indexBuffer=new Ct(gv(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=r,r+=a.size,this.dynamicStride+=a.size}const s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=new Ct(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=i,i+=a.size,this.staticStride+=a.size}const n=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(n),this.staticDataUint32=new Uint32Array(n),this.staticBuffer=new Ct(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];t.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===X.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];t.addAttribute(a.attributeName,this.staticBuffer,0,a.type===X.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(t,r,s){for(let i=0;i<this.dynamicProperties.length;i++){const n=this.dynamicProperties[i];n.uploadFunction(t,r,s,n.type===X.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,r,s){for(let i=0;i<this.staticProperties.length;i++){const n=this.staticProperties[i];n.uploadFunction(t,r,s,n.type===X.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var q1=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,K1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class w_ extends ha{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new ut,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:X.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Cr.from(K1,q1,{}),this.state=qs.for2d()}render(t){const r=t.children,s=t._maxSize,i=t._batchSize,n=this.renderer;let o=r.length;if(o===0)return;o>s&&!t.autoResize&&(o=s);let a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));const h=r[0]._texture.baseTexture,u=h.alphaMode>0;this.state.blendMode=zp(t.blendMode,u),n.state.set(this.state);const d=n.gl,l=t.worldTransform.copyTo(this.tempMatrix);l.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=l.toArray(!0),this.shader.uniforms.uColor=st.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,u).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=h,this.renderer.shader.bind(this.shader);let c=!1;for(let p=0,f=0;p<o;p+=i,f+=1){let _=o-p;_>i&&(_=i),f>=a.length&&a.push(this._generateOneMoreBuffer(t));const m=a[f];m.uploadDynamic(r,p,_);const g=t._bufferUpdateIDs[f]||0;c=c||m._updateID<g,c&&(m._updateID=t._updateID,m.uploadStatic(r,p,_)),n.geometry.bind(m.geometry),d.drawElements(d.TRIANGLES,_*6,d.UNSIGNED_SHORT,0)}}generateBuffers(t){const r=[],s=t._maxSize,i=t._batchSize,n=t._properties;for(let o=0;o<s;o+=i)r.push(new E_(this.properties,n,i));return r}_generateOneMoreBuffer(t){const r=t._batchSize,s=t._properties;return new E_(this.properties,s,r)}uploadVertices(t,r,s,i,n,o){let a=0,h=0,u=0,d=0;for(let l=0;l<s;++l){const c=t[r+l],p=c._texture,f=c.scale.x,_=c.scale.y,m=p.trim,g=p.orig;m?(h=m.x-c.anchor.x*g.width,a=h+m.width,d=m.y-c.anchor.y*g.height,u=d+m.height):(a=g.width*(1-c.anchor.x),h=g.width*-c.anchor.x,u=g.height*(1-c.anchor.y),d=g.height*-c.anchor.y),i[o]=h*f,i[o+1]=d*_,i[o+n]=a*f,i[o+n+1]=d*_,i[o+n*2]=a*f,i[o+n*2+1]=u*_,i[o+n*3]=h*f,i[o+n*3+1]=u*_,o+=n*4}}uploadPosition(t,r,s,i,n,o){for(let a=0;a<s;a++){const h=t[r+a].position;i[o]=h.x,i[o+1]=h.y,i[o+n]=h.x,i[o+n+1]=h.y,i[o+n*2]=h.x,i[o+n*2+1]=h.y,i[o+n*3]=h.x,i[o+n*3+1]=h.y,o+=n*4}}uploadRotation(t,r,s,i,n,o){for(let a=0;a<s;a++){const h=t[r+a].rotation;i[o]=h,i[o+n]=h,i[o+n*2]=h,i[o+n*3]=h,o+=n*4}}uploadUvs(t,r,s,i,n,o){for(let a=0;a<s;++a){const h=t[r+a]._texture._uvs;h?(i[o]=h.x0,i[o+1]=h.y0,i[o+n]=h.x1,i[o+n+1]=h.y1,i[o+n*2]=h.x2,i[o+n*2+1]=h.y2,i[o+n*3]=h.x3,i[o+n*3+1]=h.y3,o+=n*4):(i[o]=0,i[o+1]=0,i[o+n]=0,i[o+n+1]=0,i[o+n*2]=0,i[o+n*2+1]=0,i[o+n*3]=0,i[o+n*3+1]=0,o+=n*4)}}uploadTint(t,r,s,i,n,o){for(let a=0;a<s;++a){const h=t[r+a],u=st.shared.setValue(h._tintRGB).toPremultiplied(h.alpha,h.texture.baseTexture.alphaMode>0);i[o]=u,i[o+n]=u,i[o+n*2]=u,i[o+n*3]=u,o+=n*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}w_.extension={name:"particle",type:B.RendererPlugin},z.add(w_);var Zn=(e=>(e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e))(Zn||{});const La={willReadFrequently:!0},H=class{static get experimentalLetterSpacingSupported(){let e=H._experimentalLetterSpacingSupported;if(e!==void 0){const t=F.ADAPTER.getCanvasRenderingContext2D().prototype;e=H._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,r,s,i,n,o,a,h){this.text=e,this.style=t,this.width=r,this.height=s,this.lines=i,this.lineWidths=n,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h}static measureText(e,t,r,s=H._canvas){r=r??t.wordWrap;const i=t.toFontString(),n=H.measureFont(i);n.fontSize===0&&(n.fontSize=t.fontSize,n.ascent=t.fontSize);const o=s.getContext("2d",La);o.font=i;const a=(r?H.wordWrap(e,t,s):e).split(/(?:\r\n|\r|\n)/),h=new Array(a.length);let u=0;for(let p=0;p<a.length;p++){const f=H._measureText(a[p],t.letterSpacing,o);h[p]=f,u=Math.max(u,f)}let d=u+t.strokeThickness;t.dropShadow&&(d+=t.dropShadowDistance);const l=t.lineHeight||n.fontSize+t.strokeThickness;let c=Math.max(l,n.fontSize+t.strokeThickness*2)+(a.length-1)*(l+t.leading);return t.dropShadow&&(c+=t.dropShadowDistance),new H(e,t,d,c,a,h,l+t.leading,u,n)}static _measureText(e,t,r){let s=!1;H.experimentalLetterSpacingSupported&&(H.experimentalLetterSpacing?(r.letterSpacing=`${t}px`,r.textLetterSpacing=`${t}px`,s=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let i=r.measureText(e).width;return i>0&&(s?i-=t:i+=(H.graphemeSegmenter(e).length-1)*t),i}static wordWrap(e,t,r=H._canvas){const s=r.getContext("2d",La);let i=0,n="",o="";const a=Object.create(null),{letterSpacing:h,whiteSpace:u}=t,d=H.collapseSpaces(u),l=H.collapseNewlines(u);let c=!d;const p=t.wordWrapWidth+h,f=H.tokenize(e);for(let _=0;_<f.length;_++){let m=f[_];if(H.isNewline(m)){if(!l){o+=H.addLine(n),c=!d,n="",i=0;continue}m=" "}if(d){const v=H.isBreakingSpace(m),y=H.isBreakingSpace(n[n.length-1]);if(v&&y)continue}const g=H.getFromCache(m,h,a,s);if(g>p)if(n!==""&&(o+=H.addLine(n),n="",i=0),H.canBreakWords(m,t.breakWords)){const v=H.wordWrapSplit(m);for(let y=0;y<v.length;y++){let x=v[y],E=x,T=1;for(;v[y+T];){const b=v[y+T];if(!H.canBreakChars(E,b,m,y,t.breakWords))x+=b;else break;E=b,T++}y+=T-1;const w=H.getFromCache(x,h,a,s);w+i>p&&(o+=H.addLine(n),c=!1,n="",i=0),n+=x,i+=w}}else{n.length>0&&(o+=H.addLine(n),n="",i=0);const v=_===f.length-1;o+=H.addLine(m,!v),c=!1,n="",i=0}else g+i>p&&(c=!1,o+=H.addLine(n),n="",i=0),(n.length>0||!H.isBreakingSpace(m)||c)&&(n+=m,i+=g)}return o+=H.addLine(n,!1),o}static addLine(e,t=!0){return e=H.trimRight(e),e=t?`${e}
`:e,e}static getFromCache(e,t,r,s){let i=r[e];return typeof i!="number"&&(i=H._measureText(e,t,s)+t,r[e]=i),i}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const r=e[t];if(!H.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:H._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:H._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const t=[];let r="";if(typeof e!="string")return t;for(let s=0;s<e.length;s++){const i=e[s],n=e[s+1];if(H.isBreakingSpace(i,n)||H.isNewline(i)){r!==""&&(t.push(r),r=""),t.push(i);continue}r+=i}return r!==""&&t.push(r),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,r,s,i){return!0}static wordWrapSplit(e){return H.graphemeSegmenter(e)}static measureFont(e){if(H._fonts[e])return H._fonts[e];const t={ascent:0,descent:0,fontSize:0},r=H._canvas,s=H._context;s.font=e;const i=H.METRICS_STRING+H.BASELINE_SYMBOL,n=Math.ceil(s.measureText(i).width);let o=Math.ceil(s.measureText(H.BASELINE_SYMBOL).width);const a=Math.ceil(H.HEIGHT_MULTIPLIER*o);if(o=o*H.BASELINE_MULTIPLIER|0,n===0||a===0)return H._fonts[e]=t,t;r.width=n,r.height=a,s.fillStyle="#f00",s.fillRect(0,0,n,a),s.font=e,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(i,0,o);const h=s.getImageData(0,0,n,a).data,u=h.length,d=n*4;let l=0,c=0,p=!1;for(l=0;l<o;++l){for(let f=0;f<d;f+=4)if(h[c+f]!==255){p=!0;break}if(!p)c+=d;else break}for(t.ascent=o-l,c=u-d,p=!1,l=a;l>o;--l){for(let f=0;f<d;f+=4)if(h[c+f]!==255){p=!0;break}if(!p)c-=d;else break}return t.descent=l-o,t.fontSize=t.ascent+t.descent,H._fonts[e]=t,t}static clearMetrics(e=""){e?delete H._fonts[e]:H._fonts={}}static get _canvas(){var e;if(!H.__canvas){let t;try{const r=new OffscreenCanvas(0,0);if((e=r.getContext("2d",La))!=null&&e.measureText)return H.__canvas=r,r;t=F.ADAPTER.createCanvas()}catch{t=F.ADAPTER.createCanvas()}t.width=t.height=10,H.__canvas=t}return H.__canvas}static get _context(){return H.__context||(H.__context=H._canvas.getContext("2d",La)),H.__context}};let qt=H;qt.METRICS_STRING="|\xC9q\xC5",qt.BASELINE_SYMBOL="M",qt.BASELINE_MULTIPLIER=1.4,qt.HEIGHT_MULTIPLIER=2,qt.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const e=new Intl.Segmenter;return t=>[...e.segment(t)].map(r=>r.segment)}return e=>[...e]})(),qt.experimentalLetterSpacing=!1,qt._fonts={},qt._newlines=[10,13],qt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const Z1=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Qn=class{constructor(e){this.styleID=0,this.reset(),gu(this,e,e)}clone(){const e={};return gu(e,this,Qn.defaultStyle),new Qn(e)}reset(){gu(this,Qn.defaultStyle,Qn.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const t=mu(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const t=mu(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){Q1(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const t=mu(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let r=t.length-1;r>=0;r--){let s=t[r].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!Z1.includes(s)&&(s=`"${s}"`),t[r]=s}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}};let Kr=Qn;Kr.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Zn.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function mu(e){const t=st.shared;return Array.isArray(e)?e.map(r=>t.setValue(r).toHex()):t.setValue(e).toHex()}function Q1(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}function gu(e,t,r){for(const s in r)Array.isArray(t[s])?e[s]=t[s].slice():e[s]=t[s]}const J1={texture:!0,children:!1,baseTexture:!0},yu=class extends me{constructor(e,t,r){let s=!1;r||(r=F.ADAPTER.createCanvas(),s=!0),r.width=3,r.height=3;const i=U.from(r);i.orig=new K,i.trim=new K,super(i),this._ownCanvas=s,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=yu.defaultResolution??F.RESOLUTION,this._autoResolution=yu.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return qt.experimentalLetterSpacing}static set experimentalLetterSpacing(e){J("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),qt.experimentalLetterSpacing=e}updateText(e){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const r=this.context,s=qt.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),i=s.width,n=s.height,o=s.lines,a=s.lineHeight,h=s.lineWidths,u=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,i)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,n)+t.padding*2)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=t.strokeThickness,r.textBaseline=t.textBaseline,r.lineJoin=t.lineJoin,r.miterLimit=t.miterLimit;let l,c;const p=t.dropShadow?2:1;for(let f=0;f<p;++f){const _=t.dropShadow&&f===0,m=_?Math.ceil(Math.max(1,n)+t.padding*2):0,g=m*this._resolution;if(_){r.fillStyle="black",r.strokeStyle="black";const y=t.dropShadowColor,x=t.dropShadowBlur*this._resolution,E=t.dropShadowDistance*this._resolution;r.shadowColor=st.shared.setValue(y).setAlpha(t.dropShadowAlpha).toRgbaString(),r.shadowBlur=x,r.shadowOffsetX=Math.cos(t.dropShadowAngle)*E,r.shadowOffsetY=Math.sin(t.dropShadowAngle)*E+g}else r.fillStyle=this._generateFillStyle(t,o,s),r.strokeStyle=t.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;let v=(a-d.fontSize)/2;a-d.fontSize<0&&(v=0);for(let y=0;y<o.length;y++)l=t.strokeThickness/2,c=t.strokeThickness/2+y*a+d.ascent+v,t.align==="right"?l+=u-h[y]:t.align==="center"&&(l+=(u-h[y])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(o[y],l+t.padding,c+t.padding-m,!0),t.fill&&this.drawLetterSpacing(o[y],l+t.padding,c+t.padding-m)}this.updateTexture()}drawLetterSpacing(e,t,r,s=!1){const i=this._style.letterSpacing;let n=!1;if(qt.experimentalLetterSpacingSupported&&(qt.experimentalLetterSpacing?(this.context.letterSpacing=`${i}px`,this.context.textLetterSpacing=`${i}px`,n=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),i===0||n){s?this.context.strokeText(e,t,r):this.context.fillText(e,t,r);return}let o=t;const a=qt.graphemeSegmenter(e);let h=this.context.measureText(e).width,u=0;for(let d=0;d<a.length;++d){const l=a[d];s?this.context.strokeText(l,o,r):this.context.fillText(l,o,r);let c="";for(let p=d+1;p<a.length;++p)c+=a[p];u=this.context.measureText(c).width,o+=h-u+i,h=u}}updateTexture(){const e=this.canvas;if(this._style.trim){const n=bv(e);n.data&&(e.width=n.width,e.height=n.height,this.context.putImageData(n.data,0,0))}const t=this._texture,r=this._style,s=r.trim?0:r.padding,i=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-s,t.trim.y=-s,t.orig.width=t._frame.width-s*2,t.orig.height=t._frame.height-s*2,this._onTextureUpdate(),i.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,r){const s=e.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;let i;const n=e.dropShadow?e.dropShadowDistance:0,o=e.padding||0,a=this.canvas.width/this._resolution-n-o*2,h=this.canvas.height/this._resolution-n-o*2,u=s.slice(),d=e.fillGradientStops.slice();if(!d.length){const l=u.length+1;for(let c=1;c<l;++c)d.push(c/l)}if(u.unshift(s[0]),d.unshift(0),u.push(s[s.length-1]),d.push(1),e.fillGradientType===Zn.LINEAR_VERTICAL){i=this.context.createLinearGradient(a/2,o,a/2,h+o);const l=r.fontProperties.fontSize+e.strokeThickness;for(let c=0;c<t.length;c++){const p=r.lineHeight*(c-1)+l,f=r.lineHeight*c;let _=f;c>0&&p>f&&(_=(f+p)/2);const m=f+l,g=r.lineHeight*(c+1);let v=m;c+1<t.length&&g<m&&(v=(m+g)/2);const y=(v-_)/h;for(let x=0;x<u.length;x++){let E=0;typeof d[x]=="number"?E=d[x]:E=x/u.length;let T=Math.min(1,Math.max(0,_/h+E*y));T=Number(T.toFixed(5)),i.addColorStop(T,u[x])}}}else{i=this.context.createLinearGradient(o,h/2,a+o,h/2);const l=u.length+1;let c=1;for(let p=0;p<u.length;p++){let f;typeof d[p]=="number"?f=d[p]:f=c/l,i.addColorStop(f,u[p]),c++}}return i}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},J1,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const t=cs(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const t=cs(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof Kr?this._style=e:this._style=new Kr(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};let Zr=yu;Zr.defaultAutoResolution=!0;class tT{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function eT(e,t){var s;let r=!1;if((s=e==null?void 0:e._textures)!=null&&s.length){for(let i=0;i<e._textures.length;i++)if(e._textures[i]instanceof U){const n=e._textures[i].baseTexture;t.includes(n)||(t.push(n),r=!0)}}return r}function rT(e,t){if(e.baseTexture instanceof $){const r=e.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function sT(e,t){if(e._texture&&e._texture instanceof U){const r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function iT(e,t){return t instanceof Zr?(t.updateText(!0),!0):!1}function nT(e,t){if(t instanceof Kr){const r=t.toFontString();return qt.measureFont(r),!0}return!1}function oT(e,t){if(e instanceof Zr){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);const r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function aT(e,t){return e instanceof Kr?(t.includes(e)||t.push(e),!0):!1}const A_=class{constructor(e){this.limiter=new tT(A_.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(oT),this.registerFindHook(aT),this.registerFindHook(eT),this.registerFindHook(rT),this.registerFindHook(sT),this.registerUploadHook(iT),this.registerUploadHook(nT)}upload(e){return new Promise(t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,Ht.system.addOnce(this.tick,this,ri.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let t=!1;if(e&&!e._destroyed){for(let r=0,s=this.uploadHooks.length;r<s;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)Ht.system.addOnce(this.tick,this,ri.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let t=0,r=e.length;t<r;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof et)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&Ht.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let Fa=A_;Fa.uploadsPerFrame=4,Object.defineProperties(F,{UPLOADS_PER_FRAME:{get(){return Fa.uploadsPerFrame},set(e){J("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Fa.uploadsPerFrame=e}}});function S_(e,t){return t instanceof $?(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0):!1}function hT(e,t){if(!(t instanceof Ie))return!1;const{geometry:r}=t;t.finishPoly(),r.updateBatches();const{batches:s}=r;for(let i=0;i<s.length;i++){const{texture:n}=s[i].style;n&&S_(e,n.baseTexture)}return r.batchable||e.geometry.bind(r,t._resolveDirectShader(e)),!0}function lT(e,t){return e instanceof Ie?(t.push(e),!0):!1}class C_ extends Fa{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(lT),this.registerUploadHook(S_),this.registerUploadHook(hT)}}C_.extension={name:"prepare",type:B.RendererSystem},z.add(C_);const Jn=new W;class vu extends me{constructor(t,r=100,s=100){super(t),this.tileTransform=new Hi,this._width=r,this._height=s,this.uvMatrix=this.texture.uvMatrix||new Vl(t),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(t){this.tileTransform.scale.copyFrom(t)}get tilePosition(){return this.tileTransform.position}set tilePosition(t){this.tileTransform.position.copyFrom(t)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(t){const r=this._texture;!r||!r.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))}_calculateBounds(){const t=this._width*-this._anchor._x,r=this._height*-this._anchor._y,s=this._width*(1-this._anchor._x),i=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,r,s,i)}getLocalBounds(t){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new K),t=this._localBoundsRect),this._bounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Jn);const r=this._width,s=this._height,i=-r*this.anchor._x;if(Jn.x>=i&&Jn.x<i+r){const n=-s*this.anchor._y;if(Jn.y>=n&&Jn.y<n+s)return!0}return!1}destroy(t){super.destroy(t),this.tileTransform=null,this.uvMatrix=null}static from(t,r){const s=t instanceof U?t:U.from(t,r);return new vu(s,r.width,r.height)}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}}var uT=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,cT=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,dT=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,I_=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,pT=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Ba=new ut;class R_ extends ha{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new yf,this.state=qs.for2d()}contextChange(){const t=this.renderer,r={globals:t.globalUniforms};this.simpleShader=Cr.from(I_,pT,r),this.shader=t.context.webGLVersion>1?Cr.from(cT,uT,r):Cr.from(I_,dT,r)}render(t){const r=this.renderer,s=this.quad;let i=s.vertices;i[0]=i[6]=t._width*-t.anchor.x,i[1]=i[3]=t._height*-t.anchor.y,i[2]=i[4]=t._width*(1-t.anchor.x),i[5]=i[7]=t._height*(1-t.anchor.y);const n=t.uvRespectAnchor?t.anchor.x:0,o=t.uvRespectAnchor?t.anchor.y:0;i=s.uvs,i[0]=i[6]=-n,i[1]=i[3]=-o,i[2]=i[4]=1-n,i[5]=i[7]=1-o,s.invalidate();const a=t._texture,h=a.baseTexture,u=h.alphaMode>0,d=t.tileTransform.localTransform,l=t.uvMatrix;let c=h.isPowerOfTwo&&a.frame.width===h.width&&a.frame.height===h.height;c&&(h._glTextures[r.CONTEXT_UID]?c=h.wrapMode!==zr.CLAMP:h.wrapMode===zr.CLAMP&&(h.wrapMode=zr.REPEAT));const p=c?this.simpleShader:this.shader,f=a.width,_=a.height,m=t._width,g=t._height;Ba.set(d.a*f/m,d.b*f/g,d.c*_/m,d.d*_/g,d.tx/m,d.ty/g),Ba.invert(),c?Ba.prepend(l.mapCoord):(p.uniforms.uMapCoord=l.mapCoord.toArray(!0),p.uniforms.uClampFrame=l.uClampFrame,p.uniforms.uClampOffset=l.uClampOffset),p.uniforms.uTransform=Ba.toArray(!0),p.uniforms.uColor=st.shared.setValue(t.tint).premultiply(t.worldAlpha,u).toArray(p.uniforms.uColor),p.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),p.uniforms.uSampler=a,r.shader.bind(p),r.geometry.bind(s),this.state.blendMode=zp(t.blendMode,u),r.state.set(this.state),r.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}R_.extension={name:"tilingSprite",type:B.RendererPlugin},z.add(R_);const to=class{constructor(e,t,r=null){this.linkedSheets=[],this._texture=e instanceof U?e:null,this.baseTexture=e instanceof $?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const s=this.baseTexture.resource;this.resolution=this._updateResolution(r||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:t}=this.data.meta;let r=ps(e,null);return r===null&&(r=parseFloat(t??"1")),r!==1&&this.baseTexture.setResolution(r),r}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=to.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const r=to.BATCH_SIZE;for(;t-e<r&&t<this._frameKeys.length;){const s=this._frameKeys[t],i=this._frames[s],n=i.frame;if(n){let o=null,a=null;const h=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,u=new K(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);i.rotated?o=new K(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.h)/this.resolution,Math.floor(n.w)/this.resolution):o=new K(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(a=new K(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution)),this.textures[s]=new U(this.baseTexture,o,u,a,i.rotated?2:0,i.anchor,i.borders),U.addToCache(this.textures[s],s)}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let r=0;r<e[t].length;r++){const s=e[t][r];this.animations[t].push(this.textures[s])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*to.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*to.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var t;for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let xu=to;xu.BATCH_SIZE=1e3;const fT=["jpg","png","jpeg","avif","webp"];function M_(e,t,r){const s={};if(e.forEach(i=>{s[i]=t}),Object.keys(t.textures).forEach(i=>{s[i]=t.textures[i]}),!r){const i=se.dirname(e[0]);t.linkedSheets.forEach((n,o)=>{const a=M_([`${i}/${t.data.meta.related_multi_packs[o]}`],n,!0);Object.assign(s,a)})}return s}const _T={extension:B.Asset,cache:{test:e=>e instanceof xu,getCacheableAssets:(e,t)=>M_(e,t,!1)},resolver:{test:e=>{const t=e.split("?")[0].split("."),r=t.pop(),s=t.pop();return r==="json"&&fT.includes(s)},parse:e=>{var r;const t=e.split(".");return{resolution:parseFloat(((r=F.RETINA_PREFIX.exec(e))==null?void 0:r[1])??"1"),format:t[t.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:B.LoadParser,priority:Ir.Normal},async testParse(e,t){return se.extname(t.src).toLowerCase()===".json"&&!!e.frames},async parse(e,t,r){var h,u;let s=se.dirname(t.src);s&&s.lastIndexOf("/")!==s.length-1&&(s+="/");let i=s+e.meta.image;i=cu(i,t.src);const n=(await r.load([i]))[i],o=new xu(n.baseTexture,e,t.src);await o.parse();const a=(h=e==null?void 0:e.meta)==null?void 0:h.related_multi_packs;if(Array.isArray(a)){const d=[];for(const c of a){if(typeof c!="string")continue;let p=s+c;(u=t.data)!=null&&u.ignoreMultiPack||(p=cu(p,t.src),d.push(r.load({src:p,data:{ignoreMultiPack:!0}})))}const l=await Promise.all(d);o.linkedSheets=l,l.forEach(c=>{c.linkedSheets=[o].concat(o.linkedSheets.filter(p=>p!==c))})}return o},unload(e){e.destroy(!0)}}};z.add(_T);class Ua{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Ga{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const r=t.match(/^[a-z]+\s+.+$/gm),s={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const n in r){const o=r[n].match(/^[a-z]+/gm)[0],a=r[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),h={};for(const u in a){const d=a[u].split("="),l=d[0],c=d[1].replace(/"/gm,""),p=parseFloat(c),f=isNaN(p)?c:p;h[l]=f}s[o].push(h)}const i=new Ua;return s.info.forEach(n=>i.info.push({face:n.face,size:parseInt(n.size,10)})),s.common.forEach(n=>i.common.push({lineHeight:parseInt(n.lineHeight,10)})),s.page.forEach(n=>i.page.push({id:parseInt(n.id,10),file:n.file})),s.char.forEach(n=>i.char.push({id:parseInt(n.id,10),page:parseInt(n.page,10),x:parseInt(n.x,10),y:parseInt(n.y,10),width:parseInt(n.width,10),height:parseInt(n.height,10),xoffset:parseInt(n.xoffset,10),yoffset:parseInt(n.yoffset,10),xadvance:parseInt(n.xadvance,10)})),s.kerning.forEach(n=>i.kerning.push({first:parseInt(n.first,10),second:parseInt(n.second,10),amount:parseInt(n.amount,10)})),s.distanceField.forEach(n=>i.distanceField.push({distanceRange:parseInt(n.distanceRange,10),fieldType:n.fieldType})),i}}class bu{static test(t){const r=t;return"getElementsByTagName"in r&&r.getElementsByTagName("page").length&&r.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const r=new Ua,s=t.getElementsByTagName("info"),i=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),h=t.getElementsByTagName("distanceField");for(let u=0;u<s.length;u++)r.info.push({face:s[u].getAttribute("face"),size:parseInt(s[u].getAttribute("size"),10)});for(let u=0;u<i.length;u++)r.common.push({lineHeight:parseInt(i[u].getAttribute("lineHeight"),10)});for(let u=0;u<n.length;u++)r.page.push({id:parseInt(n[u].getAttribute("id"),10)||0,file:n[u].getAttribute("file")});for(let u=0;u<o.length;u++){const d=o[u];r.char.push({id:parseInt(d.getAttribute("id"),10),page:parseInt(d.getAttribute("page"),10)||0,x:parseInt(d.getAttribute("x"),10),y:parseInt(d.getAttribute("y"),10),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10),xoffset:parseInt(d.getAttribute("xoffset"),10),yoffset:parseInt(d.getAttribute("yoffset"),10),xadvance:parseInt(d.getAttribute("xadvance"),10)})}for(let u=0;u<a.length;u++)r.kerning.push({first:parseInt(a[u].getAttribute("first"),10),second:parseInt(a[u].getAttribute("second"),10),amount:parseInt(a[u].getAttribute("amount"),10)});for(let u=0;u<h.length;u++)r.distanceField.push({fieldType:h[u].getAttribute("fieldType"),distanceRange:parseInt(h[u].getAttribute("distanceRange"),10)});return r}}class Tu{static test(t){return typeof t=="string"&&t.includes("<font>")?bu.test(F.ADAPTER.parseXML(t)):!1}static parse(t){return bu.parse(F.ADAPTER.parseXML(t))}}const Eu=[Ga,bu,Tu];function mT(e){for(let t=0;t<Eu.length;t++)if(Eu[t].test(e))return Eu[t];return null}function gT(e,t,r,s,i,n){const o=r.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const h=r.dropShadow?r.dropShadowDistance:0,u=r.padding||0,d=e.width/s-h-u*2,l=e.height/s-h-u*2,c=o.slice(),p=r.fillGradientStops.slice();if(!p.length){const f=c.length+1;for(let _=1;_<f;++_)p.push(_/f)}if(c.unshift(o[0]),p.unshift(0),c.push(o[o.length-1]),p.push(1),r.fillGradientType===Zn.LINEAR_VERTICAL){a=t.createLinearGradient(d/2,u,d/2,l+u);let f=0;const _=(n.fontProperties.fontSize+r.strokeThickness)/l;for(let m=0;m<i.length;m++){const g=n.lineHeight*m;for(let v=0;v<c.length;v++){let y=0;typeof p[v]=="number"?y=p[v]:y=v/c.length;const x=g/l+y*_;let E=Math.max(f,x);E=Math.min(E,1),a.addColorStop(E,c[v]),f=E}}}else{a=t.createLinearGradient(u,l/2,d+u,l/2);const f=c.length+1;let _=1;for(let m=0;m<c.length;m++){let g;typeof p[m]=="number"?g=p[m]:g=_/f,a.addColorStop(g,c[m]),_++}}return a}function yT(e,t,r,s,i,n,o){const a=r.text,h=r.fontProperties;t.translate(s,i),t.scale(n,n);const u=o.strokeThickness/2,d=-(o.strokeThickness/2);if(t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=gT(e,t,o,n,[a],r),t.strokeStyle=o.stroke,o.dropShadow){const l=o.dropShadowColor,c=o.dropShadowBlur*n,p=o.dropShadowDistance*n;t.shadowColor=st.shared.setValue(l).setAlpha(o.dropShadowAlpha).toRgbaString(),t.shadowBlur=c,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*p,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*p}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;o.stroke&&o.strokeThickness&&t.strokeText(a,u,d+r.lineHeight-h.descent),o.fill&&t.fillText(a,u,d+r.lineHeight-h.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function Ha(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}function P_(e){return Array.from?Array.from(e):e.split("")}function vT(e){typeof e=="string"&&(e=[e]);const t=[];for(let r=0,s=e.length;r<s;r++){const i=e[r];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const n=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<n)throw new Error("[BitmapFont]: Invalid character range.");for(let a=n,h=o;a<=h;a++)t.push(String.fromCharCode(a))}else t.push(...P_(i))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const dr=class{constructor(e,t,r){var u;const[s]=e.info,[i]=e.common,[n]=e.page,[o]=e.distanceField,a=ps(n.file),h={};this._ownsTextures=r,this.font=s.face,this.size=s.size,this.lineHeight=i.lineHeight/a,this.chars={},this.pageTextures=h;for(let d=0;d<e.page.length;d++){const{id:l,file:c}=e.page[d];h[l]=t instanceof Array?t[d]:t[c],o!=null&&o.fieldType&&o.fieldType!=="none"&&(h[l].baseTexture.alphaMode=Je.NO_PREMULTIPLIED_ALPHA,h[l].baseTexture.mipmap=xr.OFF)}for(let d=0;d<e.char.length;d++){const{id:l,page:c}=e.char[d];let{x:p,y:f,width:_,height:m,xoffset:g,yoffset:v,xadvance:y}=e.char[d];p/=a,f/=a,_/=a,m/=a,g/=a,v/=a,y/=a;const x=new K(p+h[c].frame.x/a,f+h[c].frame.y/a,_,m);this.chars[l]={xOffset:g,yOffset:v,xAdvance:y,kerning:{},texture:new U(h[c].baseTexture,x),page:c}}for(let d=0;d<e.kerning.length;d++){let{first:l,second:c,amount:p}=e.kerning[d];l/=a,c/=a,p/=a,this.chars[c]&&(this.chars[c].kerning[l]=p)}this.distanceFieldRange=o==null?void 0:o.distanceRange,this.distanceFieldType=((u=o==null?void 0:o.fieldType)==null?void 0:u.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,t,r){let s;if(e instanceof Ua)s=e;else{const n=mT(e);if(!n)throw new Error("Unrecognized data format for font.");s=n.parse(e)}t instanceof U&&(t=[t]);const i=new dr(s,t,r);return dr.available[i.font]=i,i}static uninstall(e){const t=dr.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete dr.available[e]}static from(e,t,r){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:s,padding:i,resolution:n,textureWidth:o,textureHeight:a,...h}=Object.assign({},dr.defaultOptions,r),u=vT(s),d=t instanceof Kr?t:new Kr(t),l=o,c=new Ua;c.info[0]={face:d.fontFamily,size:d.fontSize},c.common[0]={lineHeight:d.fontSize};let p=0,f=0,_,m,g,v=0;const y=[];for(let E=0;E<u.length;E++){_||(_=F.ADAPTER.createCanvas(),_.width=o,_.height=a,m=_.getContext("2d"),g=new $(_,{resolution:n,...h}),y.push(new U(g)),c.page.push({id:y.length-1,file:""}));const T=u[E],w=qt.measureText(T,d,!1,_),b=w.width,A=Math.ceil(w.height),R=Math.ceil((d.fontStyle==="italic"?2:1)*b);if(f>=a-A*n){if(f===0)throw new Error(`[BitmapFont] textureHeight ${a}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${T}')`);--E,_=null,m=null,g=null,f=0,p=0,v=0;continue}if(v=Math.max(A+w.fontProperties.descent,v),R*n+p>=l){if(p===0)throw new Error(`[BitmapFont] textureWidth ${o}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${T}')`);--E,f+=v*n,f=Math.ceil(f),p=0,v=0;continue}yT(_,m,w,p,f,n,d);const S=Ha(w.text);c.char.push({id:S,page:y.length-1,x:p/n,y:f/n,width:R,height:A,xoffset:0,yoffset:0,xadvance:b-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0)}),p+=(R+2*i)*n,p=Math.ceil(p)}for(let E=0,T=u.length;E<T;E++){const w=u[E];for(let b=0;b<T;b++){const A=u[b],R=m.measureText(w).width,S=m.measureText(A).width,M=m.measureText(w+A).width-(R+S);M&&c.kerning.push({first:Ha(w),second:Ha(A),amount:M})}}const x=new dr(c,y,!0);return dr.available[e]!==void 0&&dr.uninstall(e),dr.available[e]=x,x}};let ge=dr;ge.ALPHA=[["a","z"],["A","Z"]," "],ge.NUMERIC=[["0","9"]],ge.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],ge.ASCII=[[" ","~"]],ge.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:dr.ALPHANUMERIC},ge.available={};var xT=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,bT=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const D_=[],O_=[],k_=[],N_=class extends et{constructor(e,t={}){super();const{align:r,tint:s,maxWidth:i,letterSpacing:n,fontName:o,fontSize:a}=Object.assign({},N_.styleDefaults,t);if(!ge.available[o])throw new Error(`Missing BitmapFont "${o}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=r,this._tintColor=new st(s),this._font=void 0,this._fontName=o,this._fontSize=a,this.text=e,this._maxWidth=i,this._maxLineHeight=0,this._letterSpacing=n,this._anchor=new _s(()=>{this.dirty=!0},this,0,0),this._roundPixels=F.ROUND_PIXELS,this.dirty=!0,this._resolution=F.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var R;const e=ge.available[this._fontName],t=this.fontSize,r=t/e.size,s=new W,i=[],n=[],o=[],a=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",h=P_(a),u=this._maxWidth*e.size/t,d=e.distanceFieldType==="none"?D_:O_;let l=null,c=0,p=0,f=0,_=-1,m=0,g=0,v=0,y=0;for(let S=0;S<h.length;S++){const M=h[S],I=Ha(M);if(/(?:\s)/.test(M)&&(_=S,m=c,y++),M==="\r"||M===`
`){n.push(c),o.push(-1),p=Math.max(p,c),++f,++g,s.x=0,s.y+=e.lineHeight,l=null,y=0;continue}const C=e.chars[I];if(!C)continue;l&&C.kerning[l]&&(s.x+=C.kerning[l]);const O=k_.pop()||{texture:U.EMPTY,line:0,charCode:0,prevSpaces:0,position:new W};O.texture=C.texture,O.line=f,O.charCode=I,O.position.x=Math.round(s.x+C.xOffset+this._letterSpacing/2),O.position.y=Math.round(s.y+C.yOffset),O.prevSpaces=y,i.push(O),c=O.position.x+Math.max(C.xAdvance-C.xOffset,C.texture.orig.width),s.x+=C.xAdvance+this._letterSpacing,v=Math.max(v,C.yOffset+C.texture.height),l=I,_!==-1&&u>0&&s.x>u&&(++g,Ui(i,1+_-g,1+S-_),S=_,_=-1,n.push(m),o.push(i.length>0?i[i.length-1].prevSpaces:0),p=Math.max(p,m),f++,s.x=0,s.y+=e.lineHeight,l=null,y=0)}const x=h[h.length-1];x!=="\r"&&x!==`
`&&(/(?:\s)/.test(x)&&(c=m),n.push(c),p=Math.max(p,c),o.push(-1));const E=[];for(let S=0;S<=f;S++){let M=0;this._align==="right"?M=p-n[S]:this._align==="center"?M=(p-n[S])/2:this._align==="justify"&&(M=o[S]<0?0:(p-n[S])/o[S]),E.push(M)}const T=i.length,w={},b=[],A=this._activePagesMeshData;d.push(...A);for(let S=0;S<T;S++){const M=i[S].texture,I=M.baseTexture.uid;if(!w[I]){let C=d.pop();if(!C){const L=new xa;let D,Y;e.distanceFieldType==="none"?(D=new Wn(U.EMPTY),Y=V.NORMAL):(D=new Wn(U.EMPTY,{program:sr.from(bT,xT),uniforms:{uFWidth:0}}),Y=V.NORMAL_NPM);const Z=new ii(L,D);Z.blendMode=Y,C={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Z,vertices:null,uvs:null,indices:null}}C.index=0,C.indexCount=0,C.vertexCount=0,C.uvsCount=0,C.total=0;const{_textureCache:O}=this;O[I]=O[I]||new U(M.baseTexture),C.mesh.texture=O[I],C.mesh.tint=this._tintColor.value,b.push(C),w[I]=C}w[I].total++}for(let S=0;S<A.length;S++)b.includes(A[S])||this.removeChild(A[S].mesh);for(let S=0;S<b.length;S++)b[S].mesh.parent!==this&&this.addChild(b[S].mesh);this._activePagesMeshData=b;for(const S in w){const M=w[S],I=M.total;if(!(((R=M.indices)==null?void 0:R.length)>6*I)||M.vertices.length<ii.BATCHABLE_SIZE*2)M.vertices=new Float32Array(4*2*I),M.uvs=new Float32Array(4*2*I),M.indices=new Uint16Array(6*I);else{const C=M.total,O=M.vertices;for(let L=C*4*2;L<O.length;L++)O[L]=0}M.mesh.size=6*I}for(let S=0;S<T;S++){const M=i[S];let I=M.position.x+E[M.line]*(this._align==="justify"?M.prevSpaces:1);this._roundPixels&&(I=Math.round(I));const C=I*r,O=M.position.y*r,L=M.texture,D=w[L.baseTexture.uid],Y=L.frame,Z=L._uvs,P=D.index++;D.indices[P*6+0]=0+P*4,D.indices[P*6+1]=1+P*4,D.indices[P*6+2]=2+P*4,D.indices[P*6+3]=0+P*4,D.indices[P*6+4]=2+P*4,D.indices[P*6+5]=3+P*4,D.vertices[P*8+0]=C,D.vertices[P*8+1]=O,D.vertices[P*8+2]=C+Y.width*r,D.vertices[P*8+3]=O,D.vertices[P*8+4]=C+Y.width*r,D.vertices[P*8+5]=O+Y.height*r,D.vertices[P*8+6]=C,D.vertices[P*8+7]=O+Y.height*r,D.uvs[P*8+0]=Z.x0,D.uvs[P*8+1]=Z.y0,D.uvs[P*8+2]=Z.x1,D.uvs[P*8+3]=Z.y1,D.uvs[P*8+4]=Z.x2,D.uvs[P*8+5]=Z.y2,D.uvs[P*8+6]=Z.x3,D.uvs[P*8+7]=Z.y3}this._textWidth=p*r,this._textHeight=(s.y+e.lineHeight)*r;for(const S in w){const M=w[S];if(this.anchor.x!==0||this.anchor.y!==0){let L=0;const D=this._textWidth*this.anchor.x,Y=this._textHeight*this.anchor.y;for(let Z=0;Z<M.total;Z++)M.vertices[L++]-=D,M.vertices[L++]-=Y,M.vertices[L++]-=D,M.vertices[L++]-=Y,M.vertices[L++]-=D,M.vertices[L++]-=Y,M.vertices[L++]-=D,M.vertices[L++]-=Y}this._maxLineHeight=v*r;const I=M.mesh.geometry.getBuffer("aVertexPosition"),C=M.mesh.geometry.getBuffer("aTextureCoord"),O=M.mesh.geometry.getIndex();I.data=M.vertices,C.data=M.uvs,O.data=M.indices,I.update(),C.update(),O.update()}for(let S=0;S<i.length;S++)k_.push(i[S]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:r,size:s}=ge.available[this._fontName];if(r!=="none"){const{a:i,b:n,c:o,d:a}=this.worldTransform,h=Math.sqrt(i*i+n*n),u=Math.sqrt(o*o+a*a),d=(Math.abs(h)+Math.abs(u))/2,l=this.fontSize/s,c=e._view.resolution;for(const p of this._activePagesMeshData)p.mesh.shader.uniforms.uFWidth=d*t*l*c}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=ge.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!ge.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??ge.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:t}=this,r=ge.available[this._fontName].distanceFieldType==="none"?D_:O_;r.push(...this._activePagesMeshData);for(const s of this._activePagesMeshData)this.removeChild(s.mesh);this._activePagesMeshData=[],r.filter(s=>t[s.mesh.texture.baseTexture.uid]).forEach(s=>{s.mesh.texture=U.EMPTY});for(const s in t)t[s].destroy(),delete t[s];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};let L_=N_;L_.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const TT=[".xml",".fnt"],ET={extension:{type:B.LoadParser,priority:Ir.Normal},name:"loadBitmapFont",test(e){return TT.includes(se.extname(e).toLowerCase())},async testParse(e){return Ga.test(e)||Tu.test(e)},async parse(e,t,r){const s=Ga.test(e)?Ga.parse(e):Tu.parse(e),{src:i}=t,{page:n}=s,o=[];for(let u=0;u<n.length;++u){const d=n[u].file;let l=se.join(se.dirname(i),d);l=cu(l,i),o.push(l)}const a=await r.load(o),h=o.map(u=>a[u]);return ge.install(s,h,!0)},async load(e,t){return(await F.ADAPTER.fetch(e)).text()},unload(e){e.destroy()}};z.add(ET);const Zi=class extends Kr{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new Zi(Object.keys(Zi.defaultOptions).reduce((t,r)=>({...t,[r]:e[r]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete Zi.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,t={}){const{availableFonts:r}=Zi;if(r[e]){const s=r[e];return this._fonts.push(s),s.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return F.ADAPTER.fetch(e).then(s=>s.blob()).then(async s=>new Promise((i,n)=>{const o=URL.createObjectURL(s),a=new FileReader;a.onload=()=>i([o,a.result]),a.onerror=n,a.readAsDataURL(s)})).then(async([s,i])=>{const n=Object.assign({family:se.basename(e,se.extname(e)),weight:"normal",style:"normal",src:s,dataSrc:i,refs:1,originalUrl:e,fontFace:null},t);r[e]=n,this._fonts.push(n),this.styleID++;const o=new FontFace(n.family,`url(${n.src})`,{weight:n.weight,style:n.style});n.fontFace=o,await o.load(),document.fonts.add(o),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const t=e.filter(r=>!this._overrides.includes(r));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){const t=e.filter(r=>this._overrides.includes(r));t.length>0&&(this._overrides=this._overrides.filter(r=>!t.includes(r)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,t)=>`${e}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style}; 
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=Bi(e)),typeof e=="number"?_v(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const t=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),s=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(t*255|0).toString(16).padStart(2,"0"));const i=`${r}px ${s}px`;return this.dropShadowBlur>0?`text-shadow: ${i} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${i} ${e}`}reset(){Object.assign(this,Zi.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=F.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};let eo=Zi;eo.availableFonts={},eo.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};const Qi=class extends me{constructor(e="",t={}){super(U.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;const r=new Image,s=U.from(r,{scaleMode:F.SCALE_MODE,resourceOptions:{autoLoad:!1}});s.orig=new K,s.trim=new K,this.texture=s;const i="http://www.w3.org/2000/svg",n="http://www.w3.org/1999/xhtml",o=document.createElementNS(i,"svg"),a=document.createElementNS(i,"foreignObject"),h=document.createElementNS(n,"div"),u=document.createElementNS(n,"style");a.setAttribute("width","10000"),a.setAttribute("height","10000"),a.style.overflow="hidden",o.appendChild(a),this.maxWidth=Qi.defaultMaxWidth,this.maxHeight=Qi.defaultMaxHeight,this._domElement=h,this._styleElement=u,this._svgRoot=o,this._foreignObject=a,this._foreignObject.appendChild(u),this._foreignObject.appendChild(h),this._image=r,this._loadImage=new Image,this._autoResolution=Qi.defaultAutoResolution,this._resolution=Qi.defaultResolution??F.RESOLUTION,this.text=e,this.style=t}measureText(e){var a,h;const{text:t,style:r,resolution:s}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:r.toCSS(s)}),this._styleElement.textContent=r.toGlobalCSS(),document.body.appendChild(this._svgRoot);const i=this._domElement.getBoundingClientRect();this._svgRoot.remove();const n=Math.min(this.maxWidth,Math.ceil(i.width)),o=Math.min(this.maxHeight,Math.ceil(i.height));return this._svgRoot.setAttribute("width",n.toString()),this._svgRoot.setAttribute("height",o.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),r!==this._style&&(Object.assign(this._domElement,{style:(a=this._style)==null?void 0:a.toCSS(s)}),this._styleElement.textContent=(h=this._style)==null?void 0:h.toGlobalCSS()),{width:n+r.padding*2,height:o+r.padding*2}}async updateText(e=!0){const{style:t,_image:r,_loadImage:s}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;const{width:i,height:n}=this.measureText();r.width=s.width=Math.ceil(Math.max(1,i)),r.height=s.height=Math.ceil(Math.max(1,n)),this._loading||(this._loading=!0,await new Promise(o=>{s.onload=async()=>{await t.onBeforeDraw(),this._loading=!1,r.src=s.src,s.onload=null,s.src="",this.updateTexture(),o()};const a=new XMLSerializer().serializeToString(this._svgRoot);s.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(a)}`}))}get source(){return this._image}updateTexture(){const{style:e,texture:t,_image:r,resolution:s}=this,{padding:i}=e,{baseTexture:n}=t;t.trim.width=t._frame.width=r.width/s,t.trim.height=t._frame.height=r.height/s,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-i*2,t.orig.height=t._frame.height-i*2,this._onTextureUpdate(),n.setRealSize(r.width,r.height,s),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var r,s,i,n,o;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Qi.defaultDestroyOptions,e),super.destroy(e);const t=null;this.ownsStyle&&((r=this._style)==null||r.cleanFonts()),this._style=t,(s=this._svgRoot)==null||s.remove(),this._svgRoot=t,(i=this._domElement)==null||i.remove(),this._domElement=t,(n=this._foreignObject)==null||n.remove(),this._foreignObject=t,(o=this._styleElement)==null||o.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const t=cs(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const t=cs(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof eo?(this.ownsStyle=!1,this._style=e):e instanceof Kr?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=eo.from(e)):(this.ownsStyle=!0,this._style=new eo(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};let za=Qi;za.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},za.defaultMaxWidth=2024,za.defaultMaxHeight=2024,za.defaultAutoResolution=!0;function F_(e,t){if(e instanceof Wr){for(let r=0;r<e.points.length;r+=2)e.points[r]+=t.x,e.points[r+1]+=t.y;return e}else return e.x+=t.x,e.y+=t.y,e}function wT(e,t){let r;if(t===void 0||t.length===0)if(it.cache.has(e))r=it.cache.get(e);else if(it.get(e))r=it.get(e).texture;else throw new Error('Asset "'+e+'" not loaded into Pixi cache');else if(t instanceof Array){const s=t.length;for(let i=0;i<s;i++){const n=t[i];if(it.get(e)){const o=it.get(e).textures;if(o!==void 0){if(r=o[e],r!==void 0)break}else throw new Error('Spritesheet "'+n+'" loaded but textures arent!')}else throw new Error('Spritesheet "'+n+'" not loaded into Pixi cache')}if(r===void 0)throw new Error('Asset "'+e+'" not found inside spritesheets "'+t.toString()+"'")}else if(it.get(t)){const s=it.get(t).textures;if(s!==void 0){if(!s.hasOwnProperty(e))throw new Error('Asset "'+e+'" not found inside spritesheet "'+t+"'");r=s[e]}else throw new Error('Spritesheet "'+t+'" loaded but textures arent?!')}else throw new Error('Spritesheet "'+t+'" not loaded into Pixi cache');return r||new me().texture}function B_(){const e="(-webkit-min-device-pixel-ratio: 1.5),            (min--moz-device-pixel-ratio: 1.5),            (-o-min-device-pixel-ratio: 3/2),            (min-resolution: 1.5dppx)";return window.devicePixelRatio>1?!0:(window.matchMedia&&window.matchMedia(e).matches)===null}function AT(){return!!/(?:; ([^;)]+) Build\/.*)?\bSilk\/([0-9._-]+)\b(.*\bMobile Safari\b)?/.exec(navigator.userAgent)}function U_(){return Er.any}function ST(){return window.location.protocol==="https"}class CT{constructor(t){t===void 0?t={antialias:!1,autoStart:!1,background:void 0,backgroundAlpha:0,backgroundColor:"transparent",clearBeforeRender:!1,context:null,eventFeatures:void 0,eventMode:void 0,forceCanvas:!1,height:0,hello:!1,powerPreference:"default",premultipliedAlpha:!1,preserveDrawingBuffer:!1,resizeTo:void 0,sharedTicker:!1,useContextAlpha:void 0,view:void 0,width:0,autoDensity:!0,resolution:U_()?B_()?2:1:2}:((t.autoDensity===void 0||!t.autoDensity)&&(t.autoDensity=!0),t.powerPreference===void 0&&(t.powerPreference="default")),typeof(t==null?void 0:t.resolution)!="number"?this.resolution=U_()?B_()?2:1:2:(this.resolution=t.resolution,this.resolution=Math.round(this.resolution),this.resolution=ai(this.resolution,1,2)),t!=null&&t.transparent?this.transparent=t.transparent:this.transparent=AT();for(const r in t)t.hasOwnProperty(r)&&(r==="resolution"||r==="transparent"||(this[r]=t[r]))}}const wu="LoadAssets",G_="LoadComplete",Au="UnloadAssets",Su="ShowLoadScreen",Cu="HideLoadScreen",H_="StateInit",z_="StateTransitionHalted",IT="StateTransitionResumeFromHalt",V_="StateLoadState",X_="LoadScreenHidden",W_="ShowPopup",j_="HidePopup",Y_="HideAllPopups",$_="HideTopmostPopup",q_="HidePopupComplete",RT="HideAllPopupsComplete",K_="PlayAudio",Z_="LoadAudio",Iu="LoadAudioFromToken",Va="AudioLoadError",Ru="PlayCaption",Q_="StopCaption",J_="GamePaused",tm="GameUnpaused",Mu="VoiceoverStarted",ro="VoiceoverEnded",MT="DragBegin",PT="DragEnd",DT="DraggableSelected",OT="DraggableDeselected",em="RegisterFocusable",rm="RegisterFocusables",sm="UnregisterFocusable",im="UnregisterFocusables",nm="UnregisterAllFocusables",om="ClearFocus",am="ForceFocus",kT="ReMapKeyboard",Pu="PushKeyboardLayer",Du="PopKeyboardLayer",hm="KeyboardForceNeighbours",lm="KeyboardClearNeighbours",NT="SetKeyboardAutomap",um="SetKeyboardEnabled",cm="GetKeyboardStatus",dm="KeyboardFocusBegin",Ou="KeyboardFocusEnd",LT="KeyboardRefocus",pm="LandscapeOrientation",fm="PortraitOrientation",FT=Object.freeze(Object.defineProperty({__proto__:null,AUDIO_LOAD_ERROR:Va,CLEAR_FOCUS:om,DRAGGABLE_DESELECTED:OT,DRAGGABLE_SELECTED:DT,DRAG_BEGIN:MT,DRAG_END:PT,FORCE_FOCUS:am,GAME_PAUSED:J_,GAME_UNPAUSED:tm,GET_KEYBOARD_STATUS:cm,HIDE_ALL_POPUPS:Y_,HIDE_ALL_POPUPS_COMPLETE:RT,HIDE_LOAD_SCREEN:Cu,HIDE_POPUP:j_,HIDE_POPUP_COMPLETE:q_,HIDE_TOPMOST_POPUP:$_,KEYBOARD_CLEAR_NEIGHBOURS:lm,KEYBOARD_FOCUS_BEGIN:dm,KEYBOARD_FOCUS_END:Ou,KEYBOARD_FORCE_NEIGHBOURS:hm,KEYBOARD_REFOCUS:LT,LANDSCAPE_ORIENTATION:pm,LOAD_ASSETS:wu,LOAD_AUDIO:Z_,LOAD_AUDIO_FROM_ASSET_MAP:Iu,LOAD_COMPLETE:G_,LOAD_SCREEN_HIDDEN:X_,PLAY_AUDIO:K_,PLAY_CAPTION:Ru,POP_KEYBOARD_LAYER:Du,PORTRAIT_ORIENTATION:fm,PUSH_KEYBOARD_LAYER:Pu,REGISTER_FOCUSABLE:em,REGISTER_FOCUSABLES:rm,RE_MAP_KEYBOARD:kT,SET_KEYBOARD_AUTOMAP:NT,SET_KEYBOARD_ENABLED:um,SHOW_LOAD_SCREEN:Su,SHOW_POPUP:W_,STATE_INIT:H_,STATE_LOAD_STATE:V_,STATE_TRANSITION_HALTED:z_,STATE_TRANSITION_RESUME_FROM_HALT:IT,STOP_CAPTION:Q_,UNLOAD_ASSETS:Au,UNREGISTER_ALL_FOCUSABLES:nm,UNREGISTER_FOCUSABLE:sm,UNREGISTER_FOCUSABLES:im,VOICEOVER_ENDED:ro,VOICEOVER_STARTED:Mu},Symbol.toStringTag,{value:"Module"}));class BT{constructor(t){this.app=t,this._isPortrait=void 0,this._enabled=!1,this._showOnLandscape=!1}init(t,r=!1){this._enabled=!0,this._promptImage=document.createElement("img"),this._promptImage.src=wT(t).baseTexture.imageUrl,this._showOnLandscape=r,this.enablePromptImage(!1),window.addEventListener("resize",()=>this.onResize()),window.addEventListener("orientationchange",()=>this.onResize()),this.onResize()}onResize(t){if(this._enabled)switch(window.orientation){case-90:case 90:this.enablePromptImage(this._showOnLandscape),(this._isPortrait||this._isPortrait===void 0)&&(this._isPortrait=!1,this.onLandscapeOrientation!==void 0&&this.onLandscapeOrientation(),PubSub.publish(pm,void 0));break;default:this.enablePromptImage(!this._showOnLandscape),this._isPortrait||(this._isPortrait=!0,this.onPortraitOrientation!==void 0&&this.onPortraitOrientation(),PubSub.publish(fm,void 0));break}}enablePromptImage(t){if(this._promptImage)if(t)document.body.append(this._promptImage),this._promptImage.id="orientation-prompt-image",this._promptImage.style.position="fixed",this._promptImage.style.width="100vw",this._promptImage.style.height="100vh",this._promptImage.style.top="0",this._promptImage.style.left="0",this._promptImage.style.objectFit="cover",this._promptImage.style.objectPosition="center",this._promptImage.style.cursor="auto",this._promptImage.style.pointerEvents="auto";else try{this._promptImage.remove()}catch{}}}class _m{constructor(t,r,s){this.app=t,this._useAspectRatio=!1,r&&(this._useAspectRatio=!0,this._sizeMin=r,s?this._sizeMax=s:this._sizeMax=r),this._useAspectRatio?this.updateRatio():(this._sizeMin=new W(0,0),this._sizeMax=new W(0,0))}get useAspectRatio(){return this._useAspectRatio}set sizeMin(t){this._sizeMin.copyFrom(t),this.updateRatio()}set sizeMax(t){this._sizeMax.copyFrom(t),this.updateRatio()}get windowAspectRatio(){return window.innerWidth/window.innerHeight}get gameAspectRatio(){return ai(this.windowAspectRatio,this._ratioMin,this._ratioMax)}getSize(){const t=new W;return t.y=this._sizeMax.y,t.x=t.y*this.gameAspectRatio,t}getStageScale(){return this.gameAspectRatio<this.windowAspectRatio?window.innerHeight/this.getSize().y:window.innerWidth/this.getSize().x}updateRatio(){this._ratioMin=this._sizeMin.x/this._sizeMin.y,this._ratioMax=this._sizeMax.x/this._sizeMax.y}}class UT{constructor(t){this.app=t,this._visibilityChangedCallbacks=new Array,document.addEventListener("visibilitychange",this.onVisibilityChanged.bind(this),!1),this._resizeCallbacks=new Array,window.addEventListener("resize",this.onResize.bind(this)),document.addEventListener("fullscreenchange",this.onResize.bind(this))}registerVisibilityChangedCallback(t){return this._visibilityChangedCallbacks.indexOf(t)===-1?(this._visibilityChangedCallbacks.push(t),!0):!1}unregisterVisibilityChangedCallback(t){const r=this._visibilityChangedCallbacks.indexOf(t);r>-1&&this._visibilityChangedCallbacks.splice(r,1)}registerResizeCallback(t){return this._resizeCallbacks.indexOf(t)===-1?(this._resizeCallbacks.push(t),!0):!1}unregisterResizeCallback(t){const r=this._resizeCallbacks.indexOf(t);r>-1&&this._resizeCallbacks.splice(r,1)}onVisibilityChanged(){this._visibilityChangedCallbacks.forEach(t=>{t(!document.hidden)})}onResize(){this._resizeCallbacks.forEach(t=>{t()})}}let mm,gm,ku;mm="modulepreload",gm=function(e){return"/"+e},ku={},So=function(e,t,r){if(!t||t.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(i=>{if(i=gm(i),i in ku)return;ku[i]=!0;const n=i.endsWith(".css"),o=n?'[rel="stylesheet"]':"";if(r)for(let h=s.length-1;h>=0;h--){const u=s[h];if(u.href===i&&(!n||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${o}`))return;const a=document.createElement("link");if(a.rel=n?"stylesheet":mm,n||(a.as="script",a.crossOrigin=""),a.href=i,document.head.appendChild(a),n)return new Promise((h,u)=>{a.addEventListener("load",h),a.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e())};var Xa={exports:{}};Xa.exports,function(e,t){(function(r,s){var i={};r.PubSub?(i=r.PubSub,console.warn("PubSub already loaded, using existing version")):(r.PubSub=i,s(i)),e!==void 0&&e.exports&&(t=e.exports=i),t.PubSub=i,e.exports=t=i})(typeof window=="object"&&window||Jt,function(r){var s={},i=-1,n="*";function o(_){var m;for(m in _)if(Object.prototype.hasOwnProperty.call(_,m))return!0;return!1}function a(_){return function(){throw _}}function h(_,m,g){try{_(m,g)}catch(v){setTimeout(a(v),0)}}function u(_,m,g){_(m,g)}function d(_,m,g,v){var y=s[m],x=v?u:h,E;if(Object.prototype.hasOwnProperty.call(s,m))for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&x(y[E],_,g)}function l(_,m,g){return function(){var v=String(_),y=v.lastIndexOf(".");for(d(_,_,m,g);y!==-1;)v=v.substr(0,y),y=v.lastIndexOf("."),d(_,v,m,g);d(_,n,m,g)}}function c(_){var m=String(_),g=!!(Object.prototype.hasOwnProperty.call(s,m)&&o(s[m]));return g}function p(_){for(var m=String(_),g=c(m)||c(n),v=m.lastIndexOf(".");!g&&v!==-1;)m=m.substr(0,v),v=m.lastIndexOf("."),g=c(m);return g}function f(_,m,g,v){_=typeof _=="symbol"?_.toString():_;var y=l(_,m,v),x=p(_);return x?(g===!0?y():setTimeout(y,0),!0):!1}r.publish=function(_,m){return f(_,m,!1,r.immediateExceptions)},r.publishSync=function(_,m){return f(_,m,!0,r.immediateExceptions)},r.subscribe=function(_,m){if(typeof m!="function")return!1;_=typeof _=="symbol"?_.toString():_,Object.prototype.hasOwnProperty.call(s,_)||(s[_]={});var g="uid_"+String(++i);return s[_][g]=m,g},r.subscribeAll=function(_){return r.subscribe(n,_)},r.subscribeOnce=function(_,m){var g=r.subscribe(_,function(){r.unsubscribe(g),m.apply(this,arguments)});return r},r.clearAllSubscriptions=function(){s={}},r.clearSubscriptions=function(_){var m;for(m in s)Object.prototype.hasOwnProperty.call(s,m)&&m.indexOf(_)===0&&delete s[m]},r.countSubscriptions=function(_){var m,g,v=0;for(m in s)if(Object.prototype.hasOwnProperty.call(s,m)&&m.indexOf(_)===0){for(g in s[m])v++;break}return v},r.getSubscriptions=function(_){var m,g=[];for(m in s)Object.prototype.hasOwnProperty.call(s,m)&&m.indexOf(_)===0&&g.push(m);return g},r.unsubscribe=function(_){var m=function(b){var A;for(A in s)if(Object.prototype.hasOwnProperty.call(s,A)&&A.indexOf(b)===0)return!0;return!1},g=typeof _=="string"&&(Object.prototype.hasOwnProperty.call(s,_)||m(_)),v=!g&&typeof _=="string",y=typeof _=="function",x=!1,E,T,w;if(g){r.clearSubscriptions(_);return}for(E in s)if(Object.prototype.hasOwnProperty.call(s,E)){if(T=s[E],v&&T[_]){delete T[_],x=_;break}if(y)for(w in T)Object.prototype.hasOwnProperty.call(T,w)&&T[w]===_&&(delete T[w],x=!0)}return x}})}(Xa,Xa.exports);var ym=Xa.exports;const vm="default",so="vo";var xs=(e=>(e.LOAD="load",e.LOAD_ERROR="loaderror",e.PLAY_ERROR="playerror",e.PLAY="play",e.END="end",e.PAUSE="pause",e.STOP="stop",e.MUTE="mute",e.VOLUME="volume",e.RATE="rate",e.SEEK="seek",e.FADE="fade",e.UNLOCK="unlock",e))(xs||{}),Ji=(e=>(e.UNLOADED="unloaded",e.LOADING="loading",e.LOADED="loaded",e))(Ji||{}),zt={},ie={},Me={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Object.prototype.hasOwnProperty;e.has=function(l,c){return t.call(l,c)};function r(l,c){return l<c?-1:l===c?0:1}e.defaultCompare=r;function s(l,c){return l===c}e.defaultEquals=s;function i(l){return l===null?"COLLECTION_NULL":a(l)?"COLLECTION_UNDEFINED":h(l)?"$s"+l:"$o"+l.toString()}e.defaultToString=i;function n(l,c){if(c===void 0&&(c=","),l===null)return"COLLECTION_NULL";if(a(l))return"COLLECTION_UNDEFINED";if(h(l))return l.toString();var p="{",f=!0;for(var _ in l)e.has(l,_)&&(f?f=!1:p=p+c,p=p+_+":"+l[_]);return p+"}"}e.makeString=n;function o(l){return typeof l=="function"}e.isFunction=o;function a(l){return typeof l>"u"}e.isUndefined=a;function h(l){return Object.prototype.toString.call(l)==="[object String]"}e.isString=h;function u(l){return a(l)||!o(l)?function(c,p){return c<p?1:c===p?0:-1}:function(c,p){return l(c,p)*-1}}e.reverseCompareFunction=u;function d(l){return function(c,p){return l(c,p)===0}}e.compareToEquals=d})(Me),Object.defineProperty(ie,"__esModule",{value:!0});var Wa=Me;function Nu(e,t,r){for(var s=r||Wa.defaultEquals,i=e.length,n=0;n<i;n++)if(s(e[n],t))return n;return-1}ie.indexOf=Nu;function GT(e,t,r){for(var s=r||Wa.defaultEquals,i=e.length,n=i-1;n>=0;n--)if(s(e[n],t))return n;return-1}ie.lastIndexOf=GT;function HT(e,t,r){return Nu(e,t,r)>=0}ie.contains=HT;function zT(e,t,r){var s=Nu(e,t,r);return s<0?!1:(e.splice(s,1),!0)}ie.remove=zT;function VT(e,t,r){for(var s=r||Wa.defaultEquals,i=e.length,n=0,o=0;o<i;o++)s(e[o],t)&&n++;return n}ie.frequency=VT;function XT(e,t,r){var s=r||Wa.defaultEquals;if(e.length!==t.length)return!1;for(var i=e.length,n=0;n<i;n++)if(!s(e[n],t[n]))return!1;return!0}ie.equals=XT;function WT(e){return e.concat()}ie.copy=WT;function jT(e,t,r){if(t<0||t>=e.length||r<0||r>=e.length)return!1;var s=e[t];return e[t]=e[r],e[r]=s,!0}ie.swap=jT;function YT(e){return"["+e.toString()+"]"}ie.toString=YT;function $T(e,t){for(var r=0,s=e;r<s.length;r++){var i=s[r];if(t(i)===!1)return}}ie.forEach=$T;var Lu={},bs={};Object.defineProperty(bs,"__esModule",{value:!0});var Rr=Me,qT=function(){function e(t){this.table={},this.nElements=0,this.toStr=t||Rr.defaultToString}return e.prototype.getValue=function(t){var r=this.table["$"+this.toStr(t)];if(!Rr.isUndefined(r))return r.value},e.prototype.setValue=function(t,r){if(!(Rr.isUndefined(t)||Rr.isUndefined(r))){var s,i="$"+this.toStr(t),n=this.table[i];return Rr.isUndefined(n)?(this.nElements++,s=void 0):s=n.value,this.table[i]={key:t,value:r},s}},e.prototype.remove=function(t){var r="$"+this.toStr(t),s=this.table[r];if(!Rr.isUndefined(s))return delete this.table[r],this.nElements--,s.value},e.prototype.keys=function(){var t=[];for(var r in this.table)if(Rr.has(this.table,r)){var s=this.table[r];t.push(s.key)}return t},e.prototype.values=function(){var t=[];for(var r in this.table)if(Rr.has(this.table,r)){var s=this.table[r];t.push(s.value)}return t},e.prototype.forEach=function(t){for(var r in this.table)if(Rr.has(this.table,r)){var s=this.table[r],i=t(s.key,s.value);if(i===!1)return}},e.prototype.containsKey=function(t){return!Rr.isUndefined(this.getValue(t))},e.prototype.clear=function(){this.table={},this.nElements=0},e.prototype.size=function(){return this.nElements},e.prototype.isEmpty=function(){return this.nElements<=0},e.prototype.toString=function(){var t="{";return this.forEach(function(r,s){t+=`
	`+r+" : "+s}),t+`
}`},e}();bs.default=qT;var ja={};Object.defineProperty(ja,"__esModule",{value:!0});var KT=Me,ZT=ie,QT=bs,JT=function(){function e(t){this.dictionary=new QT.default(t)}return e.prototype.contains=function(t){return this.dictionary.containsKey(t)},e.prototype.add=function(t){return this.contains(t)||KT.isUndefined(t)?!1:(this.dictionary.setValue(t,t),!0)},e.prototype.intersection=function(t){var r=this;this.forEach(function(s){return t.contains(s)||r.remove(s),!0})},e.prototype.union=function(t){var r=this;t.forEach(function(s){return r.add(s),!0})},e.prototype.difference=function(t){var r=this;t.forEach(function(s){return r.remove(s),!0})},e.prototype.isSubsetOf=function(t){if(this.size()>t.size())return!1;var r=!0;return this.forEach(function(s){return t.contains(s)?!0:(r=!1,!1)}),r},e.prototype.remove=function(t){return this.contains(t)?(this.dictionary.remove(t),!0):!1},e.prototype.forEach=function(t){this.dictionary.forEach(function(r,s){return t(s)})},e.prototype.toArray=function(){return this.dictionary.values()},e.prototype.isEmpty=function(){return this.dictionary.isEmpty()},e.prototype.size=function(){return this.dictionary.size()},e.prototype.clear=function(){this.dictionary.clear()},e.prototype.toString=function(){return ZT.toString(this.toArray())},e}();ja.default=JT,Object.defineProperty(Lu,"__esModule",{value:!0});var Fu=Me,tE=bs,eE=ja,rE=function(){function e(t){this.toStrF=t||Fu.defaultToString,this.dictionary=new tE.default(this.toStrF),this.nElements=0}return e.prototype.add=function(t,r){if(r===void 0&&(r=1),Fu.isUndefined(t)||r<=0)return!1;if(this.contains(t))this.dictionary.getValue(t).copies+=r;else{var s={value:t,copies:r};this.dictionary.setValue(t,s)}return this.nElements+=r,!0},e.prototype.count=function(t){return this.contains(t)?this.dictionary.getValue(t).copies:0},e.prototype.contains=function(t){return this.dictionary.containsKey(t)},e.prototype.remove=function(t,r){if(r===void 0&&(r=1),Fu.isUndefined(t)||r<=0)return!1;if(this.contains(t)){var s=this.dictionary.getValue(t);return r>s.copies?this.nElements-=s.copies:this.nElements-=r,s.copies-=r,s.copies<=0&&this.dictionary.remove(t),!0}else return!1},e.prototype.toArray=function(){for(var t=[],r=this.dictionary.values(),s=0,i=r;s<i.length;s++)for(var n=i[s],o=n.value,a=n.copies,h=0;h<a;h++)t.push(o);return t},e.prototype.toSet=function(){for(var t=new eE.default(this.toStrF),r=this.dictionary.values(),s=0,i=r;s<i.length;s++){var n=i[s],o=n.value;t.add(o)}return t},e.prototype.forEach=function(t){this.dictionary.forEach(function(r,s){for(var i=s.value,n=s.copies,o=0;o<n;o++)if(t(i)===!1)return!1;return!0})},e.prototype.size=function(){return this.nElements},e.prototype.isEmpty=function(){return this.nElements===0},e.prototype.clear=function(){this.nElements=0,this.dictionary.clear()},e}();Lu.default=rE;var Bu={},Ya={},$a={},io={};Object.defineProperty(io,"__esModule",{value:!0});var ui=Me,sE=ie,iE=function(){function e(){this.firstNode=null,this.lastNode=null,this.nElements=0}return e.prototype.add=function(t,r){if(ui.isUndefined(r)&&(r=this.nElements),r<0||r>this.nElements||ui.isUndefined(t))return!1;var s=this.createNode(t);if(this.nElements===0||this.lastNode===null)this.firstNode=s,this.lastNode=s;else if(r===this.nElements)this.lastNode.next=s,this.lastNode=s;else if(r===0)s.next=this.firstNode,this.firstNode=s;else{var i=this.nodeAtIndex(r-1);if(i===null)return!1;s.next=i.next,i.next=s}return this.nElements++,!0},e.prototype.first=function(){if(this.firstNode!==null)return this.firstNode.element},e.prototype.last=function(){if(this.lastNode!==null)return this.lastNode.element},e.prototype.elementAtIndex=function(t){var r=this.nodeAtIndex(t);if(r!==null)return r.element},e.prototype.indexOf=function(t,r){var s=r||ui.defaultEquals;if(ui.isUndefined(t))return-1;for(var i=this.firstNode,n=0;i!==null;){if(s(i.element,t))return n;n++,i=i.next}return-1},e.prototype.contains=function(t,r){return this.indexOf(t,r)>=0},e.prototype.remove=function(t,r){var s=r||ui.defaultEquals;if(this.nElements<1||ui.isUndefined(t))return!1;for(var i=null,n=this.firstNode;n!==null;){if(s(n.element,t))return i===null?(this.firstNode=n.next,n===this.lastNode&&(this.lastNode=null)):n===this.lastNode?(this.lastNode=i,i.next=n.next,n.next=null):(i.next=n.next,n.next=null),this.nElements--,!0;i=n,n=n.next}return!1},e.prototype.clear=function(){this.firstNode=null,this.lastNode=null,this.nElements=0},e.prototype.equals=function(t,r){var s=r||ui.defaultEquals;return!(t instanceof e)||this.size()!==t.size()?!1:this.equalsAux(this.firstNode,t.firstNode,s)},e.prototype.equalsAux=function(t,r,s){for(;t!==null&&r!==null;){if(!s(t.element,r.element))return!1;t=t.next,r=r.next}return!0},e.prototype.removeElementAtIndex=function(t){if(!(t<0||t>=this.nElements||this.firstNode===null||this.lastNode===null)){var r;if(this.nElements===1)r=this.firstNode.element,this.firstNode=null,this.lastNode=null;else{var s=this.nodeAtIndex(t-1);s===null?(r=this.firstNode.element,this.firstNode=this.firstNode.next):s.next===this.lastNode&&(r=this.lastNode.element,this.lastNode=s),s!==null&&s.next!==null&&(r=s.next.element,s.next=s.next.next)}return this.nElements--,r}},e.prototype.forEach=function(t){for(var r=this.firstNode;r!==null&&t(r.element)!==!1;)r=r.next},e.prototype.reverse=function(){for(var t=null,r=this.firstNode,s=null;r!==null;)s=r.next,r.next=t,t=r,r=s;s=this.firstNode,this.firstNode=this.lastNode,this.lastNode=s},e.prototype.toArray=function(){for(var t=[],r=this.firstNode;r!==null;)t.push(r.element),r=r.next;return t},e.prototype.size=function(){return this.nElements},e.prototype.isEmpty=function(){return this.nElements<=0},e.prototype.toString=function(){return sE.toString(this.toArray())},e.prototype.nodeAtIndex=function(t){if(t<0||t>=this.nElements)return null;if(t===this.nElements-1)return this.lastNode;for(var r=this.firstNode,s=0;s<t&&r!==null;s++)r=r.next;return r},e.prototype.createNode=function(t){return{element:t,next:null}},e}();io.default=iE,Object.defineProperty($a,"__esModule",{value:!0});var nE=io,oE=function(){function e(){this.list=new nE.default}return e.prototype.enqueue=function(t){return this.list.add(t)},e.prototype.add=function(t){return this.list.add(t)},e.prototype.dequeue=function(){if(this.list.size()!==0){var t=this.list.first();return this.list.removeElementAtIndex(0),t}},e.prototype.peek=function(){if(this.list.size()!==0)return this.list.first()},e.prototype.size=function(){return this.list.size()},e.prototype.contains=function(t,r){return this.list.contains(t,r)},e.prototype.isEmpty=function(){return this.list.size()<=0},e.prototype.clear=function(){this.list.clear()},e.prototype.forEach=function(t){this.list.forEach(t)},e}();$a.default=oE,Object.defineProperty(Ya,"__esModule",{value:!0});var Uu=Me,aE=$a,hE=function(){function e(t){this.root=null,this.compare=t||Uu.defaultCompare,this.nElements=0}return e.prototype.add=function(t){return Uu.isUndefined(t)?!1:this.insertNode(this.createNode(t))!==null?(this.nElements++,!0):!1},e.prototype.clear=function(){this.root=null,this.nElements=0},e.prototype.isEmpty=function(){return this.nElements===0},e.prototype.size=function(){return this.nElements},e.prototype.contains=function(t){return Uu.isUndefined(t)?!1:this.searchNode(this.root,t)!==null},e.prototype.search=function(t){var r=this.searchNode(this.root,t);if(r!==null)return r.element},e.prototype.remove=function(t){var r=this.searchNode(this.root,t);return r===null?!1:(this.removeNode(r),this.nElements--,!0)},e.prototype.inorderTraversal=function(t){this.inorderTraversalAux(this.root,t,{stop:!1})},e.prototype.preorderTraversal=function(t){this.preorderTraversalAux(this.root,t,{stop:!1})},e.prototype.postorderTraversal=function(t){this.postorderTraversalAux(this.root,t,{stop:!1})},e.prototype.levelTraversal=function(t){this.levelTraversalAux(this.root,t)},e.prototype.minimum=function(){if(!(this.isEmpty()||this.root===null))return this.minimumAux(this.root).element},e.prototype.maximum=function(){if(!(this.isEmpty()||this.root===null))return this.maximumAux(this.root).element},e.prototype.forEach=function(t){this.inorderTraversal(t)},e.prototype.toArray=function(){var t=[];return this.inorderTraversal(function(r){return t.push(r),!0}),t},e.prototype.height=function(){return this.heightAux(this.root)},e.prototype.searchNode=function(t,r){for(var s=1;t!==null&&s!==0;)s=this.compare(r,t.element),s<0?t=t.leftCh:s>0&&(t=t.rightCh);return t},e.prototype.transplant=function(t,r){t.parent===null?this.root=r:t===t.parent.leftCh?t.parent.leftCh=r:t.parent.rightCh=r,r!==null&&(r.parent=t.parent)},e.prototype.removeNode=function(t){if(t.leftCh===null)this.transplant(t,t.rightCh);else if(t.rightCh===null)this.transplant(t,t.leftCh);else{var r=this.minimumAux(t.rightCh);r.parent!==t&&(this.transplant(r,r.rightCh),r.rightCh=t.rightCh,r.rightCh.parent=r),this.transplant(t,r),r.leftCh=t.leftCh,r.leftCh.parent=r}},e.prototype.inorderTraversalAux=function(t,r,s){t===null||s.stop||(this.inorderTraversalAux(t.leftCh,r,s),!s.stop&&(s.stop=r(t.element)===!1,!s.stop&&this.inorderTraversalAux(t.rightCh,r,s)))},e.prototype.levelTraversalAux=function(t,r){var s=new aE.default;for(t!==null&&s.enqueue(t),t=s.dequeue()||null;t!=null;){if(r(t.element)===!1)return;t.leftCh!==null&&s.enqueue(t.leftCh),t.rightCh!==null&&s.enqueue(t.rightCh),t=s.dequeue()||null}},e.prototype.preorderTraversalAux=function(t,r,s){t===null||s.stop||(s.stop=r(t.element)===!1,!s.stop&&(this.preorderTraversalAux(t.leftCh,r,s),!s.stop&&this.preorderTraversalAux(t.rightCh,r,s)))},e.prototype.postorderTraversalAux=function(t,r,s){t===null||s.stop||(this.postorderTraversalAux(t.leftCh,r,s),!s.stop&&(this.postorderTraversalAux(t.rightCh,r,s),!s.stop&&(s.stop=r(t.element)===!1)))},e.prototype.minimumAux=function(t){for(;t!=null&&t.leftCh!==null;)t=t.leftCh;return t},e.prototype.maximumAux=function(t){for(;t!=null&&t.rightCh!==null;)t=t.rightCh;return t},e.prototype.heightAux=function(t){return t===null?-1:Math.max(this.heightAux(t.leftCh),this.heightAux(t.rightCh))+1},e.prototype.insertNode=function(t){for(var r=null,s=this.root;s!==null;){var i=this.compare(t.element,s.element);if(i===0)return null;i<0?(r=s,s=s.leftCh):(r=s,s=s.rightCh)}return t.parent=r,r===null?this.root=t:this.compare(t.element,r.element)<0?r.leftCh=t:r.rightCh=t,t},e.prototype.createNode=function(t){return{element:t,leftCh:null,rightCh:null,parent:null}},e}();Ya.default=hE;var lE=Jt&&Jt.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)r.hasOwnProperty(s)&&(t[s]=r[s])};return function(t,r){e(t,r);function s(){this.constructor=t}t.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(Bu,"__esModule",{value:!0});var uE=Ya,cE=function(e){lE(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(uE.default);Bu.default=cE;var qa={};Object.defineProperty(qa,"__esModule",{value:!0});var Gu=Me,Ka=ie,dE=function(){function e(t){this.data=[],this.compare=t||Gu.defaultCompare}return e.prototype.leftChildIndex=function(t){return 2*t+1},e.prototype.rightChildIndex=function(t){return 2*t+2},e.prototype.parentIndex=function(t){return Math.floor((t-1)/2)},e.prototype.minIndex=function(t,r){return r>=this.data.length?t>=this.data.length?-1:t:this.compare(this.data[t],this.data[r])<=0?t:r},e.prototype.siftUp=function(t){for(var r=this.parentIndex(t);t>0&&this.compare(this.data[r],this.data[t])>0;)Ka.swap(this.data,r,t),t=r,r=this.parentIndex(t)},e.prototype.siftDown=function(t){for(var r=this.minIndex(this.leftChildIndex(t),this.rightChildIndex(t));r>=0&&this.compare(this.data[t],this.data[r])>0;)Ka.swap(this.data,r,t),t=r,r=this.minIndex(this.leftChildIndex(t),this.rightChildIndex(t))},e.prototype.peek=function(){if(this.data.length>0)return this.data[0]},e.prototype.add=function(t){return Gu.isUndefined(t)?!1:(this.data.push(t),this.siftUp(this.data.length-1),!0)},e.prototype.removeRoot=function(){if(this.data.length>0){var t=this.data[0];return this.data[0]=this.data[this.data.length-1],this.data.splice(this.data.length-1,1),this.data.length>0&&this.siftDown(0),t}},e.prototype.contains=function(t){var r=Gu.compareToEquals(this.compare);return Ka.contains(this.data,t,r)},e.prototype.size=function(){return this.data.length},e.prototype.isEmpty=function(){return this.data.length<=0},e.prototype.clear=function(){this.data.length=0},e.prototype.forEach=function(t){Ka.forEach(this.data,t)},e}();qa.default=dE;var Hu={},pE=Jt&&Jt.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)r.hasOwnProperty(s)&&(t[s]=r[s])};return function(t,r){e(t,r);function s(){this.constructor=t}t.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(Hu,"__esModule",{value:!0});var fE=bs,tn=Me,_E=function(){function e(t,r){this.key=t,this.value=r}return e.prototype.unlink=function(){this.prev.next=this.next,this.next.prev=this.prev},e}(),xm=function(){function e(){this.key=null,this.value=null}return e.prototype.unlink=function(){this.prev.next=this.next,this.next.prev=this.prev},e}();function mE(e){return!e.next}var gE=function(e){pE(t,e);function t(r){var s=e.call(this,r)||this;return s.head=new xm,s.tail=new xm,s.head.next=s.tail,s.tail.prev=s.head,s}return t.prototype.appendToTail=function(r){var s=this.tail.prev;s.next=r,r.prev=s,r.next=this.tail,this.tail.prev=r},t.prototype.getLinkedDictionaryPair=function(r){if(!tn.isUndefined(r)){var s="$"+this.toStr(r),i=this.table[s];return i}},t.prototype.getValue=function(r){var s=this.getLinkedDictionaryPair(r);if(!tn.isUndefined(s))return s.value},t.prototype.remove=function(r){var s=this.getLinkedDictionaryPair(r);if(!tn.isUndefined(s))return e.prototype.remove.call(this,r),s.unlink(),s.value},t.prototype.clear=function(){e.prototype.clear.call(this),this.head.next=this.tail,this.tail.prev=this.head},t.prototype.replace=function(r,s){var i="$"+this.toStr(s.key);s.next=r.next,s.prev=r.prev,this.remove(r.key),s.prev.next=s,s.next.prev=s,this.table[i]=s,++this.nElements},t.prototype.setValue=function(r,s){if(!(tn.isUndefined(r)||tn.isUndefined(s))){var i=this.getLinkedDictionaryPair(r),n=new _E(r,s),o="$"+this.toStr(r);if(tn.isUndefined(i)){this.appendToTail(n),this.table[o]=n,++this.nElements;return}else return this.replace(i,n),i.value}},t.prototype.keys=function(){var r=[];return this.forEach(function(s,i){r.push(s)}),r},t.prototype.values=function(){var r=[];return this.forEach(function(s,i){r.push(i)}),r},t.prototype.forEach=function(r){for(var s=this.head.next;!mE(s);){var i=r(s.key,s.value);if(i===!1)return;s=s.next}},t}(fE.default);Hu.default=gE;var zu={};Object.defineProperty(zu,"__esModule",{value:!0});var Ts=Me,yE=bs,Vu=ie,vE=function(){function e(t,r,s){s===void 0&&(s=!1),this.dict=new yE.default(t),this.equalsF=r||Ts.defaultEquals,this.allowDuplicate=s}return e.prototype.getValue=function(t){var r=this.dict.getValue(t);return Ts.isUndefined(r)?[]:Vu.copy(r)},e.prototype.setValue=function(t,r){if(Ts.isUndefined(t)||Ts.isUndefined(r))return!1;var s=this.dict.getValue(t);return Ts.isUndefined(s)?(this.dict.setValue(t,[r]),!0):!this.allowDuplicate&&Vu.contains(s,r,this.equalsF)?!1:(s.push(r),!0)},e.prototype.remove=function(t,r){if(Ts.isUndefined(r)){var s=this.dict.remove(t);return!Ts.isUndefined(s)}var i=this.dict.getValue(t);return!Ts.isUndefined(i)&&Vu.remove(i,r,this.equalsF)?(i.length===0&&this.dict.remove(t),!0):!1},e.prototype.keys=function(){return this.dict.keys()},e.prototype.values=function(){for(var t=this.dict.values(),r=[],s=0,i=t;s<i.length;s++)for(var n=i[s],o=0,a=n;o<a.length;o++){var h=a[o];r.push(h)}return r},e.prototype.containsKey=function(t){return this.dict.containsKey(t)},e.prototype.clear=function(){this.dict.clear()},e.prototype.size=function(){return this.dict.size()},e.prototype.isEmpty=function(){return this.dict.isEmpty()},e}();zu.default=vE;var Za={},xE=Jt&&Jt.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)r.hasOwnProperty(s)&&(t[s]=r[s])};return function(t,r){e(t,r);function s(){this.constructor=t}t.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(Za,"__esModule",{value:!0});var bE=bs,TE=Me,EE=function(e){xE(t,e);function t(r,s){var i=e.call(this,s)||this;return i.defaultFactoryFunction=r,i}return t.prototype.setDefault=function(r,s){var i=e.prototype.getValue.call(this,r);return TE.isUndefined(i)?(this.setValue(r,s),s):i},t.prototype.getValue=function(r){return this.setDefault(r,this.defaultFactoryFunction())},t}(bE.default);Za.default=EE;var Xu={};Object.defineProperty(Xu,"__esModule",{value:!0});var wE=Me,AE=qa,SE=function(){function e(t){this.heap=new AE.default(wE.reverseCompareFunction(t))}return e.prototype.enqueue=function(t){return this.heap.add(t)},e.prototype.add=function(t){return this.heap.add(t)},e.prototype.dequeue=function(){if(this.heap.size()!==0){var t=this.heap.peek();return this.heap.removeRoot(),t}},e.prototype.peek=function(){return this.heap.peek()},e.prototype.contains=function(t){return this.heap.contains(t)},e.prototype.isEmpty=function(){return this.heap.isEmpty()},e.prototype.size=function(){return this.heap.size()},e.prototype.clear=function(){this.heap.clear()},e.prototype.forEach=function(t){this.heap.forEach(t)},e}();Xu.default=SE;var Wu={};Object.defineProperty(Wu,"__esModule",{value:!0});var CE=io,IE=function(){function e(){this.list=new CE.default}return e.prototype.push=function(t){return this.list.add(t,0)},e.prototype.add=function(t){return this.list.add(t,0)},e.prototype.pop=function(){return this.list.removeElementAtIndex(0)},e.prototype.peek=function(){return this.list.first()},e.prototype.size=function(){return this.list.size()},e.prototype.contains=function(t,r){return this.list.contains(t,r)},e.prototype.isEmpty=function(){return this.list.isEmpty()},e.prototype.clear=function(){this.list.clear()},e.prototype.forEach=function(t){this.list.forEach(t)},e}();Wu.default=IE;var ju={};Object.defineProperty(ju,"__esModule",{value:!0});var Et;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER",e[e.INSIDE_AT_END=2]="INSIDE_AT_END",e[e.INSIDE_AT_START=3]="INSIDE_AT_START"})(Et||(Et={}));var RE=function(){function e(t,r){t===void 0&&(t=[]),r===void 0&&(r={}),this.rootIds=t,this.nodes=r,this.initRootIds(),this.initNodes()}return e.prototype.initRootIds=function(){for(var t=0,r=this.rootIds;t<r.length;t++){var s=r[t];this.createEmptyNodeIfNotExist(s)}},e.prototype.initNodes=function(){for(var t in this.nodes)if(this.nodes.hasOwnProperty(t))for(var r=0,s=this.nodes[t];r<s.length;r++){var i=s[r];this.createEmptyNodeIfNotExist(i)}},e.prototype.createEmptyNodeIfNotExist=function(t){this.nodes[t]||(this.nodes[t]=[])},e.prototype.getRootIds=function(){var t=this.rootIds.slice();return t},e.prototype.getNodes=function(){var t={};for(var r in this.nodes)this.nodes.hasOwnProperty(r)&&(t[r]=this.nodes[r].slice());return t},e.prototype.getObject=function(){return{rootIds:this.getRootIds(),nodes:this.getNodes()}},e.prototype.toObject=function(){return this.getObject()},e.prototype.flatten=function(){for(var t=this,r=[],s=0;s<this.rootIds.length;s++){var i=this.rootIds[s];r.push({id:i,level:0,hasParent:!1,childrenCount:0}),u(i,this.nodes,r,0)}for(var n=0,o=r;n<o.length;n++){var a=o[n];a.childrenCount=h(a.id)}return r;function h(d){if(t.nodes[d]){var l=t.nodes[d].length;return l}else return 0}function u(d,l,c,p){if(p===void 0&&(p=0),!(!d||!l||!c||!l[d])){p++;for(var f=l[d],_=0;_<f.length;_++){var m=f[_];c.push({id:m,level:p,hasParent:!0}),u(m,l,c,p)}p--}}},e.prototype.moveIdBeforeId=function(t,r){return this.moveId(t,r,Et.BEFORE)},e.prototype.moveIdAfterId=function(t,r){return this.moveId(t,r,Et.AFTER)},e.prototype.moveIdIntoId=function(t,r,s){return s===void 0&&(s=!0),s?this.moveId(t,r,Et.INSIDE_AT_START):this.moveId(t,r,Et.INSIDE_AT_END)},e.prototype.swapRootIdWithRootId=function(t,r){var s=this.findRootId(t),i=this.findRootId(r);this.swapRootPositionWithRootPosition(s,i)},e.prototype.swapRootPositionWithRootPosition=function(t,r){var s=this.rootIds[r];this.rootIds[r]=this.rootIds[t],this.rootIds[t]=s},e.prototype.deleteId=function(t){this.rootDeleteId(t),this.nodeAndSubNodesDelete(t),this.nodeRefrencesDelete(t)},e.prototype.insertIdBeforeId=function(t,r){var s=this.findRootId(t);s>-1&&this.insertIdIntoRoot(r,s);for(var i in this.nodes)if(this.nodes.hasOwnProperty(i)){var n=this.findNodeId(i,t);n>-1&&this.insertIdIntoNode(i,r,n)}},e.prototype.insertIdAfterId=function(t,r){var s=this.findRootId(t);s>-1&&this.insertIdIntoRoot(r,s+1);for(var i in this.nodes)if(this.nodes.hasOwnProperty(i)){var n=this.findNodeId(i,t);n>-1&&this.insertIdIntoNode(i,r,n+1)}},e.prototype.insertIdIntoId=function(t,r){this.nodeInsertAtEnd(t,r),this.nodes[r]=[]},e.prototype.insertIdIntoRoot=function(t,r){if(r===void 0)this.rootInsertAtEnd(t);else if(r<0){var s=this.rootIds.length;this.rootIds.splice(r+s+1,0,t)}else this.rootIds.splice(r,0,t);this.nodes[t]=this.nodes[t]||[]},e.prototype.insertIdIntoNode=function(t,r,s){if(this.nodes[t]=this.nodes[t]||[],this.nodes[r]=this.nodes[r]||[],s===void 0)this.nodeInsertAtEnd(t,r);else if(s<0){var i=this.nodes[t].length;this.nodes[t].splice(s+i+1,0,r)}else this.nodes[t].splice(s,0,r)},e.prototype.moveId=function(t,r,s){var i=t,n=this.findRootId(i);this.nodes[r];for(var o in this.nodes)if(this.nodes.hasOwnProperty(o)){this.findNodeId(o,r);break}var a=r,h=this.findRootId(a);this.nodes[r];for(var o in this.nodes)if(this.nodes.hasOwnProperty(o)){this.findNodeId(o,r);break}if(n>-1)if(h>-1)switch(this.rootDelete(n),h>n&&h--,s){case Et.BEFORE:this.insertIdIntoRoot(i,h);break;case Et.AFTER:this.insertIdIntoRoot(i,h+1);break;case Et.INSIDE_AT_START:this.nodeInsertAtStart(a,i);break;case Et.INSIDE_AT_END:this.nodeInsertAtEnd(a,i);break}else{this.rootDelete(n);for(var o in this.nodes)if(this.nodes.hasOwnProperty(o)){var u=this.findNodeId(o,a);if(u>-1){switch(s){case Et.BEFORE:this.insertIdIntoNode(o,i,u);break;case Et.AFTER:this.insertIdIntoNode(o,i,u+1);break;case Et.INSIDE_AT_START:this.nodeInsertAtStart(a,i);break;case Et.INSIDE_AT_END:this.nodeInsertAtEnd(a,i);break}break}}}else if(h>-1){for(var o in this.nodes)if(this.nodes.hasOwnProperty(o)){var u=this.findNodeId(o,i);if(u>-1){this.nodeDeleteAtIndex(o,u);break}}switch(s){case Et.BEFORE:this.insertIdIntoRoot(i,h);break;case Et.AFTER:this.insertIdIntoRoot(i,h+1);break;case Et.INSIDE_AT_START:this.nodeInsertAtStart(a,i);break;case Et.INSIDE_AT_END:this.nodeInsertAtEnd(a,i);break}}else{for(var o in this.nodes)if(this.nodes.hasOwnProperty(o)){var u=this.findNodeId(o,i);if(u>-1){this.nodeDeleteAtIndex(o,u);break}}for(var o in this.nodes)if(this.nodes.hasOwnProperty(o)){var u=this.findNodeId(o,a);if(u>-1){switch(s){case Et.BEFORE:this.insertIdIntoNode(o,i,u);break;case Et.AFTER:this.insertIdIntoNode(o,i,u+1);break;case Et.INSIDE_AT_START:this.nodeInsertAtStart(a,i);break;case Et.INSIDE_AT_END:this.nodeInsertAtEnd(a,i);break}break}}}},e.prototype.swapArrayElements=function(t,r,s){var i=t[r];return t[r]=t[s],t[s]=i,t},e.prototype.rootDeleteId=function(t){var r=this.findRootId(t);r>-1&&this.rootDelete(r)},e.prototype.nodeAndSubNodesDelete=function(t){for(var r=[],s=0;s<this.nodes[t].length;s++){var i=this.nodes[t][s];this.nodeAndSubNodesDelete(i),r.push(t)}this.nodeDelete(t);for(var s=0;s<r.length;s++)this.nodeDelete(r[s])},e.prototype.nodeRefrencesDelete=function(t){for(var r in this.nodes)if(this.nodes.hasOwnProperty(r))for(var s=0;s<this.nodes[r].length;s++){var i=this.nodes[r][s];i===t&&this.nodeDeleteAtIndex(r,s)}},e.prototype.nodeDelete=function(t){delete this.nodes[t]},e.prototype.findRootId=function(t){return this.rootIds.indexOf(t)},e.prototype.findNodeId=function(t,r){return this.nodes[t].indexOf(r)},e.prototype.findNode=function(t){return this.nodes[t]},e.prototype.nodeInsertAtStart=function(t,r){this.nodes[t].unshift(r)},e.prototype.nodeInsertAtEnd=function(t,r){this.nodes[t].push(r)},e.prototype.rootDelete=function(t){this.rootIds.splice(t,1)},e.prototype.nodeDeleteAtIndex=function(t,r){this.nodes[t].splice(r,1)},e.prototype.rootInsertAtStart=function(t){this.rootIds.unshift(t)},e.prototype.rootInsertAtEnd=function(t){this.rootIds.push(t)},e}();ju.default=RE,Object.defineProperty(zt,"__esModule",{value:!0});var ME=ie;zt.arrays=ME;var PE=Lu;zt.Bag=PE.default;var DE=Bu;zt.BSTree=DE.default;var OE=Ya;zt.BSTreeKV=OE.default;var kE=bs,Es=zt.Dictionary=kE.default,NE=qa;zt.Heap=NE.default;var LE=Hu;zt.LinkedDictionary=LE.default;var FE=io;zt.LinkedList=FE.default;var BE=zu;zt.MultiDictionary=BE.default;var UE=Za;zt.FactoryDictionary=UE.default;var GE=Za;zt.DefaultDictionary=GE.default;var HE=$a;zt.Queue=HE.default;var zE=Xu;zt.PriorityQueue=zE.default;var VE=ja;zt.Set=VE.default;var XE=Wu;zt.Stack=XE.default;var WE=ju;zt.MultiRootTree=WE.default;var jE=Me;zt.util=jE;class YE{constructor(){this._tracks=new Es,this._volume=1}get volume(){return this._volume}set volume(t){this._volume=ai(t,0,1)}get tracks(){return this._tracks}}var bm={};(function(e){(function(){var t=function(){this.init()};t.prototype={init:function(){var l=this||r;return l._counter=1e3,l._html5AudioPool=[],l.html5PoolSize=10,l._codecs={},l._howls=[],l._muted=!1,l._volume=1,l._canPlayEvent="canplaythrough",l._navigator=typeof window<"u"&&window.navigator?window.navigator:null,l.masterGain=null,l.noAudio=!1,l.usingWebAudio=!0,l.autoSuspend=!0,l.ctx=null,l.autoUnlock=!0,l._setup(),l},volume:function(l){var c=this||r;if(l=parseFloat(l),c.ctx||d(),typeof l<"u"&&l>=0&&l<=1){if(c._volume=l,c._muted)return c;c.usingWebAudio&&c.masterGain.gain.setValueAtTime(l,r.ctx.currentTime);for(var p=0;p<c._howls.length;p++)if(!c._howls[p]._webAudio)for(var f=c._howls[p]._getSoundIds(),_=0;_<f.length;_++){var m=c._howls[p]._soundById(f[_]);m&&m._node&&(m._node.volume=m._volume*l)}return c}return c._volume},mute:function(l){var c=this||r;c.ctx||d(),c._muted=l,c.usingWebAudio&&c.masterGain.gain.setValueAtTime(l?0:c._volume,r.ctx.currentTime);for(var p=0;p<c._howls.length;p++)if(!c._howls[p]._webAudio)for(var f=c._howls[p]._getSoundIds(),_=0;_<f.length;_++){var m=c._howls[p]._soundById(f[_]);m&&m._node&&(m._node.muted=l?!0:m._muted)}return c},stop:function(){for(var l=this||r,c=0;c<l._howls.length;c++)l._howls[c].stop();return l},unload:function(){for(var l=this||r,c=l._howls.length-1;c>=0;c--)l._howls[c].unload();return l.usingWebAudio&&l.ctx&&typeof l.ctx.close<"u"&&(l.ctx.close(),l.ctx=null,d()),l},codecs:function(l){return(this||r)._codecs[l.replace(/^x-/,"")]},_setup:function(){var l=this||r;if(l.state=l.ctx&&l.ctx.state||"suspended",l._autoSuspend(),!l.usingWebAudio)if(typeof Audio<"u")try{var c=new Audio;typeof c.oncanplaythrough>"u"&&(l._canPlayEvent="canplay")}catch{l.noAudio=!0}else l.noAudio=!0;try{var c=new Audio;c.muted&&(l.noAudio=!0)}catch{}return l.noAudio||l._setupCodecs(),l},_setupCodecs:function(){var l=this||r,c=null;try{c=typeof Audio<"u"?new Audio:null}catch{return l}if(!c||typeof c.canPlayType!="function")return l;var p=c.canPlayType("audio/mpeg;").replace(/^no$/,""),f=l._navigator?l._navigator.userAgent:"",_=f.match(/OPR\/([0-6].)/g),m=_&&parseInt(_[0].split("/")[1],10)<33,g=f.indexOf("Safari")!==-1&&f.indexOf("Chrome")===-1,v=f.match(/Version\/(.*?) /),y=g&&v&&parseInt(v[1],10)<15;return l._codecs={mp3:!!(!m&&(p||c.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!p,opus:!!c.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(c.canPlayType('audio/wav; codecs="1"')||c.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!c.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!c.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(c.canPlayType("audio/x-m4a;")||c.canPlayType("audio/m4a;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(c.canPlayType("audio/x-m4b;")||c.canPlayType("audio/m4b;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(c.canPlayType("audio/x-mp4;")||c.canPlayType("audio/mp4;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!y&&c.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!y&&c.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!c.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(c.canPlayType("audio/x-flac;")||c.canPlayType("audio/flac;")).replace(/^no$/,"")},l},_unlockAudio:function(){var l=this||r;if(!(l._audioUnlocked||!l.ctx)){l._audioUnlocked=!1,l.autoUnlock=!1,!l._mobileUnloaded&&l.ctx.sampleRate!==44100&&(l._mobileUnloaded=!0,l.unload()),l._scratchBuffer=l.ctx.createBuffer(1,1,22050);var c=function(p){for(;l._html5AudioPool.length<l.html5PoolSize;)try{var f=new Audio;f._unlocked=!0,l._releaseHtml5Audio(f)}catch{l.noAudio=!0;break}for(var _=0;_<l._howls.length;_++)if(!l._howls[_]._webAudio)for(var m=l._howls[_]._getSoundIds(),g=0;g<m.length;g++){var v=l._howls[_]._soundById(m[g]);v&&v._node&&!v._node._unlocked&&(v._node._unlocked=!0,v._node.load())}l._autoResume();var y=l.ctx.createBufferSource();y.buffer=l._scratchBuffer,y.connect(l.ctx.destination),typeof y.start>"u"?y.noteOn(0):y.start(0),typeof l.ctx.resume=="function"&&l.ctx.resume(),y.onended=function(){y.disconnect(0),l._audioUnlocked=!0,document.removeEventListener("touchstart",c,!0),document.removeEventListener("touchend",c,!0),document.removeEventListener("click",c,!0),document.removeEventListener("keydown",c,!0);for(var x=0;x<l._howls.length;x++)l._howls[x]._emit("unlock")}};return document.addEventListener("touchstart",c,!0),document.addEventListener("touchend",c,!0),document.addEventListener("click",c,!0),document.addEventListener("keydown",c,!0),l}},_obtainHtml5Audio:function(){var l=this||r;if(l._html5AudioPool.length)return l._html5AudioPool.pop();var c=new Audio().play();return c&&typeof Promise<"u"&&(c instanceof Promise||typeof c.then=="function")&&c.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(l){var c=this||r;return l._unlocked&&c._html5AudioPool.push(l),c},_autoSuspend:function(){var l=this;if(!(!l.autoSuspend||!l.ctx||typeof l.ctx.suspend>"u"||!r.usingWebAudio)){for(var c=0;c<l._howls.length;c++)if(l._howls[c]._webAudio){for(var p=0;p<l._howls[c]._sounds.length;p++)if(!l._howls[c]._sounds[p]._paused)return l}return l._suspendTimer&&clearTimeout(l._suspendTimer),l._suspendTimer=setTimeout(function(){if(l.autoSuspend){l._suspendTimer=null,l.state="suspending";var f=function(){l.state="suspended",l._resumeAfterSuspend&&(delete l._resumeAfterSuspend,l._autoResume())};l.ctx.suspend().then(f,f)}},3e4),l}},_autoResume:function(){var l=this;if(!(!l.ctx||typeof l.ctx.resume>"u"||!r.usingWebAudio))return l.state==="running"&&l.ctx.state!=="interrupted"&&l._suspendTimer?(clearTimeout(l._suspendTimer),l._suspendTimer=null):l.state==="suspended"||l.state==="running"&&l.ctx.state==="interrupted"?(l.ctx.resume().then(function(){l.state="running";for(var c=0;c<l._howls.length;c++)l._howls[c]._emit("resume")}),l._suspendTimer&&(clearTimeout(l._suspendTimer),l._suspendTimer=null)):l.state==="suspending"&&(l._resumeAfterSuspend=!0),l}};var r=new t,s=function(l){var c=this;if(!l.src||l.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}c.init(l)};s.prototype={init:function(l){var c=this;return r.ctx||d(),c._autoplay=l.autoplay||!1,c._format=typeof l.format!="string"?l.format:[l.format],c._html5=l.html5||!1,c._muted=l.mute||!1,c._loop=l.loop||!1,c._pool=l.pool||5,c._preload=typeof l.preload=="boolean"||l.preload==="metadata"?l.preload:!0,c._rate=l.rate||1,c._sprite=l.sprite||{},c._src=typeof l.src!="string"?l.src:[l.src],c._volume=l.volume!==void 0?l.volume:1,c._xhr={method:l.xhr&&l.xhr.method?l.xhr.method:"GET",headers:l.xhr&&l.xhr.headers?l.xhr.headers:null,withCredentials:l.xhr&&l.xhr.withCredentials?l.xhr.withCredentials:!1},c._duration=0,c._state="unloaded",c._sounds=[],c._endTimers={},c._queue=[],c._playLock=!1,c._onend=l.onend?[{fn:l.onend}]:[],c._onfade=l.onfade?[{fn:l.onfade}]:[],c._onload=l.onload?[{fn:l.onload}]:[],c._onloaderror=l.onloaderror?[{fn:l.onloaderror}]:[],c._onplayerror=l.onplayerror?[{fn:l.onplayerror}]:[],c._onpause=l.onpause?[{fn:l.onpause}]:[],c._onplay=l.onplay?[{fn:l.onplay}]:[],c._onstop=l.onstop?[{fn:l.onstop}]:[],c._onmute=l.onmute?[{fn:l.onmute}]:[],c._onvolume=l.onvolume?[{fn:l.onvolume}]:[],c._onrate=l.onrate?[{fn:l.onrate}]:[],c._onseek=l.onseek?[{fn:l.onseek}]:[],c._onunlock=l.onunlock?[{fn:l.onunlock}]:[],c._onresume=[],c._webAudio=r.usingWebAudio&&!c._html5,typeof r.ctx<"u"&&r.ctx&&r.autoUnlock&&r._unlockAudio(),r._howls.push(c),c._autoplay&&c._queue.push({event:"play",action:function(){c.play()}}),c._preload&&c._preload!=="none"&&c.load(),c},load:function(){var l=this,c=null;if(r.noAudio){l._emit("loaderror",null,"No audio support.");return}typeof l._src=="string"&&(l._src=[l._src]);for(var p=0;p<l._src.length;p++){var f,_;if(l._format&&l._format[p])f=l._format[p];else{if(_=l._src[p],typeof _!="string"){l._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}f=/^data:audio\/([^;,]+);/i.exec(_),f||(f=/\.([^.]+)$/.exec(_.split("?",1)[0])),f&&(f=f[1].toLowerCase())}if(f||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),f&&r.codecs(f)){c=l._src[p];break}}if(!c){l._emit("loaderror",null,"No codec support for selected audio sources.");return}return l._src=c,l._state="loading",window.location.protocol==="https:"&&c.slice(0,5)==="http:"&&(l._html5=!0,l._webAudio=!1),new i(l),l._webAudio&&o(l),l},play:function(l,c){var p=this,f=null;if(typeof l=="number")f=l,l=null;else{if(typeof l=="string"&&p._state==="loaded"&&!p._sprite[l])return null;if(typeof l>"u"&&(l="__default",!p._playLock)){for(var _=0,m=0;m<p._sounds.length;m++)p._sounds[m]._paused&&!p._sounds[m]._ended&&(_++,f=p._sounds[m]._id);_===1?l=null:f=null}}var g=f?p._soundById(f):p._inactiveSound();if(!g)return null;if(f&&!l&&(l=g._sprite||"__default"),p._state!=="loaded"){g._sprite=l,g._ended=!1;var v=g._id;return p._queue.push({event:"play",action:function(){p.play(v)}}),v}if(f&&!g._paused)return c||p._loadQueue("play"),g._id;p._webAudio&&r._autoResume();var y=Math.max(0,g._seek>0?g._seek:p._sprite[l][0]/1e3),x=Math.max(0,(p._sprite[l][0]+p._sprite[l][1])/1e3-y),E=x*1e3/Math.abs(g._rate),T=p._sprite[l][0]/1e3,w=(p._sprite[l][0]+p._sprite[l][1])/1e3;g._sprite=l,g._ended=!1;var b=function(){g._paused=!1,g._seek=y,g._start=T,g._stop=w,g._loop=!!(g._loop||p._sprite[l][2])};if(y>=w){p._ended(g);return}var A=g._node;if(p._webAudio){var R=function(){p._playLock=!1,b(),p._refreshBuffer(g);var C=g._muted||p._muted?0:g._volume;A.gain.setValueAtTime(C,r.ctx.currentTime),g._playStart=r.ctx.currentTime,typeof A.bufferSource.start>"u"?g._loop?A.bufferSource.noteGrainOn(0,y,86400):A.bufferSource.noteGrainOn(0,y,x):g._loop?A.bufferSource.start(0,y,86400):A.bufferSource.start(0,y,x),E!==1/0&&(p._endTimers[g._id]=setTimeout(p._ended.bind(p,g),E)),c||setTimeout(function(){p._emit("play",g._id),p._loadQueue()},0)};r.state==="running"&&r.ctx.state!=="interrupted"?R():(p._playLock=!0,p.once("resume",R),p._clearTimer(g._id))}else{var S=function(){A.currentTime=y,A.muted=g._muted||p._muted||r._muted||A.muted,A.volume=g._volume*r.volume(),A.playbackRate=g._rate;try{var C=A.play();if(C&&typeof Promise<"u"&&(C instanceof Promise||typeof C.then=="function")?(p._playLock=!0,b(),C.then(function(){p._playLock=!1,A._unlocked=!0,c?p._loadQueue():p._emit("play",g._id)}).catch(function(){p._playLock=!1,p._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),g._ended=!0,g._paused=!0})):c||(p._playLock=!1,b(),p._emit("play",g._id)),A.playbackRate=g._rate,A.paused){p._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}l!=="__default"||g._loop?p._endTimers[g._id]=setTimeout(p._ended.bind(p,g),E):(p._endTimers[g._id]=function(){p._ended(g),A.removeEventListener("ended",p._endTimers[g._id],!1)},A.addEventListener("ended",p._endTimers[g._id],!1))}catch(O){p._emit("playerror",g._id,O)}};A.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(A.src=p._src,A.load());var M=window&&window.ejecta||!A.readyState&&r._navigator.isCocoonJS;if(A.readyState>=3||M)S();else{p._playLock=!0,p._state="loading";var I=function(){p._state="loaded",S(),A.removeEventListener(r._canPlayEvent,I,!1)};A.addEventListener(r._canPlayEvent,I,!1),p._clearTimer(g._id)}}return g._id},pause:function(l){var c=this;if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"pause",action:function(){c.pause(l)}}),c;for(var p=c._getSoundIds(l),f=0;f<p.length;f++){c._clearTimer(p[f]);var _=c._soundById(p[f]);if(_&&!_._paused&&(_._seek=c.seek(p[f]),_._rateSeek=0,_._paused=!0,c._stopFade(p[f]),_._node))if(c._webAudio){if(!_._node.bufferSource)continue;typeof _._node.bufferSource.stop>"u"?_._node.bufferSource.noteOff(0):_._node.bufferSource.stop(0),c._cleanBuffer(_._node)}else(!isNaN(_._node.duration)||_._node.duration===1/0)&&_._node.pause();arguments[1]||c._emit("pause",_?_._id:null)}return c},stop:function(l,c){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"stop",action:function(){p.stop(l)}}),p;for(var f=p._getSoundIds(l),_=0;_<f.length;_++){p._clearTimer(f[_]);var m=p._soundById(f[_]);m&&(m._seek=m._start||0,m._rateSeek=0,m._paused=!0,m._ended=!0,p._stopFade(f[_]),m._node&&(p._webAudio?m._node.bufferSource&&(typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),p._cleanBuffer(m._node)):(!isNaN(m._node.duration)||m._node.duration===1/0)&&(m._node.currentTime=m._start||0,m._node.pause(),m._node.duration===1/0&&p._clearSound(m._node))),c||p._emit("stop",m._id))}return p},mute:function(l,c){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"mute",action:function(){p.mute(l,c)}}),p;if(typeof c>"u")if(typeof l=="boolean")p._muted=l;else return p._muted;for(var f=p._getSoundIds(c),_=0;_<f.length;_++){var m=p._soundById(f[_]);m&&(m._muted=l,m._interval&&p._stopFade(m._id),p._webAudio&&m._node?m._node.gain.setValueAtTime(l?0:m._volume,r.ctx.currentTime):m._node&&(m._node.muted=r._muted?!0:l),p._emit("mute",m._id))}return p},volume:function(){var l=this,c=arguments,p,f;if(c.length===0)return l._volume;if(c.length===1||c.length===2&&typeof c[1]>"u"){var _=l._getSoundIds(),m=_.indexOf(c[0]);m>=0?f=parseInt(c[0],10):p=parseFloat(c[0])}else c.length>=2&&(p=parseFloat(c[0]),f=parseInt(c[1],10));var g;if(typeof p<"u"&&p>=0&&p<=1){if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"volume",action:function(){l.volume.apply(l,c)}}),l;typeof f>"u"&&(l._volume=p),f=l._getSoundIds(f);for(var v=0;v<f.length;v++)g=l._soundById(f[v]),g&&(g._volume=p,c[2]||l._stopFade(f[v]),l._webAudio&&g._node&&!g._muted?g._node.gain.setValueAtTime(p,r.ctx.currentTime):g._node&&!g._muted&&(g._node.volume=p*r.volume()),l._emit("volume",g._id))}else return g=f?l._soundById(f):l._sounds[0],g?g._volume:0;return l},fade:function(l,c,p,f){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"fade",action:function(){_.fade(l,c,p,f)}}),_;l=Math.min(Math.max(0,parseFloat(l)),1),c=Math.min(Math.max(0,parseFloat(c)),1),p=parseFloat(p),_.volume(l,f);for(var m=_._getSoundIds(f),g=0;g<m.length;g++){var v=_._soundById(m[g]);if(v){if(f||_._stopFade(m[g]),_._webAudio&&!v._muted){var y=r.ctx.currentTime,x=y+p/1e3;v._volume=l,v._node.gain.setValueAtTime(l,y),v._node.gain.linearRampToValueAtTime(c,x)}_._startFadeInterval(v,l,c,p,m[g],typeof f>"u")}}return _},_startFadeInterval:function(l,c,p,f,_,m){var g=this,v=c,y=p-c,x=Math.abs(y/.01),E=Math.max(4,x>0?f/x:f),T=Date.now();l._fadeTo=p,l._interval=setInterval(function(){var w=(Date.now()-T)/f;T=Date.now(),v+=y*w,v=Math.round(v*100)/100,y<0?v=Math.max(p,v):v=Math.min(p,v),g._webAudio?l._volume=v:g.volume(v,l._id,!0),m&&(g._volume=v),(p<c&&v<=p||p>c&&v>=p)&&(clearInterval(l._interval),l._interval=null,l._fadeTo=null,g.volume(p,l._id),g._emit("fade",l._id))},E)},_stopFade:function(l){var c=this,p=c._soundById(l);return p&&p._interval&&(c._webAudio&&p._node.gain.cancelScheduledValues(r.ctx.currentTime),clearInterval(p._interval),p._interval=null,c.volume(p._fadeTo,l),p._fadeTo=null,c._emit("fade",l)),c},loop:function(){var l=this,c=arguments,p,f,_;if(c.length===0)return l._loop;if(c.length===1)if(typeof c[0]=="boolean")p=c[0],l._loop=p;else return _=l._soundById(parseInt(c[0],10)),_?_._loop:!1;else c.length===2&&(p=c[0],f=parseInt(c[1],10));for(var m=l._getSoundIds(f),g=0;g<m.length;g++)_=l._soundById(m[g]),_&&(_._loop=p,l._webAudio&&_._node&&_._node.bufferSource&&(_._node.bufferSource.loop=p,p&&(_._node.bufferSource.loopStart=_._start||0,_._node.bufferSource.loopEnd=_._stop,l.playing(m[g])&&(l.pause(m[g],!0),l.play(m[g],!0)))));return l},rate:function(){var l=this,c=arguments,p,f;if(c.length===0)f=l._sounds[0]._id;else if(c.length===1){var _=l._getSoundIds(),m=_.indexOf(c[0]);m>=0?f=parseInt(c[0],10):p=parseFloat(c[0])}else c.length===2&&(p=parseFloat(c[0]),f=parseInt(c[1],10));var g;if(typeof p=="number"){if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"rate",action:function(){l.rate.apply(l,c)}}),l;typeof f>"u"&&(l._rate=p),f=l._getSoundIds(f);for(var v=0;v<f.length;v++)if(g=l._soundById(f[v]),g){l.playing(f[v])&&(g._rateSeek=l.seek(f[v]),g._playStart=l._webAudio?r.ctx.currentTime:g._playStart),g._rate=p,l._webAudio&&g._node&&g._node.bufferSource?g._node.bufferSource.playbackRate.setValueAtTime(p,r.ctx.currentTime):g._node&&(g._node.playbackRate=p);var y=l.seek(f[v]),x=(l._sprite[g._sprite][0]+l._sprite[g._sprite][1])/1e3-y,E=x*1e3/Math.abs(g._rate);(l._endTimers[f[v]]||!g._paused)&&(l._clearTimer(f[v]),l._endTimers[f[v]]=setTimeout(l._ended.bind(l,g),E)),l._emit("rate",g._id)}}else return g=l._soundById(f),g?g._rate:l._rate;return l},seek:function(){var l=this,c=arguments,p,f;if(c.length===0)l._sounds.length&&(f=l._sounds[0]._id);else if(c.length===1){var _=l._getSoundIds(),m=_.indexOf(c[0]);m>=0?f=parseInt(c[0],10):l._sounds.length&&(f=l._sounds[0]._id,p=parseFloat(c[0]))}else c.length===2&&(p=parseFloat(c[0]),f=parseInt(c[1],10));if(typeof f>"u")return 0;if(typeof p=="number"&&(l._state!=="loaded"||l._playLock))return l._queue.push({event:"seek",action:function(){l.seek.apply(l,c)}}),l;var g=l._soundById(f);if(g)if(typeof p=="number"&&p>=0){var v=l.playing(f);v&&l.pause(f,!0),g._seek=p,g._ended=!1,l._clearTimer(f),!l._webAudio&&g._node&&!isNaN(g._node.duration)&&(g._node.currentTime=p);var y=function(){v&&l.play(f,!0),l._emit("seek",f)};if(v&&!l._webAudio){var x=function(){l._playLock?setTimeout(x,0):y()};setTimeout(x,0)}else y()}else if(l._webAudio){var E=l.playing(f)?r.ctx.currentTime-g._playStart:0,T=g._rateSeek?g._rateSeek-g._seek:0;return g._seek+(T+E*Math.abs(g._rate))}else return g._node.currentTime;return l},playing:function(l){var c=this;if(typeof l=="number"){var p=c._soundById(l);return p?!p._paused:!1}for(var f=0;f<c._sounds.length;f++)if(!c._sounds[f]._paused)return!0;return!1},duration:function(l){var c=this,p=c._duration,f=c._soundById(l);return f&&(p=c._sprite[f._sprite][1]/1e3),p},state:function(){return this._state},unload:function(){for(var l=this,c=l._sounds,p=0;p<c.length;p++)c[p]._paused||l.stop(c[p]._id),l._webAudio||(l._clearSound(c[p]._node),c[p]._node.removeEventListener("error",c[p]._errorFn,!1),c[p]._node.removeEventListener(r._canPlayEvent,c[p]._loadFn,!1),c[p]._node.removeEventListener("ended",c[p]._endFn,!1),r._releaseHtml5Audio(c[p]._node)),delete c[p]._node,l._clearTimer(c[p]._id);var f=r._howls.indexOf(l);f>=0&&r._howls.splice(f,1);var _=!0;for(p=0;p<r._howls.length;p++)if(r._howls[p]._src===l._src||l._src.indexOf(r._howls[p]._src)>=0){_=!1;break}return n&&_&&delete n[l._src],r.noAudio=!1,l._state="unloaded",l._sounds=[],l=null,null},on:function(l,c,p,f){var _=this,m=_["_on"+l];return typeof c=="function"&&m.push(f?{id:p,fn:c,once:f}:{id:p,fn:c}),_},off:function(l,c,p){var f=this,_=f["_on"+l],m=0;if(typeof c=="number"&&(p=c,c=null),c||p)for(m=0;m<_.length;m++){var g=p===_[m].id;if(c===_[m].fn&&g||!c&&g){_.splice(m,1);break}}else if(l)f["_on"+l]=[];else{var v=Object.keys(f);for(m=0;m<v.length;m++)v[m].indexOf("_on")===0&&Array.isArray(f[v[m]])&&(f[v[m]]=[])}return f},once:function(l,c,p){var f=this;return f.on(l,c,p,1),f},_emit:function(l,c,p){for(var f=this,_=f["_on"+l],m=_.length-1;m>=0;m--)(!_[m].id||_[m].id===c||l==="load")&&(setTimeout(function(g){g.call(this,c,p)}.bind(f,_[m].fn),0),_[m].once&&f.off(l,_[m].fn,_[m].id));return f._loadQueue(l),f},_loadQueue:function(l){var c=this;if(c._queue.length>0){var p=c._queue[0];p.event===l&&(c._queue.shift(),c._loadQueue()),l||p.action()}return c},_ended:function(l){var c=this,p=l._sprite;if(!c._webAudio&&l._node&&!l._node.paused&&!l._node.ended&&l._node.currentTime<l._stop)return setTimeout(c._ended.bind(c,l),100),c;var f=!!(l._loop||c._sprite[p][2]);if(c._emit("end",l._id),!c._webAudio&&f&&c.stop(l._id,!0).play(l._id),c._webAudio&&f){c._emit("play",l._id),l._seek=l._start||0,l._rateSeek=0,l._playStart=r.ctx.currentTime;var _=(l._stop-l._start)*1e3/Math.abs(l._rate);c._endTimers[l._id]=setTimeout(c._ended.bind(c,l),_)}return c._webAudio&&!f&&(l._paused=!0,l._ended=!0,l._seek=l._start||0,l._rateSeek=0,c._clearTimer(l._id),c._cleanBuffer(l._node),r._autoSuspend()),!c._webAudio&&!f&&c.stop(l._id,!0),c},_clearTimer:function(l){var c=this;if(c._endTimers[l]){if(typeof c._endTimers[l]!="function")clearTimeout(c._endTimers[l]);else{var p=c._soundById(l);p&&p._node&&p._node.removeEventListener("ended",c._endTimers[l],!1)}delete c._endTimers[l]}return c},_soundById:function(l){for(var c=this,p=0;p<c._sounds.length;p++)if(l===c._sounds[p]._id)return c._sounds[p];return null},_inactiveSound:function(){var l=this;l._drain();for(var c=0;c<l._sounds.length;c++)if(l._sounds[c]._ended)return l._sounds[c].reset();return new i(l)},_drain:function(){var l=this,c=l._pool,p=0,f=0;if(!(l._sounds.length<c)){for(f=0;f<l._sounds.length;f++)l._sounds[f]._ended&&p++;for(f=l._sounds.length-1;f>=0;f--){if(p<=c)return;l._sounds[f]._ended&&(l._webAudio&&l._sounds[f]._node&&l._sounds[f]._node.disconnect(0),l._sounds.splice(f,1),p--)}}},_getSoundIds:function(l){var c=this;if(typeof l>"u"){for(var p=[],f=0;f<c._sounds.length;f++)p.push(c._sounds[f]._id);return p}else return[l]},_refreshBuffer:function(l){var c=this;return l._node.bufferSource=r.ctx.createBufferSource(),l._node.bufferSource.buffer=n[c._src],l._panner?l._node.bufferSource.connect(l._panner):l._node.bufferSource.connect(l._node),l._node.bufferSource.loop=l._loop,l._loop&&(l._node.bufferSource.loopStart=l._start||0,l._node.bufferSource.loopEnd=l._stop||0),l._node.bufferSource.playbackRate.setValueAtTime(l._rate,r.ctx.currentTime),c},_cleanBuffer:function(l){var c=this,p=r._navigator&&r._navigator.vendor.indexOf("Apple")>=0;if(r._scratchBuffer&&l.bufferSource&&(l.bufferSource.onended=null,l.bufferSource.disconnect(0),p))try{l.bufferSource.buffer=r._scratchBuffer}catch{}return l.bufferSource=null,c},_clearSound:function(l){var c=/MSIE |Trident\//.test(r._navigator&&r._navigator.userAgent);c||(l.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(l){this._parent=l,this.init()};i.prototype={init:function(){var l=this,c=l._parent;return l._muted=c._muted,l._loop=c._loop,l._volume=c._volume,l._rate=c._rate,l._seek=0,l._paused=!0,l._ended=!0,l._sprite="__default",l._id=++r._counter,c._sounds.push(l),l.create(),l},create:function(){var l=this,c=l._parent,p=r._muted||l._muted||l._parent._muted?0:l._volume;return c._webAudio?(l._node=typeof r.ctx.createGain>"u"?r.ctx.createGainNode():r.ctx.createGain(),l._node.gain.setValueAtTime(p,r.ctx.currentTime),l._node.paused=!0,l._node.connect(r.masterGain)):r.noAudio||(l._node=r._obtainHtml5Audio(),l._errorFn=l._errorListener.bind(l),l._node.addEventListener("error",l._errorFn,!1),l._loadFn=l._loadListener.bind(l),l._node.addEventListener(r._canPlayEvent,l._loadFn,!1),l._endFn=l._endListener.bind(l),l._node.addEventListener("ended",l._endFn,!1),l._node.src=c._src,l._node.preload=c._preload===!0?"auto":c._preload,l._node.volume=p*r.volume(),l._node.load()),l},reset:function(){var l=this,c=l._parent;return l._muted=c._muted,l._loop=c._loop,l._volume=c._volume,l._rate=c._rate,l._seek=0,l._rateSeek=0,l._paused=!0,l._ended=!0,l._sprite="__default",l._id=++r._counter,l},_errorListener:function(){var l=this;l._parent._emit("loaderror",l._id,l._node.error?l._node.error.code:0),l._node.removeEventListener("error",l._errorFn,!1)},_loadListener:function(){var l=this,c=l._parent;c._duration=Math.ceil(l._node.duration*10)/10,Object.keys(c._sprite).length===0&&(c._sprite={__default:[0,c._duration*1e3]}),c._state!=="loaded"&&(c._state="loaded",c._emit("load"),c._loadQueue()),l._node.removeEventListener(r._canPlayEvent,l._loadFn,!1)},_endListener:function(){var l=this,c=l._parent;c._duration===1/0&&(c._duration=Math.ceil(l._node.duration*10)/10,c._sprite.__default[1]===1/0&&(c._sprite.__default[1]=c._duration*1e3),c._ended(l)),l._node.removeEventListener("ended",l._endFn,!1)}};var n={},o=function(l){var c=l._src;if(n[c]){l._duration=n[c].duration,u(l);return}if(/^data:[^;]+;base64,/.test(c)){for(var p=atob(c.split(",")[1]),f=new Uint8Array(p.length),_=0;_<p.length;++_)f[_]=p.charCodeAt(_);h(f.buffer,l)}else{var m=new XMLHttpRequest;m.open(l._xhr.method,c,!0),m.withCredentials=l._xhr.withCredentials,m.responseType="arraybuffer",l._xhr.headers&&Object.keys(l._xhr.headers).forEach(function(g){m.setRequestHeader(g,l._xhr.headers[g])}),m.onload=function(){var g=(m.status+"")[0];if(g!=="0"&&g!=="2"&&g!=="3"){l._emit("loaderror",null,"Failed loading audio file with status: "+m.status+".");return}h(m.response,l)},m.onerror=function(){l._webAudio&&(l._html5=!0,l._webAudio=!1,l._sounds=[],delete n[c],l.load())},a(m)}},a=function(l){try{l.send()}catch{l.onerror()}},h=function(l,c){var p=function(){c._emit("loaderror",null,"Decoding audio data failed.")},f=function(_){_&&c._sounds.length>0?(n[c._src]=_,u(c,_)):p()};typeof Promise<"u"&&r.ctx.decodeAudioData.length===1?r.ctx.decodeAudioData(l).then(f).catch(p):r.ctx.decodeAudioData(l,f,p)},u=function(l,c){c&&!l._duration&&(l._duration=c.duration),Object.keys(l._sprite).length===0&&(l._sprite={__default:[0,l._duration*1e3]}),l._state!=="loaded"&&(l._state="loaded",l._emit("load"),l._loadQueue())},d=function(){if(r.usingWebAudio){try{typeof AudioContext<"u"?r.ctx=new AudioContext:typeof webkitAudioContext<"u"?r.ctx=new webkitAudioContext:r.usingWebAudio=!1}catch{r.usingWebAudio=!1}r.ctx||(r.usingWebAudio=!1);var l=/iP(hone|od|ad)/.test(r._navigator&&r._navigator.platform),c=r._navigator&&r._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),p=c?parseInt(c[1],10):null;if(l&&p&&p<9){var f=/safari/.test(r._navigator&&r._navigator.userAgent.toLowerCase());r._navigator&&!f&&(r.usingWebAudio=!1)}r.usingWebAudio&&(r.masterGain=typeof r.ctx.createGain>"u"?r.ctx.createGainNode():r.ctx.createGain(),r.masterGain.gain.setValueAtTime(r._muted?0:r._volume,r.ctx.currentTime),r.masterGain.connect(r.ctx.destination)),r._setup()}};e.Howler=r,e.Howl=s,typeof Jt<"u"?(Jt.HowlerGlobal=t,Jt.Howler=r,Jt.Howl=s,Jt.Sound=i):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=r,window.Howl=s,window.Sound=i)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(r){var s=this;if(!s.ctx||!s.ctx.listener)return s;for(var i=s._howls.length-1;i>=0;i--)s._howls[i].stereo(r);return s},HowlerGlobal.prototype.pos=function(r,s,i){var n=this;if(!n.ctx||!n.ctx.listener)return n;if(s=typeof s!="number"?n._pos[1]:s,i=typeof i!="number"?n._pos[2]:i,typeof r=="number")n._pos=[r,s,i],typeof n.ctx.listener.positionX<"u"?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]);else return n._pos;return n},HowlerGlobal.prototype.orientation=function(r,s,i,n,o,a){var h=this;if(!h.ctx||!h.ctx.listener)return h;var u=h._orientation;if(s=typeof s!="number"?u[1]:s,i=typeof i!="number"?u[2]:i,n=typeof n!="number"?u[3]:n,o=typeof o!="number"?u[4]:o,a=typeof a!="number"?u[5]:a,typeof r=="number")h._orientation=[r,s,i,n,o,a],typeof h.ctx.listener.forwardX<"u"?(h.ctx.listener.forwardX.setTargetAtTime(r,Howler.ctx.currentTime,.1),h.ctx.listener.forwardY.setTargetAtTime(s,Howler.ctx.currentTime,.1),h.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),h.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),h.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),h.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):h.ctx.listener.setOrientation(r,s,i,n,o,a);else return u;return h},Howl.prototype.init=function(r){return function(s){var i=this;return i._orientation=s.orientation||[1,0,0],i._stereo=s.stereo||null,i._pos=s.pos||null,i._pannerAttr={coneInnerAngle:typeof s.coneInnerAngle<"u"?s.coneInnerAngle:360,coneOuterAngle:typeof s.coneOuterAngle<"u"?s.coneOuterAngle:360,coneOuterGain:typeof s.coneOuterGain<"u"?s.coneOuterGain:0,distanceModel:typeof s.distanceModel<"u"?s.distanceModel:"inverse",maxDistance:typeof s.maxDistance<"u"?s.maxDistance:1e4,panningModel:typeof s.panningModel<"u"?s.panningModel:"HRTF",refDistance:typeof s.refDistance<"u"?s.refDistance:1,rolloffFactor:typeof s.rolloffFactor<"u"?s.rolloffFactor:1},i._onstereo=s.onstereo?[{fn:s.onstereo}]:[],i._onpos=s.onpos?[{fn:s.onpos}]:[],i._onorientation=s.onorientation?[{fn:s.onorientation}]:[],r.call(this,s)}}(Howl.prototype.init),Howl.prototype.stereo=function(r,s){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"stereo",action:function(){i.stereo(r,s)}}),i;var n=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof s>"u")if(typeof r=="number")i._stereo=r,i._pos=[r,0,0];else return i._stereo;for(var o=i._getSoundIds(s),a=0;a<o.length;a++){var h=i._soundById(o[a]);if(h)if(typeof r=="number")h._stereo=r,h._pos=[r,0,0],h._node&&(h._pannerAttr.panningModel="equalpower",(!h._panner||!h._panner.pan)&&t(h,n),n==="spatial"?typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(r,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):h._panner.setPosition(r,0,0):h._panner.pan.setValueAtTime(r,Howler.ctx.currentTime)),i._emit("stereo",h._id);else return h._stereo}return i},Howl.prototype.pos=function(r,s,i,n){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(r,s,i,n)}}),o;if(s=typeof s!="number"?0:s,i=typeof i!="number"?-.5:i,typeof n>"u")if(typeof r=="number")o._pos=[r,s,i];else return o._pos;for(var a=o._getSoundIds(n),h=0;h<a.length;h++){var u=o._soundById(a[h]);if(u)if(typeof r=="number")u._pos=[r,s,i],u._node&&((!u._panner||u._panner.pan)&&t(u,"spatial"),typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(r,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(s,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):u._panner.setPosition(r,s,i)),o._emit("pos",u._id);else return u._pos}return o},Howl.prototype.orientation=function(r,s,i,n){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(r,s,i,n)}}),o;if(s=typeof s!="number"?o._orientation[1]:s,i=typeof i!="number"?o._orientation[2]:i,typeof n>"u")if(typeof r=="number")o._orientation=[r,s,i];else return o._orientation;for(var a=o._getSoundIds(n),h=0;h<a.length;h++){var u=o._soundById(a[h]);if(u)if(typeof r=="number")u._orientation=[r,s,i],u._node&&(u._panner||(u._pos||(u._pos=o._pos||[0,0,-.5]),t(u,"spatial")),typeof u._panner.orientationX<"u"?(u._panner.orientationX.setValueAtTime(r,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(s,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):u._panner.setOrientation(r,s,i)),o._emit("orientation",u._id);else return u._orientation}return o},Howl.prototype.pannerAttr=function(){var r=this,s=arguments,i,n,o;if(!r._webAudio)return r;if(s.length===0)return r._pannerAttr;if(s.length===1)if(typeof s[0]=="object")i=s[0],typeof n>"u"&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),r._pannerAttr={coneInnerAngle:typeof i.pannerAttr.coneInnerAngle<"u"?i.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:typeof i.pannerAttr.coneOuterAngle<"u"?i.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:typeof i.pannerAttr.coneOuterGain<"u"?i.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:typeof i.pannerAttr.distanceModel<"u"?i.pannerAttr.distanceModel:r._distanceModel,maxDistance:typeof i.pannerAttr.maxDistance<"u"?i.pannerAttr.maxDistance:r._maxDistance,refDistance:typeof i.pannerAttr.refDistance<"u"?i.pannerAttr.refDistance:r._refDistance,rolloffFactor:typeof i.pannerAttr.rolloffFactor<"u"?i.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:typeof i.pannerAttr.panningModel<"u"?i.pannerAttr.panningModel:r._panningModel});else return o=r._soundById(parseInt(s[0],10)),o?o._pannerAttr:r._pannerAttr;else s.length===2&&(i=s[0],n=parseInt(s[1],10));for(var a=r._getSoundIds(n),h=0;h<a.length;h++)if(o=r._soundById(a[h]),o){var u=o._pannerAttr;u={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:u.coneOuterAngle,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:u.coneOuterGain,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:u.distanceModel,maxDistance:typeof i.maxDistance<"u"?i.maxDistance:u.maxDistance,refDistance:typeof i.refDistance<"u"?i.refDistance:u.refDistance,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:u.rolloffFactor,panningModel:typeof i.panningModel<"u"?i.panningModel:u.panningModel};var d=o._panner;d?(d.coneInnerAngle=u.coneInnerAngle,d.coneOuterAngle=u.coneOuterAngle,d.coneOuterGain=u.coneOuterGain,d.distanceModel=u.distanceModel,d.maxDistance=u.maxDistance,d.refDistance=u.refDistance,d.rolloffFactor=u.rolloffFactor,d.panningModel=u.panningModel):(o._pos||(o._pos=r._pos||[0,0,-.5]),t(o,"spatial"))}return r},Sound.prototype.init=function(r){return function(){var s=this,i=s._parent;s._orientation=i._orientation,s._stereo=i._stereo,s._pos=i._pos,s._pannerAttr=i._pannerAttr,r.call(this),s._stereo?i.stereo(s._stereo):s._pos&&i.pos(s._pos[0],s._pos[1],s._pos[2],s._id)}}(Sound.prototype.init),Sound.prototype.reset=function(r){return function(){var s=this,i=s._parent;return s._orientation=i._orientation,s._stereo=i._stereo,s._pos=i._pos,s._pannerAttr=i._pannerAttr,s._stereo?i.stereo(s._stereo):s._pos?i.pos(s._pos[0],s._pos[1],s._pos[2],s._id):s._panner&&(s._panner.disconnect(0),s._panner=void 0,i._refreshBuffer(s)),r.call(this)}}(Sound.prototype.reset);var t=function(r,s){s=s||"spatial",s==="spatial"?(r._panner=Howler.ctx.createPanner(),r._panner.coneInnerAngle=r._pannerAttr.coneInnerAngle,r._panner.coneOuterAngle=r._pannerAttr.coneOuterAngle,r._panner.coneOuterGain=r._pannerAttr.coneOuterGain,r._panner.distanceModel=r._pannerAttr.distanceModel,r._panner.maxDistance=r._pannerAttr.maxDistance,r._panner.refDistance=r._pannerAttr.refDistance,r._panner.rolloffFactor=r._pannerAttr.rolloffFactor,r._panner.panningModel=r._pannerAttr.panningModel,typeof r._panner.positionX<"u"?(r._panner.positionX.setValueAtTime(r._pos[0],Howler.ctx.currentTime),r._panner.positionY.setValueAtTime(r._pos[1],Howler.ctx.currentTime),r._panner.positionZ.setValueAtTime(r._pos[2],Howler.ctx.currentTime)):r._panner.setPosition(r._pos[0],r._pos[1],r._pos[2]),typeof r._panner.orientationX<"u"?(r._panner.orientationX.setValueAtTime(r._orientation[0],Howler.ctx.currentTime),r._panner.orientationY.setValueAtTime(r._orientation[1],Howler.ctx.currentTime),r._panner.orientationZ.setValueAtTime(r._orientation[2],Howler.ctx.currentTime)):r._panner.setOrientation(r._orientation[0],r._orientation[1],r._orientation[2])):(r._panner=Howler.ctx.createStereoPanner(),r._panner.pan.setValueAtTime(r._stereo,Howler.ctx.currentTime)),r._panner.connect(r._node),r._paused||r._parent.pause(r._id,!0).play(r._id,!0)}}()})(bm);class Qr{static addAssetGroup(t,r){this._map.setValue(t,r)}static getAssetGroup(t){if(this._map.size()===0)return this.logW("Asset map is empty. Call addAssetGroup first. Returning empty array."),[];{const r=this._map.getValue(t);return r===void 0?(this.logW("%c%s%c asset group has not been added to the map. Call addAssetGroup first. Returning empty array.",lt,t,nb),new Array):r}}static log(t,...r){this._debug&&lr(t,{className:"AssetMap",color:"green"},...r)}static logW(t,...r){this._debug&&ys(t,{className:"AssetMap",color:"green"},...r)}static logE(t,...r){Yr(t,{className:"AssetMap",color:"green"},...r)}}Qr._map=new Es,Qr._debug=!1;class Yu{constructor(t,r){this.assetPath="",this.resolutionSuffix="",this.assetName=t,this.assetType=r}getResource(){const t=it.get(this.assetName);if(!t)throw new Error(`Asset ${this.assetName} is not loaded.`);return t}getLoaderOptions(){return{texturePreference:{resolution:this.resolutionSuffix==="@1x"?1:2,format:["avif","webp","png"]}}}isLoaded(){return!!it.get(this.assetName)}destroy(){}}class Tm extends Yu{constructor(t,r,s){super(t,r),this.category=s}isLoaded(){const t=Rt.instance.audio.getAudioTrack(this.assetName,this.category);return t===void 0?!1:t.getSource().state()!==Ji.UNLOADED}}const Em={white:16777215,red:16711680,green:32768,blue:255,gray:8421504,yellow:16776960,gold:16766720,aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,blanchedalmond:16772045,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,goldenrod:14329120,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,whitesmoke:16119285,yellowgreen:10145074,black:0},$E=["visible","hidden"],qE=["center","left","right","justify"],KE=["middle","top","bottom"];function ZE([e,t,r]){return parseInt(`0x${$u(e)}${$u(t)}${$u(r)}`,16)}function $u(e){const t=e.toString(16);return t.length===1?`0${t}`:t}function QE(e,t,r){r/=100;const s=t*Math.min(r,1-r)/100,i=n=>{const o=(n+e/30)%12,a=r-s*Math.max(Math.min(o-3,9-o,1),-1);return Math.round(255*a).toString(16).padStart(2,"0")};return Gp(`#${i(0)}${i(8)}${i(4)}`)}function wm(e){if(e!=="transparent"&&e!==void 0)switch(typeof e){case"string":if(e.startsWith("#")||e.startsWith("0x"))return{hex:Gp(e),opacity:1};if(e.startsWith("rgba(")){const t=e.slice(5,-1).split(","),r=t.map(s=>parseInt(s,10));return{hex:ZE(r),opacity:parseFloat(t[3])}}else if(e.startsWith("rgb(")){const t=e.slice(5,-1).split(",").map(r=>parseInt(r,10));return{hex:Bi(t),opacity:1}}else if(e.startsWith("hsla(")){const t=e.slice(5,-1).split(","),[r,s,i]=t.map(n=>parseInt(n,10));return{hex:QE(r,s,i),opacity:parseFloat(t[3])}}else if(Object.keys(Em).includes(e))return{hex:Em[e],opacity:1};throw new Error(`Unknown color format: ${e}`);case"number":return{hex:e,opacity:1};default:return{hex:parseInt(e,16),opacity:1}}}function Mr(e,t){if(e!==void 0){if(typeof e=="number")return e;if(typeof e=="string"){if(e.endsWith("px"))return Math.floor(parseInt(e.slice(0,-2),10));if(e.endsWith("%")){const r=parseInt(e.slice(0,-1),10);return Math.floor(t?t/100*r:r)}return Math.floor(parseInt(e,10))}return 0}}function qu(e){var t;return{align:(e==null?void 0:e.textAlign)??qE[1],breakWords:(e==null?void 0:e.breakWords)??!0,dropShadow:(e==null?void 0:e.dropShadow)??!1,dropShadowAlpha:(e==null?void 0:e.dropShadowAlpha)??1,dropShadowAngle:(e==null?void 0:e.dropShadowAngle)??Math.PI/6,dropShadowBlur:(e==null?void 0:e.dropShadowBlur)??0,dropShadowColor:(e==null?void 0:e.dropShadowColor)??"black",dropShadowDistance:(e==null?void 0:e.dropShadowDistance)??5,fill:(e==null?void 0:e.fill)??((t=wm(e==null?void 0:e.color))==null?void 0:t.hex)??"black",fillGradientType:(e==null?void 0:e.fillGradientType)??Zn.LINEAR_VERTICAL,fillGradientStops:(e==null?void 0:e.fillGradientStops)??[],fontFamily:(e==null?void 0:e.fontFamily)??"Arial",fontSize:(e==null?void 0:e.fontSize)??26,fontStyle:(e==null?void 0:e.fontStyle)??"normal",fontVariant:(e==null?void 0:e.fontVariant)??"normal",fontWeight:(e==null?void 0:e.fontWeight)??"normal",letterSpacing:(e==null?void 0:e.letterSpacing)??0,lineHeight:(e==null?void 0:e.lineHeight)??0,lineJoin:(e==null?void 0:e.lineJoin)??"miter",miterLimit:(e==null?void 0:e.miterLimit)??10,stroke:(e==null?void 0:e.stroke)??"black",strokeThickness:(e==null?void 0:e.strokeThickness)??0,textBaseline:(e==null?void 0:e.textBaseline)??"alphabetic",trim:(e==null?void 0:e.trim)??!1,whiteSpace:(e==null?void 0:e.whiteSpace)??"pre",wordWrap:(e==null?void 0:e.wordWrap)??!0,wordWrapWidth:(e==null?void 0:e.wordWrapWidth)??100,leading:(e==null?void 0:e.leading)??0}}function ws(e){return e.content.children.size===1?e.content.children.entries().next().value[1]instanceof Zr:!1}class JE{constructor(t){this.layout=t}update(t,r){this.setSelfPosition(t,r),this.layout.content.resize(this.layout.width,this.layout.height),this.alignChildren(this.layout.width,this.layout.height)}alignChildren(t,r){let s=0;const{style:i}=this.layout,n=i.paddingTop??0,o=i.paddingRight??0,a=i.paddingBottom??0,h=i.paddingLeft??0;let u=h,d=n;this.layout.content.children.forEach(l=>{if(!l.height&&!l.width)return;if(l instanceof Zr&&ws(this.layout)){const T=t-h-o,w=i.textAlign;l.width<T?w==="center"?(l.anchor.x=.5,l.x=t/2):w==="right"?(l.anchor.x=1,l.x=t-o):(l.anchor.x=0,l.x=h):(l.anchor.x=0,l.x=h);const b=i.verticalAlign,A=r-n-a;l.height<A?b==="middle"?(l.anchor.y=.5,l.y=r/2):b==="bottom"?(l.anchor.y=1,l.y=r-a):(l.anchor.y=0,l.y=n):(l.anchor.y=0,l.y=n);return}let c="inline-block",p=0,f=0,_=0,m=0;if(l instanceof ue){c=l.style.display;const T=l.style.position;if(p=l.style.marginLeft,f=l.style.marginRight,_=l.style.marginTop,m=l.style.marginBottom,T!==void 0)return}let g=0,v=0;i.position===void 0&&(g=i.anchorX!==void 0?i.anchorX*this.layout.width:0,v=i.anchorY!==void 0?i.anchorY*this.layout.height:0),l.x=u+p-g,l.y=d+_-v,l.height+_+m>s&&(s=l.height+_+m);const y=t-o;c==="block"&&l.width<y&&(c="inline-block");const x=u+l.width+f<=y,E=l===this.layout.content.firstChild;switch(c){case"inline":case"inline-block":!x&&!E?(u=h+l.width+f,d+=s,l.x=h+p,l.y=d+_):u+=l.width+f;break;default:d+=l.height+m;break}})}setSelfPosition(t,r){const{position:s,marginRight:i,marginBottom:n,marginTop:o,marginLeft:a}=this.layout.style||{},{style:h}=this.layout;if(!s)return;const u=this.layout.scale.x,d=this.layout.scale.y,l=this.layout.width*u,c=this.layout.height*d,p=h.anchorX,f=h.anchorY;switch(s){case"rightTop":case"topRight":case"right":this.layout.x=t-i-l*(p??1),this.layout.y=o-c*(f??0);break;case"leftBottom":case"bottomLeft":case"bottom":this.layout.x=a-l*(p??0),this.layout.y=r-n-c*(f??1);break;case"rightBottom":case"bottomRight":this.layout.x=t-i-l*(p??1),this.layout.y=r-n-c*(f??1);break;case"center":this.layout.x=t/2-l*(p??.5)+a,this.layout.y=r/2-c*(f??.5)+o;break;case"centerTop":case"topCenter":this.layout.x=t/2-l*(p??.5)+a,this.layout.y=o-c*(f??0);break;case"centerBottom":case"bottomCenter":this.layout.x=t/2-l*(p??.5)+a,this.layout.y=r-n-c*(f??1);break;case"centerLeft":case"leftCenter":this.layout.x=a-l*(p??0),this.layout.y=r/2-c*(f??.5)+o;break;case"centerRight":case"rightCenter":this.layout.x=t-i-l*(p??1),this.layout.y=r/2-c*(f??.5)+o;break;case"leftTop":case"topLeft":case"left":case"top":default:this.layout.x=a-l*(p??0),this.layout.y=o-c*(f??0)}}}class tw{constructor(t,r){this.styles={},this._textStyle={},this.layout=t,r&&this.set(r)}set(t){this.styles.overflow=(t==null?void 0:t.overflow)??this.styles.overflow??$E[0],this.styles.display=(t==null?void 0:t.display)??this.styles.display??"inline-block",this.styles.borderRadius=(t==null?void 0:t.borderRadius)??this.styles.borderRadius??0,this.styles.zIndex=(t==null?void 0:t.zIndex)??this.styles.zIndex??1,this.opacity=(t==null?void 0:t.opacity)??this.styles.opacity??1,this.styles.maxWidth=(t==null?void 0:t.maxWidth)??this.styles.maxWidth,this.styles.maxHeight=(t==null?void 0:t.maxHeight)??this.styles.maxHeight,this.styles.minWidth=(t==null?void 0:t.minWidth)??this.styles.minWidth,this.styles.minHeight=(t==null?void 0:t.minHeight)??this.styles.minHeight,this.styles.padding=(t==null?void 0:t.padding)??this.styles.padding??0,this.styles.paddingTop=(t==null?void 0:t.paddingTop)??(t==null?void 0:t.padding)??this.styles.paddingTop??0,this.styles.paddingRight=(t==null?void 0:t.paddingRight)??(t==null?void 0:t.padding)??this.styles.paddingRight??0,this.styles.paddingBottom=(t==null?void 0:t.paddingBottom)??(t==null?void 0:t.padding)??this.styles.paddingBottom??0,this.styles.paddingLeft=(t==null?void 0:t.paddingLeft)??(t==null?void 0:t.padding)??this.styles.paddingLeft??0,this.styles.margin=(t==null?void 0:t.margin)??this.styles.margin??0,this.styles.marginTop=(t==null?void 0:t.marginTop)??(t==null?void 0:t.margin)??this.styles.marginTop??0,this.styles.marginRight=(t==null?void 0:t.marginRight)??(t==null?void 0:t.margin)??this.styles.marginRight??0,this.styles.marginBottom=(t==null?void 0:t.marginBottom)??(t==null?void 0:t.margin)??this.styles.marginBottom??0,this.styles.marginLeft=(t==null?void 0:t.marginLeft)??(t==null?void 0:t.margin)??this.styles.marginLeft??0,this.styles.scale=(t==null?void 0:t.scale)??this.styles.scale??1,this.styles.scaleX=(t==null?void 0:t.scaleX)??(t==null?void 0:t.scale)??this.styles.scaleX??1,this.styles.scaleY=(t==null?void 0:t.scaleY)??(t==null?void 0:t.scale)??this.styles.scaleY??1,this.styles.width=(t==null?void 0:t.width)??this.styles.width??"auto",this.styles.height=(t==null?void 0:t.height)??this.styles.height??"auto",(t==null?void 0:t.anchorX)!==void 0?this.styles.anchorX=t.anchorX:(t==null?void 0:t.anchor)!==void 0&&(typeof t.anchor=="number"?this.styles.anchorX=t.anchor:Array.isArray(t.anchor)&&(this.styles.anchorX=t.anchor[0])),(t==null?void 0:t.anchorY)!==void 0?this.styles.anchorY=t.anchorY:(t==null?void 0:t.anchor)!==void 0&&(typeof t.anchor=="number"?this.styles.anchorY=t.anchor:Array.isArray(t.anchor)&&t.anchor[1]!==void 0&&(this.styles.anchorY=t.anchor[1])),this.styles.background=(t==null?void 0:t.background)??(t==null?void 0:t.backgroundColor)??this.styles.background,this.styles.textAlign=(t==null?void 0:t.textAlign)??this.styles.textAlign,this.styles.position=(t==null?void 0:t.position)??this.styles.position,this.styles.verticalAlign=(t==null?void 0:t.verticalAlign)??this.styles.verticalAlign??KE[0],this.styles.aspectRatio=(t==null?void 0:t.aspectRatio)??this.styles.aspectRatio??"static",this._textStyle=qu(t)}get(t){return this.styles[t]}getAll(){return this.styles}get textStyle(){return this._textStyle}set opacity(t){this.styles.opacity=t,this.layout.alpha=t}get opacity(){return this.styles.opacity}}class ew{constructor(t){this.parentWidth=0,this.parentHeight=0,this.layout=t}update(t,r){var y,x,E,T,w;let s=0,i=0;t!==void 0&&(this.parentWidth=t),r!==void 0&&(this.parentHeight=r);const{width:n,height:o,maxWidth:a,maxHeight:h,minWidth:u,minHeight:d,scaleX:l,scaleY:c,background:p,paddingLeft:f,paddingRight:_,paddingTop:m,paddingBottom:g,aspectRatio:v}=this.layout.style;if(n===0||o===0){this.layout.visible=!1;return}if(n==="auto")switch(this.autoSizeModificator){case"innerText":const b=this.innerText.width+f+_>this.parentWidth;!this.innerText.style.wordWrap&&b&&(this.innerText.style.wordWrap=!0),this.innerText.style.wordWrap&&(this.innerText.style.wordWrapWidth=this.parentWidth-f-_),s=this.innerText.width;break;case"background":s=p.width;break;case"contentSize":let A=0;this.layout.content.resize(this.parentWidth,this.parentHeight);const{firstChild:R}=this.layout.content;R instanceof ue?A+=R.width+R.style.marginLeft+R.style.marginRight:R instanceof et&&R.width&&(A+=R.width),this.layout.content.children.forEach(S=>{if(S!==R)if(S instanceof ue&&S.style.display!=="block"){if(S.style.position)return;A+=S.width+S.style.marginLeft}else S instanceof et&&S.width&&(A+=S.width)}),s=A+f+_,ws(this.layout)&&(s=((y=this.innerText)==null?void 0:y.width)+f+_);break;case"parentSize":default:s=this.parentWidth,ws(this.layout)&&(this.innerText.style.wordWrap=!0,this.innerText.style.wordWrapWidth=t-f-_);break}else s=Mr(n,this.parentWidth);if(this.fitInnerText(s),o==="auto")switch(this.autoSizeModificator){case"innerText":i=((x=this.innerText)==null?void 0:x.height)+g+m;break;case"background":i=p.height;break;case"parentSize":case"contentSize":default:let b=0;this.layout.content.resize(this.parentWidth,this.parentHeight);const{firstChild:A}=this.layout.content;A instanceof ue?A.style.position||(b+=A.height):A instanceof et&&A.height&&(b+=A.height),this.layout.content.children.forEach(R=>{R!==A&&(R instanceof ue&&R.style.position||(R instanceof ue&&R.style.display==="block"?b+=R.height:R.height>b&&(b=R.height)))}),ws(this.layout)&&(i=(E=this.innerText)==null?void 0:E.height),i=b+m+g;break}else i=Mr(o,this.parentHeight);if(this.layout.parent instanceof ue){const{paddingLeft:b,paddingRight:A}=(T=this.layout.parent)==null?void 0:T.style,R=b??0,S=A??0;this.autoSizeModificator!=="innerText"&&(s-=R),s-=S,this.fitInnerText(s),ws(this.layout)&&o==="auto"&&(i=((w=this.innerText)==null?void 0:w.height)+g+m)}if(s<0&&(s=0),i<0&&(i=0),s===0||i===0){this.layout.visible=!1;return}this._width=Mr(s,this.parentWidth),this._height=Mr(i,this.parentHeight),this.layout.scale.set(l,c),(v==="flex"||a||h||u||d)&&this.fitToSize(this.parentWidth,this.parentHeight),this.layout.updateBG(),this.layout.updateMask(),this.layout.align.update(this.parentWidth,this.parentHeight)}fitInnerText(t){if(!ws(this.layout))return;const{paddingLeft:r,paddingRight:s}=this.layout.style;this.innerText.style.wordWrap=!0,this.innerText.style.wordWrapWidth=t-s-r}get autoSizeModificator(){const{background:t,display:r}=this.layout.style;return r==="block"?"parentSize":ws(this.layout)?"innerText":t instanceof et?"background":"contentSize"}get innerText(){if(!ws(this.layout))return null;const{firstChild:t}=this.layout.content;return t}get width(){return this._width}set width(t){this._width=Mr(t,this.parentWidth),this.layout.align.update(this.parentWidth,this.parentHeight)}get height(){return this._height}set height(t){this._height=Mr(t,this.parentHeight),this.layout.align.update(this.parentWidth,this.parentHeight)}fitToSize(t,r){const{maxWidth:s,maxHeight:i,minWidth:n,minHeight:o,aspectRatio:a}=this.layout.style,{marginLeft:h,marginRight:u,marginBottom:d,marginTop:l}=this.layout.style,c=this.layout.scale.x,p=this.layout.scale.y,f=this.layout.width+h+u,_=this.layout.height+l+d,m=Mr(s,t),g=Mr(i,r),v=Mr(n,t),y=Mr(o,r);if(a==="flex"){m&&this.width>m&&(this.width=m),g&&this.height>g&&(this.height=g);let S,M;if(v&&this.width<v&&(S=this.width/v,this.width=v),y&&this.height<y&&(M=this.height/y,this.height=y),S||M){const I=S&&M?Math.min(S,M):S??M;this.layout.scale.set(I)}return}const x=m/f,E=g/_,T=v/f,w=y/_;let b=c,A=p;f*c>m&&(b=x),_*p>g&&(A=E);let R=Math.min(b,A);if(n||o){let S=R;f*R<v&&(S=T),_*R<y&&(S=w),R=Math.max(S,S)}this.layout.scale.set(R)}}class ue extends et{constructor(t){if(super(),this.id=t==null?void 0:t.id,t==null?void 0:t.globalStyles){const r=t.globalStyles[this.id];r&&t.styles?t.styles={...r,...t.styles}:r&&(t.styles=r)}this._style=new tw(this,t==null?void 0:t.styles),this.size=new ew(this),this.align=new JE(this),this.content=new rw(this,t==null?void 0:t.content,t==null?void 0:t.globalStyles)}resize(t,r){this.size.update(t,r)}updateBG(){const{background:t}=this.style;if(t instanceof et)t instanceof me&&t.anchor.set(0),this.bg=t,this.addChildAt(this.bg,0);else{const r=t!=="transparent"&&wm(t),{borderRadius:s}=this.style,{width:i,height:n}=this;if(r&&i&&n){this.bg||(this.bg=new Ie,this.addChildAt(this.bg,0));let o=0,a=0;const{anchorX:h,anchorY:u}=this.style;h!==void 0&&(o-=i*h),u!==void 0&&(a-=n*u),this.bg instanceof Ie&&this.bg.clear().beginFill(r.hex,r.opacity).drawRoundedRect(o,a,i,n,s)}else this.bg&&(this.removeChild(this.bg),delete this.bg)}}updateMask(){const{overflow:t,borderRadius:r}=this.style,{width:s,height:i}=this;if(t==="hidden"&&s&&i){this.overflowMask||(this.overflowMask=new Ie,this.addChild(this.overflowMask));let n=0,o=0;const{anchorX:a,anchorY:h}=this.style;a!==void 0&&(n-=s*a),h!==void 0&&(o-=i*h),this.overflowMask.clear().beginFill(16777215).drawRoundedRect(n,o,s,i,r).endFill(),this.mask=this.overflowMask}else this.mask=null,delete this.overflowMask}get contentWidth(){return super.width}get contentHeight(){return super.height}set width(t){this.size.width=t}get width(){return this.size.width}set height(t){this.size.height=t}get height(){return this.size.height}addContent(t){this.content.createContent(t),this.update()}removeChildByID(t){this.content.removeContent(t),this.update()}getChildByID(t){return this.content.getByID(t)}update(){this.getRootLayout().size.update()}getRootLayout(){return this.parent&&this.parent instanceof ue?this.parent.getRootLayout():this}setStyles(t){this._style.set(t),this.update()}get textStyle(){return this._style.textStyle}get style(){return this._style.getAll()}}et.prototype.initLayout||Object.defineProperty(et.prototype,"initLayout",{value(e){return this.layout||(this.layout=new ue(e),this.addChild(this.layout)),this}});class rw{constructor(t,r,s){this.children=new Map,this.layout=t,this.children=new Map,this.createContent(r,s)}createContent(t,r){if(!t)return;const s=this.getContentType(t),i=this.newID;switch(s){case"layout":const n=t;this.addContentElement(n.id,n);break;case"container":this.addContentElement(`container-${i}`,t);break;case"string":const o=new Zr(t,this.layout.textStyle);this.addContentElement(`text-${i}`,o);break;case"text":const a=t;a.style=this.layout.textStyle,this.addContentElement(`text-${i}`,a);break;case"layoutConfig":const h=t;r&&(h.globalStyles?h.globalStyles={...r,...h.globalStyles}:h.globalStyles={...r}),h.id||(h.id=`layout-${i}`),this.addContentElement(h.id,new ue(h));break;case"object":const u=t;for(const d in u){const l=d,c=t[l],p=this.getContentType(c);let f=this.layout.textStyle;switch(p){case"string":r&&r[l]&&(f={...f,...qu(r[l])});const _=new Zr(c,f);this.addContentElement(l,_);break;case"text":const m=c;r&&r[l]&&(f={...f,...qu(r[l])}),m.style=f,this.addContentElement(l,m);break;case"layout":const g=c;r&&r[l]&&(g.setStyles(r[l]),g.update()),this.createContent(g);break;case"container":this.addContentElement(l,c);break;case"layoutConfig":this.createContent({...c,globalStyles:r,id:l});break;case"object":this.createContent(c,r);break;case"array":this.createContent(c,r);break}}break;case"array":t.forEach(d=>this.createContent(d,r));break;default:throw new Error("Unknown content type of the layout.")}}addContentElement(t,r){t&&this.children.has(t)&&console.error(`Element with '${t}' duplicates, be careful using id selectors with it.`),this.children.set(t,r),this.layout.addChild(r)}get firstChild(){return this.children.get(this.children.keys().next().value)}resize(t,r){this.children.forEach(s=>{s instanceof ue&&s.resize(t,r)})}get newID(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}getByID(t){let r=this.children.get(t);return r||this.children.forEach(s=>{if(s instanceof ue){const i=s.content.getByID(t);i&&(r=i)}}),r}getContentType(t){return typeof t=="string"?"string":t instanceof ue?"layout":t instanceof Zr?"text":t instanceof me||t instanceof Ie||t instanceof et?"container":Array.isArray(t)?"array":typeof t=="object"?t!=null&&t.content?"layoutConfig":"object":"unknown"}removeContent(t){const r=this.getByID(t);r&&(this.layout.removeChild(r),this.children.delete(t))}}function Jr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Am(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Pe={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},en={duration:.5,overwrite:!1,delay:0},Ku,ne,wt,Xe=1e8,at=1/Xe,Zu=Math.PI*2,sw=Zu/4,iw=0,Sm=Math.sqrt,nw=Math.cos,ow=Math.sin,Vt=function(e){return typeof e=="string"},At=function(e){return typeof e=="function"},ts=function(e){return typeof e=="number"},Qu=function(e){return typeof e>"u"},Pr=function(e){return typeof e=="object"},ye=function(e){return e!==!1},Ju=function(){return typeof window<"u"},Qa=function(e){return At(e)||Vt(e)},Cm=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},oe=Array.isArray,tc=/(?:-?\.?\d|\.)+/gi,Im=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,rn=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,ec=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Rm=/[+-]=-?[.\d]+/,Mm=/[^,'"\[\]\s]+/gi,aw=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,gt,We,rc,sc,De={},Ja={},Pm,Dm=function(e){return(Ja=di(e,De))&&be},ic=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},th=function(e,t){return!t&&console.warn(e)},Om=function(e,t){return e&&(De[e]=t)&&Ja&&(Ja[e]=t)||De},no=function(){return 0},hw={suppressEvents:!0,isStart:!0,kill:!1},eh={suppressEvents:!0,kill:!1},lw={suppressEvents:!0},nc={},As=[],oc={},km,Oe={},ac={},Nm=30,rh=[],hc="",lc=function(e){var t=e[0],r,s;if(Pr(t)||At(t)||(e=[e]),!(r=(t._gsap||{}).harness)){for(s=rh.length;s--&&!rh[s].targetTest(t););r=rh[s]}for(s=e.length;s--;)e[s]&&(e[s]._gsap||(e[s]._gsap=new ug(e[s],r)))||e.splice(s,1);return e},ci=function(e){return e._gsap||lc($e(e))[0]._gsap},Lm=function(e,t,r){return(r=e[t])&&At(r)?e[t]():Qu(r)&&e.getAttribute&&e.getAttribute(t)||r},ve=function(e,t){return(e=e.split(",")).forEach(t)||e},It=function(e){return Math.round(e*1e5)/1e5||0},Kt=function(e){return Math.round(e*1e7)/1e7||0},sn=function(e,t){var r=t.charAt(0),s=parseFloat(t.substr(2));return e=parseFloat(e),r==="+"?e+s:r==="-"?e-s:r==="*"?e*s:e/s},uw=function(e,t){for(var r=t.length,s=0;e.indexOf(t[s])<0&&++s<r;);return s<r},sh=function(){var e=As.length,t=As.slice(0),r,s;for(oc={},As.length=0,r=0;r<e;r++)s=t[r],s&&s._lazy&&(s.render(s._lazy[0],s._lazy[1],!0)._lazy=0)},Fm=function(e,t,r,s){As.length&&!ne&&sh(),e.render(t,r,s||ne&&t<0&&(e._initted||e._startAt)),As.length&&!ne&&sh()},Bm=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(Mm).length<2?t:Vt(e)?e.trim():e},Um=function(e){return e},je=function(e,t){for(var r in t)r in e||(e[r]=t[r]);return e},cw=function(e){return function(t,r){for(var s in r)s in t||s==="duration"&&e||s==="ease"||(t[s]=r[s])}},di=function(e,t){for(var r in t)e[r]=t[r];return e},Gm=function e(t,r){for(var s in r)s!=="__proto__"&&s!=="constructor"&&s!=="prototype"&&(t[s]=Pr(r[s])?e(t[s]||(t[s]={}),r[s]):r[s]);return t},ih=function(e,t){var r={},s;for(s in e)s in t||(r[s]=e[s]);return r},oo=function(e){var t=e.parent||gt,r=e.keyframes?cw(oe(e.keyframes)):je;if(ye(e.inherit))for(;t;)r(e,t.vars.defaults),t=t.parent||t._dp;return e},dw=function(e,t){for(var r=e.length,s=r===t.length;s&&r--&&e[r]===t[r];);return r<0},Hm=function(e,t,r,s,i){r===void 0&&(r="_first"),s===void 0&&(s="_last");var n=e[s],o;if(i)for(o=t[i];n&&n[i]>o;)n=n._prev;return n?(t._next=n._next,n._next=t):(t._next=e[r],e[r]=t),t._next?t._next._prev=t:e[s]=t,t._prev=n,t.parent=t._dp=e,t},nh=function(e,t,r,s){r===void 0&&(r="_first"),s===void 0&&(s="_last");var i=t._prev,n=t._next;i?i._next=n:e[r]===t&&(e[r]=n),n?n._prev=i:e[s]===t&&(e[s]=i),t._next=t._prev=t.parent=null},Ss=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},pi=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var r=e;r;)r._dirty=1,r=r.parent;return e},pw=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},uc=function(e,t,r,s){return e._startAt&&(ne?e._startAt.revert(eh):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,s))},fw=function e(t){return!t||t._ts&&e(t.parent)},zm=function(e){return e._repeat?nn(e._tTime,e=e.duration()+e._rDelay)*e:0},nn=function(e,t){var r=Math.floor(e/=t);return e&&r===e?r-1:r},oh=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},ah=function(e){return e._end=Kt(e._start+(e._tDur/Math.abs(e._ts||e._rts||at)||0))},hh=function(e,t){var r=e._dp;return r&&r.smoothChildTiming&&e._ts&&(e._start=Kt(r._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),ah(e),r._dirty||pi(r,e)),e},Vm=function(e,t){var r;if((t._time||t._initted&&!t._dur)&&(r=oh(e.rawTime(),t),(!t._dur||ho(0,t.totalDuration(),r)-t._tTime>at)&&t.render(r,!0)),pi(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(r=e;r._dp;)r.rawTime()>=0&&r.totalTime(r._tTime),r=r._dp;e._zTime=-at}},Dr=function(e,t,r,s){return t.parent&&Ss(t),t._start=Kt((ts(r)?r:r||e!==gt?Ye(e,r,t):e._time)+t._delay),t._end=Kt(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),Hm(e,t,"_first","_last",e._sort?"_start":0),cc(t)||(e._recent=t),s||Vm(e,t),e._ts<0&&hh(e,e._tTime),e},Xm=function(e,t){return(De.ScrollTrigger||ic("scrollTrigger",t))&&De.ScrollTrigger.create(t,e)},Wm=function(e,t,r,s,i){if(xc(e,t,i),!e._initted)return 1;if(!r&&e._pt&&!ne&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&km!==ke.frame)return As.push(e),e._lazy=[i,s],1},_w=function e(t){var r=t.parent;return r&&r._ts&&r._initted&&!r._lock&&(r.rawTime()<0||e(r))},cc=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},mw=function(e,t,r,s){var i=e.ratio,n=t<0||!t&&(!e._start&&_w(e)&&!(!e._initted&&cc(e))||(e._ts<0||e._dp._ts<0)&&!cc(e))?0:1,o=e._rDelay,a=0,h,u,d;if(o&&e._repeat&&(a=ho(0,e._tDur,t),u=nn(a,o),e._yoyo&&u&1&&(n=1-n),u!==nn(e._tTime,o)&&(i=1-n,e.vars.repeatRefresh&&e._initted&&e.invalidate())),n!==i||ne||s||e._zTime===at||!t&&e._zTime){if(!e._initted&&Wm(e,t,s,r,a))return;for(d=e._zTime,e._zTime=t||(r?at:0),r||(r=t&&!d),e.ratio=n,e._from&&(n=1-n),e._time=0,e._tTime=a,h=e._pt;h;)h.r(n,h.d),h=h._next;t<0&&uc(e,t,r,!0),e._onUpdate&&!r&&qe(e,"onUpdate"),a&&e._repeat&&!r&&e.parent&&qe(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===n&&(n&&Ss(e,1),!r&&!ne&&(qe(e,n?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},gw=function(e,t,r){var s;if(r>t)for(s=e._first;s&&s._start<=r;){if(s.data==="isPause"&&s._start>t)return s;s=s._next}else for(s=e._last;s&&s._start>=r;){if(s.data==="isPause"&&s._start<t)return s;s=s._prev}},on=function(e,t,r,s){var i=e._repeat,n=Kt(t)||0,o=e._tTime/e._tDur;return o&&!s&&(e._time*=n/e._dur),e._dur=n,e._tDur=i?i<0?1e10:Kt(n*(i+1)+e._rDelay*i):n,o>0&&!s&&hh(e,e._tTime=e._tDur*o),e.parent&&ah(e),r||pi(e.parent,e),e},jm=function(e){return e instanceof ce?pi(e):on(e,e._dur)},yw={_start:0,endTime:no,totalDuration:no},Ye=function e(t,r,s){var i=t.labels,n=t._recent||yw,o=t.duration()>=Xe?n.endTime(!1):t._dur,a,h,u;return Vt(r)&&(isNaN(r)||r in i)?(h=r.charAt(0),u=r.substr(-1)==="%",a=r.indexOf("="),h==="<"||h===">"?(a>=0&&(r=r.replace(/=/,"")),(h==="<"?n._start:n.endTime(n._repeat>=0))+(parseFloat(r.substr(1))||0)*(u?(a<0?n:s).totalDuration()/100:1)):a<0?(r in i||(i[r]=o),i[r]):(h=parseFloat(r.charAt(a-1)+r.substr(a+1)),u&&s&&(h=h/100*(oe(s)?s[0]:s).totalDuration()),a>1?e(t,r.substr(0,a-1),s)+h:o+h)):r==null?o:+r},ao=function(e,t,r){var s=ts(t[1]),i=(s?2:1)+(e<2?0:1),n=t[i],o,a;if(s&&(n.duration=t[1]),n.parent=r,e){for(o=n,a=r;a&&!("immediateRender"in o);)o=a.vars.defaults||{},a=ye(a.vars.inherit)&&a.parent;n.immediateRender=ye(o.immediateRender),e<2?n.runBackwards=1:n.startAt=t[i-1]}return new Dt(t[0],n,t[i+1])},Cs=function(e,t){return e||e===0?t(e):t},ho=function(e,t,r){return r<e?e:r>t?t:r},ae=function(e,t){return!Vt(e)||!(t=aw.exec(e))?"":t[1]},vw=function(e,t,r){return Cs(r,function(s){return ho(e,t,s)})},dc=[].slice,Ym=function(e,t){return e&&Pr(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Pr(e[0]))&&!e.nodeType&&e!==We},xw=function(e,t,r){return r===void 0&&(r=[]),e.forEach(function(s){var i;return Vt(s)&&!t||Ym(s,1)?(i=r).push.apply(i,$e(s)):r.push(s)})||r},$e=function(e,t,r){return wt&&!t&&wt.selector?wt.selector(e):Vt(e)&&!r&&(rc||!hn())?dc.call((t||sc).querySelectorAll(e),0):oe(e)?xw(e,r):Ym(e)?dc.call(e,0):e?[e]:[]},pc=function(e){return e=$e(e)[0]||th("Invalid scope")||{},function(t){var r=e.current||e.nativeElement||e;return $e(t,r.querySelectorAll?r:r===e?th("Invalid scope")||sc.createElement("div"):e)}},$m=function(e){return e.sort(function(){return .5-Math.random()})},qm=function(e){if(At(e))return e;var t=Pr(e)?e:{each:e},r=fi(t.ease),s=t.from||0,i=parseFloat(t.base)||0,n={},o=s>0&&s<1,a=isNaN(s)||o,h=t.axis,u=s,d=s;return Vt(s)?u=d={center:.5,edges:.5,end:1}[s]||0:!o&&a&&(u=s[0],d=s[1]),function(l,c,p){var f=(p||t).length,_=n[f],m,g,v,y,x,E,T,w,b;if(!_){if(b=t.grid==="auto"?0:(t.grid||[1,Xe])[1],!b){for(T=-Xe;T<(T=p[b++].getBoundingClientRect().left)&&b<f;);b--}for(_=n[f]=[],m=a?Math.min(b,f)*u-.5:s%b,g=b===Xe?0:a?f*d/b-.5:s/b|0,T=0,w=Xe,E=0;E<f;E++)v=E%b-m,y=g-(E/b|0),_[E]=x=h?Math.abs(h==="y"?y:v):Sm(v*v+y*y),x>T&&(T=x),x<w&&(w=x);s==="random"&&$m(_),_.max=T-w,_.min=w,_.v=f=(parseFloat(t.amount)||parseFloat(t.each)*(b>f?f-1:h?h==="y"?f/b:b:Math.max(b,f/b))||0)*(s==="edges"?-1:1),_.b=f<0?i-f:i,_.u=ae(t.amount||t.each)||0,r=r&&f<0?ag(r):r}return f=(_[l]-_.min)/_.max||0,Kt(_.b+(r?r(f):f)*_.v)+_.u}},fc=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(r){var s=Kt(Math.round(parseFloat(r)/e)*e*t);return(s-s%1)/t+(ts(r)?0:ae(r))}},Km=function(e,t){var r=oe(e),s,i;return!r&&Pr(e)&&(s=r=e.radius||Xe,e.values?(e=$e(e.values),(i=!ts(e[0]))&&(s*=s)):e=fc(e.increment)),Cs(t,r?At(e)?function(n){return i=e(n),Math.abs(i-n)<=s?i:n}:function(n){for(var o=parseFloat(i?n.x:n),a=parseFloat(i?n.y:0),h=Xe,u=0,d=e.length,l,c;d--;)i?(l=e[d].x-o,c=e[d].y-a,l=l*l+c*c):l=Math.abs(e[d]-o),l<h&&(h=l,u=d);return u=!s||h<=s?e[u]:n,i||u===n||ts(n)?u:u+ae(n)}:fc(e))},Zm=function(e,t,r,s){return Cs(oe(e)?!t:r===!0?!!(r=0):!s,function(){return oe(e)?e[~~(Math.random()*e.length)]:(r=r||1e-5)&&(s=r<1?Math.pow(10,(r+"").length-2):1)&&Math.floor(Math.round((e-r/2+Math.random()*(t-e+r*.99))/r)*r*s)/s})},bw=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(s){return t.reduce(function(i,n){return n(i)},s)}},Tw=function(e,t){return function(r){return e(parseFloat(r))+(t||ae(r))}},Ew=function(e,t,r){return Jm(e,t,0,1,r)},Qm=function(e,t,r){return Cs(r,function(s){return e[~~t(s)]})},ww=function e(t,r,s){var i=r-t;return oe(t)?Qm(t,e(0,t.length),r):Cs(s,function(n){return(i+(n-t)%i)%i+t})},Aw=function e(t,r,s){var i=r-t,n=i*2;return oe(t)?Qm(t,e(0,t.length-1),r):Cs(s,function(o){return o=(n+(o-t)%n)%n||0,t+(o>i?n-o:o)})},lo=function(e){for(var t=0,r="",s,i,n,o;~(s=e.indexOf("random(",t));)n=e.indexOf(")",s),o=e.charAt(s+7)==="[",i=e.substr(s+7,n-s-7).match(o?Mm:tc),r+=e.substr(t,s-t)+Zm(o?i:+i[0],o?0:+i[1],+i[2]||1e-5),t=n+1;return r+e.substr(t,e.length-t)},Jm=function(e,t,r,s,i){var n=t-e,o=s-r;return Cs(i,function(a){return r+((a-e)/n*o||0)})},Sw=function e(t,r,s,i){var n=isNaN(t+r)?0:function(p){return(1-p)*t+p*r};if(!n){var o=Vt(t),a={},h,u,d,l,c;if(s===!0&&(i=1)&&(s=null),o)t={p:t},r={p:r};else if(oe(t)&&!oe(r)){for(d=[],l=t.length,c=l-2,u=1;u<l;u++)d.push(e(t[u-1],t[u]));l--,n=function(p){p*=l;var f=Math.min(c,~~p);return d[f](p-f)},s=r}else i||(t=di(oe(t)?[]:{},t));if(!d){for(h in r)yc.call(a,t,h,"get",r[h]);n=function(p){return Ec(p,a)||(o?t.p:t)}}}return Cs(s,n)},tg=function(e,t,r){var s=e.labels,i=Xe,n,o,a;for(n in s)o=s[n]-t,o<0==!!r&&o&&i>(o=Math.abs(o))&&(a=n,i=o);return a},qe=function(e,t,r){var s=e.vars,i=s[t],n=wt,o=e._ctx,a,h,u;if(i)return a=s[t+"Params"],h=s.callbackScope||e,r&&As.length&&sh(),o&&(wt=o),u=a?i.apply(h,a):i.call(h),wt=n,u},uo=function(e){return Ss(e),e.scrollTrigger&&e.scrollTrigger.kill(!!ne),e.progress()<1&&qe(e,"onInterrupt"),e},an,eg=[],rg=function(e){if(Ju()&&e){e=!e.name&&e.default||e;var t=e.name,r=At(e),s=t&&!r&&e.init?function(){this._props=[]}:e,i={init:no,render:Ec,add:yc,kill:zw,modifier:Hw,rawVars:0},n={targetTest:0,get:0,getSetter:Tc,aliases:{},register:0};if(hn(),e!==s){if(Oe[t])return;je(s,je(ih(e,i),n)),di(s.prototype,di(i,ih(e,n))),Oe[s.prop=t]=s,e.targetTest&&(rh.push(s),nc[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}Om(t,s),e.register&&e.register(be,s,xe)}else e&&eg.push(e)},ht=255,co={aqua:[0,ht,ht],lime:[0,ht,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,ht],navy:[0,0,128],white:[ht,ht,ht],olive:[128,128,0],yellow:[ht,ht,0],orange:[ht,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[ht,0,0],pink:[ht,192,203],cyan:[0,ht,ht],transparent:[ht,ht,ht,0]},_c=function(e,t,r){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(r-t)*e*6:e<.5?r:e*3<2?t+(r-t)*(2/3-e)*6:t)*ht+.5|0},sg=function(e,t,r){var s=e?ts(e)?[e>>16,e>>8&ht,e&ht]:0:co.black,i,n,o,a,h,u,d,l,c,p;if(!s){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),co[e])s=co[e];else if(e.charAt(0)==="#"){if(e.length<6&&(i=e.charAt(1),n=e.charAt(2),o=e.charAt(3),e="#"+i+i+n+n+o+o+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return s=parseInt(e.substr(1,6),16),[s>>16,s>>8&ht,s&ht,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),s=[e>>16,e>>8&ht,e&ht]}else if(e.substr(0,3)==="hsl"){if(s=p=e.match(tc),!t)a=+s[0]%360/360,h=+s[1]/100,u=+s[2]/100,n=u<=.5?u*(h+1):u+h-u*h,i=u*2-n,s.length>3&&(s[3]*=1),s[0]=_c(a+1/3,i,n),s[1]=_c(a,i,n),s[2]=_c(a-1/3,i,n);else if(~e.indexOf("="))return s=e.match(Im),r&&s.length<4&&(s[3]=1),s}else s=e.match(tc)||co.transparent;s=s.map(Number)}return t&&!p&&(i=s[0]/ht,n=s[1]/ht,o=s[2]/ht,d=Math.max(i,n,o),l=Math.min(i,n,o),u=(d+l)/2,d===l?a=h=0:(c=d-l,h=u>.5?c/(2-d-l):c/(d+l),a=d===i?(n-o)/c+(n<o?6:0):d===n?(o-i)/c+2:(i-n)/c+4,a*=60),s[0]=~~(a+.5),s[1]=~~(h*100+.5),s[2]=~~(u*100+.5)),r&&s.length<4&&(s[3]=1),s},ig=function(e){var t=[],r=[],s=-1;return e.split(Is).forEach(function(i){var n=i.match(rn)||[];t.push.apply(t,n),r.push(s+=n.length+1)}),t.c=r,t},ng=function(e,t,r){var s="",i=(e+s).match(Is),n=t?"hsla(":"rgba(",o=0,a,h,u,d;if(!i)return e;if(i=i.map(function(l){return(l=sg(l,t,1))&&n+(t?l[0]+","+l[1]+"%,"+l[2]+"%,"+l[3]:l.join(","))+")"}),r&&(u=ig(e),a=r.c,a.join(s)!==u.c.join(s)))for(h=e.replace(Is,"1").split(rn),d=h.length-1;o<d;o++)s+=h[o]+(~a.indexOf(o)?i.shift()||n+"0,0,0,0)":(u.length?u:i.length?i:r).shift());if(!h)for(h=e.split(Is),d=h.length-1;o<d;o++)s+=h[o]+i[o];return s+h[d]},Is=function(){var e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in co)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),Cw=/hsl[a]?\(/,og=function(e){var t=e.join(" "),r;if(Is.lastIndex=0,Is.test(t))return r=Cw.test(t),e[1]=ng(e[1],r),e[0]=ng(e[0],r,ig(e[1])),!0},po,ke=function(){var e=Date.now,t=500,r=33,s=e(),i=s,n=1e3/240,o=n,a=[],h,u,d,l,c,p,f=function _(m){var g=e()-i,v=m===!0,y,x,E,T;if(g>t&&(s+=g-r),i+=g,E=i-s,y=E-o,(y>0||v)&&(T=++l.frame,c=E-l.time*1e3,l.time=E=E/1e3,o+=y+(y>=n?4:n-y),x=1),v||(h=u(_)),x)for(p=0;p<a.length;p++)a[p](E,c,T,m)};return l={time:0,frame:0,tick:function(){f(!0)},deltaRatio:function(_){return c/(1e3/(_||60))},wake:function(){Pm&&(!rc&&Ju()&&(We=rc=window,sc=We.document||{},De.gsap=be,(We.gsapVersions||(We.gsapVersions=[])).push(be.version),Dm(Ja||We.GreenSockGlobals||!We.gsap&&We||{}),d=We.requestAnimationFrame,eg.forEach(rg)),h&&l.sleep(),u=d||function(_){return setTimeout(_,o-l.time*1e3+1|0)},po=1,f(2))},sleep:function(){(d?We.cancelAnimationFrame:clearTimeout)(h),po=0,u=no},lagSmoothing:function(_,m){t=_||1/0,r=Math.min(m||33,t)},fps:function(_){n=1e3/(_||240),o=l.time*1e3+n},add:function(_,m,g){var v=m?function(y,x,E,T){_(y,x,E,T),l.remove(v)}:_;return l.remove(_),a[g?"unshift":"push"](v),hn(),v},remove:function(_,m){~(m=a.indexOf(_))&&a.splice(m,1)&&p>=m&&p--},_listeners:a},l}(),hn=function(){return!po&&ke.wake()},rt={},Iw=/^[\d.\-M][\d.\-,\s]/,Rw=/["']/g,Mw=function(e){for(var t={},r=e.substr(1,e.length-3).split(":"),s=r[0],i=1,n=r.length,o,a,h;i<n;i++)a=r[i],o=i!==n-1?a.lastIndexOf(","):a.length,h=a.substr(0,o),t[s]=isNaN(h)?h.replace(Rw,"").trim():+h,s=a.substr(o+1).trim();return t},Pw=function(e){var t=e.indexOf("(")+1,r=e.indexOf(")"),s=e.indexOf("(",t);return e.substring(t,~s&&s<r?e.indexOf(")",r+1):r)},Dw=function(e){var t=(e+"").split("("),r=rt[t[0]];return r&&t.length>1&&r.config?r.config.apply(null,~e.indexOf("{")?[Mw(t[1])]:Pw(e).split(",").map(Bm)):rt._CE&&Iw.test(e)?rt._CE("",e):r},ag=function(e){return function(t){return 1-e(1-t)}},hg=function e(t,r){for(var s=t._first,i;s;)s instanceof ce?e(s,r):s.vars.yoyoEase&&(!s._yoyo||!s._repeat)&&s._yoyo!==r&&(s.timeline?e(s.timeline,r):(i=s._ease,s._ease=s._yEase,s._yEase=i,s._yoyo=r)),s=s._next},fi=function(e,t){return e&&(At(e)?e:rt[e]||Dw(e))||t},_i=function(e,t,r,s){r===void 0&&(r=function(o){return 1-t(1-o)}),s===void 0&&(s=function(o){return o<.5?t(o*2)/2:1-t((1-o)*2)/2});var i={easeIn:t,easeOut:r,easeInOut:s},n;return ve(e,function(o){rt[o]=De[o]=i,rt[n=o.toLowerCase()]=r;for(var a in i)rt[n+(a==="easeIn"?".in":a==="easeOut"?".out":".inOut")]=rt[o+"."+a]=i[a]}),i},lg=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},mc=function e(t,r,s){var i=r>=1?r:1,n=(s||(t?.3:.45))/(r<1?r:1),o=n/Zu*(Math.asin(1/i)||0),a=function(u){return u===1?1:i*Math.pow(2,-10*u)*ow((u-o)*n)+1},h=t==="out"?a:t==="in"?function(u){return 1-a(1-u)}:lg(a);return n=Zu/n,h.config=function(u,d){return e(t,u,d)},h},gc=function e(t,r){r===void 0&&(r=1.70158);var s=function(n){return n?--n*n*((r+1)*n+r)+1:0},i=t==="out"?s:t==="in"?function(n){return 1-s(1-n)}:lg(s);return i.config=function(n){return e(t,n)},i};ve("Linear,Quad,Cubic,Quart,Quint,Strong",function(e,t){var r=t<5?t+1:t;_i(e+",Power"+(r-1),t?function(s){return Math.pow(s,r)}:function(s){return s},function(s){return 1-Math.pow(1-s,r)},function(s){return s<.5?Math.pow(s*2,r)/2:1-Math.pow((1-s)*2,r)/2})}),rt.Linear.easeNone=rt.none=rt.Linear.easeIn,_i("Elastic",mc("in"),mc("out"),mc()),function(e,t){var r=1/t,s=2*r,i=2.5*r,n=function(o){return o<r?e*o*o:o<s?e*Math.pow(o-1.5/t,2)+.75:o<i?e*(o-=2.25/t)*o+.9375:e*Math.pow(o-2.625/t,2)+.984375};_i("Bounce",function(o){return 1-n(1-o)},n)}(7.5625,2.75),_i("Expo",function(e){return e?Math.pow(2,10*(e-1)):0}),_i("Circ",function(e){return-(Sm(1-e*e)-1)}),_i("Sine",function(e){return e===1?1:-nw(e*sw)+1}),_i("Back",gc("in"),gc("out"),gc()),rt.SteppedEase=rt.steps=De.SteppedEase={config:function(e,t){e===void 0&&(e=1);var r=1/e,s=e+(t?0:1),i=t?1:0,n=1-at;return function(o){return((s*ho(0,n,o)|0)+i)*r}}},en.ease=rt["quad.out"],ve("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(e){return hc+=e+","+e+"Params,"});var ug=function(e,t){this.id=iw++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:Lm,this.set=t?t.getSetter:Tc},fo=function(){function e(r){this.vars=r,this._delay=+r.delay||0,(this._repeat=r.repeat===1/0?-2:r.repeat||0)&&(this._rDelay=r.repeatDelay||0,this._yoyo=!!r.yoyo||!!r.yoyoEase),this._ts=1,on(this,+r.duration,1,1),this.data=r.data,wt&&(this._ctx=wt,wt.data.push(this)),po||ke.wake()}var t=e.prototype;return t.delay=function(r){return r||r===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+r-this._delay),this._delay=r,this):this._delay},t.duration=function(r){return arguments.length?this.totalDuration(this._repeat>0?r+(r+this._rDelay)*this._repeat:r):this.totalDuration()&&this._dur},t.totalDuration=function(r){return arguments.length?(this._dirty=0,on(this,this._repeat<0?r:(r-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(r,s){if(hn(),!arguments.length)return this._tTime;var i=this._dp;if(i&&i.smoothChildTiming&&this._ts){for(hh(this,r),!i._dp||i.parent||Vm(i,this);i&&i.parent;)i.parent._time!==i._start+(i._ts>=0?i._tTime/i._ts:(i.totalDuration()-i._tTime)/-i._ts)&&i.totalTime(i._tTime,!0),i=i.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&r<this._tDur||this._ts<0&&r>0||!this._tDur&&!r)&&Dr(this._dp,this,this._start-this._delay)}return(this._tTime!==r||!this._dur&&!s||this._initted&&Math.abs(this._zTime)===at||!r&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=r),Fm(this,r,s)),this},t.time=function(r,s){return arguments.length?this.totalTime(Math.min(this.totalDuration(),r+zm(this))%(this._dur+this._rDelay)||(r?this._dur:0),s):this._time},t.totalProgress=function(r,s){return arguments.length?this.totalTime(this.totalDuration()*r,s):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(r,s){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-r:r)+zm(this),s):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(r,s){var i=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(r-1)*i,s):this._repeat?nn(this._tTime,i)+1:1},t.timeScale=function(r){if(!arguments.length)return this._rts===-at?0:this._rts;if(this._rts===r)return this;var s=this.parent&&this._ts?oh(this.parent._time,this):this._tTime;return this._rts=+r||0,this._ts=this._ps||r===-at?0:this._rts,this.totalTime(ho(-Math.abs(this._delay),this._tDur,s),!0),ah(this),pw(this)},t.paused=function(r){return arguments.length?(this._ps!==r&&(this._ps=r,r?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(hn(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==at&&(this._tTime-=at)))),this):this._ps},t.startTime=function(r){if(arguments.length){this._start=r;var s=this.parent||this._dp;return s&&(s._sort||!this.parent)&&Dr(s,this,r-this._delay),this}return this._start},t.endTime=function(r){return this._start+(ye(r)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(r){var s=this.parent||this._dp;return s?r&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?oh(s.rawTime(r),this):this._tTime:this._tTime},t.revert=function(r){r===void 0&&(r=lw);var s=ne;return ne=r,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(r),this.totalTime(-.01,r.suppressEvents)),this.data!=="nested"&&r.kill!==!1&&this.kill(),ne=s,this},t.globalTime=function(r){for(var s=this,i=arguments.length?r:s.rawTime();s;)i=s._start+i/(s._ts||1),s=s._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(r):i},t.repeat=function(r){return arguments.length?(this._repeat=r===1/0?-2:r,jm(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(r){if(arguments.length){var s=this._time;return this._rDelay=r,jm(this),s?this.time(s):this}return this._rDelay},t.yoyo=function(r){return arguments.length?(this._yoyo=r,this):this._yoyo},t.seek=function(r,s){return this.totalTime(Ye(this,r),ye(s))},t.restart=function(r,s){return this.play().totalTime(r?-this._delay:0,ye(s))},t.play=function(r,s){return r!=null&&this.seek(r,s),this.reversed(!1).paused(!1)},t.reverse=function(r,s){return r!=null&&this.seek(r||this.totalDuration(),s),this.reversed(!0).paused(!1)},t.pause=function(r,s){return r!=null&&this.seek(r,s),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(r){return arguments.length?(!!r!==this.reversed()&&this.timeScale(-this._rts||(r?-at:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-at,this},t.isActive=function(){var r=this.parent||this._dp,s=this._start,i;return!!(!r||this._ts&&this._initted&&r.isActive()&&(i=r.rawTime(!0))>=s&&i<this.endTime(!0)-at)},t.eventCallback=function(r,s,i){var n=this.vars;return arguments.length>1?(s?(n[r]=s,i&&(n[r+"Params"]=i),r==="onUpdate"&&(this._onUpdate=s)):delete n[r],this):n[r]},t.then=function(r){var s=this;return new Promise(function(i){var n=At(r)?r:Um,o=function(){var a=s.then;s.then=null,At(n)&&(n=n(s))&&(n.then||n===s)&&(s.then=a),i(n),s.then=a};s._initted&&s.totalProgress()===1&&s._ts>=0||!s._tTime&&s._ts<0?o():s._prom=o})},t.kill=function(){uo(this)},e}();je(fo.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-at,_prom:0,_ps:!1,_rts:1});var ce=function(e){Am(t,e);function t(s,i){var n;return s===void 0&&(s={}),n=e.call(this,s)||this,n.labels={},n.smoothChildTiming=!!s.smoothChildTiming,n.autoRemoveChildren=!!s.autoRemoveChildren,n._sort=ye(s.sortChildren),gt&&Dr(s.parent||gt,Jr(n),i),s.reversed&&n.reverse(),s.paused&&n.paused(!0),s.scrollTrigger&&Xm(Jr(n),s.scrollTrigger),n}var r=t.prototype;return r.to=function(s,i,n){return ao(0,arguments,this),this},r.from=function(s,i,n){return ao(1,arguments,this),this},r.fromTo=function(s,i,n,o){return ao(2,arguments,this),this},r.set=function(s,i,n){return i.duration=0,i.parent=this,oo(i).repeatDelay||(i.repeat=0),i.immediateRender=!!i.immediateRender,new Dt(s,i,Ye(this,n),1),this},r.call=function(s,i,n){return Dr(this,Dt.delayedCall(0,s,i),n)},r.staggerTo=function(s,i,n,o,a,h,u){return n.duration=i,n.stagger=n.stagger||o,n.onComplete=h,n.onCompleteParams=u,n.parent=this,new Dt(s,n,Ye(this,a)),this},r.staggerFrom=function(s,i,n,o,a,h,u){return n.runBackwards=1,oo(n).immediateRender=ye(n.immediateRender),this.staggerTo(s,i,n,o,a,h,u)},r.staggerFromTo=function(s,i,n,o,a,h,u,d){return o.startAt=n,oo(o).immediateRender=ye(o.immediateRender),this.staggerTo(s,i,o,a,h,u,d)},r.render=function(s,i,n){var o=this._time,a=this._dirty?this.totalDuration():this._tDur,h=this._dur,u=s<=0?0:Kt(s),d=this._zTime<0!=s<0&&(this._initted||!h),l,c,p,f,_,m,g,v,y,x,E,T;if(this!==gt&&u>a&&s>=0&&(u=a),u!==this._tTime||n||d){if(o!==this._time&&h&&(u+=this._time-o,s+=this._time-o),l=u,y=this._start,v=this._ts,m=!v,d&&(h||(o=this._zTime),(s||!i)&&(this._zTime=s)),this._repeat){if(E=this._yoyo,_=h+this._rDelay,this._repeat<-1&&s<0)return this.totalTime(_*100+s,i,n);if(l=Kt(u%_),u===a?(f=this._repeat,l=h):(f=~~(u/_),f&&f===u/_&&(l=h,f--),l>h&&(l=h)),x=nn(this._tTime,_),!o&&this._tTime&&x!==f&&this._tTime-x*_-this._dur<=0&&(x=f),E&&f&1&&(l=h-l,T=1),f!==x&&!this._lock){var w=E&&x&1,b=w===(E&&f&1);if(f<x&&(w=!w),o=w?0:h,this._lock=1,this.render(o||(T?0:Kt(f*_)),i,!h)._lock=0,this._tTime=u,!i&&this.parent&&qe(this,"onRepeat"),this.vars.repeatRefresh&&!T&&(this.invalidate()._lock=1),o&&o!==this._time||m!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(h=this._dur,a=this._tDur,b&&(this._lock=2,o=w?h:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!T&&this.invalidate()),this._lock=0,!this._ts&&!m)return this;hg(this,T)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(g=gw(this,Kt(o),Kt(l)),g&&(u-=l-(l=g._start))),this._tTime=u,this._time=l,this._act=!v,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=s,o=0),!o&&l&&!i&&!f&&(qe(this,"onStart"),this._tTime!==u))return this;if(l>=o&&s>=0)for(c=this._first;c;){if(p=c._next,(c._act||l>=c._start)&&c._ts&&g!==c){if(c.parent!==this)return this.render(s,i,n);if(c.render(c._ts>0?(l-c._start)*c._ts:(c._dirty?c.totalDuration():c._tDur)+(l-c._start)*c._ts,i,n),l!==this._time||!this._ts&&!m){g=0,p&&(u+=this._zTime=-at);break}}c=p}else{c=this._last;for(var A=s<0?s:l;c;){if(p=c._prev,(c._act||A<=c._end)&&c._ts&&g!==c){if(c.parent!==this)return this.render(s,i,n);if(c.render(c._ts>0?(A-c._start)*c._ts:(c._dirty?c.totalDuration():c._tDur)+(A-c._start)*c._ts,i,n||ne&&(c._initted||c._startAt)),l!==this._time||!this._ts&&!m){g=0,p&&(u+=this._zTime=A?-at:at);break}}c=p}}if(g&&!i&&(this.pause(),g.render(l>=o?0:-at)._zTime=l>=o?1:-1,this._ts))return this._start=y,ah(this),this.render(s,i,n);this._onUpdate&&!i&&qe(this,"onUpdate",!0),(u===a&&this._tTime>=this.totalDuration()||!u&&o)&&(y===this._start||Math.abs(v)!==Math.abs(this._ts))&&(this._lock||((s||!h)&&(u===a&&this._ts>0||!u&&this._ts<0)&&Ss(this,1),!i&&!(s<0&&!o)&&(u||o||!a)&&(qe(this,u===a&&s>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<a&&this.timeScale()>0)&&this._prom())))}return this},r.add=function(s,i){var n=this;if(ts(i)||(i=Ye(this,i,s)),!(s instanceof fo)){if(oe(s))return s.forEach(function(o){return n.add(o,i)}),this;if(Vt(s))return this.addLabel(s,i);if(At(s))s=Dt.delayedCall(0,s);else return this}return this!==s?Dr(this,s,i):this},r.getChildren=function(s,i,n,o){s===void 0&&(s=!0),i===void 0&&(i=!0),n===void 0&&(n=!0),o===void 0&&(o=-Xe);for(var a=[],h=this._first;h;)h._start>=o&&(h instanceof Dt?i&&a.push(h):(n&&a.push(h),s&&a.push.apply(a,h.getChildren(!0,i,n)))),h=h._next;return a},r.getById=function(s){for(var i=this.getChildren(1,1,1),n=i.length;n--;)if(i[n].vars.id===s)return i[n]},r.remove=function(s){return Vt(s)?this.removeLabel(s):At(s)?this.killTweensOf(s):(nh(this,s),s===this._recent&&(this._recent=this._last),pi(this))},r.totalTime=function(s,i){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Kt(ke.time-(this._ts>0?s/this._ts:(this.totalDuration()-s)/-this._ts))),e.prototype.totalTime.call(this,s,i),this._forcing=0,this):this._tTime},r.addLabel=function(s,i){return this.labels[s]=Ye(this,i),this},r.removeLabel=function(s){return delete this.labels[s],this},r.addPause=function(s,i,n){var o=Dt.delayedCall(0,i||no,n);return o.data="isPause",this._hasPause=1,Dr(this,o,Ye(this,s))},r.removePause=function(s){var i=this._first;for(s=Ye(this,s);i;)i._start===s&&i.data==="isPause"&&Ss(i),i=i._next},r.killTweensOf=function(s,i,n){for(var o=this.getTweensOf(s,n),a=o.length;a--;)Rs!==o[a]&&o[a].kill(s,i);return this},r.getTweensOf=function(s,i){for(var n=[],o=$e(s),a=this._first,h=ts(i),u;a;)a instanceof Dt?uw(a._targets,o)&&(h?(!Rs||a._initted&&a._ts)&&a.globalTime(0)<=i&&a.globalTime(a.totalDuration())>i:!i||a.isActive())&&n.push(a):(u=a.getTweensOf(o,i)).length&&n.push.apply(n,u),a=a._next;return n},r.tweenTo=function(s,i){i=i||{};var n=this,o=Ye(n,s),a=i,h=a.startAt,u=a.onStart,d=a.onStartParams,l=a.immediateRender,c,p=Dt.to(n,je({ease:i.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:i.duration||Math.abs((o-(h&&"time"in h?h.time:n._time))/n.timeScale())||at,onStart:function(){if(n.pause(),!c){var f=i.duration||Math.abs((o-(h&&"time"in h?h.time:n._time))/n.timeScale());p._dur!==f&&on(p,f,0,1).render(p._time,!0,!0),c=1}u&&u.apply(p,d||[])}},i));return l?p.render(0):p},r.tweenFromTo=function(s,i,n){return this.tweenTo(i,je({startAt:{time:Ye(this,s)}},n))},r.recent=function(){return this._recent},r.nextLabel=function(s){return s===void 0&&(s=this._time),tg(this,Ye(this,s))},r.previousLabel=function(s){return s===void 0&&(s=this._time),tg(this,Ye(this,s),1)},r.currentLabel=function(s){return arguments.length?this.seek(s,!0):this.previousLabel(this._time+at)},r.shiftChildren=function(s,i,n){n===void 0&&(n=0);for(var o=this._first,a=this.labels,h;o;)o._start>=n&&(o._start+=s,o._end+=s),o=o._next;if(i)for(h in a)a[h]>=n&&(a[h]+=s);return pi(this)},r.invalidate=function(s){var i=this._first;for(this._lock=0;i;)i.invalidate(s),i=i._next;return e.prototype.invalidate.call(this,s)},r.clear=function(s){s===void 0&&(s=!0);for(var i=this._first,n;i;)n=i._next,this.remove(i),i=n;return this._dp&&(this._time=this._tTime=this._pTime=0),s&&(this.labels={}),pi(this)},r.totalDuration=function(s){var i=0,n=this,o=n._last,a=Xe,h,u,d;if(arguments.length)return n.timeScale((n._repeat<0?n.duration():n.totalDuration())/(n.reversed()?-s:s));if(n._dirty){for(d=n.parent;o;)h=o._prev,o._dirty&&o.totalDuration(),u=o._start,u>a&&n._sort&&o._ts&&!n._lock?(n._lock=1,Dr(n,o,u-o._delay,1)._lock=0):a=u,u<0&&o._ts&&(i-=u,(!d&&!n._dp||d&&d.smoothChildTiming)&&(n._start+=u/n._ts,n._time-=u,n._tTime-=u),n.shiftChildren(-u,!1,-1/0),a=0),o._end>i&&o._ts&&(i=o._end),o=h;on(n,n===gt&&n._time>i?n._time:i,1,1),n._dirty=0}return n._tDur},t.updateRoot=function(s){if(gt._ts&&(Fm(gt,oh(s,gt)),km=ke.frame),ke.frame>=Nm){Nm+=Pe.autoSleep||120;var i=gt._first;if((!i||!i._ts)&&Pe.autoSleep&&ke._listeners.length<2){for(;i&&!i._ts;)i=i._next;i||ke.sleep()}}},t}(fo);je(ce.prototype,{_lock:0,_hasPause:0,_forcing:0});var Ow=function(e,t,r,s,i,n,o){var a=new xe(this._pt,e,t,0,1,mg,null,i),h=0,u=0,d,l,c,p,f,_,m,g;for(a.b=r,a.e=s,r+="",s+="",(m=~s.indexOf("random("))&&(s=lo(s)),n&&(g=[r,s],n(g,e,t),r=g[0],s=g[1]),l=r.match(ec)||[];d=ec.exec(s);)p=d[0],f=s.substring(h,d.index),c?c=(c+1)%5:f.substr(-5)==="rgba("&&(c=1),p!==l[u++]&&(_=parseFloat(l[u-1])||0,a._pt={_next:a._pt,p:f||u===1?f:",",s:_,c:p.charAt(1)==="="?sn(_,p)-_:parseFloat(p)-_,m:c&&c<4?Math.round:0},h=ec.lastIndex);return a.c=h<s.length?s.substring(h,s.length):"",a.fp=o,(Rm.test(s)||m)&&(a.e=0),this._pt=a,a},yc=function(e,t,r,s,i,n,o,a,h,u){At(s)&&(s=s(i||0,e,n));var d=e[t],l=r!=="get"?r:At(d)?h?e[t.indexOf("set")||!At(e["get"+t.substr(3)])?t:"get"+t.substr(3)](h):e[t]():d,c=At(d)?h?Bw:fg:bc,p;if(Vt(s)&&(~s.indexOf("random(")&&(s=lo(s)),s.charAt(1)==="="&&(p=sn(l,s)+(ae(l)||0),(p||p===0)&&(s=p))),!u||l!==s||vc)return!isNaN(l*s)&&s!==""?(p=new xe(this._pt,e,t,+l||0,s-(l||0),typeof d=="boolean"?Gw:_g,0,c),h&&(p.fp=h),o&&p.modifier(o,this,e),this._pt=p):(!d&&!(t in e)&&ic(t,s),Ow.call(this,e,t,l,s,c,a||Pe.stringFilter,h))},kw=function(e,t,r,s,i){if(At(e)&&(e=_o(e,i,t,r,s)),!Pr(e)||e.style&&e.nodeType||oe(e)||Cm(e))return Vt(e)?_o(e,i,t,r,s):e;var n={},o;for(o in e)n[o]=_o(e[o],i,t,r,s);return n},cg=function(e,t,r,s,i,n){var o,a,h,u;if(Oe[e]&&(o=new Oe[e]).init(i,o.rawVars?t[e]:kw(t[e],s,i,n,r),r,s,n)!==!1&&(r._pt=a=new xe(r._pt,i,e,0,1,o.render,o,0,o.priority),r!==an))for(h=r._ptLookup[r._targets.indexOf(i)],u=o._props.length;u--;)h[o._props[u]]=a;return o},Rs,vc,xc=function e(t,r,s){var i=t.vars,n=i.ease,o=i.startAt,a=i.immediateRender,h=i.lazy,u=i.onUpdate,d=i.onUpdateParams,l=i.callbackScope,c=i.runBackwards,p=i.yoyoEase,f=i.keyframes,_=i.autoRevert,m=t._dur,g=t._startAt,v=t._targets,y=t.parent,x=y&&y.data==="nested"?y.vars.targets:v,E=t._overwrite==="auto"&&!Ku,T=t.timeline,w,b,A,R,S,M,I,C,O,L,D,Y,Z;if(T&&(!f||!n)&&(n="none"),t._ease=fi(n,en.ease),t._yEase=p?ag(fi(p===!0?n:p,en.ease)):0,p&&t._yoyo&&!t._repeat&&(p=t._yEase,t._yEase=t._ease,t._ease=p),t._from=!T&&!!i.runBackwards,!T||f&&!i.stagger){if(C=v[0]?ci(v[0]).harness:0,Y=C&&i[C.prop],w=ih(i,nc),g&&(g._zTime<0&&g.progress(1),r<0&&c&&a&&!_?g.render(-1,!0):g.revert(c&&m?eh:hw),g._lazy=0),o){if(Ss(t._startAt=Dt.set(v,je({data:"isStart",overwrite:!1,parent:y,immediateRender:!0,lazy:!g&&ye(h),startAt:null,delay:0,onUpdate:u,onUpdateParams:d,callbackScope:l,stagger:0},o))),t._startAt._dp=0,t._startAt._sat=t,r<0&&(ne||!a&&!_)&&t._startAt.revert(eh),a&&m&&r<=0&&s<=0){r&&(t._zTime=r);return}}else if(c&&m&&!g){if(r&&(a=!1),A=je({overwrite:!1,data:"isFromStart",lazy:a&&!g&&ye(h),immediateRender:a,stagger:0,parent:y},w),Y&&(A[C.prop]=Y),Ss(t._startAt=Dt.set(v,A)),t._startAt._dp=0,t._startAt._sat=t,r<0&&(ne?t._startAt.revert(eh):t._startAt.render(-1,!0)),t._zTime=r,!a)e(t._startAt,at,at);else if(!r)return}for(t._pt=t._ptCache=0,h=m&&ye(h)||h&&!m,b=0;b<v.length;b++){if(S=v[b],I=S._gsap||lc(v)[b]._gsap,t._ptLookup[b]=L={},oc[I.id]&&As.length&&sh(),D=x===v?b:x.indexOf(S),C&&(O=new C).init(S,Y||w,t,D,x)!==!1&&(t._pt=R=new xe(t._pt,S,O.name,0,1,O.render,O,0,O.priority),O._props.forEach(function(P){L[P]=R}),O.priority&&(M=1)),!C||Y)for(A in w)Oe[A]&&(O=cg(A,w,t,D,S,x))?O.priority&&(M=1):L[A]=R=yc.call(t,S,A,"get",w[A],D,x,0,i.stringFilter);t._op&&t._op[b]&&t.kill(S,t._op[b]),E&&t._pt&&(Rs=t,gt.killTweensOf(S,L,t.globalTime(r)),Z=!t.parent,Rs=0),t._pt&&h&&(oc[I.id]=1)}M&&gg(t),t._onInit&&t._onInit(t)}t._onUpdate=u,t._initted=(!t._op||t._pt)&&!Z,f&&r<=0&&T.render(Xe,!0,!0)},Nw=function(e,t,r,s,i,n,o){var a=(e._pt&&e._ptCache||(e._ptCache={}))[t],h,u,d,l;if(!a)for(a=e._ptCache[t]=[],d=e._ptLookup,l=e._targets.length;l--;){if(h=d[l][t],h&&h.d&&h.d._pt)for(h=h.d._pt;h&&h.p!==t&&h.fp!==t;)h=h._next;if(!h)return vc=1,e.vars[t]="+=0",xc(e,o),vc=0,1;a.push(h)}for(l=a.length;l--;)u=a[l],h=u._pt||u,h.s=(s||s===0)&&!i?s:h.s+(s||0)+n*h.c,h.c=r-h.s,u.e&&(u.e=It(r)+ae(u.e)),u.b&&(u.b=h.s+ae(u.b))},Lw=function(e,t){var r=e[0]?ci(e[0]).harness:0,s=r&&r.aliases,i,n,o,a;if(!s)return t;i=di({},t);for(n in s)if(n in i)for(a=s[n].split(","),o=a.length;o--;)i[a[o]]=i[n];return i},Fw=function(e,t,r,s){var i=t.ease||s||"power1.inOut",n,o;if(oe(t))o=r[e]||(r[e]=[]),t.forEach(function(a,h){return o.push({t:h/(t.length-1)*100,v:a,e:i})});else for(n in t)o=r[n]||(r[n]=[]),n==="ease"||o.push({t:parseFloat(e),v:t[n],e:i})},_o=function(e,t,r,s,i){return At(e)?e.call(t,r,s,i):Vt(e)&&~e.indexOf("random(")?lo(e):e},dg=hc+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",pg={};ve(dg+",id,stagger,delay,duration,paused,scrollTrigger",function(e){return pg[e]=1});var Dt=function(e){Am(t,e);function t(s,i,n,o){var a;typeof i=="number"&&(n.duration=i,i=n,n=null),a=e.call(this,o?i:oo(i))||this;var h=a.vars,u=h.duration,d=h.delay,l=h.immediateRender,c=h.stagger,p=h.overwrite,f=h.keyframes,_=h.defaults,m=h.scrollTrigger,g=h.yoyoEase,v=i.parent||gt,y=(oe(s)||Cm(s)?ts(s[0]):"length"in i)?[s]:$e(s),x,E,T,w,b,A,R,S;if(a._targets=y.length?lc(y):th("GSAP target "+s+" not found. https://greensock.com",!Pe.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=p,f||c||Qa(u)||Qa(d)){if(i=a.vars,x=a.timeline=new ce({data:"nested",defaults:_||{},targets:v&&v.data==="nested"?v.vars.targets:y}),x.kill(),x.parent=x._dp=Jr(a),x._start=0,c||Qa(u)||Qa(d)){if(w=y.length,R=c&&qm(c),Pr(c))for(b in c)~dg.indexOf(b)&&(S||(S={}),S[b]=c[b]);for(E=0;E<w;E++)T=ih(i,pg),T.stagger=0,g&&(T.yoyoEase=g),S&&di(T,S),A=y[E],T.duration=+_o(u,Jr(a),E,A,y),T.delay=(+_o(d,Jr(a),E,A,y)||0)-a._delay,!c&&w===1&&T.delay&&(a._delay=d=T.delay,a._start+=d,T.delay=0),x.to(A,T,R?R(E,A,y):0),x._ease=rt.none;x.duration()?u=d=0:a.timeline=0}else if(f){oo(je(x.vars.defaults,{ease:"none"})),x._ease=fi(f.ease||i.ease||"none");var M=0,I,C,O;if(oe(f))f.forEach(function(L){return x.to(y,L,">")}),x.duration();else{T={};for(b in f)b==="ease"||b==="easeEach"||Fw(b,f[b],T,f.easeEach);for(b in T)for(I=T[b].sort(function(L,D){return L.t-D.t}),M=0,E=0;E<I.length;E++)C=I[E],O={ease:C.e,duration:(C.t-(E?I[E-1].t:0))/100*u},O[b]=C.v,x.to(y,O,M),M+=O.duration;x.duration()<u&&x.to({},{duration:u-x.duration()})}}u||a.duration(u=x.duration())}else a.timeline=0;return p===!0&&!Ku&&(Rs=Jr(a),gt.killTweensOf(y),Rs=0),Dr(v,Jr(a),n),i.reversed&&a.reverse(),i.paused&&a.paused(!0),(l||!u&&!f&&a._start===Kt(v._time)&&ye(l)&&fw(Jr(a))&&v.data!=="nested")&&(a._tTime=-at,a.render(Math.max(0,-d)||0)),m&&Xm(Jr(a),m),a}var r=t.prototype;return r.render=function(s,i,n){var o=this._time,a=this._tDur,h=this._dur,u=s<0,d=s>a-at&&!u?a:s<at?0:s,l,c,p,f,_,m,g,v,y;if(!h)mw(this,s,i,n);else if(d!==this._tTime||!s||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(l=d,v=this.timeline,this._repeat){if(f=h+this._rDelay,this._repeat<-1&&u)return this.totalTime(f*100+s,i,n);if(l=Kt(d%f),d===a?(p=this._repeat,l=h):(p=~~(d/f),p&&p===d/f&&(l=h,p--),l>h&&(l=h)),m=this._yoyo&&p&1,m&&(y=this._yEase,l=h-l),_=nn(this._tTime,f),l===o&&!n&&this._initted)return this._tTime=d,this;p!==_&&(v&&this._yEase&&hg(v,m),this.vars.repeatRefresh&&!m&&!this._lock&&(this._lock=n=1,this.render(Kt(f*p),!0).invalidate()._lock=0))}if(!this._initted){if(Wm(this,u?s:l,n,i,d))return this._tTime=0,this;if(o!==this._time)return this;if(h!==this._dur)return this.render(s,i,n)}if(this._tTime=d,this._time=l,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=g=(y||this._ease)(l/h),this._from&&(this.ratio=g=1-g),l&&!o&&!i&&!p&&(qe(this,"onStart"),this._tTime!==d))return this;for(c=this._pt;c;)c.r(g,c.d),c=c._next;v&&v.render(s<0?s:!l&&m?-at:v._dur*v._ease(l/this._dur),i,n)||this._startAt&&(this._zTime=s),this._onUpdate&&!i&&(u&&uc(this,s,i,n),qe(this,"onUpdate")),this._repeat&&p!==_&&this.vars.onRepeat&&!i&&this.parent&&qe(this,"onRepeat"),(d===this._tDur||!d)&&this._tTime===d&&(u&&!this._onUpdate&&uc(this,s,!0,!0),(s||!h)&&(d===this._tDur&&this._ts>0||!d&&this._ts<0)&&Ss(this,1),!i&&!(u&&!o)&&(d||o||m)&&(qe(this,d===a?"onComplete":"onReverseComplete",!0),this._prom&&!(d<a&&this.timeScale()>0)&&this._prom()))}return this},r.targets=function(){return this._targets},r.invalidate=function(s){return(!s||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(s),e.prototype.invalidate.call(this,s)},r.resetTo=function(s,i,n,o){po||ke.wake(),this._ts||this.play();var a=Math.min(this._dur,(this._dp._time-this._start)*this._ts),h;return this._initted||xc(this,a),h=this._ease(a/this._dur),Nw(this,s,i,n,o,h,a)?this.resetTo(s,i,n,o):(hh(this,0),this.parent||Hm(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},r.kill=function(s,i){if(i===void 0&&(i="all"),!s&&(!i||i==="all"))return this._lazy=this._pt=0,this.parent?uo(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(s,i,Rs&&Rs.vars.overwrite!==!0)._first||uo(this),this.parent&&n!==this.timeline.totalDuration()&&on(this,this._dur*this.timeline._tDur/n,0,1),this}var o=this._targets,a=s?$e(s):o,h=this._ptLookup,u=this._pt,d,l,c,p,f,_,m;if((!i||i==="all")&&dw(o,a))return i==="all"&&(this._pt=0),uo(this);for(d=this._op=this._op||[],i!=="all"&&(Vt(i)&&(f={},ve(i,function(g){return f[g]=1}),i=f),i=Lw(o,i)),m=o.length;m--;)if(~a.indexOf(o[m])){l=h[m],i==="all"?(d[m]=i,p=l,c={}):(c=d[m]=d[m]||{},p=i);for(f in p)_=l&&l[f],_&&((!("kill"in _.d)||_.d.kill(f)===!0)&&nh(this,_,"_pt"),delete l[f]),c!=="all"&&(c[f]=1)}return this._initted&&!this._pt&&u&&uo(this),this},t.to=function(s,i){return new t(s,i,arguments[2])},t.from=function(s,i){return ao(1,arguments)},t.delayedCall=function(s,i,n,o){return new t(i,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:s,onComplete:i,onReverseComplete:i,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:o})},t.fromTo=function(s,i,n){return ao(2,arguments)},t.set=function(s,i){return i.duration=0,i.repeatDelay||(i.repeat=0),new t(s,i)},t.killTweensOf=function(s,i,n){return gt.killTweensOf(s,i,n)},t}(fo);je(Dt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),ve("staggerTo,staggerFrom,staggerFromTo",function(e){Dt[e]=function(){var t=new ce,r=dc.call(arguments,0);return r.splice(e==="staggerFromTo"?5:4,0,0),t[e].apply(t,r)}});var bc=function(e,t,r){return e[t]=r},fg=function(e,t,r){return e[t](r)},Bw=function(e,t,r,s){return e[t](s.fp,r)},Uw=function(e,t,r){return e.setAttribute(t,r)},Tc=function(e,t){return At(e[t])?fg:Qu(e[t])&&e.setAttribute?Uw:bc},_g=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},Gw=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},mg=function(e,t){var r=t._pt,s="";if(!e&&t.b)s=t.b;else if(e===1&&t.e)s=t.e;else{for(;r;)s=r.p+(r.m?r.m(r.s+r.c*e):Math.round((r.s+r.c*e)*1e4)/1e4)+s,r=r._next;s+=t.c}t.set(t.t,t.p,s,t)},Ec=function(e,t){for(var r=t._pt;r;)r.r(e,r.d),r=r._next},Hw=function(e,t,r,s){for(var i=this._pt,n;i;)n=i._next,i.p===s&&i.modifier(e,t,r),i=n},zw=function(e){for(var t=this._pt,r,s;t;)s=t._next,t.p===e&&!t.op||t.op===e?nh(this,t,"_pt"):t.dep||(r=1),t=s;return!r},Vw=function(e,t,r,s){s.mSet(e,t,s.m.call(s.tween,r,s.mt),s)},gg=function(e){for(var t=e._pt,r,s,i,n;t;){for(r=t._next,s=i;s&&s.pr>t.pr;)s=s._next;(t._prev=s?s._prev:n)?t._prev._next=t:i=t,(t._next=s)?s._prev=t:n=t,t=r}e._pt=i},xe=function(){function e(r,s,i,n,o,a,h,u,d){this.t=s,this.s=n,this.c=o,this.p=i,this.r=a||_g,this.d=h||this,this.set=u||bc,this.pr=d||0,this._next=r,r&&(r._prev=this)}var t=e.prototype;return t.modifier=function(r,s,i){this.mSet=this.mSet||this.set,this.set=Vw,this.m=r,this.mt=i,this.tween=s},e}();ve(hc+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(e){return nc[e]=1}),De.TweenMax=De.TweenLite=Dt,De.TimelineLite=De.TimelineMax=ce,gt=new ce({sortChildren:!1,defaults:en,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Pe.stringFilter=og;var mi=[],lh={},Xw=[],yg=0,Ww=0,wc=function(e){return(lh[e]||Xw).map(function(t){return t()})},Ac=function(){var e=Date.now(),t=[];e-yg>2&&(wc("matchMediaInit"),mi.forEach(function(r){var s=r.queries,i=r.conditions,n,o,a,h;for(o in s)n=We.matchMedia(s[o]).matches,n&&(a=1),n!==i[o]&&(i[o]=n,h=1);h&&(r.revert(),a&&t.push(r))}),wc("matchMediaRevert"),t.forEach(function(r){return r.onMatch(r)}),yg=e,wc("matchMedia"))},vg=function(){function e(r,s){this.selector=s&&pc(s),this.data=[],this._r=[],this.isReverted=!1,this.id=Ww++,r&&this.add(r)}var t=e.prototype;return t.add=function(r,s,i){At(r)&&(i=s,s=r,r=At);var n=this,o=function(){var a=wt,h=n.selector,u;return a&&a!==n&&a.data.push(n),i&&(n.selector=pc(i)),wt=n,u=s.apply(n,arguments),At(u)&&n._r.push(u),wt=a,n.selector=h,n.isReverted=!1,u};return n.last=o,r===At?o(n):r?n[r]=o:o},t.ignore=function(r){var s=wt;wt=null,r(this),wt=s},t.getTweens=function(){var r=[];return this.data.forEach(function(s){return s instanceof e?r.push.apply(r,s.getTweens()):s instanceof Dt&&!(s.parent&&s.parent.data==="nested")&&r.push(s)}),r},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(r,s){var i=this;if(r){var n=this.getTweens();this.data.forEach(function(a){a.data==="isFlip"&&(a.revert(),a.getChildren(!0,!0,!1).forEach(function(h){return n.splice(n.indexOf(h),1)}))}),n.map(function(a){return{g:a.globalTime(0),t:a}}).sort(function(a,h){return h.g-a.g||-1}).forEach(function(a){return a.t.revert(r)}),this.data.forEach(function(a){return a instanceof ce?a.data!=="nested"&&a.kill():!(a instanceof Dt)&&a.revert&&a.revert(r)}),this._r.forEach(function(a){return a(r,i)}),this.isReverted=!0}else this.data.forEach(function(a){return a.kill&&a.kill()});if(this.clear(),s)for(var o=mi.length;o--;)mi[o].id===this.id&&mi.splice(o,1)},t.revert=function(r){this.kill(r||{})},e}(),jw=function(){function e(r){this.contexts=[],this.scope=r}var t=e.prototype;return t.add=function(r,s,i){Pr(r)||(r={matches:r});var n=new vg(0,i||this.scope),o=n.conditions={},a,h,u;wt&&!n.selector&&(n.selector=wt.selector),this.contexts.push(n),s=n.add("onMatch",s),n.queries=r;for(h in r)h==="all"?u=1:(a=We.matchMedia(r[h]),a&&(mi.indexOf(n)<0&&mi.push(n),(o[h]=a.matches)&&(u=1),a.addListener?a.addListener(Ac):a.addEventListener("change",Ac)));return u&&s(n),this},t.revert=function(r){this.kill(r||{})},t.kill=function(r){this.contexts.forEach(function(s){return s.kill(r,!0)})},e}(),uh={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(function(s){return rg(s)})},timeline:function(e){return new ce(e)},getTweensOf:function(e,t){return gt.getTweensOf(e,t)},getProperty:function(e,t,r,s){Vt(e)&&(e=$e(e)[0]);var i=ci(e||{}).get,n=r?Um:Bm;return r==="native"&&(r=""),e&&(t?n((Oe[t]&&Oe[t].get||i)(e,t,r,s)):function(o,a,h){return n((Oe[o]&&Oe[o].get||i)(e,o,a,h))})},quickSetter:function(e,t,r){if(e=$e(e),e.length>1){var s=e.map(function(u){return be.quickSetter(u,t,r)}),i=s.length;return function(u){for(var d=i;d--;)s[d](u)}}e=e[0]||{};var n=Oe[t],o=ci(e),a=o.harness&&(o.harness.aliases||{})[t]||t,h=n?function(u){var d=new n;an._pt=0,d.init(e,r?u+r:u,an,0,[e]),d.render(1,d),an._pt&&Ec(1,an)}:o.set(e,a);return n?h:function(u){return h(e,a,r?u+r:u,o,1)}},quickTo:function(e,t,r){var s,i=be.to(e,di((s={},s[t]="+=0.1",s.paused=!0,s),r||{})),n=function(o,a,h){return i.resetTo(t,o,a,h)};return n.tween=i,n},isTweening:function(e){return gt.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=fi(e.ease,en.ease)),Gm(en,e||{})},config:function(e){return Gm(Pe,e||{})},registerEffect:function(e){var t=e.name,r=e.effect,s=e.plugins,i=e.defaults,n=e.extendTimeline;(s||"").split(",").forEach(function(o){return o&&!Oe[o]&&!De[o]&&th(t+" effect requires "+o+" plugin.")}),ac[t]=function(o,a,h){return r($e(o),je(a||{},i),h)},n&&(ce.prototype[t]=function(o,a,h){return this.add(ac[t](o,Pr(a)?a:(h=a)&&{},this),h)})},registerEase:function(e,t){rt[e]=fi(t)},parseEase:function(e,t){return arguments.length?fi(e,t):rt},getById:function(e){return gt.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var r=new ce(e),s,i;for(r.smoothChildTiming=ye(e.smoothChildTiming),gt.remove(r),r._dp=0,r._time=r._tTime=gt._time,s=gt._first;s;)i=s._next,(t||!(!s._dur&&s instanceof Dt&&s.vars.onComplete===s._targets[0]))&&Dr(r,s,s._start-s._delay),s=i;return Dr(gt,r,0),r},context:function(e,t){return e?new vg(e,t):wt},matchMedia:function(e){return new jw(e)},matchMediaRefresh:function(){return mi.forEach(function(e){var t=e.conditions,r,s;for(s in t)t[s]&&(t[s]=!1,r=1);r&&e.revert()})||Ac()},addEventListener:function(e,t){var r=lh[e]||(lh[e]=[]);~r.indexOf(t)||r.push(t)},removeEventListener:function(e,t){var r=lh[e],s=r&&r.indexOf(t);s>=0&&r.splice(s,1)},utils:{wrap:ww,wrapYoyo:Aw,distribute:qm,random:Zm,snap:Km,normalize:Ew,getUnit:ae,clamp:vw,splitColor:sg,toArray:$e,selector:pc,mapRange:Jm,pipe:bw,unitize:Tw,interpolate:Sw,shuffle:$m},install:Dm,effects:ac,ticker:ke,updateRoot:ce.updateRoot,plugins:Oe,globalTimeline:gt,core:{PropTween:xe,globals:Om,Tween:Dt,Timeline:ce,Animation:fo,getCache:ci,_removeLinkedListItem:nh,reverting:function(){return ne},context:function(e){return e&&wt&&(wt.data.push(e),e._ctx=wt),wt},suppressOverwrites:function(e){return Ku=e}}};ve("to,from,fromTo,delayedCall,set,killTweensOf",function(e){return uh[e]=Dt[e]}),ke.add(ce.updateRoot),an=uh.to({},{duration:0});var Yw=function(e,t){for(var r=e._pt;r&&r.p!==t&&r.op!==t&&r.fp!==t;)r=r._next;return r},$w=function(e,t){var r=e._targets,s,i,n;for(s in t)for(i=r.length;i--;)n=e._ptLookup[i][s],n&&(n=n.d)&&(n._pt&&(n=Yw(n,s)),n&&n.modifier&&n.modifier(t[s],e,r[i],s))},Sc=function(e,t){return{name:e,rawVars:1,init:function(r,s,i){i._onInit=function(n){var o,a;if(Vt(s)&&(o={},ve(s,function(h){return o[h]=1}),s=o),t){o={};for(a in s)o[a]=t(s[a]);s=o}$w(n,s)}}}},be=uh.registerPlugin({name:"attr",init:function(e,t,r,s,i){var n,o,a;this.tween=r;for(n in t)a=e.getAttribute(n)||"",o=this.add(e,"setAttribute",(a||0)+"",t[n],s,i,0,0,n),o.op=n,o.b=a,this._props.push(n)},render:function(e,t){for(var r=t._pt;r;)ne?r.set(r.t,r.p,r.b,r):r.r(e,r.d),r=r._next}},{name:"endArray",init:function(e,t){for(var r=t.length;r--;)this.add(e,r,e[r]||0,t[r],0,0,0,0,0,1)}},Sc("roundProps",fc),Sc("modifiers"),Sc("snap",Km))||uh;Dt.version=ce.version=be.version="3.12.1",Pm=1,Ju()&&hn(),rt.Power0,rt.Power1,rt.Power2,rt.Power3,rt.Power4,rt.Linear,rt.Quad,rt.Cubic,rt.Quart,rt.Quint,rt.Strong,rt.Elastic,rt.Back,rt.SteppedEase,rt.Bounce,rt.Sine,rt.Expo,rt.Circ;var xg,Ms,ln,Cc,gi,bg,Ic,qw=function(){return typeof window<"u"},es={},yi=180/Math.PI,un=Math.PI/180,cn=Math.atan2,Tg=1e8,Rc=/([A-Z])/g,Kw=/(left|right|width|margin|padding|x)/i,Zw=/[\s,\(]\S/,Or={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Mc=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},Qw=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},Jw=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},tA=function(e,t){var r=t.s+t.c*e;t.set(t.t,t.p,~~(r+(r<0?-.5:.5))+t.u,t)},Eg=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},wg=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},eA=function(e,t,r){return e.style[t]=r},rA=function(e,t,r){return e.style.setProperty(t,r)},sA=function(e,t,r){return e._gsap[t]=r},iA=function(e,t,r){return e._gsap.scaleX=e._gsap.scaleY=r},nA=function(e,t,r,s,i){var n=e._gsap;n.scaleX=n.scaleY=r,n.renderTransform(i,n)},oA=function(e,t,r,s,i){var n=e._gsap;n[t]=r,n.renderTransform(i,n)},yt="transform",pr=yt+"Origin",aA=function e(t,r){var s=this,i=this.target,n=i.style;if(t in es&&n){if(this.tfm=this.tfm||{},t!=="transform")t=Or[t]||t,~t.indexOf(",")?t.split(",").forEach(function(o){return s.tfm[o]=rs(i,o)}):this.tfm[t]=i._gsap.x?i._gsap[t]:rs(i,t);else return Or.transform.split(",").forEach(function(o){return e.call(s,o,r)});if(this.props.indexOf(yt)>=0)return;i._gsap.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(pr,r,"")),t=yt}(n||r)&&this.props.push(t,r,n[t])},Ag=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},hA=function(){var e=this.props,t=this.target,r=t.style,s=t._gsap,i,n;for(i=0;i<e.length;i+=3)e[i+1]?t[e[i]]=e[i+2]:e[i+2]?r[e[i]]=e[i+2]:r.removeProperty(e[i].substr(0,2)==="--"?e[i]:e[i].replace(Rc,"-$1").toLowerCase());if(this.tfm){for(n in this.tfm)s[n]=this.tfm[n];s.svg&&(s.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),i=Ic(),(!i||!i.isStart)&&!r[yt]&&(Ag(r),s.uncache=1)}},Sg=function(e,t){var r={target:e,props:[],revert:hA,save:aA};return e._gsap||be.core.getCache(e),t&&t.split(",").forEach(function(s){return r.save(s)}),r},Cg,Pc=function(e,t){var r=Ms.createElementNS?Ms.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Ms.createElement(e);return r.style?r:Ms.createElement(e)},kr=function e(t,r,s){var i=getComputedStyle(t);return i[r]||i.getPropertyValue(r.replace(Rc,"-$1").toLowerCase())||i.getPropertyValue(r)||!s&&e(t,dn(r)||r,1)||""},Ig="O,Moz,ms,Ms,Webkit".split(","),dn=function(e,t,r){var s=t||gi,i=s.style,n=5;if(e in i&&!r)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);n--&&!(Ig[n]+e in i););return n<0?null:(n===3?"ms":n>=0?Ig[n]:"")+e},Dc=function(){qw()&&window.document&&(xg=window,Ms=xg.document,ln=Ms.documentElement,gi=Pc("div")||{style:{}},Pc("div"),yt=dn(yt),pr=yt+"Origin",gi.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Cg=!!dn("perspective"),Ic=be.core.reverting,Cc=1)},Oc=function e(t){var r=Pc("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=this.parentNode,i=this.nextSibling,n=this.style.cssText,o;if(ln.appendChild(r),r.appendChild(this),this.style.display="block",t)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=e}catch{}else this._gsapBBox&&(o=this._gsapBBox());return s&&(i?s.insertBefore(this,i):s.appendChild(this)),ln.removeChild(r),this.style.cssText=n,o},Rg=function(e,t){for(var r=t.length;r--;)if(e.hasAttribute(t[r]))return e.getAttribute(t[r])},Mg=function(e){var t;try{t=e.getBBox()}catch{t=Oc.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===Oc||(t=Oc.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+Rg(e,["x","cx","x1"])||0,y:+Rg(e,["y","cy","y1"])||0,width:0,height:0}:t},Pg=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&Mg(e))},mo=function(e,t){if(t){var r=e.style;t in es&&t!==pr&&(t=yt),r.removeProperty?((t.substr(0,2)==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),r.removeProperty(t.replace(Rc,"-$1").toLowerCase())):r.removeAttribute(t)}},Ps=function(e,t,r,s,i,n){var o=new xe(e._pt,t,r,0,1,n?wg:Eg);return e._pt=o,o.b=s,o.e=i,e._props.push(r),o},Dg={deg:1,rad:1,turn:1},lA={grid:1,flex:1},Ds=function e(t,r,s,i){var n=parseFloat(s)||0,o=(s+"").trim().substr((n+"").length)||"px",a=gi.style,h=Kw.test(r),u=t.tagName.toLowerCase()==="svg",d=(u?"client":"offset")+(h?"Width":"Height"),l=100,c=i==="px",p=i==="%",f,_,m,g;return i===o||!n||Dg[i]||Dg[o]?n:(o!=="px"&&!c&&(n=e(t,r,s,"px")),g=t.getCTM&&Pg(t),(p||o==="%")&&(es[r]||~r.indexOf("adius"))?(f=g?t.getBBox()[h?"width":"height"]:t[d],It(p?n/f*l:n/100*f)):(a[h?"width":"height"]=l+(c?o:i),_=~r.indexOf("adius")||i==="em"&&t.appendChild&&!u?t:t.parentNode,g&&(_=(t.ownerSVGElement||{}).parentNode),(!_||_===Ms||!_.appendChild)&&(_=Ms.body),m=_._gsap,m&&p&&m.width&&h&&m.time===ke.time&&!m.uncache?It(n/m.width*l):((p||o==="%")&&!lA[kr(_,"display")]&&(a.position=kr(t,"position")),_===t&&(a.position="static"),_.appendChild(gi),f=gi[d],_.removeChild(gi),a.position="absolute",h&&p&&(m=ci(_),m.time=ke.time,m.width=_[d]),It(c?f*n/l:f&&n?l/f*n:0))))},rs=function(e,t,r,s){var i;return Cc||Dc(),t in Or&&t!=="transform"&&(t=Or[t],~t.indexOf(",")&&(t=t.split(",")[0])),es[t]&&t!=="transform"?(i=yo(e,s),i=t!=="transformOrigin"?i[t]:i.svg?i.origin:dh(kr(e,pr))+" "+i.zOrigin+"px"):(i=e.style[t],(!i||i==="auto"||s||~(i+"").indexOf("calc("))&&(i=ch[t]&&ch[t](e,t,r)||kr(e,t)||Lm(e,t)||(t==="opacity"?1:0))),r&&!~(i+"").trim().indexOf(" ")?Ds(e,t,i,r)+r:i},uA=function(e,t,r,s){if(!r||r==="none"){var i=dn(t,e,1),n=i&&kr(e,i,1);n&&n!==r?(t=i,r=n):t==="borderColor"&&(r=kr(e,"borderTopColor"))}var o=new xe(this._pt,e.style,t,0,1,mg),a=0,h=0,u,d,l,c,p,f,_,m,g,v,y,x;if(o.b=r,o.e=s,r+="",s+="",s==="auto"&&(e.style[t]=s,s=kr(e,t)||s,e.style[t]=r),u=[r,s],og(u),r=u[0],s=u[1],l=r.match(rn)||[],x=s.match(rn)||[],x.length){for(;d=rn.exec(s);)_=d[0],g=s.substring(a,d.index),p?p=(p+1)%5:(g.substr(-5)==="rgba("||g.substr(-5)==="hsla(")&&(p=1),_!==(f=l[h++]||"")&&(c=parseFloat(f)||0,y=f.substr((c+"").length),_.charAt(1)==="="&&(_=sn(c,_)+y),m=parseFloat(_),v=_.substr((m+"").length),a=rn.lastIndex-v.length,v||(v=v||Pe.units[t]||y,a===s.length&&(s+=v,o.e+=v)),y!==v&&(c=Ds(e,t,f,v)||0),o._pt={_next:o._pt,p:g||h===1?g:",",s:c,c:m-c,m:p&&p<4||t==="zIndex"?Math.round:0});o.c=a<s.length?s.substring(a,s.length):""}else o.r=t==="display"&&s==="none"?wg:Eg;return Rm.test(s)&&(o.e=0),this._pt=o,o},Og={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},cA=function(e){var t=e.split(" "),r=t[0],s=t[1]||"50%";return(r==="top"||r==="bottom"||s==="left"||s==="right")&&(e=r,r=s,s=e),t[0]=Og[r]||r,t[1]=Og[s]||s,t.join(" ")},dA=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var r=t.t,s=r.style,i=t.u,n=r._gsap,o,a,h;if(i==="all"||i===!0)s.cssText="",a=1;else for(i=i.split(","),h=i.length;--h>-1;)o=i[h],es[o]&&(a=1,o=o==="transformOrigin"?pr:yt),mo(r,o);a&&(mo(r,yt),n&&(n.svg&&r.removeAttribute("transform"),yo(r,1),n.uncache=1,Ag(s)))}},ch={clearProps:function(e,t,r,s,i){if(i.data!=="isFromStart"){var n=e._pt=new xe(e._pt,t,r,0,0,dA);return n.u=s,n.pr=-10,n.tween=i,e._props.push(r),1}}},go=[1,0,0,1,0,0],kg={},Ng=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},Lg=function(e){var t=kr(e,yt);return Ng(t)?go:t.substr(7).match(Im).map(It)},kc=function(e,t){var r=e._gsap||ci(e),s=e.style,i=Lg(e),n,o,a,h;return r.svg&&e.getAttribute("transform")?(a=e.transform.baseVal.consolidate().matrix,i=[a.a,a.b,a.c,a.d,a.e,a.f],i.join(",")==="1,0,0,1,0,0"?go:i):(i===go&&!e.offsetParent&&e!==ln&&!r.svg&&(a=s.display,s.display="block",n=e.parentNode,(!n||!e.offsetParent)&&(h=1,o=e.nextElementSibling,ln.appendChild(e)),i=Lg(e),a?s.display=a:mo(e,"display"),h&&(o?n.insertBefore(e,o):n?n.appendChild(e):ln.removeChild(e))),t&&i.length>6?[i[0],i[1],i[4],i[5],i[12],i[13]]:i)},Nc=function(e,t,r,s,i,n){var o=e._gsap,a=i||kc(e,!0),h=o.xOrigin||0,u=o.yOrigin||0,d=o.xOffset||0,l=o.yOffset||0,c=a[0],p=a[1],f=a[2],_=a[3],m=a[4],g=a[5],v=t.split(" "),y=parseFloat(v[0])||0,x=parseFloat(v[1])||0,E,T,w,b;r?a!==go&&(T=c*_-p*f)&&(w=y*(_/T)+x*(-f/T)+(f*g-_*m)/T,b=y*(-p/T)+x*(c/T)-(c*g-p*m)/T,y=w,x=b):(E=Mg(e),y=E.x+(~v[0].indexOf("%")?y/100*E.width:y),x=E.y+(~(v[1]||v[0]).indexOf("%")?x/100*E.height:x)),s||s!==!1&&o.smooth?(m=y-h,g=x-u,o.xOffset=d+(m*c+g*f)-m,o.yOffset=l+(m*p+g*_)-g):o.xOffset=o.yOffset=0,o.xOrigin=y,o.yOrigin=x,o.smooth=!!s,o.origin=t,o.originIsAbsolute=!!r,e.style[pr]="0px 0px",n&&(Ps(n,o,"xOrigin",h,y),Ps(n,o,"yOrigin",u,x),Ps(n,o,"xOffset",d,o.xOffset),Ps(n,o,"yOffset",l,o.yOffset)),e.setAttribute("data-svg-origin",y+" "+x)},yo=function(e,t){var r=e._gsap||new ug(e);if("x"in r&&!t&&!r.uncache)return r;var s=e.style,i=r.scaleX<0,n="px",o="deg",a=getComputedStyle(e),h=kr(e,pr)||"0",u,d,l,c,p,f,_,m,g,v,y,x,E,T,w,b,A,R,S,M,I,C,O,L,D,Y,Z,P,G,Q,j,q;return u=d=l=f=_=m=g=v=y=0,c=p=1,r.svg=!!(e.getCTM&&Pg(e)),a.translate&&((a.translate!=="none"||a.scale!=="none"||a.rotate!=="none")&&(s[yt]=(a.translate!=="none"?"translate3d("+(a.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(a.rotate!=="none"?"rotate("+a.rotate+") ":"")+(a.scale!=="none"?"scale("+a.scale.split(" ").join(",")+") ":"")+(a[yt]!=="none"?a[yt]:"")),s.scale=s.rotate=s.translate="none"),T=kc(e,r.svg),r.svg&&(r.uncache?(D=e.getBBox(),h=r.xOrigin-D.x+"px "+(r.yOrigin-D.y)+"px",L=""):L=!t&&e.getAttribute("data-svg-origin"),Nc(e,L||h,!!L||r.originIsAbsolute,r.smooth!==!1,T)),x=r.xOrigin||0,E=r.yOrigin||0,T!==go&&(R=T[0],S=T[1],M=T[2],I=T[3],u=C=T[4],d=O=T[5],T.length===6?(c=Math.sqrt(R*R+S*S),p=Math.sqrt(I*I+M*M),f=R||S?cn(S,R)*yi:0,g=M||I?cn(M,I)*yi+f:0,g&&(p*=Math.abs(Math.cos(g*un))),r.svg&&(u-=x-(x*R+E*M),d-=E-(x*S+E*I))):(q=T[6],Q=T[7],Z=T[8],P=T[9],G=T[10],j=T[11],u=T[12],d=T[13],l=T[14],w=cn(q,G),_=w*yi,w&&(b=Math.cos(-w),A=Math.sin(-w),L=C*b+Z*A,D=O*b+P*A,Y=q*b+G*A,Z=C*-A+Z*b,P=O*-A+P*b,G=q*-A+G*b,j=Q*-A+j*b,C=L,O=D,q=Y),w=cn(-M,G),m=w*yi,w&&(b=Math.cos(-w),A=Math.sin(-w),L=R*b-Z*A,D=S*b-P*A,Y=M*b-G*A,j=I*A+j*b,R=L,S=D,M=Y),w=cn(S,R),f=w*yi,w&&(b=Math.cos(w),A=Math.sin(w),L=R*b+S*A,D=C*b+O*A,S=S*b-R*A,O=O*b-C*A,R=L,C=D),_&&Math.abs(_)+Math.abs(f)>359.9&&(_=f=0,m=180-m),c=It(Math.sqrt(R*R+S*S+M*M)),p=It(Math.sqrt(O*O+q*q)),w=cn(C,O),g=Math.abs(w)>2e-4?w*yi:0,y=j?1/(j<0?-j:j):0),r.svg&&(L=e.getAttribute("transform"),r.forceCSS=e.setAttribute("transform","")||!Ng(kr(e,yt)),L&&e.setAttribute("transform",L))),Math.abs(g)>90&&Math.abs(g)<270&&(i?(c*=-1,g+=f<=0?180:-180,f+=f<=0?180:-180):(p*=-1,g+=g<=0?180:-180)),t=t||r.uncache,r.x=u-((r.xPercent=u&&(!t&&r.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-u)?-50:0)))?e.offsetWidth*r.xPercent/100:0)+n,r.y=d-((r.yPercent=d&&(!t&&r.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-d)?-50:0)))?e.offsetHeight*r.yPercent/100:0)+n,r.z=l+n,r.scaleX=It(c),r.scaleY=It(p),r.rotation=It(f)+o,r.rotationX=It(_)+o,r.rotationY=It(m)+o,r.skewX=g+o,r.skewY=v+o,r.transformPerspective=y+n,(r.zOrigin=parseFloat(h.split(" ")[2])||0)&&(s[pr]=dh(h)),r.xOffset=r.yOffset=0,r.force3D=Pe.force3D,r.renderTransform=r.svg?fA:Cg?Fg:pA,r.uncache=0,r},dh=function(e){return(e=e.split(" "))[0]+" "+e[1]},Lc=function(e,t,r){var s=ae(t);return It(parseFloat(t)+parseFloat(Ds(e,"x",r+"px",s)))+s},pA=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Fg(e,t)},vi="0deg",vo="0px",xi=") ",Fg=function(e,t){var r=t||this,s=r.xPercent,i=r.yPercent,n=r.x,o=r.y,a=r.z,h=r.rotation,u=r.rotationY,d=r.rotationX,l=r.skewX,c=r.skewY,p=r.scaleX,f=r.scaleY,_=r.transformPerspective,m=r.force3D,g=r.target,v=r.zOrigin,y="",x=m==="auto"&&e&&e!==1||m===!0;if(v&&(d!==vi||u!==vi)){var E=parseFloat(u)*un,T=Math.sin(E),w=Math.cos(E),b;E=parseFloat(d)*un,b=Math.cos(E),n=Lc(g,n,T*b*-v),o=Lc(g,o,-Math.sin(E)*-v),a=Lc(g,a,w*b*-v+v)}_!==vo&&(y+="perspective("+_+xi),(s||i)&&(y+="translate("+s+"%, "+i+"%) "),(x||n!==vo||o!==vo||a!==vo)&&(y+=a!==vo||x?"translate3d("+n+", "+o+", "+a+") ":"translate("+n+", "+o+xi),h!==vi&&(y+="rotate("+h+xi),u!==vi&&(y+="rotateY("+u+xi),d!==vi&&(y+="rotateX("+d+xi),(l!==vi||c!==vi)&&(y+="skew("+l+", "+c+xi),(p!==1||f!==1)&&(y+="scale("+p+", "+f+xi),g.style[yt]=y||"translate(0, 0)"},fA=function(e,t){var r=t||this,s=r.xPercent,i=r.yPercent,n=r.x,o=r.y,a=r.rotation,h=r.skewX,u=r.skewY,d=r.scaleX,l=r.scaleY,c=r.target,p=r.xOrigin,f=r.yOrigin,_=r.xOffset,m=r.yOffset,g=r.forceCSS,v=parseFloat(n),y=parseFloat(o),x,E,T,w,b;a=parseFloat(a),h=parseFloat(h),u=parseFloat(u),u&&(u=parseFloat(u),h+=u,a+=u),a||h?(a*=un,h*=un,x=Math.cos(a)*d,E=Math.sin(a)*d,T=Math.sin(a-h)*-l,w=Math.cos(a-h)*l,h&&(u*=un,b=Math.tan(h-u),b=Math.sqrt(1+b*b),T*=b,w*=b,u&&(b=Math.tan(u),b=Math.sqrt(1+b*b),x*=b,E*=b)),x=It(x),E=It(E),T=It(T),w=It(w)):(x=d,w=l,E=T=0),(v&&!~(n+"").indexOf("px")||y&&!~(o+"").indexOf("px"))&&(v=Ds(c,"x",n,"px"),y=Ds(c,"y",o,"px")),(p||f||_||m)&&(v=It(v+p-(p*x+f*T)+_),y=It(y+f-(p*E+f*w)+m)),(s||i)&&(b=c.getBBox(),v=It(v+s/100*b.width),y=It(y+i/100*b.height)),b="matrix("+x+","+E+","+T+","+w+","+v+","+y+")",c.setAttribute("transform",b),g&&(c.style[yt]=b)},_A=function(e,t,r,s,i){var n=360,o=Vt(i),a=parseFloat(i)*(o&&~i.indexOf("rad")?yi:1),h=a-s,u=s+h+"deg",d,l;return o&&(d=i.split("_")[1],d==="short"&&(h%=n,h!==h%(n/2)&&(h+=h<0?n:-n)),d==="cw"&&h<0?h=(h+n*Tg)%n-~~(h/n)*n:d==="ccw"&&h>0&&(h=(h-n*Tg)%n-~~(h/n)*n)),e._pt=l=new xe(e._pt,t,r,s,h,Qw),l.e=u,l.u="deg",e._props.push(r),l},Bg=function(e,t){for(var r in t)e[r]=t[r];return e},mA=function(e,t,r){var s=Bg({},r._gsap),i="perspective,force3D,transformOrigin,svgOrigin",n=r.style,o,a,h,u,d,l,c,p;s.svg?(h=r.getAttribute("transform"),r.setAttribute("transform",""),n[yt]=t,o=yo(r,1),mo(r,yt),r.setAttribute("transform",h)):(h=getComputedStyle(r)[yt],n[yt]=t,o=yo(r,1),n[yt]=h);for(a in es)h=s[a],u=o[a],h!==u&&i.indexOf(a)<0&&(c=ae(h),p=ae(u),d=c!==p?Ds(r,a,h,p):parseFloat(h),l=parseFloat(u),e._pt=new xe(e._pt,o,a,d,l-d,Mc),e._pt.u=p||0,e._props.push(a));Bg(o,s)};ve("padding,margin,Width,Radius",function(e,t){var r="Top",s="Right",i="Bottom",n="Left",o=(t<3?[r,s,i,n]:[r+n,r+s,i+s,i+n]).map(function(a){return t<2?e+a:"border"+a+e});ch[t>1?"border"+e:e]=function(a,h,u,d,l){var c,p;if(arguments.length<4)return c=o.map(function(f){return rs(a,f,u)}),p=c.join(" "),p.split(c[0]).length===5?c[0]:p;c=(d+"").split(" "),p={},o.forEach(function(f,_){return p[f]=c[_]=c[_]||c[(_-1)/2|0]}),a.init(h,p,l)}});var Ug={name:"css",register:Dc,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,r,s,i){var n=this._props,o=e.style,a=r.vars.startAt,h,u,d,l,c,p,f,_,m,g,v,y,x,E,T,w;Cc||Dc(),this.styles=this.styles||Sg(e),w=this.styles.props,this.tween=r;for(f in t)if(f!=="autoRound"&&(u=t[f],!(Oe[f]&&cg(f,t,r,s,e,i)))){if(c=typeof u,p=ch[f],c==="function"&&(u=u.call(r,s,e,i),c=typeof u),c==="string"&&~u.indexOf("random(")&&(u=lo(u)),p)p(this,e,f,u,r)&&(T=1);else if(f.substr(0,2)==="--")h=(getComputedStyle(e).getPropertyValue(f)+"").trim(),u+="",Is.lastIndex=0,Is.test(h)||(_=ae(h),m=ae(u)),m?_!==m&&(h=Ds(e,f,h,m)+m):_&&(u+=_),this.add(o,"setProperty",h,u,s,i,0,0,f),n.push(f),w.push(f,0,o[f]);else if(c!=="undefined"){if(a&&f in a?(h=typeof a[f]=="function"?a[f].call(r,s,e,i):a[f],Vt(h)&&~h.indexOf("random(")&&(h=lo(h)),ae(h+"")||(h+=Pe.units[f]||ae(rs(e,f))||""),(h+"").charAt(1)==="="&&(h=rs(e,f))):h=rs(e,f),l=parseFloat(h),g=c==="string"&&u.charAt(1)==="="&&u.substr(0,2),g&&(u=u.substr(2)),d=parseFloat(u),f in Or&&(f==="autoAlpha"&&(l===1&&rs(e,"visibility")==="hidden"&&d&&(l=0),w.push("visibility",0,o.visibility),Ps(this,o,"visibility",l?"inherit":"hidden",d?"inherit":"hidden",!d)),f!=="scale"&&f!=="transform"&&(f=Or[f],~f.indexOf(",")&&(f=f.split(",")[0]))),v=f in es,v){if(this.styles.save(f),y||(x=e._gsap,x.renderTransform&&!t.parseTransform||yo(e,t.parseTransform),E=t.smoothOrigin!==!1&&x.smooth,y=this._pt=new xe(this._pt,o,yt,0,1,x.renderTransform,x,0,-1),y.dep=1),f==="scale")this._pt=new xe(this._pt,x,"scaleY",x.scaleY,(g?sn(x.scaleY,g+d):d)-x.scaleY||0,Mc),this._pt.u=0,n.push("scaleY",f),f+="X";else if(f==="transformOrigin"){w.push(pr,0,o[pr]),u=cA(u),x.svg?Nc(e,u,0,E,0,this):(m=parseFloat(u.split(" ")[2])||0,m!==x.zOrigin&&Ps(this,x,"zOrigin",x.zOrigin,m),Ps(this,o,f,dh(h),dh(u)));continue}else if(f==="svgOrigin"){Nc(e,u,1,E,0,this);continue}else if(f in kg){_A(this,x,f,l,g?sn(l,g+u):u);continue}else if(f==="smoothOrigin"){Ps(this,x,"smooth",x.smooth,u);continue}else if(f==="force3D"){x[f]=u;continue}else if(f==="transform"){mA(this,u,e);continue}}else f in o||(f=dn(f)||f);if(v||(d||d===0)&&(l||l===0)&&!Zw.test(u)&&f in o)_=(h+"").substr((l+"").length),d||(d=0),m=ae(u)||(f in Pe.units?Pe.units[f]:_),_!==m&&(l=Ds(e,f,h,m)),this._pt=new xe(this._pt,v?x:o,f,l,(g?sn(l,g+d):d)-l,!v&&(m==="px"||f==="zIndex")&&t.autoRound!==!1?tA:Mc),this._pt.u=m||0,_!==m&&m!=="%"&&(this._pt.b=h,this._pt.r=Jw);else if(f in o)uA.call(this,e,f,h,g?g+u:u);else if(f in e)this.add(e,f,h||e[f],g?g+u:u,s,i);else if(f!=="parseTransform"){ic(f,u);continue}v||(f in o?w.push(f,0,o[f]):w.push(f,1,h||e[f])),n.push(f)}}T&&gg(this)},render:function(e,t){if(t.tween._time||!Ic())for(var r=t._pt;r;)r.r(e,r.d),r=r._next;else t.styles.revert()},get:rs,aliases:Or,getSetter:function(e,t,r){var s=Or[t];return s&&s.indexOf(",")<0&&(t=s),t in es&&t!==pr&&(e._gsap.x||rs(e,"x"))?r&&bg===r?t==="scale"?iA:sA:(bg=r||{})&&(t==="scale"?nA:oA):e.style&&!Qu(e.style[t])?eA:~t.indexOf("-")?rA:Tc(e,t)},core:{_removeProperty:mo,_getMatrix:kc}};be.utils.checkPrefix=dn,be.core.getStyleSaver=Sg,function(e,t,r,s){var i=ve(e+","+t+","+r,function(n){es[n]=1});ve(t,function(n){Pe.units[n]="deg",kg[n]=1}),Or[i[13]]=e+","+t,ve(s,function(n){var o=n.split(":");Or[o[1]]=i[o[0]]})}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY"),ve("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(e){Pe.units[e]="px"}),be.registerPlugin(Ug);var ph=be.registerPlugin(Ug)||be;ph.core.Tween;const Fc=class extends et{constructor(){super(),this._gsapContext=null,this._size=new W,this._addFactory=new qg(this),this.gsapContextRevert=this.gsapContextRevert.bind(this)}static get ID(){return"State"}static get Assets(){return[]}get app(){return Rt.instance}get add(){return this._addFactory}get make(){return this.app.make}get animationContext(){return this._gsapContext||(this._gsapContext=ph.context(()=>this.gsapContextRevert)),this._gsapContext}get layout(){return this._layout}get defaultLayoutOptions(){return Fc.DEFAULT_LAYOUT_OPTIONS}getLayoutById(e){return this._layout?this._layout.content.getByID(e):null}init(e,t){this.onResize(e)}createLayout(e){const t=Object.assign({},this.defaultLayoutOptions,e);this._layout=new ue(t),this.onResize(this._size),this.layout.update(),this.add.existing(this._layout)}update(e){this._layout&&this._layout.update()}onResize(e){this._size.copyFrom(e),this.position.set(this._size.x*.5,this._size.y*.5),this._layout&&this._layout.setStyles({width:this._size.x,height:this._size.y})}animateIn(e){e()}animateOut(e){e()}destroy(e={children:!0}){super.destroy(e),this._gsapContext&&this._gsapContext.revert()}gsapContextRevert(){}};let xo=Fc;xo.NAME="State",xo.DEFAULT_LAYOUT_STYLES={root:{position:"center",textAlign:"center"},main:{display:"block",height:"100%",width:"100%",position:"center",verticalAlign:"center"},header:{display:"block",height:"10%",width:"100%",position:"top",verticalAlign:"top"},footer:{display:"block",height:"5%",width:"100%",position:"bottom",textAlign:"right",verticalAlign:"bottom"}},xo.DEFAULT_LAYOUT_OPTIONS={id:"root",content:{header:{id:"header",content:{}},main:{id:"main",content:{}},footer:{id:"footer",content:{}}},globalStyles:Fc.DEFAULT_LAYOUT_STYLES};class Gg{constructor(t,r,...s){t instanceof Object?(this.stateId=t.id,this.data=t.data):this.stateId=t,this.loadScreen=r,this.transitionSteps=s}}var N=(e=>(e[e.AnimNewIn=0]="AnimNewIn",e[e.AnimCurrentOut=1]="AnimCurrentOut",e[e.AnimSimultaneously=2]="AnimSimultaneously",e[e.AttachNewInFront=3]="AttachNewInFront",e[e.AttachNewBehind=4]="AttachNewBehind",e[e.RemoveCurrent=5]="RemoveCurrent",e[e.LoadAssets=6]="LoadAssets",e[e.UnloadAssets=7]="UnloadAssets",e[e.UnloadUnusedAssets=8]="UnloadUnusedAssets",e[e.ShowLoadScreen=9]="ShowLoadScreen",e[e.HideLoadScreen=10]="HideLoadScreen",e[e.Halt=11]="Halt",e[e.PauseAFrame=12]="PauseAFrame",e[e.Pause1Second=13]="Pause1Second",e[e.Pause5Seconds=14]="Pause5Seconds",e))(N||{});const gA=[N.LoadAssets,N.AttachNewBehind,N.HideLoadScreen,N.AnimNewIn];N.ShowLoadScreen,N.RemoveCurrent,N.UnloadAssets,N.LoadAssets,N.AttachNewInFront,N.HideLoadScreen,N.AnimNewIn,N.UnloadUnusedAssets,N.LoadAssets,N.AnimCurrentOut,N.RemoveCurrent,N.UnloadAssets,N.AttachNewInFront,N.AnimNewIn,N.UnloadUnusedAssets,N.AnimCurrentOut,N.RemoveCurrent,N.UnloadAssets,N.LoadAssets,N.AttachNewInFront,N.AnimNewIn,N.UnloadUnusedAssets,N.LoadAssets,N.AttachNewInFront,N.AnimNewIn,N.RemoveCurrent,N.UnloadAssets,N.UnloadUnusedAssets,N.LoadAssets,N.AttachNewBehind,N.AnimCurrentOut,N.RemoveCurrent,N.UnloadAssets,N.AnimNewIn,N.UnloadUnusedAssets,N.LoadAssets,N.AttachNewBehind,N.AnimSimultaneously,N.RemoveCurrent,N.UnloadAssets,N.UnloadUnusedAssets,N.LoadAssets,N.AttachNewInFront,N.AnimSimultaneously,N.RemoveCurrent,N.UnloadAssets,N.UnloadUnusedAssets;class yA extends et{constructor(t){super(),this.app=t,this._currentStateId="undefined",this._queuedStateId="undefined",this._debug=!1,this._size=new W,this._stateData=new Es,this._isTransitioning=!1,this._simultaneousCheckAnimInComplete=!1,this._simultaneousCheckAnimOutComplete=!1,this._transitionStepIndex=0,this._defaultStateId=this.app.defaultState,this.onStateLoadRequested=this.onStateLoadRequested.bind(this),this.app.subscribe(V_,this.onStateLoadRequested)}get default(){return this._defaultStateId}set debug(t){this._debug=t}update(t){this._currentState!==void 0&&this._currentState.update(t)}onResize(t){this._size.copyFrom(t),this._currentState!==void 0&&this._currentState.onResize(this._size)}register(t,r){if(typeof t=="string")this._stateData.setValue(t,{create:r});else{const s=t;this._stateData.setValue(s.NAME,{create:()=>new s})}}transitionTo(t,r,s){const i=t,n=t;s||(s=gA);let o;i!=null&&i.id?o=new Gg(i,r,...s):o=new Gg(n,r,...s),this._newStateToken=o,this.startTransition(o.stateId,o.loadScreen)}startTransition(t,r){if(this.log("Transition requested from %c%s %cto %c%s.",lt,this._currentStateId,Tt,lt,t),this._isTransitioning){this.logW("Transition already in progress, transition to (%s) ignored",t);return}const s=this._stateData.getValue(t);if(s===void 0){this.logE("%c%s%c has not been registered as a state. Please include it in your registerState implementation.",lt,t,Tt);return}this._isTransitioning=!0,this._queuedStateId=t,this._newStateData=s,this._loadScreen=r,this.setAndPerformTransitionStep(0)}handleViewAnimateInComplete(){this.log("handleViewAnimateInComplete");let t;if(this._newStateToken!==void 0)switch(t=this._newStateToken.transitionSteps[this._transitionStepIndex],t){case N.AnimNewIn:this.performNextTransitionStep();break;case N.AnimSimultaneously:this._simultaneousCheckAnimInComplete=!0,this._simultaneousCheckAnimInComplete&&this._simultaneousCheckAnimOutComplete&&this.performNextTransitionStep();break}}handleViewAnimateOutComplete(){this.log("handleViewAnimateOutComplete");let t;if(this._newStateToken!==void 0)switch(t=this._newStateToken.transitionSteps[this._transitionStepIndex],t){case N.AnimCurrentOut:this.performNextTransitionStep();break;case N.AnimSimultaneously:this._simultaneousCheckAnimOutComplete=!0,this._simultaneousCheckAnimInComplete&&this._simultaneousCheckAnimOutComplete&&this.performNextTransitionStep();break}}handleLoadScreenAnimateInComplete(){this.log("handleLoadScreenAnimateInComplete"),this.performNextTransitionStep()}handleLoadScreenAnimateOutComplete(){this.log("handleLoadScreenAnimateOutComplete"),this.performNextTransitionStep()}handleLoadAssetsComplete(){this.log("handleLoadAssetsComplete"),this._newStateToken!==void 0&&this._newStateToken.transitionSteps.length>0&&this._newStateToken.transitionSteps[this._transitionStepIndex]===N.LoadAssets&&this.performNextTransitionStep()}handleUnloadAssetsComplete(){this.log("handleUnloadAssetsComplete"),this.performNextTransitionStep()}handleViewReady(t){this.log("handleViewReady");let r;if(this._newStateToken!==void 0)switch(r=this._newStateToken.transitionSteps[this._transitionStepIndex],r){case N.AttachNewInFront:case N.AttachNewBehind:this.performNextTransitionStep();break}}handleResumeFromHalt(){this.log("handleResumeFromHalt");let t;if(this._newStateToken!==void 0)switch(t=this._newStateToken.transitionSteps[this._transitionStepIndex],t){case N.Halt:this.performNextTransitionStep();break}}performNextTransitionStep(){this.log("performNextTransitionStep"),this.setAndPerformTransitionStep(this._transitionStepIndex+1)}setAndPerformTransitionStep(t){this.log("setAndPerformTransitionStep");let r;this._transitionStepIndex=t,this.log("Step index %s out of %s steps",t,this._newStateToken.transitionSteps.length),this._transitionStepIndex<this._newStateToken.transitionSteps.length?(r=this._newStateToken.transitionSteps[this._transitionStepIndex],this.performTransitionStep(r)):(this.log("%cNO MORE STEPS",ib),this._currentState=this._newState,this._currentStateData=this._newStateData,this._currentStateId=this._newStateToken.stateId,this._newStateToken=void 0,this._newState=void 0,this._newStateData=void 0,this._transitionStepIndex=0,this._isTransitioning=!1,this._simultaneousCheckAnimInComplete=!1,this._simultaneousCheckAnimOutComplete=!1)}performTransitionStep(t){switch(this.log("performTransitionStep(%c%s%c)",Sa,N[t],Tt),t){case N.AnimNewIn:this.performStepAnimNewIn();break;case N.AnimCurrentOut:this.performStepAnimCurrentOut();break;case N.AnimSimultaneously:this.performStepAnimSimultaneously();break;case N.AttachNewInFront:this.performStepAttachNewView(!0);break;case N.AttachNewBehind:this.performStepAttachNewView(!1);break;case N.RemoveCurrent:this.performStepRemoveCurrent();break;case N.LoadAssets:this.performStepLoadAssets();break;case N.UnloadAssets:this.performStepUnloadAssets();break;case N.UnloadUnusedAssets:this.performStepUnloadUnusedAssets();break;case N.ShowLoadScreen:this.performStepShowLoadScreen();break;case N.HideLoadScreen:this.performStepHideLoadScreen();break;case N.Halt:this.performStepHalt();break;case N.PauseAFrame:this.performPause(.1);break;case N.Pause1Second:this.performPause(1);break;case N.Pause5Seconds:this.performPause(5);break}}performStepAnimNewIn(){this.log("performStepAnimNewIn"),this._newState===void 0?(this.logE("The new view is null. Ensure step %s or %s is performed before this one.",N.AttachNewInFront,N.AttachNewBehind),this.performNextTransitionStep()):this._newState.animateIn(this.handleViewAnimateInComplete.bind(this))}performStepAnimCurrentOut(){this.log("performStepAnimCurrentOut"),this._currentState===void 0?(this.logE("The current view is null. Review your transition steps."),this.performNextTransitionStep()):this._currentState.animateOut(this.handleViewAnimateOutComplete.bind(this))}performStepAnimSimultaneously(){this.log("performStepAnimSimultaneously"),this._simultaneousCheckAnimInComplete=!1,this._simultaneousCheckAnimOutComplete=!1,this._newState===void 0?(this.logE("The new view is null. Ensure step %s or %s is performed before this one.",N.AttachNewInFront,N.AttachNewBehind),this._simultaneousCheckAnimInComplete=!0):this._newState.animateIn(this.handleViewAnimateInComplete.bind(this)),this._currentState===void 0?(this.logE("The current view is null. Review your transition steps."),this._simultaneousCheckAnimOutComplete=!0):this._currentState.animateOut(this.handleViewAnimateOutComplete.bind(this)),this._simultaneousCheckAnimInComplete&&this._simultaneousCheckAnimOutComplete&&this.performNextTransitionStep()}performStepAttachNewView(t){this.log("performStepAttachNewView");const r=new Date;this.log(`(%s)
 --- current view: '%s' @ time %s with %s milliseconds`,this._newStateToken.stateId,this._currentStateId,r.toLocaleTimeString(),r.getMilliseconds()),this._newState!==void 0?(this.logE("New view already exists. Review your transition steps."),this.performNextTransitionStep()):(this._newState=this.createState(this._newStateData),this.addChild(this._newState),this._newState.init(this._size,this._newStateToken.data),this.app.broadcast(H_,this._newStateToken.data),t?(this.log("Attaching %c%s%c in %cfront.",lt,this._newStateToken.stateId,Tt,Sa),this.setChildIndex(this._newState,this.children.length-1)):(this.log("Attaching %c%s%c %cbehind.",lt,this._newStateToken.stateId,Tt,Sa),this.setChildIndex(this._newState,0)),this.handleViewReady(this._newStateToken))}performStepRemoveCurrent(){this.log("performStepRemoveCurrent"),this._currentState===void 0?(this.logE("The current view is null. Review your transition steps."),this.performNextTransitionStep()):(this.removeChild(this._currentState),this._currentState.destroy({children:!0}),this._currentState=void 0,delete this._currentState,this.log("Current %c%s%c removed.",lt,this._currentStateId,Tt),this.performNextTransitionStep())}performStepLoadAssets(){this.log("performStepLoadAssets");let t;if(t=this.trimLoadList(this._newStateToken.stateId),t.length>0){const r=new Hg(t,this.handleLoadAssetsComplete.bind(this),this._loadScreen);this.app.broadcast(wu,r)}else this.logW("No new assets to load found for %c%s%c. Advancing transition.",lt,this._newStateToken.stateId,Tt),this.performNextTransitionStep()}performStepUnloadAssets(){this.log("performStepUnloadAssets");const t=this.trimUnloadList(this._currentStateId,this._newStateToken.stateId);if(t!==void 0)if(t.length>0){const r=new Hg(t,this.handleUnloadAssetsComplete.bind(this),this._loadScreen);this.app.broadcast(Au,r)}else this.performNextTransitionStep();else this.performNextTransitionStep()}performStepUnloadUnusedAssets(){this.log("performStepUnloadUnusedAssets"),this.performNextTransitionStep()}performStepShowLoadScreen(){this.log("performStepShowLoadScreen"),this._loadScreen!==void 0?this.app.broadcast(Su,{callback:this.handleLoadScreenAnimateInComplete.bind(this),loadScreen:this._loadScreen,stateData:this._newStateToken!==void 0?this._newStateToken.data:void 0,firstLoad:!1}):this.logE("Load screen show requested with %c%s%c passed in. Please specify a registered load screen to use.",lt,this._loadScreen,Tt)}performStepHideLoadScreen(){this.log("performStepHideLoadScreen"),this._loadScreen!==void 0?this.app.broadcast(Cu,{callback:this.handleLoadScreenAnimateOutComplete.bind(this),loadScreen:this._loadScreen}):this.logE("Load screen show requested with %c%s%c passed in. Please specify a registered load screen to use.",lt,this._loadScreen,Tt)}performStepHalt(){this.log("performStepHalt"),this.app.broadcast(z_,this._newStateToken)}performPause(t){this.log("performPause"),ph.delayedCall(t,this.performNextTransitionStep.bind(this))}trimUnloadList(t,r){const s=Qr.getAssetGroup(t),i=Qr.getAssetGroup(r),n=Rt.instance.requiredAssets.map(a=>a.assetName).concat(...i.map(a=>a.assetName)),o=s.filter(a=>n.indexOf(a.assetName)<0);return this._debug&&o.forEach(a=>{this.log("Added %c%s%c to unload list",lt,a.assetName,Tt)}),o}trimLoadList(t){const r=Qr.getAssetGroup(t),s=new Array;for(const i of r)i.isLoaded()||s.push(i);return s}createState(t){let r;return r=t.create(),r}onStateLoadRequested(t,r){this._newStateToken=r,this.startTransition(r.stateId,r.loadScreen)}log(t,...r){this._debug&&lr(t,{className:"StateManager",color:iu},...r)}logW(t,...r){this._debug&&ys(t,{className:"StateManager",color:iu},...r)}logE(t,...r){Yr(t,{className:"StateManager",color:iu},...r)}}class Bc extends xo{constructor(){super(),this.onLoadComplete=t=>{t()},this._autoProgress=!0}get autoProgress(){return this._autoProgress}onLoadProgress(t){}}let pn=class extends Bc{};pn.NAME="Load_Splash";class vA extends et{constructor(t,r){super(),this.app=t,this._isCurrentLoadScreenPersistent=!0,this._debug=!1,this._size=new W,this._loadScreens=new Es,this._currentLoadScreen=r,this._splashScreen=r,this.showLoadScreen=this.showLoadScreen.bind(this),this.hideLoadScreen=this.hideLoadScreen.bind(this),this.onLoadRequested=this.onLoadRequested.bind(this),this.onUnloadRequested=this.onUnloadRequested.bind(this),this.onLoadScreenComplete=this.onLoadScreenComplete.bind(this),this.onAudioLoadProgress=this.onAudioLoadProgress.bind(this),this.onAllLoadsComplete=this.onAllLoadsComplete.bind(this),this.onPixiLoadProgress=this.onPixiLoadProgress.bind(this),this.onPixiLoadError=this.onPixiLoadError.bind(this),this.app.subscribe(Su,this.showLoadScreen),this.app.subscribe(Cu,this.hideLoadScreen),this.app.subscribe(wu,this.onLoadRequested),this.app.subscribe(Au,this.onUnloadRequested)}set debug(t){this._debug=t}update(t){this._currentLoadScreen!==void 0&&this._currentLoadScreen.update(t)}startSplashProcess(t,r){const s=Qr.getAssetGroup(pn.NAME),i=new Array;for(let n=0;n<t.length;n++){const o=t[n];let a=!1;for(let h=0;h<s.length;h++){const u=s[h];if(o.assetName===u.assetName&&o.assetType===u.assetType){a=!0;break}}a===!1&&i.push(o)}this.loadOnSplash(Qr.getAssetGroup(pn.NAME),()=>{this._splashScreen.init(this._size),this.addChild(this._splashScreen),this._splashScreen.animateIn(()=>this.load(i,r))})}registerLoadScreen(t,r,s=!1){this._loadScreens.setValue(t,r),s&&(this._defaultLoadScreen=r)}onResize(t){this._size.copyFrom(t),this._currentLoadScreen!==void 0&&this._currentLoadScreen.onResize(this._size)}showLoadScreen(t,r){this.log("Show load screen requested: %c%s",lt,r.loadScreen),this._currentLoadScreen=this.getLoadScreen(r.loadScreen),this._currentLoadScreen!==void 0?(this._currentLoadScreen.init(this._size,r.stateData),this.addChild(this._currentLoadScreen),this._currentLoadScreen.animateIn(()=>{this.log("Load screen animate in complete."),r.callback()})):this.logE("%c%s%c has not been registered as a load screen. Please include it in your registerLoadScreen implementation.",lt,r.loadScreen,Tt)}hideLoadScreen(t,r){this.log("Hide load screen requested: %c%s",lt,r.loadScreen);const s=r;this._currentLoadScreen===void 0&&(this._currentLoadScreen=this.getLoadScreen(r.loadScreen)),this._currentLoadScreen!==void 0?this._currentLoadScreen.animateOut(()=>{this.onLoadAnimateOutComplete(),s.callback()}):this.logE("%c%s%c has not been registered as a load screen. Please include it in your registerLoadScreen implementation.",lt,r.loadScreen,Tt)}load(t,r){this._onLoadComplete!==void 0&&this.logW("Replacing existing _onLoadComplete callback!"),this.log("Asset Load requested. Count: %c%s",lt,t===void 0?"Nothing to load":t.length),this._onLoadComplete=r,this.loadAssets(t)}loadOnSplash(t,r){this._onLoadComplete!==void 0&&this.logW("Replacing existing _onLoadComplete callback!"),this.log("Splash Asset Load requested. Count: %c%s",lt,t===void 0?"Nothing to load":t.length),this._onLoadComplete=r,this._currentLoadScreen=this._splashScreen,this.loadAssets(t)}unload(t,r){if(t!==void 0)for(const s of t)this.log("Trying to destroy %c%s",lt,s.assetName),s instanceof Tm?this.destroyAudioResource(s):this.destroyPixiResource(s.assetName),s.destroy();r!==void 0&&r()}getLoadScreen(t){if(this._isCurrentLoadScreenPersistent=!0,t!==void 0){let r=this._loadScreens.getValue(t);if(typeof r=="function"&&(this._isCurrentLoadScreenPersistent=!1,r=r()),r!==void 0)return this.log("Loadscreen %c%s%c found",lt,t,Tt),r;this.log("Load screen %c%s%c not found",lt,t,Tt);return}else{this.log("No load screen requested -> Returning the default loadscreen");let r=this._defaultLoadScreen;return typeof r=="function"&&(this._isCurrentLoadScreenPersistent=!1,r=r()),r}}async loadAssets(t){if(t!==void 0){const r=this.removeRedundantLoads(t),s=[],i=[];for(const n of r)if(!(n.resolutionSuffix&&n.resolutionSuffix!==Zt.resolutionSuffix))if(this.log("file requested: %c%s",lt,n.assetName),n instanceof Tm)s.push(n);else{const o=n.assetPath?Zt.replaceResolutionToken(n.assetPath):Zt.getPathToAsset(n);it.add(n.assetName,o),i.push(n.assetName)}s.length>0?(await it.load(s.map(n=>n.getResource().src),this.onPixiLoadProgress),this.app.broadcast(Iu,{assets:s,progressCallback:this.onAudioLoadProgress,callback:this.onAllLoadsComplete})):(await it.load(i,this.onPixiLoadProgress).catch(n=>this.onPixiLoadError(n)),this.onAllLoadsComplete())}else this.log("Nothing to load"),this.onAllLoadsComplete()}destroyAudioResource(t){Rt.instance.audio.unload(t.assetName,t.category,!0)}destroyPixiResource(t){it.unload(t)}removeRedundantLoads(t){const r=new Array;let s;for(let i=0;i<t.length;++i){let n=!1;s=t[i];for(let o=0;o<r.length;o++){const a=r[o];if(a.assetName===s.assetName&&a.resolutionSuffix===s.resolutionSuffix){n=!0;break}}n?this.log("Excluding %c%s%c from the final list because it is already included.",lt,s.assetName,Tt):(this.log("Adding %c%s%c to the final list.",lt,s.assetName,Tt),r.push(s))}return r}onPixiLoadProgress(t){this._currentLoadScreen!==void 0&&this._currentLoadScreen.onLoadProgress(t)}onPixiLoadError(t){this.logE(t.message)}onAudioLoadProgress(t){this._currentLoadScreen!==void 0&&this._currentLoadScreen.onLoadProgress(t)}onAllLoadsComplete(){this._currentLoadScreen!==void 0?this._currentLoadScreen.onLoadComplete(this.onLoadScreenComplete):this.onLoadScreenComplete(),this.app.broadcast(G_)}onLoadScreenComplete(){if(this.log("Requested load complete."),this._onLoadComplete!==void 0){const t=this._onLoadComplete;this._onLoadComplete=void 0,t()}else this.logE("_onLoadComplete undefined in onLoadScreenComplete")}onLoadAnimateOutComplete(){this.log("Load screen completely hidden."),this._currentLoadScreen&&(this.removeChild(this._currentLoadScreen),this._isCurrentLoadScreenPersistent||this._currentLoadScreen.destroy()),this._currentLoadScreen=void 0,this.app.broadcast(X_)}onLoadRequested(t,r){this.log("Load requested"),this.load(r.assets,r.callback)}onUnloadRequested(t,r){this.log("Unload requested"),this.unload(r.assets,r.callback)}log(t,...r){this._debug&&lr(t,{className:"LoadManager",color:"orange"},...r)}logW(t,...r){this._debug&&ys(t,{className:"LoadManager",color:"orange"},...r)}logE(t,...r){Yr(t,{className:"LoadManager",color:"orange"},...r)}}class Hg{constructor(t,r,s){this.assets=t,this.callback=r,this.loadScreen=s}}class Uc extends Yu{constructor(t,r){super(t,typeof r=="number"?r:bo.JPG),typeof r=="string"&&(this.assetPath=r)}getAsset(){return this.getResource().texture}}var bo=(e=>(e[e.TEXTURE_ATLAS=0]="TEXTURE_ATLAS",e[e.PNG=1]="PNG",e[e.JPG=2]="JPG",e[e.FONT=3]="FONT",e[e.SPINE=4]="SPINE",e[e.SPINE_JSON=5]="SPINE_JSON",e[e.SPINE_SKEL=6]="SPINE_SKEL",e[e.SPINE_ATLAS=7]="SPINE_ATLAS",e[e.AUDIO=8]="AUDIO",e[e.JSON=9]="JSON",e[e.NONE=10]="NONE",e[e.NUM_ELEMENTS=11]="NUM_ELEMENTS",e))(bo||{});class Zt{static getPathToAsset(t,r){switch(t instanceof Yu&&(r=t.assetType,t=t.assetName),r){case 0:return this.FILEPATH_SPRITESHEET+t+this._resolutionSuffix+this.FILE_EXTENSION_JSON;case 2:return this.FILEPATH_IMAGE+t+this._resolutionSuffix+this.FILE_EXTENSION_JPG;case 1:return this.FILEPATH_IMAGE+t+this._resolutionSuffix+this.FILE_EXTENSION_PNG;case 3:return this.FILEPATH_FONT+t+this._resolutionSuffix+this.FILE_EXTENSION_FONT;case 4:return this.FILEPATH_SPINE+t+this._resolutionSuffix+this.FILE_EXTENSION_JSON;case 5:return this.FILEPATH_SPINE+t+this.FILE_EXTENSION_JSON;case 6:return this.FILEPATH_SPINE+t+this.FILE_EXTENSION_SPINE_SKEL;case 7:return this.FILEPATH_SPINE+t+this._resolutionSuffix+this.FILE_EXTENSION_SPINE_ATLAS;case 9:return this.FILEPATH_JSON+t+this.FILE_EXTENSION_JSON;default:return""}}static get resolutionSuffix(){return this._resolutionSuffix}static set resolutionSuffix(t){this._resolutionSuffix=t}static replaceResolutionToken(t,r="@x"){return t.replace(r,this._resolutionSuffix)}}Zt.FILEPATH_IMAGE="assets/images/static/",Zt.FILEPATH_SPRITESHEET="assets/images/spritesheets/",Zt.FILEPATH_AUDIO="assets/audio/",Zt.FILEPATH_FONT="assets/fonts/",Zt.FILEPATH_SPINE="assets/spine/",Zt.FILEPATH_JSON="assets/json/",Zt.FILE_EXTENSION_JSON=".json",Zt.FILE_EXTENSION_PNG=".png",Zt.FILE_EXTENSION_JPG=".jpg",Zt.FILE_EXTENSION_FONT=".fnt",Zt.FILE_EXTENSION_SPINE_ATLAS=".atlas",Zt.FILE_EXTENSION_SPINE_SKEL=".skel";const fh=class{constructor(e,t,r,s=1,i=!1){this._volume=1,this._id=e,this._audioManager=r,this._category=t,it.resolver.basePath!==""?this._urls=fh.getDefaultUrls(this._id).map(n=>it.resolver.basePath+"/"+n):this._urls=fh.getDefaultUrls(this._id),this.loadSource(),this.setVolume(s),this.setLooped(i)}static getDefaultUrls(e){return fh.FILE_EXTENSIONS.map(t=>Zt.FILEPATH_AUDIO+e+"."+t)}get id(){return this._id}getSource(){return this._source}play(){if(this._source.state()===Ji.UNLOADED){console.error(this._id+" source Howl is not loaded. Call loadSource() before playing.");return}this._source.play()}pause(){this._source.pause()}stop(){this._source.stop()}fadeTo(e,t){const r=e*this._audioManager.masterVolume*this._audioManager.getCategoryVolume(this._category);this._source.fade(this._source.volume(),r,t)}unloadSource(){this._source.unload()}loadSource(){this._source===void 0?this._source=new bm.Howl({preload:!0,src:this._urls,onloaderror:this.onLoadError.bind(this)}):(this._source._src=this._urls,this._source.load())}isMuted(){return this._source.mute()}setMuted(e){this._source.mute(e)}isLooped(){return this._source.loop()}setLooped(e){this._source.loop(e)}getVolume(){return this._volume}setVolume(e){this.setVolumeWithModifiers(e,this._audioManager.masterVolume,this._audioManager.getCategoryVolume(this._category))}setVolumeWithModifiers(e,t,r){this._volume=e,this._source.volume(this._volume*t*r)}getTimePos(){return this._source.seek()}setTimePos(e){this._source.seek(e)}getDuration(){return this._source.duration()}isPlaying(){return this._source.playing()}on(e,t){this._source.on(e,t)}off(e,t){this._source.off(e,t)}once(e,t){this._source.once(e,t)}onLoadError(e,t){let r=this._source._src;r instanceof Array&&(r.length===0?r="":r=r[0]),this._urls=this._urls.slice(this._urls.indexOf(r)+1),PubSub.publishSync(Va,{id:this._id,category:this._category,src:r,fallback:[...this._urls],error:t})}};let zg=fh;zg.FILE_EXTENSIONS=["webm","mp3","ogg","m4a"];class xA{constructor(t){this.app=t,this._loadedCount=0,this._debug=!1,this._masterVolume=1,this._previousMasterVolume=this._masterVolume,this._collections=new Es,this._audioLoadTokens=new Array}init(){Rt.instance.webEvents.registerVisibilityChangedCallback(this.onVisibilityChanged.bind(this)),this.app.subscribe(K_,this.onPlayRequested.bind(this)),this.app.subscribe(Z_,this.loadFromIds.bind(this)),this.app.subscribe(Iu,this.loadFromAssetMapData.bind(this)),this.app.subscribe(Va,this.onAudioLoadError.bind(this))}set debug(t){this._debug=t}get masterVolume(){return this._masterVolume}set masterVolume(t){this._masterVolume=ai(t,0,1),this.updateAllCategoryVolume()}getCategoryVolume(t){return this.getCollection(t).volume}setCategoryVolume(t,r){this.getCollection(t).volume=r,this.updateCategoryVolume(t)}getDuration(t,r){const s=this.getAudioTrack(t,r);if(s!==void 0)return s.getDuration()}play(t,r=1,s=!1,i=vm){let n;const o=this.getCollection(i),a=o.tracks.getValue(t);a===void 0?this.load(t,i,()=>{n=o.tracks.getValue(t),n.setLooped(s),n.setVolumeWithModifiers(r,this._masterVolume,o.volume),n.play()}):(a.setLooped(s),a.setVolumeWithModifiers(r,this._masterVolume,o.volume),a.play())}pause(t,r){const s=this.getAudioTrack(t,r);s!==void 0&&s.pause()}stop(t,r){const s=this.getAudioTrack(t,r);s!==void 0&&s.stop()}load(t,r,s){const i=this.getCollection(r);let n,o;typeof t=="string"&&(t=[t]);for(let a=t.length-1;a>=0;--a)o=t[a],n=i.tracks.getValue(o),n===void 0?n=this.createAudioTrack(o,r):n.getSource().state()===Ji.UNLOADED&&n.loadSource();if(s!==void 0){let a=0;for(let h=t.length-1;h>=0;--h){const u=i.tracks.getValue(t[h]).getSource();u.state()!==Ji.LOADED?u.on(xs.LOAD,()=>{++a,a>=t.length&&s()}):++a}a===t.length&&s()}}unload(t,r,s){const i=this.getCollection(r),n=i.tracks.getValue(t);n!==void 0&&(n.unloadSource(),s===!0&&i.tracks.remove(t))}fadeTo(t,r,s,i){const n=this.getAudioTrack(t,r);n!==void 0&&(s=ai(s,0,1),n.fadeTo(s,i))}getAudioTrack(t,r){if(this._collections.containsKey(r))return this._collections.getValue(r).tracks.getValue(t)}createAudioTrack(t,r=vm,s=1,i=!1){this.log("Creating new howler track with id %c%s%c and category %c%s%c.",lt,t,Tt,lt,r,Tt);const n=new zg(t,r,this,s,i);return this.getCollection(r).tracks.setValue(t,n),n}loadFromIds(t,r){this.load(r.assets,r.category,r.callback)}loadFromAssetMapData(t,r){this.log("Loading audio assets from AssetMap."),this._audioLoadTokenCallback=r.callback,this._audioLoadTokenProgressCallback=r.progressCallback,r.assets.forEach(s=>{this._audioLoadTokens.push(s)}),this.tryLoadFirstAssetMapAudioData()}onAudioFromAssetMapDataLoaded(){this._loadedCount++;const t=this._loadedCount/(this._loadedCount+this._audioLoadTokens.length)*100;this._audioLoadTokenProgressCallback(t),this.tryLoadFirstAssetMapAudioData()===!1&&(this.log("All audio from asset map loaded"),this._audioLoadTokenCallback())}tryLoadFirstAssetMapAudioData(){if(this._audioLoadTokens.length>0){const t=this._audioLoadTokens[0];return this._audioLoadTokens.shift(),this.load(t.assetName,t.category,this.onAudioFromAssetMapDataLoaded.bind(this)),!0}return!1}updateAllCategoryVolume(){for(let t=0;t<this._collections.keys().length;++t)this.updateCategoryVolume(this._collections.keys()[t])}updateCategoryVolume(t){const r=this.getCollection(t),s=r.tracks.values();for(let i=s.length-1;i>=0;--i)s[i].setVolumeWithModifiers(s[i].getVolume(),this._masterVolume,r.volume)}getCollection(t){return this._collections.containsKey(t)===!1&&this.createCollection(t),this._collections.getValue(t)}createCollection(t){this._collections.setValue(t,new YE)}onPlayRequested(t,r){this.play(r.id,r.volume,r.loop,r.category)}onVisibilityChanged(t){t?(this._masterVolume=this._previousMasterVolume,this.updateAllCategoryVolume()):(this._previousMasterVolume=this._masterVolume,this._masterVolume=0,this.updateAllCategoryVolume())}onAudioLoadError(t=Va,r){if(r.fallback.length>0){this.logW("Audio Load Error. Trying again with a fallback url.",r);const s=this.getAudioTrack(r.id,r.category);s!==void 0&&s.loadSource()}else this.logE("Audio Load Error. No more fallback urls to try.",r)}log(t,...r){this._debug&&lr(t,{className:"HowlerManager",color:su},...r)}logW(t,...r){this._debug&&ys(t,{className:"HowlerManager",color:su},...r)}logE(t,...r){Yr(t,{className:"HowlerManager",color:su},...r)}}const vt=Tt,Xt=lt,To=Sa;class bA{constructor(t){this.app=t,this.FADE_OUT_DURATION=150,this.debug=!1,this._queue=[],this.log=(r,...s)=>{this.debug&&lr(r,{className:"VoiceOverManager",color:"salmon"},...s)},this.warn=(r,...s)=>{ys(r,{className:"VoiceOverManager",color:"salmon"},...s)},this.error=(r,...s)=>Yr(r,{className:"VoiceOverManager",color:"salmon"},...s),PubSub.subscribe(J_,this.onPause.bind(this)),PubSub.subscribe(tm,this.onResume.bind(this))}get activeVO(){if(this._queue.length>0&&this._queue[0].key)return Rt.instance.audio.getAudioTrack(this._queue[0].key,so)}playVO(t,r,s){Array.isArray(t)||(t=[t]);let i=!1,n=0,o;typeof r=="function"?s=r:typeof r=="object"&&(i=r.skipCC===!0,n=r.priority||0,s=r.callback,o=r.caption,r=r.mode),typeof r!="string"&&(r="override"),this.log("\u{1F5E3} Play VO requested. Key(s): [%c%s%c], Mode: %c%s%c, Priority: %c%s%c",Xt,t.join(", "),vt,To,r,vt,To,n,vt),t.length===1&&this._queue.length===1&&this._queue[0].key===t[0]?(this.warn("\u{1F507} Skipped VO [%c%s%c] because it is already playing",Xt,t[0],vt),s&&s(!1)):this._queue.length===0||r==="override"&&n>=this._queue[0].priority||r==="new"&&n>this._queue[0].priority?(this.stopVO(),this.addToQueue(t,s,i,n,o),this.playNext()):r==="append"?this.addToQueue(t,s,i,n,o):s?(this.warn("\u{1F39F}\u{1F507} Firing callback without playing VO(s) %c%s%c",Xt,t.join(", "),vt),s(!1)):this.warn("\u{1F507} Skipped VO(s) [%c%s%c] because it is lower priority than what was already playing",Xt,t.join(", "),vt)}stopVO(){const t=this.activeVO,r=this._queue[0];this._queue.length>1&&this.log("\u{1F5D1} Clearing VO queue. Length was: %c%s%c",To,this._queue.length,vt),this._queue.splice(0,this._queue.length),t&&(t.off(xs.END),t.getSource().state()===Ji.LOADING?(this.warn("\u{1F6D1} Stopping VO %c%s%c while it is still loading",Xt,t.id,vt),t.stop()):t.isPlaying()?(this.log("\u{1F92B} Fading out VO %c%s%c (duration: %c%s%cms)",Xt,t.id,vt,To,this.FADE_OUT_DURATION,vt),t.fadeTo(0,this.FADE_OUT_DURATION),t.off(xs.END),t.once(xs.FADE,()=>{this.log("\u{1F636} Fade out complete %c%s%c",Xt,t.id,vt),t.stop()}),r&&!r.skipCC&&PubSub.publishSync(Q_,{id:t.id})):t.stop(),PubSub.publishSync(ro,t.id)),this._activeTimeout&&(this._activeTimeout.kill(),this._activeTimeout=void 0)}addToQueue(t,r,s,i,n){for(let a=0;a<t.length;a++){const h=t[a];typeof h=="number"?this.log("\u2795 Queueing delay %c%s%c",Xt,h,vt):this.log("\u2795 Queueing VO %c%s%c",Xt,h,vt),n!==void 0&&a!==0&&(s=!0),this._queue.push({key:typeof h=="string"?h:"",delay:typeof h=="number"?h:void 0,callback:a===t.length-1?r:void 0,skipCC:s,priority:i,caption:n})}const o=t.filter(a=>typeof a=="string");this.log("\u{1F4C2} Loading VO(s) [%c%s%c]",Xt,o.join(", "),vt),Rt.instance.audio.load(o,so)}playNext(){if(this._queue.length>0){const t=this._queue[0];if(t.delay!==void 0)this._activeTimeout&&this._activeTimeout.kill(),this._queue.length===1?(this.log("\u231B Skipping delay because there are no more items in queue"),this._activeTimeout=void 0,this._queue.shift(),t.callback&&t.callback(!0),this.playNext()):(this.log("\u23F3 Waiting %s seconds before next VO",t.delay),this._activeTimeout=ph.delayedCall(t.delay,()=>{this._activeTimeout=void 0,this._queue.shift(),t.callback&&t.callback(!0),this.playNext()}));else{const r=Rt.instance.audio.getAudioTrack(t.key,so);r!==void 0?(r.off(xs.FADE),r.isPlaying()&&(this.warn("\u{1F6D1} Stopping VO %c%s%c (no fade out)",Xt,r.id,vt),r.stop(),PubSub.publishSync(ro,t.key))):this.log("\u{1F4C2} Loading VO %c%s%c",Xt,t.key,vt),Rt.instance.audio.load(t.key,so,()=>{if(this._queue[0]!==t)return;this.log("\u25B6\uFE0F\u25B6\uFE0F Playing VO %c%s%c",Xt,t.key,vt),this.log("\u2139\uFE0F Queue length: %c%s%c",To,this._queue.length,vt),Rt.instance.audio.play(t.key,void 0,!1,so),t.skipCC||(t.caption?PubSub.publishSync(Ru,{id:t.caption.id,args:t.caption.args}):PubSub.publishSync(Ru,{id:t.key}));const s=i=>{this.log("\u{1F3C1} Completed VO %c%s%c",Xt,t.key,vt),PubSub.publishSync(ro,t.key),this._queue.shift(),this._activeTimeout&&(this._activeTimeout.kill(),this._activeTimeout=void 0),this.playNext(),t.callback&&(this.log("\u{1F39F} Firing callback for %c%s%c",Xt,t.key,vt),t.callback(i))};this.activeVO?(this.activeVO.once(xs.END,()=>s(!0)),this.activeVO.once(xs.PLAY,()=>{PubSub.publishSync(Mu,t.key)})):(this.error("\u26A0\uFE0F Vo %c%s%c completed early (did not play?)",Xt,t.key,vt),s(!1))})}}else this.log("\u2705 Nothing left in queue")}onPause(){this.activeVO!==void 0&&this.activeVO.getTimePos()>0&&this.activeVO.isPlaying()&&(this.log("\u23F8 Pausing VO %c%s%c",Xt,this.activeVO.id,vt),this.activeVO.pause(),PubSub.publishSync(ro,this.activeVO.id)),this._activeTimeout&&this._activeTimeout.pause()}onResume(){this.activeVO!==void 0&&this.activeVO.getTimePos()>0&&!this.activeVO.isPlaying()&&(this.log("\u23EF Resuming VO %c%s%c",Xt,this.activeVO.id,vt),this.activeVO.play(),PubSub.publishSync(Mu,this.activeVO.id)),this._activeTimeout&&this._activeTimeout.resume()}}const Vg=class{constructor(e){this.app=e,this._copyChangedCallbacks=new Array,this._languageId=Vg.EN_CA}get curLanguage(){return this._languageId}setData(e,t){t!==void 0&&(this._languageId=t),this._data=e}getCopy(e){return this._data===void 0?(this.logError("Set the copy data first."),"No data set."):this._data[e]===void 0?(this.logError("%s not found.",e),"Missing key."):this._data[e][this._languageId]===void 0?(this.logError("No %s data for %s was found",this._languageId,e),"No data found."):this._data[e][this._languageId]}registerOnChangeLanguageCallback(e){return this._copyChangedCallbacks.indexOf(e)===-1?(this._copyChangedCallbacks.push(e),!0):!1}unregisterOnChangeLanguageCallback(e){const t=this._copyChangedCallbacks.indexOf(e);t>-1&&this._copyChangedCallbacks.splice(t,1)}changeLanguage(e){this._languageId=e,this._copyChangedCallbacks.forEach(t=>{t()})}logError(e,...t){Yr(e,{className:"CopyManager",color:"DarkViolet"},...t)}};let Xg=Vg;Xg.EN_CA="en_ca";var Gc={exports:{}};(function(e,t){function r(h){if(h&&typeof h=="object"){var u=h.which||h.keyCode||h.charCode;u&&(h=u)}if(typeof h=="number")return o[h];var d=String(h),l=s[d.toLowerCase()];if(l)return l;var l=i[d.toLowerCase()];if(l)return l;if(d.length===1)return d.charCodeAt(0)}r.isEventKey=function(h,u){if(h&&typeof h=="object"){var d=h.which||h.keyCode||h.charCode;if(d==null)return!1;if(typeof u=="string"){var l=s[u.toLowerCase()];if(l)return l===d;var l=i[u.toLowerCase()];if(l)return l===d}else if(typeof u=="number")return u===d;return!1}},t=e.exports=r;var s=t.code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=t.aliases={windows:91,"\u21E7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(n=97;n<123;n++)s[String.fromCharCode(n)]=n-32;for(var n=48;n<58;n++)s[n-48]=n;for(n=1;n<13;n++)s["f"+n]=n+111;for(n=0;n<10;n++)s["numpad "+n]=n+96;var o=t.names=t.title={};for(n in s)o[s[n]]=n;for(var a in i)s[a]=i[a]})(Gc,Gc.exports);var Wg=Gc.exports;class TA{constructor(t){this._components=t}get components(){return this._components}contains(t,r){for(let s=0;s<this._components.length;++s)if(this._components[s].contains(t,r))return!0;return!1}}var Os=(e=>(e.CLICK="click",e.MOUSE_DOWN="mousedown",e.MOUSE_MOVE="mousemove",e.MOUSE_OUT="mouseout",e.MOUSE_OVER="mouseover",e.MOUSE_UP="mouseup",e.MOUSE_UP_OUTSIDE="mouseupoutside",e.POINTER_CANCEL="pointercancel",e.POINTER_DOWN="pointerdown",e.POINTER_MOVE="pointermove",e.POINTER_OUT="pointerout",e.POINTER_OVER="pointerover",e.POINTER_TAP="pointertap",e.POINTER_UP="pointerup",e.POINTER_UP_OUTSIDE="pointerupoutside",e.RIGHT_CLICK="rightclick",e.RIGHT_DOWN="rightdown",e.RIGHT_UP="rightup",e.RIGHT_UP_OUTSIDE="rightupoutside",e.TAP="tap",e.TOUCH_CANCEL="touchcancel",e.TOUCH_END="touchend",e.TOUCH_END_OUTSIDE="touchendoutside",e.TOUCH_MOVE="touchmove",e.TOUCH_START="touchstart",e.FOCUS="focus",e.BLUR="blur",e.KEY_DOWN="keydown",e.KEY_PRESS="keypress",e.KEY_UP="keyup",e))(Os||{}),EA=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,wA=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterClamp;

uniform float uAlpha;
uniform vec2 uThickness;
uniform vec4 uColor;
uniform bool uKnockout;

const float DOUBLE_PI = 2. * 3.14159265358979323846264;
const float ANGLE_STEP = \${angleStep};

float outlineMaxAlphaAtPos(vec2 pos) {
    if (uThickness.x == 0. || uThickness.y == 0.) {
        return 0.;
    }

    vec4 displacedColor;
    vec2 displacedPos;
    float maxAlpha = 0.;

    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {
        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);
        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);
        displacedColor = texture2D(uSampler, clamp(displacedPos, filterClamp.xy, filterClamp.zw));
        maxAlpha = max(maxAlpha, displacedColor.a);
    }

    return maxAlpha;
}

void main(void) {
    vec4 sourceColor = texture2D(uSampler, vTextureCoord);
    vec4 contentColor = sourceColor * float(!uKnockout);
    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);
    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);
    gl_FragColor = contentColor + outlineColor;
}
`;const _h=class extends Gt{constructor(e=1,t=0,r=.1,s=1,i=!1){super(EA,wA.replace(/\$\{angleStep\}/,_h.getAngleStep(r))),this._thickness=1,this._alpha=1,this._knockout=!1,this.uniforms.uThickness=new Float32Array([0,0]),this.uniforms.uColor=new Float32Array([0,0,0,1]),this.uniforms.uAlpha=s,this.uniforms.uKnockout=i,Object.assign(this,{thickness:e,color:t,quality:r,alpha:s,knockout:i})}static getAngleStep(e){const t=Math.max(e*_h.MAX_SAMPLES,_h.MIN_SAMPLES);return(Math.PI*2/t).toFixed(7)}apply(e,t,r,s){this.uniforms.uThickness[0]=this._thickness/t._frame.width,this.uniforms.uThickness[1]=this._thickness/t._frame.height,this.uniforms.uAlpha=this._alpha,this.uniforms.uKnockout=this._knockout,e.applyFilter(this,t,r,s)}get alpha(){return this._alpha}set alpha(e){this._alpha=e}get color(){return Bi(this.uniforms.uColor)}set color(e){Up(e,this.uniforms.uColor)}get knockout(){return this._knockout}set knockout(e){this._knockout=e}get thickness(){return this._thickness}set thickness(e){this._thickness=e,this.padding=e}};let jg=_h;jg.MIN_SAMPLES=1,jg.MAX_SAMPLES=100;class AA{constructor(t,r,s=0){this._target=r,this._norm=new W,this._pixel=new W;const i=t.plugins.extract.pixels(r);let n=0,o=0;r.texture.width%1!==0&&(n=-.5),r.texture.height%1!==0&&(o=-.5),this._map=new Array;for(let a=0;a<r.texture.width+n;++a){this._map.push(new Array);for(let h=0;h<r.texture.height+o;++h)this._map[a][h]=i[(h*(r.texture.width+n)+a)*4+3]>s}}get width(){return this._map.length}get scaledWidth(){return this.width*this._target.scale.x}get height(){return this._map[0].length}get scaledHeight(){return this.height*this._target.scale.y}getHitAreaAtPixel(t,r){return this._map[t][r]}contains(t,r){return this._norm.x=(t+this.width*this._target.anchor.x)/this.width,this._norm.y=(r+this.height*this._target.anchor.y)/this.height,this._norm.x>=0&&this._norm.x<=1&&this._norm.y>=0&&this._norm.y<=1?(this._pixel.x=Math.floor(ai(this._norm.x*this._map.length,0,this._map.length-1)),this._pixel.y=Math.floor(ai(this._norm.y*this._map[0].length,0,this._map[0].length-1)),this._map[this._pixel.x][this._pixel.y]):!1}}class SA extends et{constructor(t,r=!1,s=0){super(),this._root=t,this._interval=s,this._elapsed=0,this._active=r,this._graphics=new Ie,this.addChild(this._graphics)}get active(){return this._active}set active(t){this._active=t,this._active===!1?this.clear():this.renderHitAreas()}set interval(t){this._interval=t}update(t){this._active&&(this._interval>0&&(this._elapsed+=t),this._elapsed>=this._interval&&(this._elapsed%=this._interval,this.renderHitAreas()))}renderHitAreas(){this._graphics.clear(),this._graphics.beginFill(16711680,.25),this.renderRecursive(this._root),this._graphics.endFill()}clear(){this._graphics.clear()}renderRecursive(t){if(t.interactive===!0&&t.worldVisible===!0&&this.renderTarget(t),!(!(t instanceof et)||t.children.length===0)&&t instanceof et&&t.interactiveChildren===!0)for(let r=0;r<t.children.length;++r)this.renderRecursive(t.children[r])}renderTarget(t){const r=new Hi;t.parent.worldTransform.decompose(r);const s=new W(r.scale.x/this.parent.scale.x,r.scale.y/this.parent.scale.y),i=new W(s.x*t.scale.x,s.y*t.scale.y),n=t.hitArea,o=t.getGlobalPosition();if(o.x*=1/this.parent.scale.x,o.y*=1/this.parent.scale.y,n instanceof K||n instanceof sa||n instanceof ea||n instanceof ra||n instanceof Wr){const a=n.clone();this._graphics.drawShape(F_(a,o))}else if(n instanceof TA)for(let a=0;a<n.components.length;++a){const h=n.components[a].clone();this._graphics.drawShape(F_(h,o))}else if(n instanceof AA)for(let a=0;a<n.width;++a)for(let h=0;h<n.height;++h)n.getHitAreaAtPixel(a,h)&&this._graphics.drawRect(o.x-n.scaledWidth*.5*i.x+a*i.x,o.y-n.scaledHeight*.5*i.y+h*i.y,i.x,i.y)}}var fr=(e=>(e.UP="Up",e.RIGHT="Right",e.DOWN="Down",e.LEFT="Left",e.FORWARDS="Forwards",e.BACKWARDS="Backwards",e))(fr||{});class CA{constructor(){this._isActive=!1,this._focusables=[],this._neighbours=[]}set isActive(t){this._isActive=t,this._isActive===!1&&this._currentFocusable!==void 0?this.clearFocus():this._isActive===!0&&this._currentFocusable===void 0&&this.focusFirstNode()}get currentFocusable(){return this._currentFocusable}clear(){this._focusables.length=0,this._neighbours.length=0,this.clearFocus()}registerFocusable(t){Array.isArray(t)||(t=[t]);for(const r of t)r&&this._focusables.indexOf(r)<0&&this._focusables.push(r);this._isActive===!0&&this._currentFocusable===void 0&&this.focusFirstNode()}unregisterFocusable(t){Array.isArray(t)||(t=[t]);for(const r of t)if(typeof r=="function")this._focusables=this._focusables.filter(s=>!r(s));else{const s=this._focusables.indexOf(r);s>=0&&this._focusables.splice(s,1)}this._currentFocusable&&t.indexOf(this._currentFocusable)>-1&&(this.clearFocus(),this.focusFirstNode())}step(t){if(this._currentFocusable===void 0)this.focusFirstNode();else if(!this.stepToNeighbour(t)){const r=this._focusables.filter(this.isFocusable);r.length>1?this.stepToNearest(t,r):r.length>0?this.setFocus(r[0]):this.clearFocus()}}clearFocus(){this._currentFocusable!==void 0&&(this._currentFocusable.onFocusEnd(),PubSub.publishSync(Ou,this._currentFocusable),this._currentFocusable=void 0)}setFocus(t){this._currentFocusable!==t&&(this._currentFocusable!==void 0&&(this._currentFocusable.onFocusEnd(),PubSub.publishSync(Ou,this._currentFocusable)),this._currentFocusable=t,this._currentFocusable.onFocusBegin(),PubSub.publishSync(dm,this._currentFocusable))}focusFirstNode(){for(const t of this._focusables)if(this.isFocusable(t)){this.setFocus(t);return}ys("No registered focusables are currently focusable.",{className:"KeyboardMap",color:"brown"})}activateFocussedNode(){this._currentFocusable!==void 0&&this._currentFocusable.onFocusActivated()}forceNeighbour(t,r,s){this._neighbours.push({from:t,to:r,direction:s})}clearNeighbours(){this._neighbours.length=0}stepToNeighbour(t){if(t==="Forwards"||t==="Backwards"){if(this._currentFocusable){const r=this._focusables.filter(this.isFocusable),s=r.indexOf(this._currentFocusable);if(t==="Forwards")return r.length>s+1?(this.setFocus(r[s+1]),!0):(this.setFocus(r[0]),!0);if(s>0)return this.setFocus(r[s-1]),!0;if(s===0)return this.setFocus(r[r.length-1]),!0}return!1}for(const r of this._neighbours)if(r.from===this._currentFocusable&&r.direction===t&&this.isFocusable(r.to))return this.setFocus(r.to),!0;return!1}stepToNearest(t,r){if(this._currentFocusable){const s=this._currentFocusable.getFocusPosition();let i=Number.MAX_VALUE,n;for(const o of r)if(o!==this._currentFocusable){const a=this.calculateWeight(s,o.getFocusPosition(),t);a<i&&(i=a,n=o)}n&&this.setFocus(n)}}calculateWeight(t,r,s){const i=r.x-t.x,n=r.y-t.y;switch(s){case"Up":return n>=0?Number.MAX_VALUE:this.temp(Math.abs(n),Math.abs(i));case"Right":return i<=0?Number.MAX_VALUE:this.temp(Math.abs(i),Math.abs(n));case"Down":return n<=0?Number.MAX_VALUE:this.temp(Math.abs(n),Math.abs(i));case"Left":default:return i>=0?Number.MAX_VALUE:this.temp(Math.abs(i),Math.abs(n))}}temp(t,r){return t+r*(r/t)}isFocusable(t){return t.isFocusable?t.isFocusable():t instanceof et?t.interactive&&t.worldVisible:!1}}var Te=(e=>(e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE_BREAK=19]="PAUSE_BREAK",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACEBAR=32]="SPACEBAR",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.OS_LEFT=91]="OS_LEFT",e[e.OS_RIGHT=92]="OS_RIGHT",e[e.SELECT=93]="SELECT",e[e.NUMPAD_0=96]="NUMPAD_0",e[e.NUMPAD_1=97]="NUMPAD_1",e[e.NUMPAD_2=98]="NUMPAD_2",e[e.NUMPAD_3=99]="NUMPAD_3",e[e.NUMPAD_4=100]="NUMPAD_4",e[e.NUMPAD_5=101]="NUMPAD_5",e[e.NUMPAD_6=102]="NUMPAD_6",e[e.NUMPAD_7=103]="NUMPAD_7",e[e.NUMPAD_8=104]="NUMPAD_8",e[e.NUMPAD_9=105]="NUMPAD_9",e[e.NUMPAD_MULT=106]="NUMPAD_MULT",e[e.NUMPAD_ADD=107]="NUMPAD_ADD",e[e.NUMPAD_SUBTRACT=109]="NUMPAD_SUBTRACT",e[e.NUMPAD_DECIMAL=110]="NUMPAD_DECIMAL",e[e.NUMPAD_DIVIDE=111]="NUMPAD_DIVIDE",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUM_LOCK=144]="NUM_LOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.SEMI_COLON=186]="SEMI_COLON",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.DASH=189]="DASH",e[e.PERIOD=190]="PERIOD",e[e.FORWARD_SLASH=191]="FORWARD_SLASH",e[e.GRAVE=192]="GRAVE",e[e.OPEN_BRACKET=219]="OPEN_BRACKET",e[e.BACK_SLASH=220]="BACK_SLASH",e[e.CLOSE_BRACKET=221]="CLOSE_BRACKET",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e))(Te||{});const mh=class{constructor(e){this._eventSystem=e,this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this._eventSystem.domElement.addEventListener(Os.MOUSE_DOWN,this.onMouseDown),this._eventSystem.domElement.addEventListener(Os.MOUSE_UP,this.onMouseUp)}static get mouseDown(){return mh._mouseDown}onMouseDown(){mh._mouseDown=!0}onMouseUp(){mh._mouseDown=!1}};let Yg=mh;Yg._mouseDown=!1;class Ke{constructor(t){this.app=t,this._debug=!1,this._keyBindings=new Es,this._isActive=!1,this._isEnabled=!0,this._maps=new Array,this.addDefaultBindings(),window.addEventListener(Os.KEY_DOWN,this.onKeyDown.bind(this),!1),window.addEventListener(Os.MOUSE_DOWN,this.onMouseDown.bind(this),!1),window.addEventListener(Os.FOCUS,this.onBrowserFocus.bind(this)),window.addEventListener(Os.BLUR,this.onBrowserBlur.bind(this)),PubSub.subscribe(em,this.onRegisterFocusable.bind(this)),PubSub.subscribe(rm,this.onRegisterFocusable.bind(this)),PubSub.subscribe(sm,this.onUnregisterFocusable.bind(this)),PubSub.subscribe(im,this.onUnregisterFocusable.bind(this)),PubSub.subscribe(nm,this.onUnregisterAllFocusables.bind(this)),PubSub.subscribe(om,this.onClearFocus.bind(this)),PubSub.subscribe(am,this.onForceFocus.bind(this)),PubSub.subscribe(hm,this.onForceNeighbours.bind(this)),PubSub.subscribe(lm,this.onClearNeighbours.bind(this)),PubSub.subscribe(Pu,this.pushMapLayer.bind(this)),PubSub.subscribe(Du,this.popMapLayer.bind(this)),PubSub.subscribe(um,this.onSetKeyboardEnabled.bind(this)),PubSub.subscribe(cm,this.onGetKeyboardStatus.bind(this))}set debug(t){this._debug=t}static bindingToString(t){let r="";return t.altKey&&(r+="alt + "),t.shiftKey&&(r+="shift + "),t.ctrlKey&&(r+="ctrl + "),r+=Wg.names[t.code],r}static doesEventMatchBinding(t,r){return!(!Wg.isEventKey(t,r.code)||(r.altKey??!1)!==t.altKey||(r.shiftKey??!1)!==t.shiftKey||(r.ctrlKey??!1)!==t.ctrlKey)}static areEqual(t,r){return t.code.valueOf()===r.code.valueOf()&&(t.altKey??!1)===(r.altKey??!1)&&(t.shiftKey??!1)===(r.shiftKey??!1)&&(t.ctrlKey??!1)===(r.ctrlKey??!1)}addKeyBinding(t,r,s){const i={code:r,...s},n=this.isKeyBound(r,s??{});if(n!==!1)if(n.direction===t){this.log('addKeyBinding: Ignoring duplicate mapping. "'+Ke.bindingToString(i)+'" is already mapped to "'+t.toString()+'"');return}else this.logW('addKeyBinding: Key "'+Ke.bindingToString(i)+'" was already mapped to a different function. Un-mapping it before adding new binding.'),this.removeKeyBinding(n.direction,n.binding.code,n.binding);this._keyBindings.containsKey(t)?this._keyBindings.getValue(t).push(i):this._keyBindings.setValue(t,[i]),this.log('addKeyBinding: Key "'+Ke.bindingToString(i)+'" is now mapped to "'+t.toString()+'"')}removeKeyBindings(t){this._keyBindings.remove(t),this.log('removeKeyBindings: Cleared all mappings for "'+t.toString()+'"')}removeKeyBinding(t,r,s){const i=this.getKeyBindings(t);let n=!1;for(let o=i.length-1;o>=0;o--)if(Ke.areEqual(i[o],{code:r,...s})){i.splice(o,1),n=!0;break}n?(this._keyBindings.setValue(t,i),this.log('removeKeyBinding: Key "'+Ke.bindingToString({code:r,...s})+'" is no longer mapped to "'+t.toString()+'"')):this.isKeyBound(r,s)?this.logE('removeKeyBinding: Key "'+Ke.bindingToString({code:r,...s})+'" was not mapped to mapped to direction "'+t.toString()+'", so nothing has been removed'):this.logE('removeKeyBinding: Key "'+Ke.bindingToString({code:r,...s})+'" is not mapped to any direction, so nothing has been removed')}removeAllKeyBindings(){this._keyBindings.clear(),this.log("removeAllKeyBindings: All key mappings have been cleared")}getKeyBindings(t){return this._keyBindings.getValue(t)??[]}getAllKeyBindings(){const t=(r,s)=>(r[s.toString()]=this._keyBindings.getValue(s),r);return this._keyBindings.keys().reduce(t,{})}printAllKeyBindings(){this.log("printAllKeyBindings:");const t=this.getAllKeyBindings();Object.keys(t).forEach(r=>{this.log("  "+r+": "+t[r].map(Ke.bindingToString).join(", "))})}addDefaultBindings(){this.log("addDefaultBindings: Adding default key bindings"),this.addKeyBinding(fr.UP,Te.UP),this.addKeyBinding(fr.DOWN,Te.DOWN),this.addKeyBinding(fr.LEFT,Te.LEFT),this.addKeyBinding(fr.RIGHT,Te.RIGHT),this.addKeyBinding(fr.UP,Te.W),this.addKeyBinding(fr.DOWN,Te.S),this.addKeyBinding(fr.LEFT,Te.A),this.addKeyBinding(fr.RIGHT,Te.D),this.addKeyBinding(fr.FORWARDS,Te.TAB),this.addKeyBinding(fr.BACKWARDS,Te.TAB,{shiftKey:!0}),this.addKeyBinding("Enter",Te.ENTER),this.addKeyBinding("Enter",Te.SPACEBAR)}isKeyBound(t,r){let s;return this._keyBindings.forEach((i,n)=>{for(let o=0;o<n.length;o++){const a=n[o],h={code:t,...r};if(Ke.areEqual(a,h))return s={direction:i,binding:n[o]},!1}}),s??!1}onKeyDown(t){this._isEnabled&&(this._isActive===!1?this._maps.length>0&&(this._isActive=!0,this._maps[0].isActive=!0,t.preventDefault()):this._keyBindings.forEach((r,s)=>{s.forEach(i=>{Ke.doesEventMatchBinding(t,i)&&(r==="Enter"?this._maps.length>0&&(this._maps[0].activateFocussedNode(),t.preventDefault()):this.onDirectionPressed(r),t.preventDefault())})}))}onDirectionPressed(t){this._maps.length>0&&this._maps[0].step(t)}onMouseDown(){this._isActive===!0&&(this._isActive=!1,this._maps.length>0&&(this._maps[0].isActive=!1))}onBrowserBlur(){this._isActive&&this._maps.length>0&&(this._maps[0].isActive=!1)}onBrowserFocus(){this._isEnabled&&this._isActive&&this._maps.length>0&&(this._maps[0].isActive=!0)}onRegisterFocusable(t,r){this._maps.length>0&&this._maps[0].registerFocusable(r)}onUnregisterFocusable(t,r){for(const s of this._maps)s.unregisterFocusable(r)}onUnregisterAllFocusables(){for(let t=0;t<this._maps.length;++t)this._maps[t].clear()}onClearFocus(){this._maps.length>0&&this._maps[0].clearFocus()}onForceFocus(t,r){this._isActive&&this._maps.length>0&&this._maps[0].setFocus(r)}onForceNeighbours(t,r){if(this._maps.length>0){Array.isArray(r)||(r=[r]);for(const s of r)s.neighbours.forEach((i,n)=>{if(n!==void 0)return this._maps[0].forceNeighbour(s.target,n,i),!1})}}onClearNeighbours(){this._maps.length>0&&this._maps[0].clearNeighbours()}onSetKeyboardEnabled(t,r){this._isEnabled=r}onGetKeyboardStatus(t,r){r({enabled:this._isEnabled,active:this._isActive,layer:this._maps.length,currentFocusable:this._maps.length>0?this._maps[0].currentFocusable:void 0})}pushMapLayer(){this._maps.length>0&&(this._maps[0].isActive=!1);const t=new CA;this._maps.unshift(t),t.isActive=this._isActive}popMapLayer(){this._maps.length>0&&(this._maps[0].isActive=!1,this._maps[0].clear()),this._maps.shift(),this._maps.length>0&&(this._maps[0].isActive=this._isActive)}log(t,...r){this._debug&&lr(t,{className:"KeyboardManager",color:"brown"},...r)}logW(t,...r){this._debug&&ys(t,{className:"KeyboardManager",color:"brown"},...r)}logE(t,...r){Yr(t,{className:"KeyboardManager",color:"brown"},...r)}}var gh=(e=>(e.MATTER="matter",e.RAPIER="rapier",e))(gh||{});Qg=class{constructor(e){this.app=e,this._debug=!1}get factory(){return this._factory}set debug(e){this._debug=e}get debug(){return!1}get add(){return this.factory.add}set container(e){this.factory.container=e}init(e,t,r,s){}update(e){}addToWorld(e){}removeFromWorld(e){}};class IA extends et{constructor(t,r=0,s=.75){super(),this.app=t,this._debug=!1,this._popups=new Es,this._activePopups=new Array,this._overlayColor=r,this._overlayAlpha=s,PubSub.subscribe(W_,this.handleShowPopup.bind(this)),PubSub.subscribe(j_,this.handleHidePopup.bind(this)),PubSub.subscribe(Y_,this.handleHideAllPopups.bind(this)),PubSub.subscribe($_,this.handleHideTopmostPopup.bind(this)),PubSub.subscribe(q_,this.handleHidePopupComplete.bind(this)),window.addEventListener(Os.KEY_DOWN,this.handleKeyDown.bind(this),!1)}set debug(t){this._debug=t}registerPopup(t,r){this._popups.setValue(r,t),this.log('registerPopup: Registered popup with ID "'+r+'"')}update(t){for(let r=0;r<this._activePopups.length;++r)this._activePopups[r].update(t)}onResize(t){this._size=t,this.position.set(this._size.x*.5,this._size.y*.5);for(let r=0;r<this._activePopups.length;++r)this._activePopups[r].onResize(t)}ShowPopup(t){const r=this._popups.getValue(t.id);if(r!==void 0){this.log('ShowPopup: Creating popup from ID: "'+t.id+'"');const s=r();if(t.backdrop!==!1){const i=this.CreateOverlay();this.addChild(i),s.blackout=i}PubSub.publishSync(Pu,null),s.init(this._size),this.addChild(s),this._activePopups.push(s),this.log("ShowPopup: Showing popup"),s.show(t)}else this.logW('ShowPopup: No popup with the ID "'+t.id+'" has been registered')}HidePopup(t){const r=this.getPopup(t);r!==void 0?(this.log('HidePopup: Attempting to hide popup with ID "'+t+'"'),this._hidePopup(r)):this.logE(`HidePopup: Can't find any active popup with ID "`+t+'"')}HideAllPopups(){if(this._activePopups.length===0)this.logW("HideAllPopups: No popups to hide!");else{this.log("HideAllPopups: Hiding all popups");for(let t=this._activePopups.length-1;t>=0;--t)this._hidePopup(this._activePopups[t])}}HideTopmostPopup(){if(this._activePopups.length===0)this.logW("HideTopmostPopup: No popups to hide!");else{const t=this._activePopups[this._activePopups.length-1];this.log("HideTopmostPopup: Hiding topmost popup"),this._hidePopup(t)}}_hidePopup(t){t.hide()}handleEscapeKeyDown(t){if(this.log("Escape key (or Android back button) pressed"),this._activePopups.length===0)this.logW("No popups to close");else{const r=this._activePopups[this._activePopups.length-1];r.keyboardToClose&&(t.preventDefault(),this._hidePopup(r))}}onHidePopupComplete(t){if(t!==void 0){this._activePopups.splice(this._activePopups.indexOf(t),1),this.removeChild(t),this.log("onHidePopupComplete: Removed popup from stage");const s=t.blackout;s!==void 0?(this.removeChild(s),this.log("onHidePopupComplete: Removed overlay from stage"),s.destroy(),this.log("onHidePopupComplete: Destroyed overlay")):this.logE("onHidePopupComplete: Can't find overlay to remove"),t.destroy(),this.log("onHidePopupComplete: Destroyed popup"),PubSub.publishSync(Du,null)}else this.logE("onHidePopupComplete: parameter pPopup is undefined!");const r=this._activePopups.length;r===0?this.log("onHidePopupComplete: No more popups"):this.log("onHidePopupComplete: "+r+" popups remaining")}handleHidePopup(t,r){this.HidePopup(r)}handleHideAllPopups(t){this.HideAllPopups()}handleShowPopup(t,r){this.ShowPopup(r)}handleHidePopupComplete(t,r){this.onHidePopupComplete(r)}handleHideTopmostPopup(t){this.HideTopmostPopup()}handleKeyDown(t){switch(t.keyCode){case Te.ESC:this.handleEscapeKeyDown(t);break}}CreateOverlay(){const t=new Ie;return t.beginFill(this._overlayColor,this._overlayAlpha),t.drawRect(0,0,2,2),t.endFill(),t.blendMode=V.OVERLAY,t.interactive=!0,t.x=-this._size.x/2,t.y=-this._size.y/2,t.width=this._size.x,t.height=this._size.y,t}getPopup(t){let r;for(let s=this._activePopups.length-1;s>=0;--s)if(this._activePopups[s].id===t){r=this._activePopups[s];break}return r}log(t,...r){this._debug&&lr(t,{className:"PopupManager",color:"blue"},...r)}logW(t,...r){this._debug&&ys(t,{className:"PopupManager",color:"blue"},...r)}logE(t,...r){Yr(t,{className:"PopupManager",color:"blue"},...r)}}class fn{constructor(){this._debug=!1,this._storedCookies=new Es,this.EXPIRE_DATE=new Date(1970,1),fn.FUTURE_DATE=new Date(2050,1),this.readAllValues()}static get NEVER_EXPIRE_DATE(){return this.FUTURE_DATE}get hasUserData(){return this._storedCookies.keys().length>0}set debug(t){this._debug=t}storeBool(t,r,s){const i=r?"true":"false";this.log("STORING BOOL: %s at value: %s",t,i),this.storeValue(t,i,s)}readBool(t,r=!1){const s=this._storedCookies.getValue(t);return s!==void 0?s==="true":r}storeNumber(t,r,s){const i=r.toString();this.log("STORING NUMBER: %s at value: %s",t,i),this.storeValue(t,i,s)}readNumber(t,r=0){const s=this._storedCookies.getValue(t);return s!==void 0?+s:r}storeString(t,r,s){this.log("STORING STRING: %s at value: %s",t,r),this.storeValue(t,r,s)}readString(t,r=""){const s=this._storedCookies.getValue(t);return s!==void 0?s:r}deleteItem(t){const r=this._storedCookies.getValue(t);r!==void 0&&(this.storeValue(t,r,this.EXPIRE_DATE),this._storedCookies.remove(t))}printAll(){this._storedCookies.forEach((t,r)=>{lr("Key: %s | Value: %s",{className:"CookieManager",color:"blue"},t,r)})}setCookieExpiration(t,r){const s=this.readString(t);s!==void 0?this.storeValue(t,s,r):Yr("Trying to set expiration date of ID: %s when it doesn't exist!",{className:"CookieManager",color:"red"},t)}deleteAllData(){this._storedCookies.forEach(t=>{this.deleteItem(t)}),this._storedCookies.clear()}storeValue(t,r,s){this._storedCookies.setValue(t,r);let i=`${t}=${r}`;s!==void 0&&(i+=`;expires=${s.toUTCString()}`),ST()&&(i+=";secure"),i+=";samesite=lax",i+=";path=/",document.cookie=i}readAllValues(){const t=decodeURIComponent(document.cookie).split(";");let r;for(let s=0;s<t.length;++s){if(r=t[s].split("="),r.length<2)continue;const i=r[0].trim(),n=r[1];this._storedCookies.setValue(i,n)}}log(t,...r){this._debug&&lr(t,{className:"CookieStorage",color:"orange"},...r)}}class RA{constructor(){this._debug=!1}get hasUserData(){return localStorage.length>0}set debug(t){this._debug=t}storeBool(t,r){const s=r?"true":"false";this.log("STORING BOOL: %s at value: %s",t,s),localStorage.setItem(t,s)}readBool(t,r=!1){const s=localStorage.getItem(t);return s!==null?s==="true":r}storeNumber(t,r){const s=r.toString();this.log("STORING NUMBER: %s at value: %s",t,s),localStorage.setItem(t,s)}readNumber(t,r=0){const s=localStorage.getItem(t);return s!==null?+s:r}storeString(t,r){this.log("STORING STRING: %s at value: %s",t,r),localStorage.setItem(t,r)}readString(t,r=""){const s=localStorage.getItem(t);return s!==null?s:r}deleteItem(t){return localStorage.getItem(t)!==null?(localStorage.removeItem(t),!0):(this.log("Trying to delete %s when it doesn't exist!",t),!1)}printAll(){for(let t=0;t<localStorage.length;++t){const r=localStorage.key(t);if(r!==null){const s=localStorage.getItem(r);s!==null&&lr("Key: %s | Value: %s",{className:"LocalStorage",color:"blue"},r,s)}}}deleteAllData(){localStorage.clear()}log(t,...r){this._debug&&lr(t,{className:"LocalStorageManager",color:"orange"},...r)}}class MA{constructor(t){this.app=t,this._debug=!1,this._cookieStorage=new fn,this._localStorage=new RA}get hasLocalStorageData(){return this._localStorage.hasUserData}get hasCookieData(){return this._cookieStorage.hasUserData}set debug(t){this._debug=t,this._cookieStorage.debug=t,this._localStorage.debug=t}storeBool(t,r,s=0){switch(s){case 0:this._cookieStorage.storeBool(t,r,fn.NEVER_EXPIRE_DATE);break;case 1:this._localStorage.storeBool(t,r);break}}readBool(t,r=!1,s=0){switch(s){case 0:return this._cookieStorage.readBool(t,r);case 1:return this._localStorage.readBool(t,r)}}storeNumber(t,r,s=0){switch(s){case 0:this._cookieStorage.storeNumber(t,r,fn.NEVER_EXPIRE_DATE);break;case 1:this._localStorage.storeNumber(t,r);break}}readNumber(t,r=0,s=0){switch(s){case 0:return this._cookieStorage.readNumber(t,r);case 1:return this._localStorage.readNumber(t,r)}}storeString(t,r,s=0){switch(s){case 0:this._cookieStorage.storeString(t,r,fn.NEVER_EXPIRE_DATE);break;case 1:this._localStorage.storeString(t,r);break}}readString(t,r="",s=0){switch(s){case 0:return this._cookieStorage.readString(t,r);case 1:return this._localStorage.readString(t,r)}}deleteItem(t,r=0){switch(r){case 0:this._cookieStorage.deleteItem(t);break;case 1:this._localStorage.deleteItem(t);break}}setCookieExpiration(t,r){this._cookieStorage.setCookieExpiration(t,r)}printAll(t){switch(t){case 0:this._cookieStorage.printAll();break;case 1:this._localStorage.printAll();break}}deleteAllData(){this._cookieStorage.deleteAllData(),this._localStorage.deleteAllData()}}const _r=class extends uu{constructor(e){super(new CT(e)),Zt.resolutionSuffix=this.resolutionSuffix,this.update=this.update.bind(this),this.onRequiredAssetsLoaded=this.onRequiredAssetsLoaded.bind(this),this._makeFactory=new $g,this._addFactory=new qg(this.stage),this._size=new W,Ht.shared.add(this.update),this._webEventsManager=new UT(this),this._mouseManager=new Yg(this.renderer.events),this._stateManager=new yA(this),this._popupManager=new IA(this),this._loadManager=new vA(this,this.createSplashScreen()),this._audioManager=new xA(this),this._keyboardManager=new Ke(this),this.resizeTo?this._resizeManager=new _m(this):this._resizeManager=new _m(this,(e==null?void 0:e.sizeMin)||_r.SIZE_MIN_DEFAULT,(e==null?void 0:e.sizeMax)||_r.SIZE_MAX_DEFAULT),this._copyManager=new Xg(this),this._saveManager=new MA(this),this._orientationManager=new BT(this),this._voiceoverManager=new bA(this),this.startSplashProcess=this._loadManager.startSplashProcess.bind(this._loadManager)}static get containerElement(){return document.getElementById(_r.containerID)}static get containerID(){return"game-container"}static get instance(){return _r._instance===void 0&&console.error("You've tried to access the instance of HLF.Application when it hasn't been set. Please set the _instance in your Application."),_r._instance}static createContainer(e){const t=document.createElement("div");return t.setAttribute("id",e),document.body.appendChild(t),t}static create(e=_r.containerID){let t=null;return typeof e=="string"?(t=document.getElementById(e),t||(t=_r.createContainer(e))):e instanceof HTMLElement&&(t=e),t?this.instance.create(t):(console.error("You passed in a DOM Element, but none was found. If you instead pass in a string, a container will be created for you, using the string for its id."),null)}get resolutionSuffix(){return"@"+this.renderer.resolution+"x"}get add(){return this._addFactory}get make(){return this._makeFactory}get addToStage(){return this.stage.addChild.bind(this.stage)}get requiredAssets(){return[]}get state(){return this._stateManager}get audio(){return this._audioManager}get voiceover(){return this._voiceoverManager}get size(){return this._size}get hitAreaRenderer(){return this._hitAreaRenderer}get resizer(){return this._resizeManager}get copy(){return this._copyManager}get webEvents(){return this._webEventsManager}get saveManager(){return this._saveManager}get orientationManager(){return this._orientationManager}get load(){return this._loadManager}get topics(){return FT}get defaultState(){}get physics(){return this._physics}get debugger(){return this._debugger||this.addDebugger(),this._debugger}async addPhysics(e=gh.MATTER){let t;switch(e){case gh.RAPIER:t=await So(()=>import("./RapierPhysicsBase-6f9b0033.js").then(async r=>(await r.__tla,r)),[]);break;case gh.MATTER:default:t=await So(()=>import("./MatterPhysicsBase-948b6b72.js").then(async r=>(await r.__tla,r)),[]);break}return this._physics=new t.default(this),this._physics}broadcast(e,t){return ym.publishSync(e,t)}subscribe(e,t){return ym.subscribe(e,t)}addAssetGroup(e,t){if(typeof e=="string")return Qr.addAssetGroup(e,t);{const r=e;if(!r.NAME)throw new Error(`You tried to add an asset group for ${r}, but it has no NAME defined.`);if(!r.Assets)throw new Error(`You tried to add an asset group for ${r.NAME}, but it has no assets defined.`);return Qr.addAssetGroup(r.NAME,r.Assets)}}hasAsset(e){return it.get(e)!==void 0}create(e){if(e)e.appendChild(_r.instance.view);else return console.error("No element found to append the view to."),null;return _r.instance.init(),_r.instance}async init(e=!0){this.onPlayAudio=this.onPlayAudio.bind(this),this.addToStage(this._stateManager),this.addToStage(this._popupManager),this.addToStage(this._loadManager),this.addToStage(this._hitAreaRenderer=new SA(this.stage)),this._audioManager.init(),this.subscribe(this.topics.PLAY_AUDIO,this.onPlayAudio),this.createAssetMap(),this.registerStates(),this.registerPopups(),this.registerLoadingScreens(),this.startSplashProcess(this.requiredAssets,this.onRequiredAssetsLoaded),this.onResize(0),this.onResize(.5),this._webEventsManager.registerResizeCallback(()=>this.onResize(.5))}async addDebugger(){const e=await So(()=>import("./index-b1999626.js").then(async t=>(await t.__tla,t)),[]).then(t=>t.Debugger);this._debugger=new e(this)}update(){var t;const e=Ht.shared.elapsedMS/1e3;this._stateManager.update(e),this._popupManager.update(e),this._loadManager.update(e),this._hitAreaRenderer.update(e),(t=this._physics)==null||t.update(e)}createSplashScreen(){return new pn}createAssetMap(){}registerLoadingScreens(){}registerPopups(){}registerStates(){}async onResize(e=0){var t,r;if(e>0&&await Vc(e),this._resizeManager.useAspectRatio){this._size.copyFrom(this._resizeManager.getSize());const s=this._resizeManager.getStageScale();this.stage.scale.set(s),this.renderer.resize(this._size.x*s,this._size.y*s)}else{let s=this._size.x,i=this._size.y;if((t=this.resizeTo)!=null&&t.getBoundingClientRect){const n=this.resizeTo;s=n.getBoundingClientRect().width,i=n.getBoundingClientRect().height}else if((r=this.resizeTo)!=null&&r.innerWidth){const n=this.resizeTo;s=n.innerWidth,i=n.innerHeight}this._size=new W(s,i),this._resizeManager.sizeMin=this._size,this._resizeManager.sizeMax=this._size,this.renderer.resize(s,i)}this._stateManager.onResize(this._size),this._loadManager.onResize(this._size),this._popupManager.onResize(this._size),this._orientationManager.onResize(this._size),this.broadcast(this.topics.KEYBOARD_REFOCUS),this._hitAreaRenderer.active&&this._hitAreaRenderer.renderHitAreas(),this.onResizeComplete()}onPlayAudio(e,t){const r=t;this.audio.play(r.id,r.volume,r.loop,r.category)}onResizeComplete(){}async onRequiredAssetsLoaded(){document!=null&&document.fonts&&await document.fonts.ready,this.state.default&&this.state.transitionTo(this.state.default,pn.NAME)}};Rt=_r,Rt.SIZE_MIN_DEFAULT=new W(1024,768),Rt.SIZE_MAX_DEFAULT=new W(1365,768),Ft=function(e){let t=0,r=0;if(Array.isArray(e))t=e[0],r=e[1]||e[0];else if(typeof e=="object"){const s=e;t=s.x||0,r=s.y||0}else t=e,r=e;return{x:t,y:r}};function PA(e){return Array.isArray(e)?e.join("/"):e}function Eo(e,t,r){r&&t?e.name=`${PA(r)}/${t}`:typeof t=="string"&&(e.name=`${t}`),typeof t=="string"&&(e.__textureString=t),Array.isArray(r)?e.__textureSheetArray=r:r&&(e.__textureSheet=r)}class $g{texture(t,r){let s;if(!r||(r==null?void 0:r.length)===0)if(it.cache.has(t))s=it.get(t);else if(it.get(t))s=it.get(t).texture;else throw new Error('Asset "'+t+'" not loaded into Pixi cache');else if(r instanceof Array){const i=r.length;for(let n=0;n<i;n++){const o=r[n];if(it.get(t)){const a=it.get(t).textures;if(a!==void 0){if(s=a[t],s!==void 0)break}else throw new Error('Spritesheet "'+o+'" loaded but textures arent!')}else throw new Error('Spritesheet "'+o+'" not loaded into Pixi cache')}if(s===void 0)throw new Error('Asset "'+t+'" not found inside spritesheets "'+r.toString()+"'")}else if(it.get(r)){const i=it.get(r).textures;if(i!==void 0){if(!i.hasOwnProperty(t))throw new Error('Asset "'+t+'" not found inside spritesheet "'+r+"'");s=i[t]}else throw new Error('Spritesheet "'+r+'" loaded but textures arent?!')}else throw new Error('Spritesheet "'+r+'" not loaded into Pixi cache');return s||new me().texture}sprite(t,r){let s;return s=new me(typeof t=="string"?this.texture(t,r):t),Eo(s,t,r),s}text(t="",r){let s;return s=new Zr(t,r),s}bitmapText(t="",r){let s;return s=new L_(t,r),s}container(){let t;return t=new et,t}graphics(){let t;return t=new Ie,t}tiledSprite(t,r,s,i,n){let o;return o=new vu(this.texture(t,r),s,i),Eo(o,t,r),n&&(o.tilePosition=n),o}mesh(t,r,s,i){let n;return n=new ii(t,r,s,i),n}simpleRope(t,r,s,i){let n;return n=new $x(this.texture(t,r),s),Eo(n,t,r),n.autoUpdate=i!==!1,n}simplePlane(t,r,s,i){let n;return n=new Yx(this.texture(t,r),s,i),Eo(n,t,r),n}simpleMesh(t,r,s,i,n,o){let a;return a=new qf(this.texture(t,r),s,i,n,o),Eo(a,t,r),a}}class qg{constructor(t){this.defaultContainer=t,this._make=new $g}existing(t){return this.defaultContainer.addChild(t)}coloredSprite(t=0,r=1,s={x:0,y:0},i={x:.5,y:.5},n={x:1,y:1}){const o=new Ie;o.beginFill(t),o.drawRect(0,0,1,1),o.endFill();const a=this._make.sprite(Rt.instance.renderer.generateTexture(o));a.tint=t,a.alpha=r;const h=Ft(s),u=Ft(i),d=Ft(n);return a.x=h.x,a.y=h.y,a.anchor.x=u.x,a.anchor.y=u.y,a.scale.x=d.x,a.scale.y=d.y,this.defaultContainer.addChild(a)}sprite(t,r,s=1,i={x:0,y:0},n={x:.5,y:.5},o={x:1,y:1}){const a=this._make.sprite(t,r);a.alpha=s;const h=Ft(i),u=Ft(n),d=Ft(o);return a.x=h.x,a.y=h.y,a.anchor.x=u.x,a.anchor.y=u.y,a.scale.x=d.x,a.scale.y=d.y,this.defaultContainer.addChild(a)}text(t="",r,s=1,i={x:0,y:0},n={x:.5,y:.5},o={x:1,y:1}){const a=this._make.text(t,r);a.alpha=s;const h=Ft(i),u=Ft(n),d=Ft(o);return a.x=h.x,a.y=h.y,a.anchor.x=u.x,a.anchor.y=u.y,a.scale.x=d.x,a.scale.y=d.y,this.defaultContainer.addChild(a)}bitmapText(t,r,s=1,i={x:0,y:0},n={x:.5,y:.5},o={x:1,y:1}){const a=this._make.bitmapText(t,r);a.alpha=s;const h=Ft(i),u=Ft(n),d=Ft(o);return a.x=h.x,a.y=h.y,a.anchor.x=u.x,a.anchor.y=u.y,a.scale.x=d.x,a.scale.y=d.y,this.defaultContainer.addChild(a)}container(t=1,r={x:0,y:0},s={x:1,y:1}){const i=this._make.container();i.alpha=t;const n=Ft(r),o=Ft(s);return i.x=n.x,i.y=n.y,i.scale.x=o.x,i.scale.y=o.y,this.defaultContainer.addChild(i)}graphics(t=1,r={x:0,y:0},s={x:1,y:1}){const i=this._make.graphics();i.alpha=t;const n=Ft(r),o=Ft(s);return i.x=n.x,i.y=n.y,i.scale.x=o.x,i.scale.y=o.y,this.defaultContainer.addChild(i)}}Vc=function(e=0){return new Promise(t=>setTimeout(t,e*1e3))};const DA="html-living-framework",OA="1.1.1",kA="main",NA="5fcff7b8ad4e5dc25dad82b3bc876ba8ba32a7e4";function LA(){let e=`%c${DA} v${OA}`;e+=` - ${kA}`,e+=`#${NA.substr(0,7)}`,e+=" - %chttps://reli.sh",console.log(e,rb,sb)}bi=(e=>(e.RECTANGLE="rectangle",e.CIRCLE="circle",e.CONVEX="convex",e.TRAPEZOID="trapezoid",e.POLYGON="polygon",e.CHAMFER="chamfer",e))(bi||{});const Kg=class extends et{constructor(e,t,r,s="rectangle"){super(),this.onAdded=this.onAdded.bind(this),this.visual=typeof e=="string"?this.addChild(this.app.make.sprite(e,t)):this.addChild(new me(e)),this.visual.anchor.set(.5,.5),r&&(this._size=Ft(r),this.visual.width=this._size.x,this.visual.height=this._size.y),this._bodyType=s,this.on("added",this.onAdded),this.on("removed",this.onRemoved)}get physics(){return this.app.physics}get debugColor(){return Kg.DEFAULT_DEBUG_COLOR}get app(){return Rt.instance}onAdded(){this.createBody(),this.physics.addToWorld(this)}onRemoved(){this.physics.removeFromWorld(this.body)}createBody(){switch(this._bodyType){case"rectangle":this.body=Matter.Bodies.rectangle(this.x,this.y,this.visual.width,this.visual.height);break;case"circle":this.body=Matter.Bodies.circle(this.x,this.y,this.visual.width*.5);break;case"convex":break;case"trapezoid":this.body=Matter.Bodies.trapezoid(this.x,this.y,this.visual.width,this.visual.height,.5);break}}update(){this.visual&&this.body&&(this.x=this.body.position.x,this.y=this.body.position.y,this.rotation=this.body.angle)}};Xc=Kg,Xc.DEFAULT_DEBUG_COLOR=2737654,LA();class Hc extends Bc{constructor(){super(...arguments),this._loaded=!1}init(t,r){super.init(t,r),this._loaded||(this._loaded=!0,this._bg=this.add.sprite("black2x2",null,0,0,.5,[this._size.x,this._size.y]))}onLoadProgress(t){console.log("interstitial progress",t)}async animateIn(t){await Xs.timeline().to(this._bg,{duration:1,alpha:1,ease:Gd.easeOut}),t()}async animateOut(t){await Xs.timeline().to(this._bg,{duration:.5,alpha:0,ease:Gd.easeInOut}),t()}onResize(t){super.onResize(t),this._bg!==void 0&&this._bg.scale.set(this._size.x,this._size.y)}}Hc.NAME="Interstitial";const Zg=5285220;class FA extends xo{constructor(){super()}get app(){return wo.instance}init(t){super.init(t),this._bg=this.add.coloredSprite(Zg),this._bg.eventMode="static",this.createLayout(),this.layout.alpha=0;const r=this.getLayoutById("header"),s=this.getLayoutById("main"),i=this.getLayoutById("footer");r.setStyles({fontFamily:"arboria",height:80,paddingLeft:25,paddingTop:8,fontSize:54,color:"white",background:"rgba(0,0,0,0.05)"}),i.setStyles({fontFamily:"arboria",paddingRight:20,paddingBottom:10,fontSize:14,color:"white"}),s.setStyles({fontFamily:"arboria",paddingRight:10,paddingBottom:10,fontSize:18,color:"white",opacity:.2,textAlign:"center",verticalAlign:"middle",align:"center"}),this._title=this.make.text("",{fontFamily:"arboria",fill:16777215}),this._title.alpha=0,this._mainTitle=this.make.text("",{fontFamily:"arboria",fill:16777215,fontSize:14,align:"center"}),this._mainTitle.alpha=0,this._footerTitle=this.make.text(`\u24B8 ${new Date().getFullYear()} Relish Digital`,{fontFamily:"arboria",fill:16777215,fontSize:14}),this._footerTitle.alpha=0,r.addContent(this._title),s.addContent(this._mainTitle),i.addContent(this._footerTitle)}setHeaderText(t){this._title.text=t}setMainText(t){this._mainTitle.text=t}async animateIn(t){await Xs.timeline().to(this.layout,{alpha:1,duration:.5}).fromTo(this.getLayoutById("header"),{y:-200},{y:0,duration:.4,ease:"sine.out"}).fromTo([this._title,this._mainTitle,this._footerTitle],{alpha:0},{duration:.4,alpha:1,stagger:.1}),t()}async animateOut(t){await Xs.timeline().to(this,{duration:.5,alpha:0}),t()}onResize(t){super.onResize(t),this._bg&&(this._bg.width=this._size.x,this._bg.height=this._size.y)}destroy(){super.destroy()}static get Assets(){return[new Uc("black2x2",bo.PNG)]}}class yh extends FA{constructor(){super()}static get Assets(){return[new Uc("relish-logo-circle",bo.PNG)]}init(t){super.init(t),this.setHeaderText("Matter Physics Example"),this.setMainText(`Click anywhere to add a physics enabled sprite.
Press the 'D' key to toggle debug mode.`),this.startPhysics()}getObjectSize(){return Math.random()*50+50}async startPhysics(){await this.app.addPhysics(),this.app.physics.init(!0,!1),this.app.physics.container=this;const t=this.make.graphics();window.addEventListener("keyup",r=>{r.key==="d"&&(this.app.physics.debug=!this.app.physics.debug)}),this.eventMode="static",this.on("pointerdown",r=>{const s=r.getLocalPosition(this),i=Math.random()>.5?bi.CIRCLE:bi.RECTANGLE,n=i===bi.CIRCLE?this.getObjectSize():[this.getObjectSize(),this.getObjectSize()];if(t.clear(),t.beginFill(Math.floor(Math.random()*16777215)),i===bi.CIRCLE){t.drawCircle(0,0,n*.5),t.endFill();const o=Math.random()>.5;this.app.physics.add.physicsSprite(o?"relish-logo-circle":this.app.renderer.generateTexture(t),void 0,n,i,1,s)}else t.drawRect(0,0,n[0],n[1]),t.endFill(),this.app.physics.add.physicsSprite(this.app.renderer.generateTexture(t),void 0,n,i,1,s);t.clear()})}}yh.NAME="MatterPhysicsExample";class zc extends Bc{init(t){super.init(t)}async animateIn(t){this._bg=this.add.coloredSprite(Zg,0),this.onResize(this.app.size),this.animationContext.add(async()=>{await Xs.to(this._bg,{duration:.75,alpha:1,ease:"sine.out"}),t&&t()})}async animateOut(t){this.animationContext.add(async()=>{await Xs.to(this,{duration:.5,alpha:0,ease:"sine.in"}),t&&t()})}onResize(t){super.onResize(t),this._bg&&(this._bg.width=t.x,this._bg.height=t.y)}static get Assets(){return[]}}zc.NAME="SplashScreen";class wo extends Rt{constructor(){Rt._instance!==void 0&&console.warn("Application is a singleton class and should not be instantiated directly. Use Application.instance instead."),super({resizeTo:wo.containerElement})}static get instance(){return Rt._instance===void 0&&(Rt._instance=new wo),Rt._instance}get requiredAssets(){return[new Uc("black2x2",bo.PNG)]}get defaultState(){return yh.NAME}createSplashScreen(){return new zc}registerLoadingScreens(){this.load.registerLoadScreen(Hc.NAME,new Hc,!0)}registerStates(){this.state.register(yh)}createAssetMap(){this.addAssetGroup(pn.NAME,zc.Assets),this.addAssetGroup(yh)}}wo.create()})();export{Rt as A,bi as B,Vc as D,Xc as M,Qg as P,So as _,UA as __tla,Jg as a,Jt as c,xh as g,Ft as r};
